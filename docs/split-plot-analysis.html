<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Split Plot Analysis | RJafroc Documentation</title>
  <meta name="description" content="Extended RJafroc documentation." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Split Plot Analysis | RJafroc Documentation" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Extended RJafroc documentation." />
  <meta name="github-repo" content="dpc10ster/RJafrocBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Split Plot Analysis | RJafroc Documentation" />
  
  <meta name="twitter:description" content="Extended RJafroc documentation." />
  

<meta name="author" content="Dev P. Chakraborty, PhD" />


<meta name="date" content="2019-08-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="frocdataformat.html">
<link rel="next" href="roidataformat.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RJafroc documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="rocdataformat.html"><a href="rocdataformat.html"><i class="fa fa-check"></i><b>3</b> ROC data format</a><ul>
<li class="chapter" data-level="3.1" data-path="rocdataformat.html"><a href="rocdataformat.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="rocdataformat.html"><a href="rocdataformat.html#an-actual-mrmc-roc-dataset"><i class="fa fa-check"></i><b>3.2</b> An actual MRMC ROC dataset</a><ul>
<li class="chapter" data-level="3.2.1" data-path="rocdataformat.html"><a href="rocdataformat.html#overview-of-the-data-structure"><i class="fa fa-check"></i><b>3.2.1</b> Overview of the data structure</a></li>
<li class="chapter" data-level="3.2.2" data-path="rocdataformat.html"><a href="rocdataformat.html#details-of-the-modalityid-and-readerid-list-members"><i class="fa fa-check"></i><b>3.2.2</b> Details of the <code>modalityID</code> and <code>readerID</code> list members</a></li>
<li class="chapter" data-level="3.2.3" data-path="rocdataformat.html"><a href="rocdataformat.html#details-of-the-nl-and-ll-list-members"><i class="fa fa-check"></i><b>3.2.3</b> Details of the <code>NL</code> and <code>LL</code> list members</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="rocdataformat.html"><a href="rocdataformat.html#the-roc-excel-data-input-file"><i class="fa fa-check"></i><b>3.3</b> The ROC Excel data input file</a><ul>
<li class="chapter" data-level="3.3.1" data-path="rocdataformat.html"><a href="rocdataformat.html#the-excel-file-organization"><i class="fa fa-check"></i><b>3.3.1</b> The Excel file organization</a></li>
<li class="chapter" data-level="3.3.2" data-path="rocdataformat.html"><a href="rocdataformat.html#the-truth-worksheet-organization"><i class="fa fa-check"></i><b>3.3.2</b> The Truth worksheet organization</a></li>
<li class="chapter" data-level="3.3.3" data-path="rocdataformat.html"><a href="rocdataformat.html#the-fpnl-worksheet-organization"><i class="fa fa-check"></i><b>3.3.3</b> The FP/NL worksheet organization</a></li>
<li class="chapter" data-level="3.3.4" data-path="rocdataformat.html"><a href="rocdataformat.html#the-tpll-worksheet-organization"><i class="fa fa-check"></i><b>3.3.4</b> The TP/LL worksheet organization</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="rocdataformat.html"><a href="rocdataformat.html#summary"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="frocdataformat.html"><a href="frocdataformat.html"><i class="fa fa-check"></i><b>4</b> FROC data format</a><ul>
<li class="chapter" data-level="4.1" data-path="frocdataformat.html"><a href="frocdataformat.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="frocdataformat.html"><a href="frocdataformat.html#an-actual-mrmc-froc-dataset"><i class="fa fa-check"></i><b>4.2</b> An actual MRMC FROC dataset</a><ul>
<li class="chapter" data-level="4.2.1" data-path="frocdataformat.html"><a href="frocdataformat.html#the-nl-aand-ll-list-members"><i class="fa fa-check"></i><b>4.2.1</b> The <code>NL</code> aand <code>LL</code> list members</a></li>
<li class="chapter" data-level="4.2.2" data-path="frocdataformat.html"><a href="frocdataformat.html#the-lesionnum-list-member"><i class="fa fa-check"></i><b>4.2.2</b> The <code>lesionNum</code> list member</a></li>
<li class="chapter" data-level="4.2.3" data-path="frocdataformat.html"><a href="frocdataformat.html#the-lesionid-list-member"><i class="fa fa-check"></i><b>4.2.3</b> The <code>lesionID</code> list member</a></li>
<li class="chapter" data-level="4.2.4" data-path="frocdataformat.html"><a href="frocdataformat.html#the-lesionweight-list-member"><i class="fa fa-check"></i><b>4.2.4</b> The <code>LesionWeight</code> list member</a></li>
<li class="chapter" data-level="4.2.5" data-path="frocdataformat.html"><a href="frocdataformat.html#the-datatype-list-member"><i class="fa fa-check"></i><b>4.2.5</b> The <code>dataType</code> list member</a></li>
<li class="chapter" data-level="4.2.6" data-path="frocdataformat.html"><a href="frocdataformat.html#details-of-the-modalityid-and-readerid-list-members-1"><i class="fa fa-check"></i><b>4.2.6</b> Details of the <code>modalityID</code> and <code>readerID</code> list members</a></li>
<li class="chapter" data-level="4.2.7" data-path="frocdataformat.html"><a href="frocdataformat.html#details-of-the-nl-and-ll-list-members-1"><i class="fa fa-check"></i><b>4.2.7</b> Details of the <code>NL</code> and <code>LL</code> list members</a></li>
<li class="chapter" data-level="4.2.8" data-path="frocdataformat.html"><a href="frocdataformat.html#numbers-of-non-diseased-and-diseased-cases-1"><i class="fa fa-check"></i><b>4.2.8</b> Numbers of non-diseased and diseased cases</a></li>
<li class="chapter" data-level="4.2.9" data-path="frocdataformat.html"><a href="frocdataformat.html#why-dimension-the-nl-array-for-the-total-number-of-cases-1"><i class="fa fa-check"></i><b>4.2.9</b> Why dimension the <code>NL</code> array for the total number of cases?</a></li>
<li class="chapter" data-level="4.2.10" data-path="frocdataformat.html"><a href="frocdataformat.html#ratings-on-a-non-diseased-case-1"><i class="fa fa-check"></i><b>4.2.10</b> Ratings on a non-diseased case</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="frocdataformat.html"><a href="frocdataformat.html#the-froc-excel-data-input-file"><i class="fa fa-check"></i><b>4.3</b> The FROC Excel data input file</a><ul>
<li class="chapter" data-level="4.3.1" data-path="frocdataformat.html"><a href="frocdataformat.html#the-truth-worksheet"><i class="fa fa-check"></i><b>4.3.1</b> The Truth worksheet</a></li>
<li class="chapter" data-level="4.3.2" data-path="frocdataformat.html"><a href="frocdataformat.html#the-fpnl-worksheet"><i class="fa fa-check"></i><b>4.3.2</b> The <code>FP/NL</code> worksheet</a></li>
<li class="chapter" data-level="4.3.3" data-path="frocdataformat.html"><a href="frocdataformat.html#the-tpll-worksheet"><i class="fa fa-check"></i><b>4.3.3</b> The <code>TP/LL</code> worksheet</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="frocdataformat.html"><a href="frocdataformat.html#summary-1"><i class="fa fa-check"></i><b>4.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="split-plot-analysis.html"><a href="split-plot-analysis.html"><i class="fa fa-check"></i><b>5</b> Split Plot Analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="split-plot-analysis.html"><a href="split-plot-analysis.html#extending-the-dataset-to-accommodate-split-plot-designs"><i class="fa fa-check"></i><b>5.1</b> Extending the dataset to accommodate split-plot designs</a></li>
<li class="chapter" data-level="5.2" data-path="split-plot-analysis.html"><a href="split-plot-analysis.html#introduction-2"><i class="fa fa-check"></i><b>5.2</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="roidataformat.html"><a href="roidataformat.html"><i class="fa fa-check"></i><b>6</b> ROI data format</a><ul>
<li class="chapter" data-level="6.1" data-path="roidataformat.html"><a href="roidataformat.html#roi-paradigm"><i class="fa fa-check"></i><b>6.1</b> ROI paradigm</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">RJafroc Documentation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="split-plot-analysis" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Split Plot Analysis</h1>
<div id="extending-the-dataset-to-accommodate-split-plot-designs" class="section level2">
<h2><span class="header-section-number">5.1</span> Extending the dataset to accommodate split-plot designs</h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">ds &lt;-<span class="st"> </span>dataset02</a></code></pre></div>
<ul>
<li>Need modality index as before.</li>
<li>Each reader interprets a subset of the cases in both modalities.</li>
<li>Assume reader <code>j</code> interprets <span class="math inline">\(K_j\)</span> cases, where K = <span class="math inline">\(\sum_{i=1}^{J} K_j\)</span> is the total number of cases imaged in both treatments.</li>
<li>What is the structure of the dataset?</li>
<li>LL[i,j, <span class="math inline">\(k_j\)</span>, 1];</li>
<li>Existing structure should suffice as each case is interpreted twice, once in each treatment, by <em>only</em> one reader.</li>
<li>Assume <code>K/J</code> = integer, 100 in the planned study; <code>J</code> = 8, <code>K</code> = 800</li>
<li>Modification is needed only in FOM; also dataType needs to be changed to “SplitPlotRoc” or “SplitPlotFroc”</li>
<li>ROC_SP or FROC_SP</li>
<li>LL[i,j, 800, 1] for ROC</li>
<li>LL[i,j, 800, maxL] for FROC</li>
<li>Likewise for NL arrays</li>
<li>Work next on FOM</li>
</ul>
</div>
<div id="introduction-2" class="section level2">
<h2><span class="header-section-number">5.2</span> Introduction</h2>
<p>Jason:
Thanks for inviting me to join your profile. Could you describe what you were planning on doing? Please use a simple example that illustrates the basic data collection. The key  point I want to be sure about is that strict pairing of readers across different treatments is preserved. I once had a study that had different readers interpreting in different treatments, which makes it impossible to separate the treatment effect (which is our primary interest) from a treatment-reader interaction effect. I am going to post that problem on Research Gate (the regulatory agency was telling them to do the study in a non-scientific way). Dev</p>
<p>Dr. Chakraborty, there will be 8 readers in my study. Around 800 CT images will be collected. Each reader reads 100 CT images unaided and aided by the CADe in two independent reading sessions separated by a washout period of 4 weeks. Each CT image will only be interpreted by one reader. I think it is a split-plot design with cases nested within reader so the strict pairing of readers across different treatments is preserved. Thanks for your help!</p>
<p>Hi Jason,
This problem has been solved in the ROC context (localization information not used) by Hillis and others; they may even have software. To analyze it using localization, one needs to use a location-sensitive figure of merit, like the weighted AFROC. That would be my recommendation. So, for each reader j, one has a figure of merit theta_ij, where i is the modality index. One can average over j, yielding theta_i_dot. Significance testing can be performed in the usual manner - e.g., DBMH or ORH. A custom program would need to be written or one can construct one out of R-scripts using the existing functions in RJafroc (the Windows program is obsolete). I can help in this regard. I would ask you to read the relevant papers and explain to me if my approach, summarized above, is basically correct. In any case, any method for ROC analysis can be adapted to FROC analysis if one uses the appropriate figure of merit. Good luck. Dev</p>
<p>Jason: Attached is the Hillis paper; I am not a statistician and find the term “nested” confusing; this paper claims to analyze split plot design using the OR approach as applied to ROC split plot data; if you think this is the correct approach for your study, apart from the limitation to ROC, I can easily extend the software to analyze FROC split plot data; please review and advise; Dev</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="frocdataformat.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="roidataformat.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["RJafrocBook.pdf", "RJafrocBook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
