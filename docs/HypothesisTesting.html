<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Hypothesis Testing | The RJafroc Book</title>
  <meta name="description" content="Extended RJafroc documentation." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Hypothesis Testing | The RJafroc Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Extended RJafroc documentation." />
  <meta name="github-repo" content="dpc10ster/RJafrocBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Hypothesis Testing | The RJafroc Book" />
  
  <meta name="twitter:description" content="Extended RJafroc documentation." />
  

<meta name="author" content="Dev P. Chakraborty, PhD" />


<meta name="date" content="2020-04-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="BinormalModel.html"/>
<link rel="next" href="DBMHnalysis.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RJafroc documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="a-note-on-the-online-distribution-mechanism-of-the-book.html"><a href="a-note-on-the-online-distribution-mechanism-of-the-book.html"><i class="fa fa-check"></i>A note on the online distribution mechanism of the book</a></li>
<li class="chapter" data-level="" data-path="contributing-to-this-book.html"><a href="contributing-to-this-book.html"><i class="fa fa-check"></i>Contributing to this book</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="NpvPpv.html"><a href="NpvPpv.html"><i class="fa fa-check"></i><b>2</b> Negative and Positive Predictive Values</a>
<ul>
<li class="chapter" data-level="2.1" data-path="NpvPpv.html"><a href="NpvPpv.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="NpvPpv.html"><a href="NpvPpv.html#relevant-equations"><i class="fa fa-check"></i><b>2.2</b> Relevant equations</a></li>
<li class="chapter" data-level="2.3" data-path="NpvPpv.html"><a href="NpvPpv.html#example-calculation-of-ppv-npv-and-accuracy"><i class="fa fa-check"></i><b>2.3</b> Example calculation of PPV, NPV and accuracy</a></li>
<li class="chapter" data-level="2.4" data-path="NpvPpv.html"><a href="NpvPpv.html#comments"><i class="fa fa-check"></i><b>2.4</b> Comments</a></li>
<li class="chapter" data-level="2.5" data-path="NpvPpv.html"><a href="NpvPpv.html#ppv-and-npv-are-irrelevant-to-laboratory-tasks"><i class="fa fa-check"></i><b>2.5</b> PPV and NPV are irrelevant to laboratory tasks</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modelingBinaryTask.html"><a href="modelingBinaryTask.html"><i class="fa fa-check"></i><b>3</b> Modeling the Binary Task</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modelingBinaryTask.html"><a href="modelingBinaryTask.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="modelingBinaryTask.html"><a href="modelingBinaryTask.html#the-equal-variance-binormal-model"><i class="fa fa-check"></i><b>3.2</b> The equal-variance binormal model</a></li>
<li class="chapter" data-level="3.3" data-path="modelingBinaryTask.html"><a href="modelingBinaryTask.html#definitions-and-relevant-formulae"><i class="fa fa-check"></i><b>3.3</b> Definitions and relevant formulae</a></li>
<li class="chapter" data-level="3.4" data-path="modelingBinaryTask.html"><a href="modelingBinaryTask.html#the-normal-distribution-pdf-and-cdf-plots"><i class="fa fa-check"></i><b>3.4</b> The normal distribution pdf and cdf plots</a></li>
<li class="chapter" data-level="3.5" data-path="modelingBinaryTask.html"><a href="modelingBinaryTask.html#binary-ratings"><i class="fa fa-check"></i><b>3.5</b> Binary ratings</a></li>
<li class="chapter" data-level="3.6" data-path="modelingBinaryTask.html"><a href="modelingBinaryTask.html#calculating-confidence-intervals-for-sensitivity-and-specificity"><i class="fa fa-check"></i><b>3.6</b> Calculating confidence intervals for sensitivity and specificity</a></li>
<li class="chapter" data-level="3.7" data-path="modelingBinaryTask.html"><a href="modelingBinaryTask.html#references"><i class="fa fa-check"></i><b>3.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html"><i class="fa fa-check"></i><b>4</b> Ratings Paradigm</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#the-roc-counts-table"><i class="fa fa-check"></i><b>4.2</b> The ROC counts table</a></li>
<li class="chapter" data-level="4.3" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#operating-points-from-counts-table"><i class="fa fa-check"></i><b>4.3</b> Operating points from counts table</a></li>
<li class="chapter" data-level="4.4" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#automating-all-this"><i class="fa fa-check"></i><b>4.4</b> Automating all this</a></li>
<li class="chapter" data-level="4.5" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#relation-between-ratings-paradigm-and-the-binary-paradigm"><i class="fa fa-check"></i><b>4.5</b> Relation between ratings paradigm and the binary paradigm</a></li>
<li class="chapter" data-level="4.6" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#ratings-are-not-numerical-values"><i class="fa fa-check"></i><b>4.6</b> Ratings are not numerical values</a></li>
<li class="chapter" data-level="4.7" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#a-single-clinical-operating-point-from-ratings-data"><i class="fa fa-check"></i><b>4.7</b> A single “clinical” operating point from ratings data</a></li>
<li class="chapter" data-level="4.8" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#observer-performance-studies-as-laboratory-simulations-of-clinical-tasks"><i class="fa fa-check"></i><b>4.8</b> Observer performance studies as laboratory simulations of clinical tasks</a></li>
<li class="chapter" data-level="4.9" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#discrete-vs.-continuous-ratings-the-miller-study"><i class="fa fa-check"></i><b>4.9</b> Discrete vs. continuous ratings: the Miller study</a></li>
<li class="chapter" data-level="4.10" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#references-1"><i class="fa fa-check"></i><b>4.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="BinormalModel.html"><a href="BinormalModel.html"><i class="fa fa-check"></i><b>5</b> Binormal model</a>
<ul>
<li class="chapter" data-level="5.1" data-path="BinormalModel.html"><a href="BinormalModel.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="BinormalModel.html"><a href="BinormalModel.html#the-binormal-model"><i class="fa fa-check"></i><b>5.2</b> The binormal model</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="BinormalModel.html"><a href="BinormalModel.html#binning-the-data"><i class="fa fa-check"></i><b>5.2.1</b> Binning the data</a></li>
<li class="chapter" data-level="5.2.2" data-path="BinormalModel.html"><a href="BinormalModel.html#invariance-of-the-binormal-model-to-arbitrary-monotone-transformations"><i class="fa fa-check"></i><b>5.2.2</b> Invariance of the binormal model to arbitrary monotone transformations</a></li>
<li class="chapter" data-level="5.2.3" data-path="BinormalModel.html"><a href="BinormalModel.html#expressions-for-sensitivity-and-specificity"><i class="fa fa-check"></i><b>5.2.3</b> Expressions for sensitivity and specificity</a></li>
<li class="chapter" data-level="5.2.4" data-path="BinormalModel.html"><a href="BinormalModel.html#binormal-model-in-conventional-notation"><i class="fa fa-check"></i><b>5.2.4</b> Binormal model in “conventional” notation</a></li>
<li class="chapter" data-level="5.2.5" data-path="BinormalModel.html"><a href="BinormalModel.html#properties-of-the-binormal-model-roc-curve"><i class="fa fa-check"></i><b>5.2.5</b> Properties of the binormal model ROC curve</a></li>
<li class="chapter" data-level="5.2.6" data-path="BinormalModel.html"><a href="BinormalModel.html#pdfs-of-the-binormal-model"><i class="fa fa-check"></i><b>5.2.6</b> pdfs of the binormal model</a></li>
<li class="chapter" data-level="5.2.7" data-path="BinormalModel.html"><a href="BinormalModel.html#fitting-the-roc-curve"><i class="fa fa-check"></i><b>5.2.7</b> Fitting the ROC curve</a></li>
<li class="chapter" data-level="5.2.8" data-path="BinormalModel.html"><a href="BinormalModel.html#least-squares-estimation"><i class="fa fa-check"></i><b>5.2.8</b> Least-squares estimation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="BinormalModel.html"><a href="BinormalModel.html#maximum-likelihood-estimation-mle"><i class="fa fa-check"></i><b>5.3</b> Maximum likelihood estimation (MLE)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="BinormalModel.html"><a href="BinormalModel.html#code-implementing-mle"><i class="fa fa-check"></i><b>5.3.1</b> Code implementing MLE</a></li>
<li class="chapter" data-level="5.3.2" data-path="BinormalModel.html"><a href="BinormalModel.html#validating-the-fitting-model"><i class="fa fa-check"></i><b>5.3.2</b> Validating the fitting model</a></li>
<li class="chapter" data-level="5.3.3" data-path="BinormalModel.html"><a href="BinormalModel.html#estimating-the-covariance-matrix"><i class="fa fa-check"></i><b>5.3.3</b> Estimating the covariance matrix</a></li>
<li class="chapter" data-level="5.3.4" data-path="BinormalModel.html"><a href="BinormalModel.html#estimating-the-variance-of-az"><i class="fa fa-check"></i><b>5.3.4</b> Estimating the variance of Az</a></li>
<li class="chapter" data-level="5.3.5" data-path="BinormalModel.html"><a href="BinormalModel.html#expression-for-area-under-roc-curve"><i class="fa fa-check"></i><b>5.3.5</b> Expression for area under ROC curve</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="BinormalModel.html"><a href="BinormalModel.html#discussion"><i class="fa fa-check"></i><b>5.4</b> Discussion</a></li>
<li class="chapter" data-level="5.5" data-path="BinormalModel.html"><a href="BinormalModel.html#references-2"><i class="fa fa-check"></i><b>5.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html"><i class="fa fa-check"></i><b>6</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="6.1" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#hypothesis-testing-for-a-single-modality-single-reader-roc-study"><i class="fa fa-check"></i><b>6.2</b> Hypothesis testing for a single-modality single-reader ROC study</a></li>
<li class="chapter" data-level="6.3" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#type-i-errors"><i class="fa fa-check"></i><b>6.3</b> Type-I errors</a></li>
<li class="chapter" data-level="6.4" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#one-sided-vs.-two-sided-tests"><i class="fa fa-check"></i><b>6.4</b> One sided vs. two sided tests</a></li>
<li class="chapter" data-level="6.5" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#statistical-power"><i class="fa fa-check"></i><b>6.5</b> Statistical power</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#factors-affecting-statistical-power"><i class="fa fa-check"></i><b>6.5.1</b> Factors affecting statistical power</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#comments-1"><i class="fa fa-check"></i><b>6.6</b> Comments</a></li>
<li class="chapter" data-level="6.7" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#why-alpha-is-chosen-to-be-5"><i class="fa fa-check"></i><b>6.7</b> Why alpha is chosen to be 5%</a></li>
<li class="chapter" data-level="6.8" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#discussion-1"><i class="fa fa-check"></i><b>6.8</b> Discussion</a></li>
<li class="chapter" data-level="6.9" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#references-3"><i class="fa fa-check"></i><b>6.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html"><i class="fa fa-check"></i><b>7</b> DBMH-analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#introduction-5"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#historical-background"><i class="fa fa-check"></i><b>7.2</b> Historical background</a></li>
<li class="chapter" data-level="7.3" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#references-4"><i class="fa fa-check"></i><b>7.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rocdataformat.html"><a href="rocdataformat.html"><i class="fa fa-check"></i><b>8</b> ROC DATA FORMAT</a>
<ul>
<li class="chapter" data-level="8.1" data-path="rocdataformat.html"><a href="rocdataformat.html#introduction-6"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="rocdataformat.html"><a href="rocdataformat.html#note-to-existing-users"><i class="fa fa-check"></i><b>8.2</b> Note to existing users</a></li>
<li class="chapter" data-level="8.3" data-path="rocdataformat.html"><a href="rocdataformat.html#the-excel-data-format"><i class="fa fa-check"></i><b>8.3</b> The Excel data format</a></li>
<li class="chapter" data-level="8.4" data-path="rocdataformat.html"><a href="rocdataformat.html#illustrative-toy-file"><i class="fa fa-check"></i><b>8.4</b> Illustrative toy file</a></li>
<li class="chapter" data-level="8.5" data-path="rocdataformat.html"><a href="rocdataformat.html#the-truth-worksheet"><i class="fa fa-check"></i><b>8.5</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="8.6" data-path="rocdataformat.html"><a href="rocdataformat.html#the-structure-of-an-roc-dataset"><i class="fa fa-check"></i><b>8.6</b> The structure of an ROC dataset</a></li>
<li class="chapter" data-level="8.7" data-path="rocdataformat.html"><a href="rocdataformat.html#the-false-positive-fp-ratings"><i class="fa fa-check"></i><b>8.7</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="8.8" data-path="rocdataformat.html"><a href="rocdataformat.html#the-true-positive-tp-ratings"><i class="fa fa-check"></i><b>8.8</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="8.9" data-path="rocdataformat.html"><a href="rocdataformat.html#correspondence-between-nl-member-of-dataset-and-the-fp-worksheet"><i class="fa fa-check"></i><b>8.9</b> Correspondence between <code>NL</code> member of dataset and the <code>FP</code> worksheet</a></li>
<li class="chapter" data-level="8.10" data-path="rocdataformat.html"><a href="rocdataformat.html#correspondence-between-ll-member-of-dataset-and-the-tp-worksheet"><i class="fa fa-check"></i><b>8.10</b> Correspondence between <code>LL</code> member of dataset and the <code>TP</code> worksheet</a></li>
<li class="chapter" data-level="8.11" data-path="rocdataformat.html"><a href="rocdataformat.html#correspondence-using-the-which-function"><i class="fa fa-check"></i><b>8.11</b> Correspondence using the <code>which</code> function</a></li>
<li class="chapter" data-level="8.12" data-path="rocdataformat.html"><a href="rocdataformat.html#references-5"><i class="fa fa-check"></i><b>8.12</b> References</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="frocdataformat.html"><a href="frocdataformat.html"><i class="fa fa-check"></i><b>9</b> FROC data format</a>
<ul>
<li class="chapter" data-level="9.1" data-path="frocdataformat.html"><a href="frocdataformat.html#purpose"><i class="fa fa-check"></i><b>9.1</b> Purpose</a></li>
<li class="chapter" data-level="9.2" data-path="frocdataformat.html"><a href="frocdataformat.html#introduction-7"><i class="fa fa-check"></i><b>9.2</b> Introduction</a></li>
<li class="chapter" data-level="9.3" data-path="frocdataformat.html"><a href="frocdataformat.html#the-excel-data-format-1"><i class="fa fa-check"></i><b>9.3</b> The Excel data format</a></li>
<li class="chapter" data-level="9.4" data-path="frocdataformat.html"><a href="frocdataformat.html#the-truth-worksheet-1"><i class="fa fa-check"></i><b>9.4</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="9.5" data-path="frocdataformat.html"><a href="frocdataformat.html#the-structure-of-an-froc-dataset"><i class="fa fa-check"></i><b>9.5</b> The structure of an FROC dataset</a></li>
<li class="chapter" data-level="9.6" data-path="frocdataformat.html"><a href="frocdataformat.html#the-false-positive-fp-ratings-1"><i class="fa fa-check"></i><b>9.6</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="9.7" data-path="frocdataformat.html"><a href="frocdataformat.html#the-true-positive-tp-ratings-1"><i class="fa fa-check"></i><b>9.7</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="9.8" data-path="frocdataformat.html"><a href="frocdataformat.html#on-the-distribution-of-numbers-of-lesions-in-abnormal-cases"><i class="fa fa-check"></i><b>9.8</b> On the distribution of numbers of lesions in abnormal cases</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="frocdataformat.html"><a href="frocdataformat.html#definition-of-lesdistr-array"><i class="fa fa-check"></i><b>9.8.1</b> Definition of <code>lesDistr</code> array</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="frocdataformat.html"><a href="frocdataformat.html#definition-of-leswghtdistr-array"><i class="fa fa-check"></i><b>9.9</b> Definition of <code>lesWghtDistr</code> array</a></li>
<li class="chapter" data-level="9.10" data-path="frocdataformat.html"><a href="frocdataformat.html#summary"><i class="fa fa-check"></i><b>9.10</b> Summary</a></li>
<li class="chapter" data-level="9.11" data-path="frocdataformat.html"><a href="frocdataformat.html#references-6"><i class="fa fa-check"></i><b>9.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html"><i class="fa fa-check"></i><b>10</b> ROC split plot data format</a>
<ul>
<li class="chapter" data-level="10.1" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#introduction-8"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-excel-data-format-2"><i class="fa fa-check"></i><b>10.2</b> The Excel data format</a></li>
<li class="chapter" data-level="10.3" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-truth-worksheet-2"><i class="fa fa-check"></i><b>10.3</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="10.4" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-structure-of-the-roc-split-plot-dataset"><i class="fa fa-check"></i><b>10.4</b> The structure of the ROC split plot dataset</a></li>
<li class="chapter" data-level="10.5" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-truthtablestr-member"><i class="fa fa-check"></i><b>10.5</b> The <code>truthTableStr</code> member</a></li>
<li class="chapter" data-level="10.6" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-false-positive-fp-ratings-2"><i class="fa fa-check"></i><b>10.6</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="10.7" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-true-positive-tp-ratings-2"><i class="fa fa-check"></i><b>10.7</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="10.8" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#summary-1"><i class="fa fa-check"></i><b>10.8</b> Summary</a></li>
<li class="chapter" data-level="10.9" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#references-7"><i class="fa fa-check"></i><b>10.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html"><i class="fa fa-check"></i><b>11</b> FROC ROC DATA FORMAT SPLIT PLOT</a>
<ul>
<li class="chapter" data-level="11.1" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#introduction-9"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-excel-data-format-3"><i class="fa fa-check"></i><b>11.2</b> The Excel data format</a></li>
<li class="chapter" data-level="11.3" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-truth-worksheet-3"><i class="fa fa-check"></i><b>11.3</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="11.4" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-structure-of-the-froc-split-plot-dataset"><i class="fa fa-check"></i><b>11.4</b> The structure of the FROC split plot dataset</a></li>
<li class="chapter" data-level="11.5" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-false-positive-fp-ratings-3"><i class="fa fa-check"></i><b>11.5</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="11.6" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-true-positive-tp-ratings-3"><i class="fa fa-check"></i><b>11.6</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="11.7" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#summary-2"><i class="fa fa-check"></i><b>11.7</b> Summary</a></li>
<li class="chapter" data-level="11.8" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#references-8"><i class="fa fa-check"></i><b>11.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html"><i class="fa fa-check"></i><b>12</b> QUICK START DBM1</a>
<ul>
<li class="chapter" data-level="12.1" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#introduction-10"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#an-roc-dataset"><i class="fa fa-check"></i><b>12.2</b> An ROC dataset</a></li>
<li class="chapter" data-level="12.3" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#creating-a-dataset-from-a-jafroc-format-file"><i class="fa fa-check"></i><b>12.3</b> Creating a dataset from a JAFROC format file</a></li>
<li class="chapter" data-level="12.4" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#analyzing-the-roc-dataset"><i class="fa fa-check"></i><b>12.4</b> Analyzing the ROC dataset</a></li>
<li class="chapter" data-level="12.5" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#explanation-of-the-output"><i class="fa fa-check"></i><b>12.5</b> Explanation of the output</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#foms"><i class="fa fa-check"></i><b>12.5.1</b> FOMs</a></li>
<li class="chapter" data-level="12.5.2" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#pseudovalue-anova-table"><i class="fa fa-check"></i><b>12.5.2</b> Pseudovalue ANOVA table</a></li>
<li class="chapter" data-level="12.5.3" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#pseudovalue-anova-table-each-treatment"><i class="fa fa-check"></i><b>12.5.3</b> Pseudovalue ANOVA table, each treatment</a></li>
<li class="chapter" data-level="12.5.4" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#pseudovalue-variance-components"><i class="fa fa-check"></i><b>12.5.4</b> Pseudovalue Variance Components</a></li>
<li class="chapter" data-level="12.5.5" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#random-reader-random-case-rrrc-analysis"><i class="fa fa-check"></i><b>12.5.5</b> Random-reader random-case (RRRC) analysis</a></li>
<li class="chapter" data-level="12.5.6" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#fixed-reader-random-case-frrc-analysis"><i class="fa fa-check"></i><b>12.5.6</b> Fixed-reader random-case (FRRC) analysis</a></li>
<li class="chapter" data-level="12.5.7" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#random-reader-fixed-case-rrfc-analysis"><i class="fa fa-check"></i><b>12.5.7</b> Random-reader fixed-case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#orh-significance-testing"><i class="fa fa-check"></i><b>12.6</b> ORH significance testing</a></li>
<li class="chapter" data-level="12.7" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#references-9"><i class="fa fa-check"></i><b>12.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="QuickStartDBM2.html"><a href="QuickStartDBM2.html"><i class="fa fa-check"></i><b>13</b> QUICK START DBM2</a>
<ul>
<li class="chapter" data-level="13.1" data-path="QuickStartDBM2.html"><a href="QuickStartDBM2.html#introduction-11"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="QuickStartDBM2.html"><a href="QuickStartDBM2.html#generating-the-excel-output-file"><i class="fa fa-check"></i><b>13.2</b> Generating the Excel output file</a></li>
<li class="chapter" data-level="13.3" data-path="QuickStartDBM2.html"><a href="QuickStartDBM2.html#orh-significance-testing-1"><i class="fa fa-check"></i><b>13.3</b> ORH significance testing</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="SSFDistr.html"><a href="SSFDistr.html"><i class="fa fa-check"></i><b>14</b> BACKGROUND ON THE F-DISTRIBUTION</a>
<ul>
<li class="chapter" data-level="14.1" data-path="SSFDistr.html"><a href="SSFDistr.html#introduction-12"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="SSFDistr.html"><a href="SSFDistr.html#effect-of-ncp-for-ndf-2-and-ddf-10"><i class="fa fa-check"></i><b>14.2</b> Effect of <code>ncp</code> for <code>ndf</code> = 2 and <code>ddf</code> = 10</a></li>
<li class="chapter" data-level="14.3" data-path="SSFDistr.html"><a href="SSFDistr.html#comments-2"><i class="fa fa-check"></i><b>14.3</b> Comments</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-a"><i class="fa fa-check"></i><b>14.3.1</b> Fig. A</a></li>
<li class="chapter" data-level="14.3.2" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-b"><i class="fa fa-check"></i><b>14.3.2</b> Fig. B</a></li>
<li class="chapter" data-level="14.3.3" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-c"><i class="fa fa-check"></i><b>14.3.3</b> Fig. C</a></li>
<li class="chapter" data-level="14.3.4" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-d"><i class="fa fa-check"></i><b>14.3.4</b> Fig. D</a></li>
<li class="chapter" data-level="14.3.5" data-path="SSFDistr.html"><a href="SSFDistr.html#summary-3"><i class="fa fa-check"></i><b>14.3.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="SSFDistr.html"><a href="SSFDistr.html#effect-of-ncp-for-ndf-2-and-ddf-100"><i class="fa fa-check"></i><b>14.4</b> Effect of <code>ncp</code> for <code>ndf</code> = 2 and <code>ddf</code> = 100</a></li>
<li class="chapter" data-level="14.5" data-path="SSFDistr.html"><a href="SSFDistr.html#comments-3"><i class="fa fa-check"></i><b>14.5</b> Comments</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-e"><i class="fa fa-check"></i><b>14.5.1</b> Fig. E</a></li>
<li class="chapter" data-level="14.5.2" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-f"><i class="fa fa-check"></i><b>14.5.2</b> Fig. F</a></li>
<li class="chapter" data-level="14.5.3" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-g"><i class="fa fa-check"></i><b>14.5.3</b> Fig. G</a></li>
<li class="chapter" data-level="14.5.4" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-h"><i class="fa fa-check"></i><b>14.5.4</b> Fig. H</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="SSFDistr.html"><a href="SSFDistr.html#effect-of-ncp-for-ndf-1-ddf-100"><i class="fa fa-check"></i><b>14.6</b> Effect of <code>ncp</code> for <code>ndf</code> = 1, <code>ddf</code> = 100</a></li>
<li class="chapter" data-level="14.7" data-path="SSFDistr.html"><a href="SSFDistr.html#comments-4"><i class="fa fa-check"></i><b>14.7</b> Comments</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-i"><i class="fa fa-check"></i><b>14.7.1</b> Fig. I</a></li>
<li class="chapter" data-level="14.7.2" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-j"><i class="fa fa-check"></i><b>14.7.2</b> Fig. J</a></li>
<li class="chapter" data-level="14.7.3" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-k"><i class="fa fa-check"></i><b>14.7.3</b> Fig. K</a></li>
<li class="chapter" data-level="14.7.4" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-l"><i class="fa fa-check"></i><b>14.7.4</b> Fig. L</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="SSFDistr.html"><a href="SSFDistr.html#summary-4"><i class="fa fa-check"></i><b>14.8</b> Summary</a></li>
<li class="chapter" data-level="14.9" data-path="SSFDistr.html"><a href="SSFDistr.html#references-10"><i class="fa fa-check"></i><b>14.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html"><i class="fa fa-check"></i><b>15</b> ROC-DBMH sample size from first principles</a>
<ul>
<li class="chapter" data-level="15.1" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#introduction-13"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#sample-size-estimation-using-the-dbmh-method"><i class="fa fa-check"></i><b>15.2</b> Sample size estimation using the DBMH method</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#random-reader-random-case-rrrc"><i class="fa fa-check"></i><b>15.2.1</b> Random reader random case (RRRC)</a></li>
<li class="chapter" data-level="15.2.2" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#fixed-reader-random-case-frrc"><i class="fa fa-check"></i><b>15.2.2</b> Fixed reader random case (FRRC)</a></li>
<li class="chapter" data-level="15.2.3" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#random-reader-fixed-case-rrfc"><i class="fa fa-check"></i><b>15.2.3</b> Random reader fixed case (RRFC)</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#summary-5"><i class="fa fa-check"></i><b>15.3</b> Summary</a></li>
<li class="chapter" data-level="15.4" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#references-11"><i class="fa fa-check"></i><b>15.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html"><i class="fa fa-check"></i><b>16</b> ROC-DBMH sample size using RJafroc</a>
<ul>
<li class="chapter" data-level="16.1" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#introduction-14"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#illustration-of-sspowergivenjk-using-method-dbmh"><i class="fa fa-check"></i><b>16.2</b> Illustration of <code>SsPowerGivenJK()</code> using <code>method = "DBMH"</code></a></li>
<li class="chapter" data-level="16.3" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#illustration-of-sspowertable-using-method-dbmh"><i class="fa fa-check"></i><b>16.3</b> Illustration of <code>SsPowerTable()</code> using <code>method = "DBMH"</code></a></li>
<li class="chapter" data-level="16.4" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#illustration-of-sssamplesizekgivenj-using-method-dbmh"><i class="fa fa-check"></i><b>16.4</b> Illustration of <code>SsSampleSizeKGivenJ()</code> using <code>method = "DBMH"</code></a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#rrrc"><i class="fa fa-check"></i><b>16.4.1</b> RRRC</a></li>
<li class="chapter" data-level="16.4.2" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#frrc"><i class="fa fa-check"></i><b>16.4.2</b> FRRC</a></li>
<li class="chapter" data-level="16.4.3" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#rrfc"><i class="fa fa-check"></i><b>16.4.3</b> RRFC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html"><i class="fa fa-check"></i><b>17</b> ROC-ORH sample size using RJafroc</a>
<ul>
<li class="chapter" data-level="17.1" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#introduction-15"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#illustration-of-sspowergivenjk-using-method-orh"><i class="fa fa-check"></i><b>17.2</b> Illustration of <code>SsPowerGivenJK()</code> using <code>method = "ORH"</code></a></li>
<li class="chapter" data-level="17.3" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#illustration-of-sspowertable-using-method-orh"><i class="fa fa-check"></i><b>17.3</b> Illustration of <code>SsPowerTable()</code> using <code>method = "ORH"</code></a></li>
<li class="chapter" data-level="17.4" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#illustrations-of-sssamplesizekgivenj-using-method-orh"><i class="fa fa-check"></i><b>17.4</b> Illustrations of <code>SsSampleSizeKGivenJ()</code> using <code>method = "ORH"</code></a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#for-rrrc-generalization"><i class="fa fa-check"></i><b>17.4.1</b> For RRRC generalization</a></li>
<li class="chapter" data-level="17.4.2" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#for-frrc-generalization"><i class="fa fa-check"></i><b>17.4.2</b> For FRRC generalization</a></li>
<li class="chapter" data-level="17.4.3" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#for-rrfc-generalization"><i class="fa fa-check"></i><b>17.4.3</b> For RRFC generalization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="SSJafrocEffectSize.html"><a href="SSJafrocEffectSize.html"><i class="fa fa-check"></i><b>18</b> Choosing a realistic effect size</a>
<ul>
<li class="chapter" data-level="18.1" data-path="SSJafrocEffectSize.html"><a href="SSJafrocEffectSize.html#introduction-16"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="SSJafrocEffectSize.html"><a href="SSJafrocEffectSize.html#illustration-of-sspowergivenjk-using-method-orh-1"><i class="fa fa-check"></i><b>18.2</b> Illustration of <code>SsPowerGivenJK()</code> using <code>method = "ORH"</code></a></li>
<li class="chapter" data-level="18.3" data-path="SSJafrocEffectSize.html"><a href="SSJafrocEffectSize.html#references-12"><i class="fa fa-check"></i><b>18.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="SSFroc1.html"><a href="SSFroc1.html"><i class="fa fa-check"></i><b>19</b> FROC sample size estimation and comparison to ROC</a>
<ul>
<li class="chapter" data-level="19.1" data-path="SSFroc1.html"><a href="SSFroc1.html#introduction-17"><i class="fa fa-check"></i><b>19.1</b> Introduction</a></li>
<li class="chapter" data-level="19.2" data-path="SSFroc1.html"><a href="SSFroc1.html#relating-an-roc-effect-size-to-a-wafroc-effect-size"><i class="fa fa-check"></i><b>19.2</b> Relating an ROC effect-size to a wAFROC effect-size</a></li>
<li class="chapter" data-level="19.3" data-path="SSFroc1.html"><a href="SSFroc1.html#computing-the-respective-variance-components"><i class="fa fa-check"></i><b>19.3</b> Computing the respective variance components</a></li>
<li class="chapter" data-level="19.4" data-path="SSFroc1.html"><a href="SSFroc1.html#comparing-roc-power-to-wafroc-power-for-equivalent-effect-sizes"><i class="fa fa-check"></i><b>19.4</b> Comparing ROC power to wAFROC power for equivalent effect-sizes</a></li>
<li class="chapter" data-level="19.5" data-path="SSFroc1.html"><a href="SSFroc1.html#references-13"><i class="fa fa-check"></i><b>19.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="SSFroc2.html"><a href="SSFroc2.html"><i class="fa fa-check"></i><b>20</b> FROC sample size estimation using specified ROC effect</a>
<ul>
<li class="chapter" data-level="20.1" data-path="SSFroc2.html"><a href="SSFroc2.html#introduction-18"><i class="fa fa-check"></i><b>20.1</b> Introduction</a></li>
<li class="chapter" data-level="20.2" data-path="SSFroc2.html"><a href="SSFroc2.html#constructing-the-nh-model-for-the-dataset"><i class="fa fa-check"></i><b>20.2</b> Constructing the NH model for the dataset</a></li>
<li class="chapter" data-level="20.3" data-path="SSFroc2.html"><a href="SSFroc2.html#extracting-the-wafroc-variance-components"><i class="fa fa-check"></i><b>20.3</b> Extracting the wAFROC variance components</a></li>
<li class="chapter" data-level="20.4" data-path="SSFroc2.html"><a href="SSFroc2.html#wafroc-power-for-specified-roc-effect-size-number-of-readers-j-and-number-of-cases-k"><i class="fa fa-check"></i><b>20.4</b> wAFROC power for specified ROC effect size, number of readers J and number of cases K</a></li>
<li class="chapter" data-level="20.5" data-path="SSFroc2.html"><a href="SSFroc2.html#wafroc-number-of-cases-for-80-power-for-a-given-number-of-readers-j"><i class="fa fa-check"></i><b>20.5</b> wAFROC number of cases for 80% power for a given number of readers J</a></li>
<li class="chapter" data-level="20.6" data-path="SSFroc2.html"><a href="SSFroc2.html#wafroc-power-for-a-given-number-of-readers-j-and-cases-k"><i class="fa fa-check"></i><b>20.6</b> wAFROC Power for a given number of readers J and cases K</a></li>
<li class="chapter" data-level="20.7" data-path="SSFroc2.html"><a href="SSFroc2.html#references-14"><i class="fa fa-check"></i><b>20.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="RsmOpCh.html"><a href="RsmOpCh.html"><i class="fa fa-check"></i><b>21</b> RSM predicted operating characteristics</a>
<ul>
<li class="chapter" data-level="21.1" data-path="RsmOpCh.html"><a href="RsmOpCh.html#introduction-19"><i class="fa fa-check"></i><b>21.1</b> Introduction</a></li>
<li class="chapter" data-level="21.2" data-path="RsmOpCh.html"><a href="RsmOpCh.html#the-distinction-between-predicted-curves-and-empirical-curves"><i class="fa fa-check"></i><b>21.2</b> The distinction between predicted curves and empirical curves</a></li>
<li class="chapter" data-level="21.3" data-path="RsmOpCh.html"><a href="RsmOpCh.html#the-rsm-model"><i class="fa fa-check"></i><b>21.3</b> The RSM model</a></li>
<li class="chapter" data-level="21.4" data-path="RsmOpCh.html"><a href="RsmOpCh.html#the-empirical-wafroc"><i class="fa fa-check"></i><b>21.4</b> The empirical wAFROC</a></li>
<li class="chapter" data-level="21.5" data-path="RsmOpCh.html"><a href="RsmOpCh.html#the-predicted-wafroc"><i class="fa fa-check"></i><b>21.5</b> The predicted wAFROC</a></li>
<li class="chapter" data-level="21.6" data-path="RsmOpCh.html"><a href="RsmOpCh.html#the-distribution-of-number-of-lesions-and-weights"><i class="fa fa-check"></i><b>21.6</b> The distribution of number of lesions and weights</a></li>
<li class="chapter" data-level="21.7" data-path="RsmOpCh.html"><a href="RsmOpCh.html#other-operating-characteristics"><i class="fa fa-check"></i><b>21.7</b> Other operating characteristics</a></li>
<li class="chapter" data-level="21.8" data-path="RsmOpCh.html"><a href="RsmOpCh.html#summary-6"><i class="fa fa-check"></i><b>21.8</b> Summary</a></li>
<li class="chapter" data-level="21.9" data-path="RsmOpCh.html"><a href="RsmOpCh.html#references-15"><i class="fa fa-check"></i><b>21.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="ImproperROCs.html"><a href="ImproperROCs.html"><i class="fa fa-check"></i><b>22</b> Improper ROCs</a>
<ul>
<li class="chapter" data-level="22.1" data-path="ImproperROCs.html"><a href="ImproperROCs.html#the-binormal-model-1"><i class="fa fa-check"></i><b>22.1</b> The binormal model</a></li>
<li class="chapter" data-level="22.2" data-path="ImproperROCs.html"><a href="ImproperROCs.html#improper-rocs"><i class="fa fa-check"></i><b>22.2</b> Improper ROCs</a></li>
<li class="chapter" data-level="22.3" data-path="ImproperROCs.html"><a href="ImproperROCs.html#reason-for-improper-rocs"><i class="fa fa-check"></i><b>22.3</b> Reason for improper ROCs</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html"><i class="fa fa-check"></i><b>23</b> Degenerate datasets in the binormal model</a>
<ul>
<li class="chapter" data-level="23.1" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#two-helper-functions"><i class="fa fa-check"></i><b>23.1</b> Two helper functions</a></li>
<li class="chapter" data-level="23.2" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#degenerate-datasets"><i class="fa fa-check"></i><b>23.2</b> Degenerate datasets</a></li>
<li class="chapter" data-level="23.3" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#understanding-degenerate-datasets"><i class="fa fa-check"></i><b>23.3</b> Understanding degenerate datasets</a></li>
<li class="chapter" data-level="23.4" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#the-exact-fit-is-not-unique"><i class="fa fa-check"></i><b>23.4</b> The exact fit is not unique</a></li>
<li class="chapter" data-level="23.5" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#comments-on-degeneracy"><i class="fa fa-check"></i><b>23.5</b> Comments on degeneracy</a></li>
<li class="chapter" data-level="23.6" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#a-reasonable-fit-to-the-degenerate-dataset"><i class="fa fa-check"></i><b>23.6</b> A reasonable fit to the degenerate dataset</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="ProperROCs.html"><a href="ProperROCs.html"><i class="fa fa-check"></i><b>24</b> Proper ROCs</a>
<ul>
<li class="chapter" data-level="24.1" data-path="ProperROCs.html"><a href="ProperROCs.html#helper-functions"><i class="fa fa-check"></i><b>24.1</b> Helper functions</a></li>
<li class="chapter" data-level="24.2" data-path="ProperROCs.html"><a href="ProperROCs.html#definitions-of-proproc-parameters-in-terms-of-binormal-model-parameters"><i class="fa fa-check"></i><b>24.2</b> Definitions of PROPROC parameters in terms of binormal model parameters</a></li>
<li class="chapter" data-level="24.3" data-path="ProperROCs.html"><a href="ProperROCs.html#main-code-and-output"><i class="fa fa-check"></i><b>24.3</b> Main code and output</a></li>
<li class="chapter" data-level="24.4" data-path="ProperROCs.html"><a href="ProperROCs.html#discussion-2"><i class="fa fa-check"></i><b>24.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="MetzEqn36.html"><a href="MetzEqn36.html"><i class="fa fa-check"></i><b>25</b> Metz Eqn36 numerical check</a>
<ul>
<li class="chapter" data-level="25.1" data-path="MetzEqn36.html"><a href="MetzEqn36.html#helper-functions-1"><i class="fa fa-check"></i><b>25.1</b> Helper functions</a></li>
<li class="chapter" data-level="25.2" data-path="MetzEqn36.html"><a href="MetzEqn36.html#main-code-and-output-1"><i class="fa fa-check"></i><b>25.2</b> Main code and output</a></li>
<li class="chapter" data-level="25.3" data-path="MetzEqn36.html"><a href="MetzEqn36.html#discussion-3"><i class="fa fa-check"></i><b>25.3</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="CbmPlots.html"><a href="CbmPlots.html"><i class="fa fa-check"></i><b>26</b> CBM Plots</a>
<ul>
<li class="chapter" data-level="26.1" data-path="CbmPlots.html"><a href="CbmPlots.html#helper-functions-2"><i class="fa fa-check"></i><b>26.1</b> Helper functions</a></li>
<li class="chapter" data-level="26.2" data-path="CbmPlots.html"><a href="CbmPlots.html#main-code-and-output-2"><i class="fa fa-check"></i><b>26.2</b> Main code and output</a></li>
<li class="chapter" data-level="26.3" data-path="CbmPlots.html"><a href="CbmPlots.html#comments-5"><i class="fa fa-check"></i><b>26.3</b> Comments</a></li>
<li class="chapter" data-level="26.4" data-path="CbmPlots.html"><a href="CbmPlots.html#pdf-plots"><i class="fa fa-check"></i><b>26.4</b> pdf plots</a></li>
<li class="chapter" data-level="26.5" data-path="CbmPlots.html"><a href="CbmPlots.html#comments-6"><i class="fa fa-check"></i><b>26.5</b> Comments</a></li>
<li class="chapter" data-level="26.6" data-path="CbmPlots.html"><a href="CbmPlots.html#likelihood-ratio-plots"><i class="fa fa-check"></i><b>26.6</b> likelihood ratio plots</a></li>
<li class="chapter" data-level="26.7" data-path="CbmPlots.html"><a href="CbmPlots.html#comments-7"><i class="fa fa-check"></i><b>26.7</b> Comments</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="ROIDataStr.html"><a href="ROIDataStr.html"><i class="fa fa-check"></i><b>27</b> ROI paradigm data</a>
<ul>
<li class="chapter" data-level="27.1" data-path="ROIDataStr.html"><a href="ROIDataStr.html#introduction-this-chapter-is-under-construction"><i class="fa fa-check"></i><b>27.1</b> Introduction; this chapter is under construction!</a></li>
<li class="chapter" data-level="27.2" data-path="ROIDataStr.html"><a href="ROIDataStr.html#an-example-roi-dataset"><i class="fa fa-check"></i><b>27.2</b> An example ROI dataset</a></li>
<li class="chapter" data-level="27.3" data-path="ROIDataStr.html"><a href="ROIDataStr.html#the-roi-excel-data-file"><i class="fa fa-check"></i><b>27.3</b> The ROI Excel data file</a></li>
<li class="chapter" data-level="27.4" data-path="ROIDataStr.html"><a href="ROIDataStr.html#next-tba"><i class="fa fa-check"></i><b>27.4</b> Next, TBA</a></li>
<li class="chapter" data-level="27.5" data-path="ROIDataStr.html"><a href="ROIDataStr.html#references-16"><i class="fa fa-check"></i><b>27.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="28" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html"><i class="fa fa-check"></i><b>28</b> Analyzing data acquired according to the ROI paradigm</a>
<ul>
<li class="chapter" data-level="28.1" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#introduction-this-chapter-is-under-construction-1"><i class="fa fa-check"></i><b>28.1</b> Introduction; this chapter is under construction!</a></li>
<li class="chapter" data-level="28.2" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#note-to-self-102919-dpc"><i class="fa fa-check"></i><b>28.2</b> Note to self (10/29/19) !!!DPC!!!</a></li>
<li class="chapter" data-level="28.3" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#introduction-20"><i class="fa fa-check"></i><b>28.3</b> Introduction</a></li>
<li class="chapter" data-level="28.4" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#the-roi-figure-of-merit"><i class="fa fa-check"></i><b>28.4</b> The ROI figure of merit</a></li>
<li class="chapter" data-level="28.5" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#calculation-of-the-roi-figure-of-merit."><i class="fa fa-check"></i><b>28.5</b> Calculation of the ROI figure of merit.</a></li>
<li class="chapter" data-level="28.6" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#significance-testing"><i class="fa fa-check"></i><b>28.6</b> Significance testing</a>
<ul>
<li class="chapter" data-level="28.6.1" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#rrrc-analysis"><i class="fa fa-check"></i><b>28.6.1</b> RRRC analysis</a></li>
<li class="chapter" data-level="28.6.2" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#frrc-analysis"><i class="fa fa-check"></i><b>28.6.2</b> FRRC analysis</a></li>
<li class="chapter" data-level="28.6.3" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#rrfc-analysis"><i class="fa fa-check"></i><b>28.6.3</b> RRFC analysis</a></li>
</ul></li>
<li class="chapter" data-level="28.7" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#summary-7"><i class="fa fa-check"></i><b>28.7</b> Summary</a></li>
<li class="chapter" data-level="28.8" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#references-17"><i class="fa fa-check"></i><b>28.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="myEquations.html"><a href="myEquations.html"><i class="fa fa-check"></i><b>29</b> EQUATIONS</a></li>
<li class="chapter" data-level="" data-path="references-18.html"><a href="references-18.html"><i class="fa fa-check"></i>REFERENCES</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The RJafroc Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="HypothesisTesting" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Hypothesis Testing</h1>
<div id="introduction-4" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Introduction</h2>
<p>The problem addressed in this chapter is how to decide whether an estimate of AUC is consistent with a pre-specified value. One example of this is when a single-reader rates a set of cases in a single-modality, from which one estimates AUC, and the question is whether the estimate is statistically consistent with a pre-specified value. From a clinical point of view, this is generally not a useful exercise, but its simplicity is conducive to illustrating the broader concepts involved in this and later chapters. The clinically more useful analysis is when multiple readers interpret the same cases in two or more modalities. With two modalities, for example, one obtains an estimate AUC for each reader in each modality, averages the AUC values over all readers within each modality, and computes the inter-modality difference in reader-averaged AUC values. The question forming the main subject of this book is whether the observed difference is consistent with zero.</p>
<p>Each situation outlined above admits a binary (yes/no) answer, which is different from the estimation problem that was dealt with in connection with the maximum likelihood method in Chapter 06, where one computed numerical estimates (and confidence intervals) of the parameters of the fitting model.</p>
<p><strong>Hypothesis testing is the process of dichotomizing the possible outcomes of a statistical study and then using probabilistic arguments to choose one option over the other.</strong></p>
<p>The two competing options are termed the null hypothesis (NH) and the alternative hypothesis (AH). The hypothesis testing procedure is analogous1 to the jury trial system in the US, with 20 instead of 12 jurors, with the null hypothesis being the presumption of innocence and the alternative hypothesis being the defendant is guilty, and the decision rule is to assume the defendant is innocent unless all 20 jurors agree the defendant is guilty. If even one juror disagrees, the defendant is deemed innocent (equivalent to choosing an <span class="math inline">\(\alpha\)</span> – defined below - of 0.05, or 1/20).</p>
</div>
<div id="hypothesis-testing-for-a-single-modality-single-reader-roc-study" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Hypothesis testing for a single-modality single-reader ROC study</h2>
<p>The binormal model described in Chapter 06 can be used to generate sets of ratings to illustrate the methods being described in this chapter. To recapitulate, the model is described by:</p>
<p><span class="math display">\[\begin{equation*} 
Z_{k_11} \sim N\left ( 0,1 \right )\\
Z_{k_22} \sim N\left ( \mu,\sigma^2 \right )
\end{equation*}\]</span></p>
<p>The following code chunk encodes the <code>Wilcoxon</code> function:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="HypothesisTesting.html#cb12-1"></a>Wilcoxon &lt;-<span class="st"> </span><span class="cf">function</span> (zk1, zk2)</span>
<span id="cb12-2"><a href="HypothesisTesting.html#cb12-2"></a>{</span>
<span id="cb12-3"><a href="HypothesisTesting.html#cb12-3"></a>  K1 =<span class="st"> </span><span class="kw">length</span>(zk1)</span>
<span id="cb12-4"><a href="HypothesisTesting.html#cb12-4"></a>  K2 =<span class="st"> </span><span class="kw">length</span>(zk2)</span>
<span id="cb12-5"><a href="HypothesisTesting.html#cb12-5"></a>  W &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb12-6"><a href="HypothesisTesting.html#cb12-6"></a>  <span class="cf">for</span> (k1 <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>K1) {</span>
<span id="cb12-7"><a href="HypothesisTesting.html#cb12-7"></a>    W &lt;-<span class="st"> </span>W <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(zk1[k1] <span class="op">&lt;</span><span class="st"> </span>zk2)</span>
<span id="cb12-8"><a href="HypothesisTesting.html#cb12-8"></a>    W &lt;-<span class="st"> </span>W <span class="op">+</span><span class="st"> </span><span class="fl">0.5</span> <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>(zk1[k1] <span class="op">==</span><span class="st"> </span>zk2)</span>
<span id="cb12-9"><a href="HypothesisTesting.html#cb12-9"></a>  }</span>
<span id="cb12-10"><a href="HypothesisTesting.html#cb12-10"></a>  W &lt;-<span class="st"> </span>W<span class="op">/</span>K1<span class="op">/</span>K2</span>
<span id="cb12-11"><a href="HypothesisTesting.html#cb12-11"></a>  <span class="kw">return</span> (W)</span>
<span id="cb12-12"><a href="HypothesisTesting.html#cb12-12"></a>}</span></code></pre></div>
<p>In the next code chunk we set <span class="math inline">\(\mu = 1.5\)</span> and <span class="math inline">\(\sigma = 1.3\)</span> and simulate <span class="math inline">\(K_1 = 50\)</span> non-diseased cases and <span class="math inline">\(K_2 = 52\)</span> diseased cases. For clarity I like to keep the sizes of the two arrays slightly different; this allows one to quickly check, with a glance at the <code>Environment</code> panel, that array dimensions are as expected. The <code>for</code> loop draws 50 samples from the <span class="math inline">\(N(0,1)\)</span> distribution and 52 samples from the <span class="math inline">\(N(\mu,\sigma^2)\)</span> distribution, calculates the empirical AUC using the Wilcoxon, and the process is repeated 10,000 times, the AUC values are saved to a huge array <code>AUC</code>. After exit from the <code>for-loop</code> we calculate the mean and standard deviation of the <code>AUC</code> values.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="HypothesisTesting.html#cb13-1"></a>seed &lt;-<span class="st"> </span><span class="dv">1</span>;<span class="kw">set.seed</span>(seed)</span>
<span id="cb13-2"><a href="HypothesisTesting.html#cb13-2"></a>mu &lt;-<span class="st"> </span><span class="fl">1.5</span>;sigma &lt;-<span class="st"> </span><span class="fl">1.3</span>;K1 &lt;-<span class="st"> </span><span class="dv">50</span>;K2 &lt;-<span class="st"> </span><span class="dv">52</span></span>
<span id="cb13-3"><a href="HypothesisTesting.html#cb13-3"></a></span>
<span id="cb13-4"><a href="HypothesisTesting.html#cb13-4"></a><span class="co"># cheat to find the population mean and std. dev.</span></span>
<span id="cb13-5"><a href="HypothesisTesting.html#cb13-5"></a>AUC &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="dv">10000</span>)</span>
<span id="cb13-6"><a href="HypothesisTesting.html#cb13-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(AUC)) {</span>
<span id="cb13-7"><a href="HypothesisTesting.html#cb13-7"></a>  zk1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K1);zk2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K2, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> sigma)  </span>
<span id="cb13-8"><a href="HypothesisTesting.html#cb13-8"></a>  AUC[i] &lt;-<span class="st"> </span><span class="kw">Wilcoxon</span>(zk1, zk2)</span>
<span id="cb13-9"><a href="HypothesisTesting.html#cb13-9"></a>}</span>
<span id="cb13-10"><a href="HypothesisTesting.html#cb13-10"></a>meanAUC   &lt;-<span class="st">  </span><span class="kw">mean</span>(AUC);sigmaAUC  &lt;-<span class="st">  </span><span class="kw">sd</span>(AUC)</span>
<span id="cb13-11"><a href="HypothesisTesting.html#cb13-11"></a><span class="kw">cat</span>(<span class="st">&quot;pop mean AUC = &quot;</span>, meanAUC, <span class="st">&quot;, pop sigma AUC = &quot;</span>, sigmaAUC, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb13-12"><a href="HypothesisTesting.html#cb13-12"></a><span class="co">#&gt; pop mean AUC =  0.819178 , pop sigma AUC =  0.04176683</span></span></code></pre></div>
<p>By the simple (if unimaginative) approach of sampling 10,000 times, one estimates the <em>population</em> mean and standard deviation of empirical AUC, denoted below by <span class="math inline">\(AUC_{pop}\)</span> and <span class="math inline">\(\sigma_{AUC}\)</span>, respectively. Based on the 10,000 simulations, <span class="math inline">\(AUC_{pop}\)</span> = 0.819178 and <span class="math inline">\(\sigma_{AUC}\)</span> =0.0417668.</p>
<p>The next chunk simulates one more independent ROC study with the same numbers of cases, and the resulting area under the empirical curve is denoted <span class="math inline">\(AUC\)</span>, AUC in the code.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="HypothesisTesting.html#cb14-1"></a><span class="co"># one more trial, this is the one we want to compare to meanAUC, i.e., get P-value</span></span>
<span id="cb14-2"><a href="HypothesisTesting.html#cb14-2"></a>zk1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K1);zk2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K2, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> sigma) </span>
<span id="cb14-3"><a href="HypothesisTesting.html#cb14-3"></a>AUC &lt;-<span class="st"> </span><span class="kw">Wilcoxon</span>(zk1, zk2)</span>
<span id="cb14-4"><a href="HypothesisTesting.html#cb14-4"></a><span class="kw">cat</span>(<span class="st">&quot;New AUC = &quot;</span>, AUC, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-5"><a href="HypothesisTesting.html#cb14-5"></a><span class="co">#&gt; New AUC =  0.8626923</span></span>
<span id="cb14-6"><a href="HypothesisTesting.html#cb14-6"></a></span>
<span id="cb14-7"><a href="HypothesisTesting.html#cb14-7"></a>z &lt;-<span class="st"> </span>(AUC <span class="op">-</span><span class="st"> </span>meanAUC)<span class="op">/</span>sigmaAUC</span>
<span id="cb14-8"><a href="HypothesisTesting.html#cb14-8"></a><span class="kw">cat</span>(<span class="st">&quot;z-statistic = &quot;</span>, z, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb14-9"><a href="HypothesisTesting.html#cb14-9"></a><span class="co">#&gt; z-statistic =  1.04184</span></span></code></pre></div>
<p>Is the new value, 0.8626923, sufficiently different from the population mean (0.819178) to reject the null hypothesis <span class="math inline">\(NH: AUC = AUC_{pop}\)</span>? Note that the answer to this question can be either yes or no: equivocation is not allowed.</p>
<p>The new value is “somewhat close” to the population mean, but how does one decide if “somewhat close” is close enough? Needed is the statistical distribution of the random variable <span class="math inline">\(AUC\)</span> under the hypothesis that the true mean is <span class="math inline">\(AUC_{pop}\)</span>. In the asymptotic limit of a large number of cases (this is an approximation), one can assume that the pdf of <span class="math inline">\(AUC\)</span> under the null hypothesis is the normal distribution <span class="math inline">\(N\left ( AUC_{pop}, \sigma_{AUC}^{2} \right )\)</span>:</p>
<p><span class="math display">\[\begin{equation*} 
pdf_{AUC}\left ( AUC\mid AUC_{pop}, \sigma_{AUC} \right )=\frac{1}{\sqrt{2\pi}\sigma_{AUC}}exp\left ( -\frac{1}{2} \left ( \frac{AUC-AUC_{pop}}{\sigma_{AUC}} \right )^2\right )
\end{equation*}\]</span></p>
<p>The translated and scaled value is distributed as a unit normal distribution, i.e.,</p>
<p><span class="math display">\[\begin{equation*} 
Z=\frac{AUC-AUC_{pop}}{\sigma_{AUC}}\sim N\left ( 0,1 \right )
\end{equation*}\]</span></p>
<p>[The <span class="math inline">\(Z\)</span> notation here should not be confused with z-sample, decision variable or rating of a case in an ROC study; the latter, when sampled over a set of non-diseased and diseased cases, yield a realization of <span class="math inline">\(AUC\)</span>. The author trusts the distinction will be clear from the context.] The observed magnitude of <span class="math inline">\(z\)</span> is 1.0418397.</p>
<p><strong>The ubiquitous p-value is the probability that the observed magnitude of <span class="math inline">\(z\)</span>, or larger, occurs under the null hypothesis (NH), that the true mean of <span class="math inline">\(Z\)</span> is zero.</strong></p>
<p>The p-value corresponding to an observed <span class="math inline">\(z\)</span> of 1.0418397 is given by (as always, uppercase <span class="math inline">\(Z\)</span> is the random variable, while lower case <span class="math inline">\(z\)</span> is a realized value):</p>
<p><span class="math display">\[\begin{equation*} 
\Pr\left ( \lvert Z \rvert \geq \lvert z \rvert \mid Z\sim N\left ( 0,1 \right )\right )=\\
\Pr\left ( \lvert Z \rvert \geq 1.042 \mid Z\sim N\left ( 0,1 \right )\right )=\\
2\Phi\left ( -1.042 \right )=0.2975
\end{equation*}\]</span></p>
<p>To recapitulate statistical notation, <span class="math inline">\(\Pr\left ( \lvert Z \rvert \geq \lvert z \rvert \mid Z\sim N\left ( 0,1 \right )\right )\)</span> is to be parsed as <span class="math inline">\(\Pr\left ( A\mid B \right )\)</span>, that is, the probability <span class="math inline">\(\lvert Z \rvert \geq \lvert z \rvert\)</span> given that <span class="math inline">\(Z\sim N\left ( 0,1 \right )\)</span>. The last line in Eqn. (8.4) follows from the symmetry of the unit normal distribution, i.e., the area above 1.042 must equal the area below -1.042.</p>
<p>Since <span class="math inline">\(z\)</span> is a continuous variable, the probability that a sampled value will exactly equal the observed value is zero. Therefore, one must pose the question as stated above, namely what is the probability that <span class="math inline">\(Z\)</span> is at least as extreme as the observed value (by “extreme” I mean further from zero, in either positive or negative directions). If the observed was <span class="math inline">\(z\)</span> = 2.5 then the corresponding p-value would be <span class="math inline">\(2\Phi(-2.5)\)</span>=0.01242, which is smaller than 0.2975 (<code>2*pnorm(-2.5)</code> = 0.01241933). This is cited below as the “second example”.</p>
<p>Under the zero-mean null hypothesis, the larger the magnitude of the observed value of <span class="math inline">\(Z\)</span>, the smaller the p-value, and the more unlikely that the data supports the NH. <strong>The p-value can be interpreted as the degree of unlikelihood that the data supports the NH.</strong></p>
<p>By convention one adopts a fixed value of the probability, denoted and usually <span class="math inline">\(\alpha\)</span> = 0.05, which is termed the <em>size</em> of the test or <em>the significance level</em> of the test, and the decision rule is to reject the null hypothesis if the observed p-value &lt; <span class="math inline">\(\alpha\)</span>.</p>
<p><span class="math display">\[\begin{equation*} 
p &lt; \alpha \Rightarrow \text{Reject NH}
\end{equation*}\]</span></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="HypothesisTesting.html#cb15-1"></a>p2tailed &lt;-<span class="st"> </span><span class="kw">pnorm</span>(<span class="op">-</span><span class="kw">abs</span>(z)) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(<span class="kw">abs</span>(z))) <span class="co"># p value for two-sided AH</span></span>
<span id="cb15-2"><a href="HypothesisTesting.html#cb15-2"></a>p1tailedGT &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(z) <span class="co"># p value for one-sided AH &gt; 0 </span></span>
<span id="cb15-3"><a href="HypothesisTesting.html#cb15-3"></a>p1tailedLT &lt;-<span class="st"> </span><span class="kw">pnorm</span>(z)<span class="co"># p value for one-sided AH &lt; 0 </span></span>
<span id="cb15-4"><a href="HypothesisTesting.html#cb15-4"></a>alpha  &lt;-<span class="st"> </span><span class="fl">0.05</span></span></code></pre></div>
<p>In the first example, with observed p-value equal to 0.2975, one would not reject the null hypothesis, but in the second example, with observed p-value equal to 0.01242, one would. If the p-value is exactly 0.05 (unlikely with ROC analysis, but one needs to account for it) then one does not reject the NH. In the 20-juror analogy, of one juror insists the defendant is not guilty, then observed <span class="math inline">\(\Pr\)</span> is 0.05, and one does not reject the NH that the defendant is innocent (the double negatives, very common in statistics, can be confusing; in plain English, the defendant goes home).</p>
<p>According to the previous discussion, the critical magnitude of <span class="math inline">\(z\)</span> that determines whether to reject the null hypothesis is given by:</p>
<p><span class="math display">\[\begin{equation*} 
z_\frac{\alpha}{2}=-\Phi^{-1}\left ( \frac{\alpha}{2} \right )
\end{equation*}\]</span></p>
<p>For <span class="math inline">\(\alpha\)</span> = 0.05 this evaluates to 1.95996 (which is sometimes rounded up to two, good enough for “government work” as the saying goes) and the decision rule is to reject the null hypothesis only if the observed magnitude of <span class="math inline">\(z\)</span> is larger than <span class="math inline">\(z_\frac{\alpha}{2}\)</span>.</p>
<p><strong>The decision rule based on comparing the observed z to a critical value is equivalent to a decision rule based on comparing the observed p-value to <span class="math inline">\(\alpha\)</span>. It is also equivalent, as will be shown later, to a decision rule based on a <span class="math inline">\(\left ( 1-\alpha \right )\)</span> confidence interval for the observed statistic. One rejects the NH if the closed confidence interval does not include zero.</strong></p>
</div>
<div id="type-i-errors" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Type-I errors</h2>
<p>Just because one rejects the null hypothesis, as in the second example, does not mean that the null hypothesis is false. Following the decision rule “caps”, or puts an upper limit on, the probability of incorrectly rejecting the null hypothesis at <span class="math inline">\(\alpha\)</span>. In other words, by agreeing to reject the NH only if <span class="math inline">\(p \leq \alpha\)</span>, one has set an upper limit, namely <span class="math inline">\(\alpha\)</span>, on errors of this type, termed <em>Type-I</em> errors. These could be termed false positives in the hypothesis testing sense, not to be confused with false positive occurring on individual case-level decisions. According to the definition of <span class="math inline">\(\alpha\)</span>:</p>
<p><span class="math display">\[\begin{equation*} 
\Pr( \text{Type I error} \mid {NH} )=\alpha
\end{equation*}\]</span></p>
<p>To demonstrate the ideas one needs to have a very cooperative reader interpreting new sets of independent cases not just one more time, but 2000 more times (the reason for the 2000 trials will be explained below). The simulation code for this follows:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="HypothesisTesting.html#cb16-1"></a>seed &lt;-<span class="st"> </span><span class="dv">1</span>;<span class="kw">set.seed</span>(seed)</span>
<span id="cb16-2"><a href="HypothesisTesting.html#cb16-2"></a>mu &lt;-<span class="st"> </span><span class="fl">1.5</span>;sigma &lt;-<span class="st"> </span><span class="fl">1.3</span>;K1 &lt;-<span class="st"> </span><span class="dv">50</span>;K2 &lt;-<span class="st"> </span><span class="dv">52</span></span>
<span id="cb16-3"><a href="HypothesisTesting.html#cb16-3"></a></span>
<span id="cb16-4"><a href="HypothesisTesting.html#cb16-4"></a>nTrials &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb16-5"><a href="HypothesisTesting.html#cb16-5"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="co"># size of test</span></span>
<span id="cb16-6"><a href="HypothesisTesting.html#cb16-6"></a>reject =<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="dt">dim =</span> nTrials)</span>
<span id="cb16-7"><a href="HypothesisTesting.html#cb16-7"></a><span class="cf">for</span> (trial <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(reject)) {  </span>
<span id="cb16-8"><a href="HypothesisTesting.html#cb16-8"></a>  zk1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K1);zk2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K2, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> sigma)  </span>
<span id="cb16-9"><a href="HypothesisTesting.html#cb16-9"></a>  AUC &lt;-<span class="st"> </span><span class="kw">Wilcoxon</span>(zk1, zk2)  </span>
<span id="cb16-10"><a href="HypothesisTesting.html#cb16-10"></a>  z &lt;-<span class="st"> </span>(AUC <span class="op">-</span><span class="st"> </span>meanAUC)<span class="op">/</span>sigmaAUC</span>
<span id="cb16-11"><a href="HypothesisTesting.html#cb16-11"></a>  p &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">pnorm</span>(<span class="op">-</span><span class="kw">abs</span>(z)) <span class="co"># p value for individual trial</span></span>
<span id="cb16-12"><a href="HypothesisTesting.html#cb16-12"></a>  <span class="cf">if</span> (p <span class="op">&lt;</span><span class="st"> </span>alpha) reject[trial] =<span class="st"> </span><span class="dv">1</span> </span>
<span id="cb16-13"><a href="HypothesisTesting.html#cb16-13"></a>}</span>
<span id="cb16-14"><a href="HypothesisTesting.html#cb16-14"></a></span>
<span id="cb16-15"><a href="HypothesisTesting.html#cb16-15"></a>CI &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>); width &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">qnorm</span>(alpha<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb16-16"><a href="HypothesisTesting.html#cb16-16"></a>ObsvdTypeIErrRate &lt;-<span class="st"> </span><span class="kw">sum</span>(reject)<span class="op">/</span><span class="kw">length</span>(reject)</span>
<span id="cb16-17"><a href="HypothesisTesting.html#cb16-17"></a>CI[<span class="dv">1</span>] &lt;-<span class="st"> </span>ObsvdTypeIErrRate <span class="op">-</span><span class="st"> </span>width<span class="op">*</span><span class="kw">sqrt</span>(ObsvdTypeIErrRate<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>ObsvdTypeIErrRate)<span class="op">/</span>nTrials)</span>
<span id="cb16-18"><a href="HypothesisTesting.html#cb16-18"></a>CI[<span class="dv">2</span>] &lt;-<span class="st"> </span>ObsvdTypeIErrRate <span class="op">+</span><span class="st"> </span>width<span class="op">*</span><span class="kw">sqrt</span>(ObsvdTypeIErrRate<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>ObsvdTypeIErrRate)<span class="op">/</span>nTrials)</span>
<span id="cb16-19"><a href="HypothesisTesting.html#cb16-19"></a><span class="kw">cat</span>(<span class="st">&quot;alpha = &quot;</span>, alpha, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb16-20"><a href="HypothesisTesting.html#cb16-20"></a><span class="co">#&gt; alpha =  0.05</span></span>
<span id="cb16-21"><a href="HypothesisTesting.html#cb16-21"></a><span class="kw">cat</span>(<span class="st">&quot;ObsvdTypeIErrRate = &quot;</span>, ObsvdTypeIErrRate, <span class="st">&quot;, 95% confidence interval = &quot;</span>, CI, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb16-22"><a href="HypothesisTesting.html#cb16-22"></a><span class="co">#&gt; ObsvdTypeIErrRate =  0.0535 , 95% confidence interval =  0.04363788 0.06336212</span></span>
<span id="cb16-23"><a href="HypothesisTesting.html#cb16-23"></a>exact &lt;-<span class="st"> </span><span class="kw">binom.test</span>(<span class="kw">sum</span>(reject),<span class="dt">n =</span> <span class="dv">2000</span>,<span class="dt">p =</span> alpha)</span>
<span id="cb16-24"><a href="HypothesisTesting.html#cb16-24"></a><span class="kw">cat</span>(<span class="st">&quot;exact 95% CI = &quot;</span>, <span class="kw">as.numeric</span>(exact<span class="op">$</span>conf.int), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb16-25"><a href="HypothesisTesting.html#cb16-25"></a><span class="co">#&gt; exact 95% CI =  0.04404871 0.06428544</span></span></code></pre></div>
<p>The population means were calculated in an earlier code chunk. One initializes <code>NTrials</code> to 2000 and <span class="math inline">\(\alpha\)</span> to 0.05. The <code>for-loop</code> describes our captive reader interpreting independent sets of cases 2000 times. <em>Each completed interpretation of 102 cases is termed a trial.</em> For each trial one calculates the observed value of <code>AUC</code>, the observed <code>z</code> statistic and the the observed p-value. The observed p-value is compared against the fixed value <span class="math inline">\(\alpha\)</span> and one sets the corresponding <code>reject[trial]</code> flag to unity if <span class="math inline">\(p &lt; \alpha\)</span>. In other words, if the trial-specific p-value is less than <span class="math inline">\(\alpha\)</span> one counts an instance of rejection of the null hypothesis. The process is repeated 2000 times.</p>
<p>Upon exit from the for-loop, one calculates the observed Type-I error rate, denoted <code>ObsvdTypeIErrRate</code> by summing the reject array and dividing by 2000. One calculates a 95% confidence interval for <code>ObsvdTypeIErrRate</code> based on the binomial distribution, as in Chapter 03.</p>
<p>The observed Type-I error rate is a realization of a random variable, as is the estimated 95% confidence interval. The fact that the confidence interval includes <span class="math inline">\(\alpha\)</span> = 0.05 is no coincidence - it shows that the hypothesis testing procedure is working as expected. To distinguish between the selected <span class="math inline">\(\alpha\)</span> (a fixed value) and that observed in a simulation study (a realization of a random variable), the term <em>empirical <span class="math inline">\(\alpha\)</span></em> is used to denote the observed value rejection rate.</p>
<p>It is a mistake to state that one wishes to minimize the Type-I error probability (the author has seen this comment from a senior researcher, which is the reason for bringing it up). The minimum value of <span class="math inline">\(\alpha\)</span> (a probability) is zero. Run the software with this value of <span class="math inline">\(\alpha\)</span>: the NH will never be rejected. The downside of minimizing the expected Type-I error rate is that the NH will never be rejected, even when the NH is patently false. The aim of a valid method of analyzing the data is not minimizing the Type-I error rate, rather, the observed Type-I error rate should equal the specified value of <span class="math inline">\(\alpha\)</span> (0.05 in our example), allowance being made for the inherent variability in it’s estimate, i.e., its confidence interval. This is the reason 2000 trials were chosen for testing the validity of the NH testing procedure. With this choice, the 95% confidence interval, assuming that observed value is close to 0.05, is roughly ±0.01 as explained next.</p>
<p>Following analogous reasoning to Chapter 03, Eqn. (3.10.10), and defining <span class="math inline">\(f\)</span> as the observed rejection fraction over <span class="math inline">\(T\)</span> trials, and as usual, <span class="math inline">\(F\)</span> is a random variable and <span class="math inline">\(f\)</span> a realized value,</p>
<p><span class="math display">\[\begin{equation*} 
\sigma_f = \sqrt{f(1-f)/T}\\
F \sim N\left ( f,\sigma_{f}^{2} \right )
\end{equation*}\]</span></p>
<p>An approximate <span class="math inline">\((1-\alpha)100\)</span> percent CI for <span class="math inline">\(f\)</span> is:</p>
<p><span class="math display">\[\begin{equation*} 
{CI}_f = \left [ f-z_{\frac{\alpha}{2}}\sigma_f, f+z_{\frac{\alpha}{2}}\sigma_f \right ]
\end{equation*}\]</span></p>
<p>If <span class="math inline">\(f\)</span> is close to 0.05, then for 2000 trials, the 0.95 or 95% CI for <span class="math inline">\(f\)</span> is <span class="math inline">\(f \pm 0.01\)</span>, i.e., <code>qnorm(alpha/2) * sqrt(.05*(.95)/2000)</code> = 0.009551683 ~ 0.01.</p>
<p>The only way to reduce the width of the CI, and thereby run a more stringent test of the validity of the analysis, is to increase the number of trials <span class="math inline">\(T\)</span>. Since the width of the CI depends on the inverse square root of the number of trials, one soon reaches a point of diminishing returns. Usually <span class="math inline">\(T = 2000\)</span> trials are enough for most statisticians and the author, but examples using more simulations have been published.</p>
</div>
<div id="one-sided-vs.-two-sided-tests" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> One sided vs. two sided tests</h2>
<p>In the preceding example, the null hypothesis was rejected anytime the magnitude of the observed value of <span class="math inline">\(z\)</span> exceeded the critical value <span class="math inline">\(-\Phi^{-1}\left ( \frac{\alpha}{2} \right)\)</span>. This is a statement of the alternative hypothesis (AH) <span class="math inline">\(AUC\neq AUC_{pop}\)</span>, in other words too high or too low values of <span class="math inline">\(z\)</span> <em>both</em> result in rejection of the null hypothesis. This is referred to as a two-sided AH and the resulting p-value is termed a <em>two-sided</em> p-value. This is the most common one used in the literature.</p>
<p>Now suppose that the additional trial performed by the radiologist was performed after an intervention following which the radiologist’s performance is expected to increase. To make matters clearer, assume the interpretations in the 10,000 trials used to estimate <span class="math inline">\(AUC_{pop}\)</span> were performed with the radiologist wearing an old pair of eye-glasses, possibly out of proper strength, and the additional trial is performed after the radiologist gets a new set of prescription eye-glasses. Because the radiologist’s eyesight has improved, the expectation is that performance should increase. In this situation, it is appropriate to use the one-sided alternative hypothesis <span class="math inline">\(AUC &gt; AUC_{pop}\)</span>. Now, large values of <span class="math inline">\(z\)</span> result in rejection of the null hypothesis, but small values do not. The critical value of <span class="math inline">\(z\)</span> is defined by <span class="math inline">\(z_\alpha = \Phi\left ( 1-\alpha \right )\)</span>, which for <span class="math inline">\(\alpha\)</span> = 0.05 is 1.645 (i.e., <code>qnorm(1-alpha) = 1.644854</code>). Compare 1.64 to the critical value <span class="math inline">\(-\Phi^{-1}\left ( \frac{\alpha}{2} \right)\)</span> = 1.96 for a two-sided test. If the change is in the expected direction, it is more likely that one will reject the NH with a one-sided than with a two-sided test. The p-value for a one-sided test is given by:</p>
<p><span class="math display">\[\begin{equation*} 
\Pr\left ( Z \geq 1.042 \mid NH \right ) = \Phi \left (-1.042  \right ) = 0.1487
\end{equation*}\]</span></p>
<p>Notice that this is half the corresponding two-sided test p-value; this is because one is only interested in the area under the unit normal that is above the observed value of <span class="math inline">\(z\)</span>. If the intent is to obtain a significant finding, it is tempting to use one-sided tests. The down side of a one-sided test is that even with a large excursion of the observed <span class="math inline">\(z\)</span> in the other direction one cannot reject the null hypothesis. So if the new eye-glasses are so bad as to render the radiologist practically blind (think of a botched cataract surgery) the observed <span class="math inline">\(z\)</span> would be large and negative, but one cannot reject the null hypothesis <span class="math inline">\(AUC=AUC_{pop}\)</span>.</p>
<p>The one-sided test could be run the other way, with the alternative hypothesis being stated as <span class="math inline">\(AUC&lt;AUC_{pop}\)</span>. Now, large negative excursions of the observed value of AUC cause rejection of the null hypothesis, but large positive excursions do not. The critical value is defined by <span class="math inline">\(z_\alpha = \Phi^{-1}\left (\alpha \right )\)</span>, which for <span class="math inline">\(\alpha\)</span> = 0.05 is -1.645. The p-value is given by (note the reversed sign compared to the previous one-sided test:</p>
<p><span class="math display">\[\begin{equation*} 
\Pr\left ( Z \leq 1.042 \mid NH  \right ) = \Phi(1.042) = 1 - 0.1487 = 0.8513
\end{equation*}\]</span></p>
<p>This is the complement of the value for a one-sided test with the alternative hypothesis going the other way: obviously the probability that <span class="math inline">\(Z\)</span> is smaller than the observed value (1.042) plus the probability that <span class="math inline">\(Z\)</span> is larger than the same value must equal one.</p>
</div>
<div id="statistical-power" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Statistical power</h2>
<p>So far, focus has been on the null hypothesis. The Type-I error probability was introduced, defined as the probability of incorrectly rejecting the null hypothesis, the control, or “cap” on which is <span class="math inline">\(\alpha\)</span>, usually set to 0.05. What if the null hypothesis is actually false and the study fails to reject it? This is termed a Type-II error, the control on which is denoted <span class="math inline">\(\beta\)</span>, the probability of a Type-II error. <strong>The complement of <span class="math inline">\(\beta\)</span> is called statistical power.</strong></p>
<p>The following table summarizes the two types of errors and the two correct decisions that can occur in hypothesis testing. In the context of hypothesis testing, a Type-II error could be termed a false negative, not to be confused with false negatives occurring on individual case-level decisions.</p>
<table>
<thead>
<tr class="header">
<th align="left">Truth</th>
<th align="left">Fail to reject NH</th>
<th align="left">Reject NH</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NH is True</td>
<td align="left">1 - <span class="math inline">\(\alpha\)</span></td>
<td align="left"><span class="math inline">\(\alpha\)</span> (FPF)</td>
</tr>
<tr class="even">
<td align="left">NH is False</td>
<td align="left"><span class="math inline">\(\beta\)</span> (FNF)</td>
<td align="left">Power = 1 - <span class="math inline">\(\beta\)</span></td>
</tr>
</tbody>
</table>
<p>This resembles the 2 x 2 table encountered in Chapter 02, which led to the concepts of <span class="math inline">\(FPF\)</span>, <span class="math inline">\(TPF\)</span> and the ROC curve. Indeed, it is possible think of an analogous plot of empirical (i.e., observed) power vs. empirical <span class="math inline">\(\alpha\)</span>, which looks like an ROC plot, with empirical <span class="math inline">\(\alpha\)</span> playing the role of <span class="math inline">\(FPF\)</span> and empirical power playing the role of <span class="math inline">\(TPF\)</span>, see below. If <span class="math inline">\(\alpha\)</span> = 0, then power = 0; i.e., if Type-I errors are minimized all the way to zero, then power is zero and one makes Type-II errors all the time. On the other hand, if <span class="math inline">\(\alpha\)</span> = 1 then Power = 1, and one makes Type-I errors all the time.</p>
<p>A little history is due at this point. The author’s first FROC study, which led to his entry into this field <span class="citation">(Chakraborty et al. <a href="#ref-RN621" role="doc-biblioref">1986</a>)</span>, was published in Radiology in 1986 after a lot of help from a reviewer, who we (correctly) guessed was the late Prof. Charles E. Metz. Prof. Gary T. Barnes (the author’s mentor at that time at the University of Alabama at Birmingham) and the author visited Prof. Charles Metz in Chicago for a day ca. 1986, to figuratively “pick Charlie’s brain”. Prof. Metz referred to the concept outlined in the previous paragraph, as an <em>ROC within an ROC</em>.</p>
<p>This curve does not summarize the result of a single ROC study. Rather it summarizes the probabilistic behavior of the two types of errors that occur when one conducts thousands of such studies, under both NH true and NH false conditions, each time with different values of <span class="math inline">\(\alpha\)</span>, with each trial ending in a decision to reject or not reject the null hypothesis. The long sentence is best explained with an example.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="HypothesisTesting.html#cb17-1"></a>seed &lt;-<span class="st"> </span><span class="dv">1</span>;<span class="kw">set.seed</span>(seed)</span>
<span id="cb17-2"><a href="HypothesisTesting.html#cb17-2"></a>muNH &lt;-<span class="st"> </span><span class="fl">1.5</span>;muAH &lt;-<span class="st"> </span><span class="fl">2.1</span>;sigma &lt;-<span class="st"> </span><span class="fl">1.3</span>;K1 &lt;-<span class="st"> </span><span class="dv">50</span>;K2 &lt;-<span class="st"> </span><span class="dv">52</span><span class="co"># Line 6</span></span>
<span id="cb17-3"><a href="HypothesisTesting.html#cb17-3"></a></span>
<span id="cb17-4"><a href="HypothesisTesting.html#cb17-4"></a><span class="co"># cheat to find the population mean and std. dev.</span></span>
<span id="cb17-5"><a href="HypothesisTesting.html#cb17-5"></a>AUC &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="dv">10000</span>) <span class="co"># line 8</span></span>
<span id="cb17-6"><a href="HypothesisTesting.html#cb17-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(AUC)) {</span>
<span id="cb17-7"><a href="HypothesisTesting.html#cb17-7"></a>  zk1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K1);zk2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K2, <span class="dt">mean =</span> muNH, <span class="dt">sd =</span> sigma)  </span>
<span id="cb17-8"><a href="HypothesisTesting.html#cb17-8"></a>  AUC[i] &lt;-<span class="st"> </span><span class="kw">Wilcoxon</span>(zk1, zk2)</span>
<span id="cb17-9"><a href="HypothesisTesting.html#cb17-9"></a>}</span>
<span id="cb17-10"><a href="HypothesisTesting.html#cb17-10"></a>sigmaAUC &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(AUC));meanAUC &lt;-<span class="st"> </span><span class="kw">mean</span>(AUC) <span class="co"># Line 14</span></span>
<span id="cb17-11"><a href="HypothesisTesting.html#cb17-11"></a></span>
<span id="cb17-12"><a href="HypothesisTesting.html#cb17-12"></a>T &lt;-<span class="st"> </span><span class="dv">2000</span>  <span class="co"># Line 16</span></span>
<span id="cb17-13"><a href="HypothesisTesting.html#cb17-13"></a>mu &lt;-<span class="st"> </span><span class="kw">c</span>(muNH,muAH) <span class="co"># Line 17</span></span>
<span id="cb17-14"><a href="HypothesisTesting.html#cb17-14"></a>alphaArr &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="dt">length.out =</span> <span class="dv">10</span>)</span>
<span id="cb17-15"><a href="HypothesisTesting.html#cb17-15"></a>EmpAlpha &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">length</span>(alphaArr));EmpPower &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">length</span>(alphaArr))</span>
<span id="cb17-16"><a href="HypothesisTesting.html#cb17-16"></a><span class="cf">for</span> (a <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(alphaArr)) { <span class="co"># Line 20</span></span>
<span id="cb17-17"><a href="HypothesisTesting.html#cb17-17"></a>  alpha &lt;-<span class="st"> </span>alphaArr[a] </span>
<span id="cb17-18"><a href="HypothesisTesting.html#cb17-18"></a>  reject &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>, T))</span>
<span id="cb17-19"><a href="HypothesisTesting.html#cb17-19"></a>  <span class="cf">for</span> (h <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) {  </span>
<span id="cb17-20"><a href="HypothesisTesting.html#cb17-20"></a>    <span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(reject[h,])) {  </span>
<span id="cb17-21"><a href="HypothesisTesting.html#cb17-21"></a>      zk1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K1);zk2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K2, <span class="dt">mean =</span> mu[h], <span class="dt">sd =</span> sigma)  </span>
<span id="cb17-22"><a href="HypothesisTesting.html#cb17-22"></a>      AUC &lt;-<span class="st"> </span><span class="kw">Wilcoxon</span>(zk1, zk2)  </span>
<span id="cb17-23"><a href="HypothesisTesting.html#cb17-23"></a>      obsvdZ &lt;-<span class="st"> </span>(AUC <span class="op">-</span><span class="st"> </span>meanAUC)<span class="op">/</span>sigmaAUC</span>
<span id="cb17-24"><a href="HypothesisTesting.html#cb17-24"></a>      p &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">pnorm</span>(<span class="op">-</span><span class="kw">abs</span>(obsvdZ)) <span class="co"># p value for individual t</span></span>
<span id="cb17-25"><a href="HypothesisTesting.html#cb17-25"></a>      <span class="cf">if</span> (p <span class="op">&lt;</span><span class="st"> </span>alpha) reject[h,t] =<span class="st"> </span><span class="dv">1</span> </span>
<span id="cb17-26"><a href="HypothesisTesting.html#cb17-26"></a>    }</span>
<span id="cb17-27"><a href="HypothesisTesting.html#cb17-27"></a>  }</span>
<span id="cb17-28"><a href="HypothesisTesting.html#cb17-28"></a>  EmpAlpha[a] &lt;-<span class="st"> </span><span class="kw">sum</span>(reject[<span class="dv">1</span>,])<span class="op">/</span><span class="kw">length</span>(reject[<span class="dv">1</span>,])</span>
<span id="cb17-29"><a href="HypothesisTesting.html#cb17-29"></a>  EmpPower[a] &lt;-<span class="st"> </span><span class="kw">sum</span>(reject[<span class="dv">2</span>,])<span class="op">/</span><span class="kw">length</span>(reject[<span class="dv">2</span>,])</span>
<span id="cb17-30"><a href="HypothesisTesting.html#cb17-30"></a>}</span>
<span id="cb17-31"><a href="HypothesisTesting.html#cb17-31"></a>EmpAlpha &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,EmpAlpha,<span class="dv">1</span>); EmpPower &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,EmpPower,<span class="dv">1</span>) <span class="co"># Line 19</span></span>
<span id="cb17-32"><a href="HypothesisTesting.html#cb17-32"></a></span>
<span id="cb17-33"><a href="HypothesisTesting.html#cb17-33"></a>pointData &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">EmpAlpha =</span> EmpAlpha, <span class="dt">EmpPower =</span> EmpPower)</span>
<span id="cb17-34"><a href="HypothesisTesting.html#cb17-34"></a>zetas &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb17-35"><a href="HypothesisTesting.html#cb17-35"></a>muRoc &lt;-<span class="st"> </span><span class="fl">1.8</span></span>
<span id="cb17-36"><a href="HypothesisTesting.html#cb17-36"></a>curveData &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">EmpAlpha =</span> <span class="kw">pnorm</span>(<span class="op">-</span>zetas), <span class="dt">EmpPower =</span> <span class="kw">pnorm</span>(muRoc <span class="op">-</span><span class="st"> </span>zetas))</span>
<span id="cb17-37"><a href="HypothesisTesting.html#cb17-37"></a>alphaPowerPlot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> EmpAlpha, <span class="dt">y =</span> EmpPower)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">data =</span> pointData, <span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> curveData)</span>
<span id="cb17-38"><a href="HypothesisTesting.html#cb17-38"></a><span class="kw">print</span>(alphaPowerPlot)</span></code></pre></div>
<p><img src="08-hypothesis-testing_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Line 6 creates two variables, <code>muNH</code> = 1.5 (the binormal model separation parameter under the NH) and <code>muAH</code> = 2.1 (the separation parameter under the AH). Under either hypotheses, the same diseased case standard deviation <code>sigma</code> = 1.3 and 50 non-diseased and 52 diseased cases are assumed. As before, lines 8 – 14 use the “brute force” technique to determine population AUC and standard deviation of AUC under the NH condition. Line 16 defines the number of trials <code>T</code> = 2000. Line 17 creates a vector <code>mu</code> containing the NH and AH values defined at line 6. Line 18 creates <code>alphaArr</code>, a sequence of 10 equally spaced values in the range 0.05 to 0.95, which represent 10 values for <span class="math inline">\(\alpha\)</span>. Line 19 creates two arrays of length 10 each, named <code>EmpAlpha</code> and <code>EmpPower</code>, to hold the values of the observed Type-I error rate, i.e., empirical <span class="math inline">\(\alpha\)</span>, and the empirical power, respectively. The program will run <code>T</code> = 2000 NH and <code>T</code> = 2000 AH trials using as <span class="math inline">\(\alpha\)</span> each successive value in <code>alphaArr</code> and save the observed Type-I error rates and observed powers to the arrays <code>EmpAlpha</code> and <code>EmpPower</code>, respectively.</p>
<p>The action begins in line 20, which begins a for-loop in <code>a</code>, an index into <code>alphaArr.</code> Line 21 selects the appropriate value for <code>alpha</code> (0.05 on the first pass, 0.15 on the next pass, etc.). Line 22 initializes <code>reject[2,2000]</code> with zeroes, to hold the result of each trial; the first index corresponds to hypothesis <code>h</code> and the second to trial <code>t</code>. Line 23 begins a for-loop in <code>h</code>, with <code>h</code> = 1 corresponding to the NH and <code>h</code> = 2 to the AH. Line 24 begins a for-loop in <code>t</code>, the trial index. The code within this block is similar to previous examples. It simulates ratings, computes AUC, calculates the p-value, and saves a rejection of the NH as a one at the appropriate array location <code>reject[h,t]</code>. Lines 32 – 33 calculate the empirical <span class="math inline">\(\alpha\)</span> and empirical power for each value of <span class="math inline">\(\alpha\)</span> in <code>alphaArr</code>. After padding the ends with zero and ones (the trivial points), the remaining lines plot the “ROC within an ROC”.</p>
<p>Each of the circles in the figure corresponds to a specific value of <span class="math inline">\(\alpha\)</span>. For example the lowest non-trivial corresponds to <span class="math inline">\(\alpha\)</span> = 0.05, for which the empirical <span class="math inline">\(\alpha\)</span> is 0.049 and the corresponding empirical Power is 0.4955. True <span class="math inline">\(\alpha\)</span> increases as the operating point moves up the plot, with empirical <span class="math inline">\(\alpha\)</span> and empirical power increasing correspondingly. The <span class="math inline">\(AUC\)</span> under this curve is determined by the effect size, defined as the difference between the AH and NH values of the separation parameter. If the effect size is zero, then the circles will scatter around the chance diagonal; the scatter will be consistent with the 2000 trials used to generate each coordinate of a point. As the effect size increases, the plot approaches the perfect “ROC”, i.e., approaching the top-left corner. One could use AUC under this “ROC” as a measure of the incremental performance, the advantage being that it would be totally independent of <span class="math inline">\(\alpha\)</span>, but this would not be practical as it requires replication of the study under NH and AH conditions about 2000 times each and the entire process has to be repeated for several values of <span class="math inline">\(\alpha\)</span>. The purpose of this demonstration was to illustrate the concept behind Metz’s profound remark.</p>
<p>It is time to move on to factors affecting statistical power in a single study.</p>
<div id="factors-affecting-statistical-power" class="section level3" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Factors affecting statistical power</h3>
<ul>
<li>Effect size: effect size is defined as the difference in <span class="math inline">\(AUC_{pop}\)</span> values between the alternative hypothesis condition and the null hypothesis condition. Recall that <span class="math inline">\(AUC_{pop}\)</span> is defined as the true or population value of the empirical ROC-AUC for the relevant hypothesis. One can use the “cheat method” to estimate it under the alternative hypothesis. The formalism is easier if one assumes it is equal to the asymptotic binormal model predicted value. The binormal model yields an estimate of the parameters, which only approach the population values in the asymptotic limit of a large number of cases. In the following, it is assumed that the parameters on the right hand side are the population values)
It follows that effect size (ES) is given by (all quantities on the right hand side of Eqn. (8.13) are population values):</li>
</ul>
<p><span class="math display">\[\begin{equation*} 
AUC = \Phi\left ( \frac{ \mu }{\sqrt{ 1 + \sigma^2}} \right )
\end{equation*}\]</span></p>
<p>It follows that effect size (ES) is given by (all quantities on the right hand side of above equation are population values):</p>
<p><span class="math display">\[\begin{equation*} 
ES = \Phi\left ( \frac{\mu_{AH}}{\sqrt{1+\sigma^2}} \right ) - \Phi\left ( \frac{\mu_{NH}}{\sqrt{1+\sigma^2}} \right )
\end{equation*}\]</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="HypothesisTesting.html#cb18-1"></a>EffectSize &lt;-<span class="st"> </span><span class="cf">function</span> (muNH, sigmaNH, muAH, sigmaAH)</span>
<span id="cb18-2"><a href="HypothesisTesting.html#cb18-2"></a>{</span>
<span id="cb18-3"><a href="HypothesisTesting.html#cb18-3"></a>  ES &lt;-<span class="st"> </span><span class="kw">pnorm</span>(muAH<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">+</span>sigmaAH<span class="op">^</span><span class="dv">2</span>)) <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(muNH<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">1</span><span class="op">+</span>sigmaNH<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb18-4"><a href="HypothesisTesting.html#cb18-4"></a>  <span class="kw">return</span> (ES)</span>
<span id="cb18-5"><a href="HypothesisTesting.html#cb18-5"></a>}</span>
<span id="cb18-6"><a href="HypothesisTesting.html#cb18-6"></a></span>
<span id="cb18-7"><a href="HypothesisTesting.html#cb18-7"></a>seed &lt;-<span class="st"> </span><span class="dv">1</span>;<span class="kw">set.seed</span>(seed)</span>
<span id="cb18-8"><a href="HypothesisTesting.html#cb18-8"></a>muAH &lt;-<span class="st"> </span><span class="fl">2.1</span> <span class="co"># NH value, defined previously, was mu = 1.5</span></span>
<span id="cb18-9"><a href="HypothesisTesting.html#cb18-9"></a></span>
<span id="cb18-10"><a href="HypothesisTesting.html#cb18-10"></a>T &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb18-11"><a href="HypothesisTesting.html#cb18-11"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="co"># size of test</span></span>
<span id="cb18-12"><a href="HypothesisTesting.html#cb18-12"></a>reject =<span class="st"> </span><span class="kw">array</span>(<span class="dv">0</span>, <span class="dt">dim =</span> T)</span>
<span id="cb18-13"><a href="HypothesisTesting.html#cb18-13"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(reject)) {  </span>
<span id="cb18-14"><a href="HypothesisTesting.html#cb18-14"></a>  zk1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K1);zk2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K2, <span class="dt">mean =</span> muAH, <span class="dt">sd =</span> sigma)  </span>
<span id="cb18-15"><a href="HypothesisTesting.html#cb18-15"></a>  AUC &lt;-<span class="st"> </span><span class="kw">Wilcoxon</span>(zk1, zk2)  </span>
<span id="cb18-16"><a href="HypothesisTesting.html#cb18-16"></a>  obsvdZ &lt;-<span class="st"> </span>(AUC <span class="op">-</span><span class="st"> </span>meanAUC)<span class="op">/</span>sigmaAUC</span>
<span id="cb18-17"><a href="HypothesisTesting.html#cb18-17"></a>  p &lt;-<span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">pnorm</span>(<span class="op">-</span><span class="kw">abs</span>(obsvdZ)) <span class="co"># p value for individual t</span></span>
<span id="cb18-18"><a href="HypothesisTesting.html#cb18-18"></a>  <span class="cf">if</span> (p <span class="op">&lt;</span><span class="st"> </span>alpha) reject[t] =<span class="st"> </span><span class="dv">1</span> </span>
<span id="cb18-19"><a href="HypothesisTesting.html#cb18-19"></a>}</span>
<span id="cb18-20"><a href="HypothesisTesting.html#cb18-20"></a></span>
<span id="cb18-21"><a href="HypothesisTesting.html#cb18-21"></a>ObsvdTypeIErrRate &lt;-<span class="st"> </span><span class="kw">sum</span>(reject)<span class="op">/</span><span class="kw">length</span>(reject)</span>
<span id="cb18-22"><a href="HypothesisTesting.html#cb18-22"></a>CI &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>);width &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">qnorm</span>(alpha<span class="op">/</span><span class="dv">2</span>)</span>
<span id="cb18-23"><a href="HypothesisTesting.html#cb18-23"></a>CI[<span class="dv">1</span>] &lt;-<span class="st"> </span>ObsvdTypeIErrRate <span class="op">-</span><span class="st"> </span>width<span class="op">*</span><span class="kw">sqrt</span>(ObsvdTypeIErrRate<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>ObsvdTypeIErrRate)<span class="op">/</span>T)</span>
<span id="cb18-24"><a href="HypothesisTesting.html#cb18-24"></a>CI[<span class="dv">2</span>] &lt;-<span class="st"> </span>ObsvdTypeIErrRate <span class="op">+</span><span class="st"> </span>width<span class="op">*</span><span class="kw">sqrt</span>(ObsvdTypeIErrRate<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>ObsvdTypeIErrRate)<span class="op">/</span>T)</span>
<span id="cb18-25"><a href="HypothesisTesting.html#cb18-25"></a><span class="kw">cat</span>(<span class="st">&quot;obsvdPower = &quot;</span>, ObsvdTypeIErrRate, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb18-26"><a href="HypothesisTesting.html#cb18-26"></a><span class="co">#&gt; obsvdPower =  0.489</span></span>
<span id="cb18-27"><a href="HypothesisTesting.html#cb18-27"></a><span class="kw">cat</span>(<span class="st">&quot;95% confidence interval = &quot;</span>, CI, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb18-28"><a href="HypothesisTesting.html#cb18-28"></a><span class="co">#&gt; 95% confidence interval =  0.4670922 0.5109078</span></span>
<span id="cb18-29"><a href="HypothesisTesting.html#cb18-29"></a><span class="kw">cat</span>(<span class="st">&quot;Effect Size = &quot;</span>, <span class="kw">EffectSize</span>(mu, sigma, muAH, sigma), <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb18-30"><a href="HypothesisTesting.html#cb18-30"></a><span class="co">#&gt; Effect Size =  0.08000617 0</span></span></code></pre></div>
<p>The ES for the code above is 0.08 (in AUC units). It should be obvious that if effect size is zero, then power equals <span class="math inline">\(\alpha\)</span>. This is because then there is no distinction between the null and alternative hypotheses conditions. Conversely, as effect size increases, statistical power increases, the limiting value being unity, when every trial results in rejection of the null hypothesis. The reader should experiment with different values of <code>muAH</code> to be convinced of the truth of these statements.</p>
<ul>
<li>Sample size: increase the number of cases by a factor of two, and run the above code chunk.</li>
</ul>
<pre><code>#&gt; pop NH mean AUC =  0.8594882 , pop NH sigma AUC =  0.02568252
#&gt; num. non-diseased images =  100 num. diseased images =  104
#&gt; obsvdPower =  0.313
#&gt; 95% confidence interval =  0.2926772 0.3333228
#&gt; Effect Size =  0.08000617 0</code></pre>
<p>So doubling the numbers of cases (both non-diseased and diseased) results in statistical power increasing from 0.509 to 0.844. Increasing the numbers of cases decreases <span class="math inline">\(\sigma_{AUC}\)</span>, the standard deviation of the empirical AUC. The new value of <span class="math inline">\(\sigma_{AUC}\)</span> is 0.02947, which should be compared to the value 0.04177 for K1 = 50, K2 = 52. Recall that <span class="math inline">\(\sigma_{AUC}\)</span> enters the denominator of the Z-statistic, so decreasing it will increase the probability of rejecting the null hypothesis.</p>
<ul>
<li>Alpha: Statistical power depends on <span class="math inline">\(alpha\)</span>. return the sample size to the original values . The results below are for two runs of the code, the first with the original value , set at line 16, the second with :</li>
</ul>
<pre><code>#&gt; alpha =  0.05 obsvdPower =  0.1545 
#&gt; alpha =  0.01 obsvdPower =  0.0265</code></pre>
<p>Decreasing <span class="math inline">\(\alpha\)</span> results in decreased statistical power.</p>
</div>
</div>
<div id="comments-1" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Comments</h2>
<p>The Wilcoxon statistic was used to estimate the area under the ROC curve. One could have used the binormal model, introduced in Chapter 06, to obtain maximum likelihood estimates of the area under the binormal model fitted ROC curve. The reasons for choosing the simpler empirical area are as follows. (1) With continuous ratings and 102 operating points, the area under the empirical ROC curve is expected to be a close approximation to the fitted area. (2) With maximum likelihood estimation, the code would be more complex – in addition to the fitting routine one would require a binning routine and that would introduce yet another variable in the analysis, namely the number of bins and how the bin boundaries were chosen. (3) The maximum likelihood fitting code can sometimes fail to converge, while the Wilcoxon method is always guaranteed to yield a result. The non-convergence issue is overcome by modern methods of curve fitting described in later chapters. (4) The aim was to provide an understanding of null hypothesis testing and statistical power without being bogged down in the details of curve fitting.</p>
</div>
<div id="why-alpha-is-chosen-to-be-5" class="section level2" number="6.7">
<h2><span class="header-section-number">6.7</span> Why alpha is chosen to be 5%</h2>
<p>One might ask why <span class="math inline">\(\alpha\)</span> is traditionally chosen to be 5%. It is not a magical number, rather a cost benefit tradeoff. Choosing too small a value of <span class="math inline">\(\alpha\)</span> would result in greater probability <span class="math inline">\((1-\alpha)\)</span> of the NH not being rejected, even when it is false, i.e., decreased power. Sometimes it is important to detect a true difference between the measured AUC and the postulated value. For example, a new eye-laser surgery procedure is invented and the number of patients is necessarily small as one does not wish to subject a large number of patients to an untried procedure. One seeks some leeway on the Type-I error probability, possibly increasing it to <span class="math inline">\(\alpha\)</span> = 0.1, in order to have a reasonable chance of success in detecting an improvement in performance due to better eyesight after the surgery. If the NH is rejected and the change is in the right direction, then that is good news for the researcher. One might then consider a larger clinical trial and set <span class="math inline">\(\alpha\)</span> at the traditional 0.05, making up the lost statistical power by increasing the number of patients on which the surgery is tried.</p>
<p>If a whole branch of science hinges on the results of a study, such as discovering the Higg’s Boson in particle physics, statistical significance is often expressed in multiples of the standard deviation (<span class="math inline">\(\sigma\)</span>) of the normal distribution, with the significance threshold set at a much stricter level (e.g. <span class="math inline">\(5\sigma\)</span>). This corresponds to <span class="math inline">\(\alpha\)</span> ~ 1 in 3.5 million (<code>1/pnorm(-5)</code> = 3.5 x 10^6, a one-sided test of significance). There is an article in Scientific American (<a href="https://blogs.scientificamerican.com/observations/five-sigmawhats-that/" class="uri">https://blogs.scientificamerican.com/observations/five-sigmawhats-that/</a>) on the use of <span class="math inline">\(n\sigma\)</span>, where <code>n</code> is an integer, e.g. 5, to denote the significance level of a study, and some interesting anecdotes on why such high significance levels (low alpha) are used in some fields of research.</p>
<p>Similar concerns apply to manufacturing where the cost of a mistake could be the very expensive recall of an entire product line. For background on Six Sigma Performance, see <a href="http://www.six-sigma-material.com/Six-Sigma.html" class="uri">http://www.six-sigma-material.com/Six-Sigma.html</a>. An article downloaded 3/30/17 from <a href="https://en.wikipedia.org/wiki/Six_Sigma" class="uri">https://en.wikipedia.org/wiki/Six_Sigma</a> is included as supplemental material to this chapter (Six Sigma.pdf). It has an explanation of why <span class="math inline">\(6\sigma\)</span> translates to one defect per 3.4 million opportunities (it has to do with short-term and long-term drifts in a process). In the author’s opinion, looking at other fields offers a deeper understanding of this material than simply stating that by tradition one adopts alpha = 5%.</p>
<p>Most observer performance studies, while important in the search for better imaging methods, are not of such “earth-shattering” importance, and it is somewhat important to detect true differences (AH is true) at a reasonable alpha, so alpha = 5% and beta = 20% represent a good compromise. If one adopted a <span class="math inline">\(5\sigma\)</span> criterion, the NH would never be rejected, and progress in image quality optimization would come to a grinding halt. That is not to say that a <span class="math inline">\(5\sigma\)</span> criterion cannot be used; rather if used, the number of patients needed to detect a reasonable difference (effect size) with 80% probability would be astronomically large. Truth-proven cases are a precious commodity in observer performance studies. Particle physicists working on discovering the Higg’s Boson can get away with <span class="math inline">\(5\sigma\)</span> criterion because the number of independent observations and/or effect size is much larger than corresponding numbers in observer performance research.</p>
</div>
<div id="discussion-1" class="section level2" number="6.8">
<h2><span class="header-section-number">6.8</span> Discussion</h2>
<p>In most statistics books, the subject of hypothesis testing is demonstrated in different (i.e., non-ROC) contexts. That is to be expected since the ROC-analysis field is a very small subspecialty of statistics (Prof. Howard E. Rockette, private communication, ca. 2002). Since this book is about ROC analysis, the author decided to use a demonstration using ROC analysis. Using a data simulator, one is allowed to “cheat” by conducting a very large number of simulations to estimate the population <span class="math inline">\(AUC\)</span> under the null hypothesis. This permitted us to explore the related concepts of Type-I and Type-II errors within the context of ROC analysis. Ideally, both errors should be zero, but the nature of statistics leads one to two compromises. Usually one accepts a Type-I error capped at 5% and a Type-II error capped at 20%. These translate to <span class="math inline">\(\alpha\)</span> = 0.05 and desired statistical power = 80%. The dependence of statistical power on <span class="math inline">\(\alpha\)</span>, the numbers of cases and the effect size was explored. Statistical power increases with the effect size, it increases with <span class="math inline">\(\alpha\)</span> and it increases with the sample size (numbers of cases).</p>
<p>In Chapter 11 sample-size calculations are described that allow one to estimate the numbers of readers and cases needed to detect a specified difference in inter-modality AUCs with an expected statistical power <span class="math inline">\(1-\beta\)</span> . The word “detect” in the preceding sentence is shorthand for “reject the NH with probability capped at <span class="math inline">\(\alpha\)</span> while also rejecting the alternative hypothesis with probability capped at <span class="math inline">\(\beta\)</span>”.</p>
<p>This chapter also gives the first example of validation of a hypothesis testing method. Statisticians sometimes refer to this as showing a proposed test is a “5% test”. What is meant is that one needs to be assured that when the NH is true the probability of NH rejection equals the expected value, namely <span class="math inline">\(\alpha\)</span>, typically chosen to be 5%. Since the observed NH rejection rate over 2000 simulations is a random variable, one does not expect the NH rejection rate to exactly equal 5%, rather the constructed 95% confidence interval (also a random interval variable) should include the NH value with probability <span class="math inline">\(\alpha\)</span>.</p>
<p>As noted in the introduction, comparing a single reader’s performance to a specified value is not a clinically interesting problem. The next two chapters describe methods for significance testing of multiple-reader multiple-case (MRMC) ROC datasets, consisting of interpretations by a group of readers of a common set of cases in typically two modalities. It turns out that the analyses yield variability estimates that permit sample size calculation. After all, sample size calculation is all about estimation of variability, the denominator of the z-statistic, i.e., Eqn. (8.3), in the context of this chapter. The formulae will look more complex, as interest is not in determining the standard deviation of AUC, but in the standard deviation of the inter-modality reader-averaged AUC difference. However, the basic concepts remain the same.</p>
</div>
<div id="references-3" class="section level2" number="6.9">
<h2><span class="header-section-number">6.9</span> References</h2>

</div>
</div>
<h3>REFERENCES</h3>
<div id="refs" class="references">
<div id="ref-RN621">
<p>Chakraborty, D. P., E. S. Breatnach, M. V. Yester, B. Soto, G. T. Barnes, and R. G. Fraser. 1986. “Digital and Conventional Chest Imaging: A Modified Roc Study of Observer Performance Using Simulated Nodules.” Journal Article. <em>Radiology</em> 158: 35–39.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="BinormalModel.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="DBMHnalysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["RJafrocBook.pdf", "RJafrocBook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
