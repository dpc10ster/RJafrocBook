<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Sample size estimation for ROC studies OR method | The RJafroc Book</title>
  <meta name="description" content="Extended RJafroc documentation." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Sample size estimation for ROC studies OR method | The RJafroc Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Extended RJafroc documentation." />
  <meta name="github-repo" content="dpc10ster/RJafrocBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Sample size estimation for ROC studies OR method | The RJafroc Book" />
  
  <meta name="twitter:description" content="Extended RJafroc documentation." />
  

<meta name="author" content="Dev P. Chakraborty, PhD" />


<meta name="date" content="2020-08-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="RocSampleSizeDBM.html"/>
<link rel="next" href="SplitPlotChapter.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RJafroc documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="a-note-on-the-online-distribution-mechanism-of-the-book.html"><a href="a-note-on-the-online-distribution-mechanism-of-the-book.html"><i class="fa fa-check"></i>A note on the online distribution mechanism of the book</a></li>
<li class="chapter" data-level="" data-path="contributing-to-this-book.html"><a href="contributing-to-this-book.html"><i class="fa fa-check"></i>Contributing to this book</a></li>
<li class="chapter" data-level="" data-path="is-this-book-relevant-to-you-and-what-are-the-alternatives.html"><a href="is-this-book-relevant-to-you-and-what-are-the-alternatives.html"><i class="fa fa-check"></i>Is this book relevant to you and what are the alternatives?</a></li>
<li class="chapter" data-level="1" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html"><i class="fa fa-check"></i><b>1</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="1.1" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#HypothesisTesting-introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#hypothesis-testing-for-a-single-modality-single-reader-roc-study"><i class="fa fa-check"></i><b>1.2</b> Hypothesis testing for a single-modality single-reader ROC study</a></li>
<li class="chapter" data-level="1.3" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#type-i-errors"><i class="fa fa-check"></i><b>1.3</b> Type-I errors</a></li>
<li class="chapter" data-level="1.4" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#one-sided-vs.-two-sided-tests"><i class="fa fa-check"></i><b>1.4</b> One sided vs. two sided tests</a></li>
<li class="chapter" data-level="1.5" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#statistical-power"><i class="fa fa-check"></i><b>1.5</b> Statistical power</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#factors-affecting-statistical-power"><i class="fa fa-check"></i><b>1.5.1</b> Factors affecting statistical power</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#comments"><i class="fa fa-check"></i><b>1.6</b> Comments</a></li>
<li class="chapter" data-level="1.7" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#why-alpha-is-chosen-to-be-5"><i class="fa fa-check"></i><b>1.7</b> Why alpha is chosen to be 5%</a></li>
<li class="chapter" data-level="1.8" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#discussion"><i class="fa fa-check"></i><b>1.8</b> Discussion</a></li>
<li class="chapter" data-level="1.9" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#HypothesisTesting-references"><i class="fa fa-check"></i><b>1.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html"><i class="fa fa-check"></i><b>2</b> Background on Dorfman Berbaum Metz (DBM) Analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#DBMAnalysisBkgrnd-introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#historical-background"><i class="fa fa-check"></i><b>2.1.1</b> Historical background</a></li>
<li class="chapter" data-level="2.1.2" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#the-wagner-analogy"><i class="fa fa-check"></i><b>2.1.2</b> The Wagner analogy</a></li>
<li class="chapter" data-level="2.1.3" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#the-shortage-of-numbers-to-analyze-and-a-pivotal-breakthrough"><i class="fa fa-check"></i><b>2.1.3</b> The shortage of numbers to analyze and a pivotal breakthrough</a></li>
<li class="chapter" data-level="2.1.4" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#organization-of-the-chapter"><i class="fa fa-check"></i><b>2.1.4</b> Organization of the chapter</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#random-and-fixed-factors"><i class="fa fa-check"></i><b>2.2</b> Random and fixed factors</a></li>
<li class="chapter" data-level="2.3" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#reader-and-case-populations-and-data-correlations"><i class="fa fa-check"></i><b>2.3</b> Reader and case populations and data correlations</a></li>
<li class="chapter" data-level="2.4" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#three-types-of-analyses"><i class="fa fa-check"></i><b>2.4</b> Three types of analyses</a></li>
<li class="chapter" data-level="2.5" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#general-approach"><i class="fa fa-check"></i><b>2.5</b> General approach</a></li>
<li class="chapter" data-level="2.6" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#DBMAnalysisBkgrnd-summary"><i class="fa fa-check"></i><b>2.6</b> Summary TBA</a></li>
<li class="chapter" data-level="2.7" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#DBMAnalysisBkgrnd-references"><i class="fa fa-check"></i><b>2.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html"><i class="fa fa-check"></i><b>3</b> Significance Testing using the DBM Method</a>
<ul>
<li class="chapter" data-level="3.1" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#the-dbm-sampling-model"><i class="fa fa-check"></i><b>3.1</b> The DBM sampling model</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#explanation-of-terms-in-the-model"><i class="fa fa-check"></i><b>3.1.1</b> Explanation of terms in the model</a></li>
<li class="chapter" data-level="3.1.2" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#meanings-of-variance-components-in-the-dbm-model-tba-this-section-can-be-improved"><i class="fa fa-check"></i><b>3.1.2</b> Meanings of variance components in the DBM model (<strong>TBA this section can be improved</strong>)</a></li>
<li class="chapter" data-level="3.1.3" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#definitions-of-mean-squares"><i class="fa fa-check"></i><b>3.1.3</b> Definitions of mean-squares</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#expected-values-of-mean-squares"><i class="fa fa-check"></i><b>3.2</b> Expected values of mean squares</a></li>
<li class="chapter" data-level="3.3" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#DBMAnalysisSigtesting-RRRC-analysis"><i class="fa fa-check"></i><b>3.3</b> Random-reader random-case (RRRC) analysis</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#calculation-of-mean-squares-an-example"><i class="fa fa-check"></i><b>3.3.1</b> Calculation of mean squares: an example</a></li>
<li class="chapter" data-level="3.3.2" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#DBMAnalysisSigtesting-sig-testing"><i class="fa fa-check"></i><b>3.3.2</b> Significance testing</a></li>
<li class="chapter" data-level="3.3.3" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#the-satterthwaite-approximation"><i class="fa fa-check"></i><b>3.3.3</b> The Satterthwaite approximation</a></li>
<li class="chapter" data-level="3.3.4" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#decision-rules-p-value-and-confidence-intervals"><i class="fa fa-check"></i><b>3.3.4</b> Decision rules, p-value and confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#sample-size-estimation-for-random-reader-random-case-generalization"><i class="fa fa-check"></i><b>3.4</b> Sample size estimation for random-reader random-case generalization</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#the-non-centrality-parameter"><i class="fa fa-check"></i><b>3.4.1</b> The non-centrality parameter</a></li>
<li class="chapter" data-level="3.4.2" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#the-denominator-degrees-of-freedom"><i class="fa fa-check"></i><b>3.4.2</b> The denominator degrees of freedom</a></li>
<li class="chapter" data-level="3.4.3" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#example-of-sample-size-estimation-rrrc-generalization"><i class="fa fa-check"></i><b>3.4.3</b> Example of sample size estimation, RRRC generalization</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#significance-testing-and-sample-size-estimation-for-fixed-reader-random-case-generalization"><i class="fa fa-check"></i><b>3.5</b> Significance testing and sample size estimation for fixed-reader random-case generalization</a></li>
<li class="chapter" data-level="3.6" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#significance-testing-and-sample-size-estimation-for-random-reader-fixed-case-generalization"><i class="fa fa-check"></i><b>3.6</b> Significance testing and sample size estimation for random-reader fixed-case generalization</a></li>
<li class="chapter" data-level="3.7" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#DBMAnalysisSigtesting-summary"><i class="fa fa-check"></i><b>3.7</b> Summary TBA</a></li>
<li class="chapter" data-level="3.8" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#things-for-me-to-think-about"><i class="fa fa-check"></i><b>3.8</b> Things for me to think about</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#expected-values-of-mean-squares-1"><i class="fa fa-check"></i><b>3.8.1</b> Expected values of mean squares</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#DBMAnalysisSigtesting-references"><i class="fa fa-check"></i><b>3.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="DBMSpecialCases.html"><a href="DBMSpecialCases.html"><i class="fa fa-check"></i><b>4</b> DBM method special cases</a>
<ul>
<li class="chapter" data-level="4.1" data-path="DBMSpecialCases.html"><a href="DBMSpecialCases.html#FRRCDBMAnalysis"><i class="fa fa-check"></i><b>4.1</b> Fixed-reader random-case (FRRC) analysis</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="DBMSpecialCases.html"><a href="DBMSpecialCases.html#FRRCSingleReaderDBMAnalysis"><i class="fa fa-check"></i><b>4.1.1</b> Single-reader multiple-treatment analysis</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="DBMSpecialCases.html"><a href="DBMSpecialCases.html#DBMSpecialCases-RRFCAnalysis"><i class="fa fa-check"></i><b>4.2</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="4.3" data-path="DBMSpecialCases.html"><a href="DBMSpecialCases.html#DBMSpecialCases-references"><i class="fa fa-check"></i><b>4.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html"><i class="fa fa-check"></i><b>5</b> Introduction to the Obuchowski-Rockette method</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#ORMethodIntro-introduction"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#OR1RMTModel"><i class="fa fa-check"></i><b>5.2</b> Single-reader multiple-treatment OR model</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#definitions-of-covariance-and-correlation"><i class="fa fa-check"></i><b>5.2.1</b> Definitions of covariance and correlation</a></li>
<li class="chapter" data-level="5.2.2" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#special-case-when-variables-have-equal-variances"><i class="fa fa-check"></i><b>5.2.2</b> Special case when variables have equal variances</a></li>
<li class="chapter" data-level="5.2.3" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#estimating-the-variance-covariance-matrix"><i class="fa fa-check"></i><b>5.2.3</b> Estimating the variance-covariance matrix</a></li>
<li class="chapter" data-level="5.2.4" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#the-variance-inflation-factor"><i class="fa fa-check"></i><b>5.2.4</b> The variance inflation factor</a></li>
<li class="chapter" data-level="5.2.5" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#meaning-of-the-covariance-matrix-in-eqn.-refeqexamplesigma"><i class="fa fa-check"></i><b>5.2.5</b> Meaning of the covariance matrix in Eqn. @ref(eq:ExampleSigma)</a></li>
<li class="chapter" data-level="5.2.6" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#code-illustrating-the-covariance-matrix"><i class="fa fa-check"></i><b>5.2.6</b> Code illustrating the covariance matrix</a></li>
<li class="chapter" data-level="5.2.7" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#SignificanceTesting1ROR"><i class="fa fa-check"></i><b>5.2.7</b> Significance testing</a></li>
<li class="chapter" data-level="5.2.8" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#ORMethodIntro-pvalue-ci"><i class="fa fa-check"></i><b>5.2.8</b> p-value and confidence interval</a></li>
<li class="chapter" data-level="5.2.9" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#ORMethodIntro-CompareDBM2OR41R"><i class="fa fa-check"></i><b>5.2.9</b> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#SignificanceTestingORMRMC"><i class="fa fa-check"></i><b>5.3</b> Multiple-reader multiple-treatment OR model</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#StrCovMatrix"><i class="fa fa-check"></i><b>5.3.1</b> Structure of the covariance matrix</a></li>
<li class="chapter" data-level="5.3.2" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#PhysicalMeaningsOfCovMatrix"><i class="fa fa-check"></i><b>5.3.2</b> Physical meanings of the covariance terms</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#discussionsummary1"><i class="fa fa-check"></i><b>5.4</b> Discussion/Summary/1</a></li>
<li class="chapter" data-level="5.5" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#ORMethodIntro-references"><i class="fa fa-check"></i><b>5.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html"><i class="fa fa-check"></i><b>6</b> Obuchowski Rockette (OR) Analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#ORAnalysisSigTesting-introduction"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#OR_RRRC"><i class="fa fa-check"></i><b>6.2</b> Random-reader random-case (RRRC) analysis</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#TwoAnecdotes"><i class="fa fa-check"></i><b>6.2.1</b> Two anecdotes</a></li>
<li class="chapter" data-level="6.2.2" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#Hills-ddf"><i class="fa fa-check"></i><b>6.2.2</b> Hillis ddf</a></li>
<li class="chapter" data-level="6.2.3" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#decision-rule-p-value-and-confidence-interval"><i class="fa fa-check"></i><b>6.2.3</b> Decision rule, p-value and confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#fixed-reader-random-case-frrc-analysis"><i class="fa fa-check"></i><b>6.3</b> Fixed-reader random-case (FRRC) analysis</a></li>
<li class="chapter" data-level="6.4" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#ORAnalysisSigTesting-RRFCAnalysis"><i class="fa fa-check"></i><b>6.4</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="6.5" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#discussionsummary4"><i class="fa fa-check"></i><b>6.5</b> Discussion/Summary/4</a></li>
<li class="chapter" data-level="6.6" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#ORAnalysisSigTesting-references"><i class="fa fa-check"></i><b>6.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ORApplications.html"><a href="ORApplications.html"><i class="fa fa-check"></i><b>7</b> Applications using the Obuchowski Rockette method</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-introduction"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-steps"><i class="fa fa-check"></i><b>7.2</b> Steps in the analysis</a></li>
<li class="chapter" data-level="7.3" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-dataset02-hand"><i class="fa fa-check"></i><b>7.3</b> Hand calculation using dataset02</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRRC-dataset02-hand"><i class="fa fa-check"></i><b>7.3.1</b> Random-Reader Random-Case (RRRC) analysis hand calculation</a></li>
<li class="chapter" data-level="7.3.2" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-FRRC-dataset02-hand"><i class="fa fa-check"></i><b>7.3.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="7.3.3" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRFC-dataset02-hand"><i class="fa fa-check"></i><b>7.3.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-dataset02-RJafroc"><i class="fa fa-check"></i><b>7.4</b> Using RJafroc: dataset02</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRRC-dataset02-RJafroc"><i class="fa fa-check"></i><b>7.4.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="7.4.2" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-FRRC-dataset02-RJafroc"><i class="fa fa-check"></i><b>7.4.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="7.4.3" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRFC-dataset02-RJafroc"><i class="fa fa-check"></i><b>7.4.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-dataset04-RJafroc"><i class="fa fa-check"></i><b>7.5</b> Using RJafroc: dataset04</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRRC-dataset04"><i class="fa fa-check"></i><b>7.5.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="7.5.2" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-FRRC-dataset04"><i class="fa fa-check"></i><b>7.5.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="7.5.3" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRFC-dataset04"><i class="fa fa-check"></i><b>7.5.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-dataset04-FROC-RJafroc"><i class="fa fa-check"></i><b>7.6</b> Using RJafroc: dataset04, FROC analysis</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRRC-dataset04-FROC"><i class="fa fa-check"></i><b>7.6.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="7.6.2" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-FRRC-dataset04-FROC"><i class="fa fa-check"></i><b>7.6.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="7.6.3" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRFC-dataset04-FROC"><i class="fa fa-check"></i><b>7.6.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-dataset04-FROC-DBM-RJafroc"><i class="fa fa-check"></i><b>7.7</b> Using RJafroc for dataset04, FROC analysis, DBM method</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRRC-dataset04-FROC-DBM"><i class="fa fa-check"></i><b>7.7.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="7.7.2" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-FRRC-dataset04-FROC-DBM"><i class="fa fa-check"></i><b>7.7.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="7.7.3" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRFC-dataset04-FROC-DBM"><i class="fa fa-check"></i><b>7.7.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="ORApplications.html"><a href="ORApplications.html#discussionsummary5"><i class="fa fa-check"></i><b>7.8</b> Discussion/Summary/5</a></li>
<li class="chapter" data-level="7.9" data-path="ORApplications.html"><a href="ORApplications.html#ToMullOver1-tentative"><i class="fa fa-check"></i><b>7.9</b> Tentative, need to think over</a></li>
<li class="chapter" data-level="7.10" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-references"><i class="fa fa-check"></i><b>7.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html"><i class="fa fa-check"></i><b>8</b> Sample size estimation for ROC studies DBM method</a>
<ul>
<li class="chapter" data-level="8.1" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-introduction"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#StatPower1"><i class="fa fa-check"></i><b>8.2</b> Statistical Power</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#observed-vs.-anticipated-effect-size"><i class="fa fa-check"></i><b>8.2.1</b> Observed vs. anticipated effect-size</a></li>
<li class="chapter" data-level="8.2.2" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-dependence-of-stats-power"><i class="fa fa-check"></i><b>8.2.2</b> Dependence of statistical power on estimates of model parameters</a></li>
<li class="chapter" data-level="8.2.3" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-RRRC-sample-size-estimation"><i class="fa fa-check"></i><b>8.2.3</b> Formulae for random-reader random-case (RRRC) sample size estimation</a></li>
<li class="chapter" data-level="8.2.4" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-sig-testing"><i class="fa fa-check"></i><b>8.2.4</b> Significance testing</a></li>
<li class="chapter" data-level="8.2.5" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-pvalue-ci"><i class="fa fa-check"></i><b>8.2.5</b> p-value and confidence interval</a></li>
<li class="chapter" data-level="8.2.6" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-CompareDBM2OR"><i class="fa fa-check"></i><b>8.2.6</b> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-FRRC-sample-size-estimation"><i class="fa fa-check"></i><b>8.3</b> Formulae for fixed-reader random-case (FRRC) sample size estimation</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-RRFC-sample-size-estimation"><i class="fa fa-check"></i><b>8.3.1</b> Formulae for random-reader fixed-case (RRFC) sample size estimation</a></li>
<li class="chapter" data-level="8.3.2" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-FRRCAnalysis"><i class="fa fa-check"></i><b>8.3.2</b> Fixed-reader random-case (FRRC) analysis TBA</a></li>
<li class="chapter" data-level="8.3.3" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-RRFCAnalysis"><i class="fa fa-check"></i><b>8.3.3</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="8.3.4" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-STMRAnalysis"><i class="fa fa-check"></i><b>8.3.4</b> Single-treatment multiple-reader analysis</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#discussionsummary2"><i class="fa fa-check"></i><b>8.4</b> Discussion/Summary/2</a></li>
<li class="chapter" data-level="8.5" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-references"><i class="fa fa-check"></i><b>8.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html"><i class="fa fa-check"></i><b>9</b> Sample size estimation for ROC studies OR method</a>
<ul>
<li class="chapter" data-level="9.1" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-introduction"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#StatPower2"><i class="fa fa-check"></i><b>9.2</b> Statistical Power</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#sample-size-estimation-for-random-reader-random-cases"><i class="fa fa-check"></i><b>9.2.1</b> Sample size estimation for random-reader random-cases</a></li>
<li class="chapter" data-level="9.2.2" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-dependence-of-stats-power"><i class="fa fa-check"></i><b>9.2.2</b> Dependence of statistical power on estimates of model parameters</a></li>
<li class="chapter" data-level="9.2.3" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-RRRC-sample-size-estimation"><i class="fa fa-check"></i><b>9.2.3</b> Formulae for random-reader random-case (RRRC) sample size estimation</a></li>
<li class="chapter" data-level="9.2.4" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-sig-testing"><i class="fa fa-check"></i><b>9.2.4</b> Significance testing</a></li>
<li class="chapter" data-level="9.2.5" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-pvalue-ci"><i class="fa fa-check"></i><b>9.2.5</b> p-value and confidence interval</a></li>
<li class="chapter" data-level="9.2.6" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-CompareDBM2OR"><i class="fa fa-check"></i><b>9.2.6</b> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-FRRC-sample-size-estimation"><i class="fa fa-check"></i><b>9.3</b> Formulae for fixed-reader random-case (FRRC) sample size estimation</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-RRFC-sample-size-estimation"><i class="fa fa-check"></i><b>9.3.1</b> Formulae for random-reader fixed-case (RRFC) sample size estimation</a></li>
<li class="chapter" data-level="9.3.2" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#example-1"><i class="fa fa-check"></i><b>9.3.2</b> Example 1</a></li>
<li class="chapter" data-level="9.3.3" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-FRRCAnalysis"><i class="fa fa-check"></i><b>9.3.3</b> Fixed-reader random-case (FRRC) analysis</a></li>
<li class="chapter" data-level="9.3.4" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-RRFCAnalysis"><i class="fa fa-check"></i><b>9.3.4</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="9.3.5" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-STMRAnalysis"><i class="fa fa-check"></i><b>9.3.5</b> Single-treatment multiple-reader analysis</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#discussionsummary3"><i class="fa fa-check"></i><b>9.4</b> Discussion/Summary/3</a></li>
<li class="chapter" data-level="9.5" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-references"><i class="fa fa-check"></i><b>9.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html"><i class="fa fa-check"></i><b>10</b> Split Plot Study Design</a>
<ul>
<li class="chapter" data-level="10.1" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#mean-square-rt"><i class="fa fa-check"></i><b>10.1</b> Mean Square R(T)</a></li>
<li class="chapter" data-level="10.2" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#SplitPlotChapter-references"><i class="fa fa-check"></i><b>10.2</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>REFERENCES</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The RJafroc Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="RocSampleSizeOR" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Sample size estimation for ROC studies OR method</h1>
<div id="RocSampleSizeOR-introduction" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Introduction</h2>
</div>
<div id="StatPower2" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Statistical Power</h2>
<p><span class="math display" id="eq:DefinitionStatPower1">\[\begin{equation}
Power = 1 - \beta
\tag{9.1}
\end{equation}\]</span></p>
<div id="sample-size-estimation-for-random-reader-random-cases" class="section level3" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Sample size estimation for random-reader random-cases</h3>
<p>For convenience the OR model is repeated below with the case-set index suppressed:</p>
<p><span class="math display" id="eq:ORModelSsOR">\[\begin{equation}
Y_{n(ijk)}=\mu+\tau_i+R_j+C_k+(\tau R)_{ij}+(\tau C)_{ik}+(RC)_{jk}+(\tau RC)_{ijk}+\epsilon_ {n(ijk)}
\tag{9.2}
\end{equation}\]</span></p>
<p>As usual, the treatment effects <span class="math inline">\(\tau_i\)</span> are subject to the constraint that they sum to zero. The observed effect size (a random variable) is defined by:</p>
<p><span class="math display" id="eq:EffectSize1">\[\begin{equation}
d=\theta_{1\bullet}-\theta_{2\bullet}
\tag{9.3}
\end{equation}\]</span></p>
<p>It is a realization of a random variable, so one has some leeway in the choice of anticipated effect size. In the significance-testing procedure described in TBA Chapter 09 interest was in the distribution of the F-statistic when the NH is true. For sample size estimation, one needs to know the distribution of the statistic when the NH is false. It was shown that then the observed F-statistic TBA Eqn. (9.35) is distributed as a non-central F-distribution <span class="math inline">\(F_{ndf,ddf,\Delta}\)</span> with non-centrality parameter <span class="math inline">\(\Delta\)</span>:</p>
<p><span class="math display" id="eq:FDBMSampling1">\[\begin{equation}
F_{DBM|AH} \sim F_{ndf,ddf,\Delta}
\tag{9.4}
\end{equation}\]</span></p>
<p>The non-centrality parameter was defined, Eqn. TBA (9.34), by:</p>
<p><span class="math display" id="eq:DefDelta1">\[\begin{equation}
\Delta=\frac{JK\sigma_{Y;\tau}^2}{\left ( \sigma_{Y;\epsilon}^2 + \sigma_{Y;\tau RC}^2 \right )+K\sigma_{Y;\tau R}^2+J\sigma_{Y;\tau C}^2}
\tag{9.5}
\end{equation}\]</span></p>
<p>To minimize confusion, this equation has been rewritten here using the subscript <span class="math inline">\(Y\)</span> to explicitly denote pseudo-value derived quantities (in TBA Chapter 09 this subscript was suppressed.</p>
<p>The estimate of <span class="math inline">\(\sigma_{Y;\tau C}^2\)</span> can turn out to bee negative. To avoid a negative denominator, Hillis suggests the following modification:</p>
<p><span class="math display" id="eq:DefDeltaHillis1">\[\begin{equation}
\Delta=\frac{JK\sigma_{Y;\tau}^2}{\left ( \sigma_{Y;\epsilon}^2 + \sigma_{Y;\tau RC}^2 \right )+K\sigma_{Y;\tau R}^2+\max \left (J\sigma_{Y;\tau C}^2 ,0 \right )}
\tag{9.6}
\end{equation}\]</span></p>
<p>This expression depends on three variance components, <span class="math inline">\((\sigma_{Y;\epsilon}^2 + \sigma_{Y;\tau RC}^2)\)</span> - the two terms are inseparable - <span class="math inline">\(\sigma_{Y;\tau R}^2\)</span> and <span class="math inline">\(\sigma_{Y;\tau C}^2\)</span>. The <span class="math inline">\(ddf\)</span> term appearing in TBA Eqn. (11.4) was defined by TBA Eqn. (9.24) - this quantity does not change between NH and AH:</p>
<p><span class="math display" id="eq:ddfH1">\[\begin{equation}
ddf_H=\frac{\left [MSTR+\max(MSTR-MSTRC,0)  \right ]^2}{\frac{[MSTR]^2}{(I-1)(J-1)}}
\tag{9.7}
\end{equation}\]</span></p>
<p>The mean squares in this expression can be expressed in terms of the three variance-components appearing in TBA Eqn. (11.6). Hillis and Berbaum <span class="citation">(Hillis and Berbaum <a href="#ref-RN1476" role="doc-biblioref">2004</a>)</span> have derived these expression and they will not be repeated here (Eqn. 4 in the cited reference). RJafroc implements a function to calculate the mean squares, <code>UtilMeanSquares()</code>, which allows ddf to be calculated using Eqn. TBA (11.7). The sample size functions in this package need only the three variance-components (the formula for <span class="math inline">\(ddf_H\)</span> is implemented internally).</p>
<p>For two treatments, since the individual treatment effects must be the negatives of each other (because they sum to zero), it is easily shown that:</p>
<p><span class="math display" id="eq:sigma2Tau1">\[\begin{equation}
\sigma_{Y;\tau}^2=\frac{d^2}{2}
\tag{9.8}
\end{equation}\]</span></p>
</div>
<div id="RocSampleSizeOR-dependence-of-stats-power" class="section level3" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Dependence of statistical power on estimates of model parameters</h3>
<p>Examination of the expression for , Eqn. (11.5), shows that statistical power increases if:
* The numerator is large. This occurs if: (a) the anticipated effect-size <span class="math inline">\(d\)</span> is large. Since effect-size enters as the <em>square</em>, TBA Eqn. (11.8), it is has a particularly strong effect; (b) If <span class="math inline">\(J \times K\)</span> is large. Both of these results should be obvious, as a large effect size and a large sample size should result in increased probability of rejecting the NH.
* The denominator is small. The first term in the denominator is <span class="math inline">\(\left ( \sigma_{Y;\epsilon}^2 + \sigma_{Y;\tau RC}^2 \right )\)</span>. These two terms cannot be separated. This is the residual variability of the jackknife pseudovalues. It should make sense that the smaller the variability, the larger is the non-centrality parameter and the statistical power.
* The next term in the denominator is <span class="math inline">\(K\sigma_{Y;\tau R}^2\)</span>, the treatment-reader variance component multiplied by the total number of cases. The reader variance <span class="math inline">\(\sigma_{Y;R}^2\)</span> has no effect on statistical power, because it has an equal effect on both treatments and cancels out in the difference. Instead, it is the treatment-reader variance <span class="math inline">\(\sigma_{Y;R}^2\)</span> that contributes “noise” tending to confound the estimate of the effect-size.
* The variance components estimated by the ANOVA procedure are realizations of random variables and as such subject to noise (there actually exists a beast such as variance of a variance). The presence of the <span class="math inline">\(K\)</span> term, usually large, can amplify the effect of noise in the estimate of <span class="math inline">\(\sigma_{Y;R}^2\)</span>, making the sample size estimation procedure less accurate.
* The final term in the denominator is <span class="math inline">\(J\sigma_{Y;\tau C}^2\)</span>. The variance <span class="math inline">\(\sigma_{Y;C}^2\)</span> has no impact on statistical power, as it cancels out in the difference. The treatment-case variance component introduces “noise” into the estimate of the effect size, thereby decreasing power. Since it is multiplied by J, the number of readers, and typically <span class="math inline">\(J&lt;&lt;K\)</span>, the error amplification effect on accuracy of the sample size estimate is not as bad as with the treatment-reader variance component.
* Accuracy of sample size estimation, essentially estimating confidence intervals for statistical power, is addressed in <span class="citation">(Chakraborty <a href="#ref-RN2027" role="doc-biblioref">2010</a>)</span>.</p>
</div>
<div id="RocSampleSizeOR-RRRC-sample-size-estimation" class="section level3" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> Formulae for random-reader random-case (RRRC) sample size estimation</h3>
</div>
<div id="RocSampleSizeOR-sig-testing" class="section level3" number="9.2.4">
<h3><span class="header-section-number">9.2.4</span> Significance testing</h3>
</div>
<div id="RocSampleSizeOR-pvalue-ci" class="section level3" number="9.2.5">
<h3><span class="header-section-number">9.2.5</span> p-value and confidence interval</h3>
</div>
<div id="RocSampleSizeOR-CompareDBM2OR" class="section level3" number="9.2.6">
<h3><span class="header-section-number">9.2.6</span> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</h3>
<p>Having performed a pilot study and planning to perform a pivotal study, sample size estimation follows the following procedure, which assumes that both reader and case are treated as random factors. Different formulae, described later, apply when either reader or case is treated as a fixed factor.</p>
<ul>
<li>Perform OR analysis on the pilot data. This yields the observed effect size as well as estimates of all relevant variance components and mean squares appearing in TBA Eqn. (11.5) and Eqn. (11.7).</li>
<li>This is the difficult but critical part: make an educated guess regarding the effect-size, <span class="math inline">\(d\)</span>, that one is interested in “detecting” (i.e., hoping to reject the NH with probability <span class="math inline">\(1-\beta\)</span>). The author prefers the term “anticipated” effect-size to “true” effect-size (the latter implies knowledge of the true difference between the modalities which, as noted earlier, would obviate the need for a pivotal study).</li>
<li>Two scenarios are considered below. In the first scenario, the effect-size is assumed equal to that observed in the pilot study, i.e., <span class="math inline">\(d = d_{obs}\)</span>.</li>
<li>In the second, so-called “best-case” scenario, one assumes that the anticipate value of <span class="math inline">\(d\)</span> is the observed value plus two-sigma of the confidence interval, in the correct direction, of course, i.e., <span class="math inline">\(d=\left | d_{obs} \right |+2\sigma\)</span>. Here <span class="math inline">\(\sigma\)</span> is one-fourth the width of the 95% confidence interval for <span class="math inline">\(d_{obs}\)</span>. Anticipating more than <span class="math inline">\(2\sigma\)</span> greater than the observed effect-size would be overly optimistic. The width of the CI implies that chances are less than 2.5% that the anticipated value is at or beyond the overly optimistic value. These points will become clearer when example datasets are analyzed below.</li>
<li>Calculate statistical power using the distribution implied by Eqn. (11.4), to calculate the probability that a random value of the relevant F-statistic will exceed the critical value, as in §11.3.2.</li>
<li>If power is below the desired or “target” power, one tries successively larger value of <span class="math inline">\(J\)</span> and / or <span class="math inline">\(K\)</span> until the target power is reached.</li>
</ul>
</div>
</div>
<div id="RocSampleSizeOR-FRRC-sample-size-estimation" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Formulae for fixed-reader random-case (FRRC) sample size estimation</h2>
<p>It was shown in TBA §9.8.2 that for fixed-reader analysis the non-centrality parameter is defined by:</p>
<p><span class="math display" id="eq:DeltaFRRC1">\[\begin{equation}
\Delta=\frac{JK\sigma_{Y;\tau}^2}{\sigma_{Y;\epsilon}^2+\sigma_{Y;\tau RC}^2+J\sigma_{Y;\tau C}^2}
\tag{9.9}
\end{equation}\]</span></p>
<p>The sampling distribution of the F-statistic under the AH is:</p>
<p><span class="math display" id="eq:SamplingFFRRC1">\[\begin{equation}
F_{AH|R}\equiv \frac{MST}{MSTC}\sim F_{I-1,(I-1)(K-1),\Delta}
\tag{9.10}
\end{equation}\]</span></p>
<div id="RocSampleSizeOR-RRFC-sample-size-estimation" class="section level3" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Formulae for random-reader fixed-case (RRFC) sample size estimation</h3>
<p>It is shown in TBA §9.9 that for fixed-case analysis the non-centrality parameter is defined by:</p>
<p><span class="math display" id="eq:DeltaFRRFC1">\[\begin{equation}
\Delta=\frac{JK\sigma_{Y;\tau}^2}{\sigma_{Y;\epsilon}^2+\sigma_{Y;\tau RC}^2+K\sigma_{Y;\tau R}^2}
\tag{9.11}
\end{equation}\]</span></p>
<p>Under the AH, the test statistic is distributed as a non-central F-distribution as follows:</p>
<p><span class="math display" id="eq:SamplingFRRFC1">\[\begin{equation}
F_{AH|C}\equiv \frac{MST}{MSTR}\sim F_{I-1,(I-1)(J-1),\Delta}
\tag{9.12}
\end{equation}\]</span></p>
</div>
<div id="example-1" class="section level3" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Example 1</h3>
<p>In the first example the Van Dyke dataset is regarded as a pilot study. Two implementations are shown, a direct application of the relevant formulae, including usage of the mean squares, which in principle can be calculated from the three variance-components. This is then compared to the <code>RJafroc</code> implementation.</p>
<p>Shown first is the “open” implementation.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="RocSampleSizeOR.html#cb83-1"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>;<span class="kw">cat</span>(<span class="st">&quot;alpha = &quot;</span>, alpha, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb83-2"><a href="RocSampleSizeOR.html#cb83-2"></a><span class="co">#&gt; alpha =  0.05</span></span>
<span id="cb83-3"><a href="RocSampleSizeOR.html#cb83-3"></a>rocData &lt;-<span class="st"> </span>dataset02 <span class="co"># select Van Dyke dataset</span></span>
<span id="cb83-4"><a href="RocSampleSizeOR.html#cb83-4"></a>retDbm &lt;-<span class="st"> </span><span class="kw">StSignificanceTesting</span>(<span class="dt">dataset =</span> rocData, <span class="dt">FOM =</span> <span class="st">&quot;Wilcoxon&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;DBM&quot;</span>) </span>
<span id="cb83-5"><a href="RocSampleSizeOR.html#cb83-5"></a>varYTR &lt;-<span class="st"> </span>retDbm<span class="op">$</span>ANOVA<span class="op">$</span>VarCom[<span class="st">&quot;VarTR&quot;</span>,<span class="st">&quot;Estimates&quot;</span>]</span>
<span id="cb83-6"><a href="RocSampleSizeOR.html#cb83-6"></a>varYTC &lt;-<span class="st"> </span>retDbm<span class="op">$</span>ANOVA<span class="op">$</span>VarCom[<span class="st">&quot;VarTC&quot;</span>,<span class="st">&quot;Estimates&quot;</span>]</span>
<span id="cb83-7"><a href="RocSampleSizeOR.html#cb83-7"></a>varYEps &lt;-<span class="st"> </span>retDbm<span class="op">$</span>ANOVA<span class="op">$</span>VarCom[<span class="st">&quot;VarErr&quot;</span>,<span class="st">&quot;Estimates&quot;</span>]</span>
<span id="cb83-8"><a href="RocSampleSizeOR.html#cb83-8"></a>effectSize &lt;-<span class="st"> </span>retDbm<span class="op">$</span>FOMs<span class="op">$</span>trtMeanDiffs[<span class="st">&quot;trt0-trt1&quot;</span>,<span class="st">&quot;Estimate&quot;</span>]</span>
<span id="cb83-9"><a href="RocSampleSizeOR.html#cb83-9"></a><span class="kw">cat</span>(<span class="st">&quot;effect size = &quot;</span>, effectSize, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb83-10"><a href="RocSampleSizeOR.html#cb83-10"></a><span class="co">#&gt; effect size =  -0.043800322</span></span>
<span id="cb83-11"><a href="RocSampleSizeOR.html#cb83-11"></a></span>
<span id="cb83-12"><a href="RocSampleSizeOR.html#cb83-12"></a><span class="co">#RRRC</span></span>
<span id="cb83-13"><a href="RocSampleSizeOR.html#cb83-13"></a>J &lt;-<span class="st"> </span><span class="dv">10</span>; K &lt;-<span class="st"> </span><span class="dv">163</span></span>
<span id="cb83-14"><a href="RocSampleSizeOR.html#cb83-14"></a>ncp &lt;-<span class="st"> </span>(<span class="fl">0.5</span><span class="op">*</span>J<span class="op">*</span>K<span class="op">*</span>(effectSize)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(K<span class="op">*</span>varYTR<span class="op">+</span><span class="kw">max</span>(J<span class="op">*</span>varYTC,<span class="dv">0</span>)<span class="op">+</span>varYEps)</span>
<span id="cb83-15"><a href="RocSampleSizeOR.html#cb83-15"></a>MS &lt;-<span class="st"> </span><span class="kw">UtilMeanSquares</span>(rocData, <span class="dt">FOM =</span> <span class="st">&quot;Wilcoxon&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;DBM&quot;</span>)</span>
<span id="cb83-16"><a href="RocSampleSizeOR.html#cb83-16"></a>ddf &lt;-<span class="st"> </span>(MS<span class="op">$</span>msTR<span class="op">+</span><span class="kw">max</span>(MS<span class="op">$</span>msTC<span class="op">-</span>MS<span class="op">$</span>msTRC,<span class="dv">0</span>))<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(MS<span class="op">$</span>msTR<span class="op">^</span><span class="dv">2</span>)<span class="op">*</span>(J<span class="dv">-1</span>)</span>
<span id="cb83-17"><a href="RocSampleSizeOR.html#cb83-17"></a>FCrit &lt;-<span class="st"> </span><span class="kw">qf</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha, <span class="dv">1</span>, ddf)</span>
<span id="cb83-18"><a href="RocSampleSizeOR.html#cb83-18"></a>Power &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">pf</span>(FCrit, <span class="dv">1</span>, ddf, <span class="dt">ncp =</span> ncp)</span>
<span id="cb83-19"><a href="RocSampleSizeOR.html#cb83-19"></a><span class="kw">data.frame</span>(<span class="st">&quot;J&quot;</span>=<span class="st"> </span>J,  <span class="st">&quot;K&quot;</span> =<span class="st"> </span>K, <span class="st">&quot;FCrit&quot;</span> =<span class="st"> </span>FCrit, <span class="st">&quot;ddf&quot;</span> =<span class="st"> </span>ddf, <span class="st">&quot;ncp&quot;</span> =<span class="st"> </span>ncp, <span class="st">&quot;RRRCPower&quot;</span> =<span class="st"> </span>Power)</span>
<span id="cb83-20"><a href="RocSampleSizeOR.html#cb83-20"></a><span class="co">#&gt;    J   K     FCrit       ddf       ncp  RRRCPower</span></span>
<span id="cb83-21"><a href="RocSampleSizeOR.html#cb83-21"></a><span class="co">#&gt; 1 10 163 4.1270572 34.334268 8.1269825 0.79111255</span></span>
<span id="cb83-22"><a href="RocSampleSizeOR.html#cb83-22"></a></span>
<span id="cb83-23"><a href="RocSampleSizeOR.html#cb83-23"></a><span class="co">#FRRC</span></span>
<span id="cb83-24"><a href="RocSampleSizeOR.html#cb83-24"></a>J &lt;-<span class="st"> </span><span class="dv">10</span>; K &lt;-<span class="st"> </span><span class="dv">133</span></span>
<span id="cb83-25"><a href="RocSampleSizeOR.html#cb83-25"></a>ncp &lt;-<span class="st"> </span>(<span class="fl">0.5</span><span class="op">*</span>J<span class="op">*</span>K<span class="op">*</span>(effectSize)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(<span class="kw">max</span>(J<span class="op">*</span>varYTC,<span class="dv">0</span>)<span class="op">+</span>varYEps)</span>
<span id="cb83-26"><a href="RocSampleSizeOR.html#cb83-26"></a>ddf &lt;-<span class="st"> </span>(K<span class="dv">-1</span>)</span>
<span id="cb83-27"><a href="RocSampleSizeOR.html#cb83-27"></a>FCrit &lt;-<span class="st"> </span><span class="kw">qf</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha, <span class="dv">1</span>, ddf)</span>
<span id="cb83-28"><a href="RocSampleSizeOR.html#cb83-28"></a>Power &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">pf</span>(FCrit, <span class="dv">1</span>, ddf, <span class="dt">ncp =</span> ncp)</span>
<span id="cb83-29"><a href="RocSampleSizeOR.html#cb83-29"></a><span class="kw">data.frame</span>(<span class="st">&quot;J&quot;</span>=<span class="st"> </span>J,  <span class="st">&quot;K&quot;</span> =<span class="st"> </span>K, <span class="st">&quot;FCrit&quot;</span> =<span class="st"> </span>FCrit, <span class="st">&quot;ddf&quot;</span> =<span class="st"> </span>ddf, <span class="st">&quot;ncp&quot;</span> =<span class="st"> </span>ncp, <span class="st">&quot;RRRCPower&quot;</span> =<span class="st"> </span>Power)</span>
<span id="cb83-30"><a href="RocSampleSizeOR.html#cb83-30"></a><span class="co">#&gt;    J   K    FCrit ddf       ncp  RRRCPower</span></span>
<span id="cb83-31"><a href="RocSampleSizeOR.html#cb83-31"></a><span class="co">#&gt; 1 10 133 3.912875 132 7.9873835 0.80111671</span></span>
<span id="cb83-32"><a href="RocSampleSizeOR.html#cb83-32"></a></span>
<span id="cb83-33"><a href="RocSampleSizeOR.html#cb83-33"></a><span class="co">#RRFC</span></span>
<span id="cb83-34"><a href="RocSampleSizeOR.html#cb83-34"></a>J &lt;-<span class="st"> </span><span class="dv">10</span>; K &lt;-<span class="st"> </span><span class="dv">53</span></span>
<span id="cb83-35"><a href="RocSampleSizeOR.html#cb83-35"></a>ncp &lt;-<span class="st"> </span>(<span class="fl">0.5</span><span class="op">*</span>J<span class="op">*</span>K<span class="op">*</span>(effectSize)<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span>(K<span class="op">*</span>varYTR<span class="op">+</span>varYEps)</span>
<span id="cb83-36"><a href="RocSampleSizeOR.html#cb83-36"></a>ddf &lt;-<span class="st"> </span>(J<span class="dv">-1</span>)</span>
<span id="cb83-37"><a href="RocSampleSizeOR.html#cb83-37"></a>FCrit &lt;-<span class="st"> </span><span class="kw">qf</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha, <span class="dv">1</span>, ddf)</span>
<span id="cb83-38"><a href="RocSampleSizeOR.html#cb83-38"></a>Power &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">pf</span>(FCrit, <span class="dv">1</span>, ddf, <span class="dt">ncp =</span> ncp)</span>
<span id="cb83-39"><a href="RocSampleSizeOR.html#cb83-39"></a><span class="kw">data.frame</span>(<span class="st">&quot;J&quot;</span>=<span class="st"> </span>J,  <span class="st">&quot;K&quot;</span> =<span class="st"> </span>K, <span class="st">&quot;FCrit&quot;</span> =<span class="st"> </span>FCrit, <span class="st">&quot;ddf&quot;</span> =<span class="st"> </span>ddf, <span class="st">&quot;ncp&quot;</span> =<span class="st"> </span>ncp, <span class="st">&quot;RRRCPower&quot;</span> =<span class="st"> </span>Power)</span>
<span id="cb83-40"><a href="RocSampleSizeOR.html#cb83-40"></a><span class="co">#&gt;    J  K    FCrit ddf       ncp  RRRCPower</span></span>
<span id="cb83-41"><a href="RocSampleSizeOR.html#cb83-41"></a><span class="co">#&gt; 1 10 53 5.117355   9 10.048716 0.80496663</span></span></code></pre></div>
<p>For 10 readers, the numbers of cases needed for 80% power is largest (163) for RRRC and least for RRFC (53). For all three analyses, the expectation of 80% power is met - the numbers of cases and readers were chosen to achieve close to 80% statistical power. Intermediate quantities such as the critical value of the F-statistic, <code>ddf</code> and <code>ncp</code> are shown. The reader should confirm that the code does in fact implement the relevant formulae. Shown next is the <code>RJafroc</code> implementation. The relevant file is mainSsDbm.R, a listing of which follows:</p>
</div>
<div id="RocSampleSizeOR-FRRCAnalysis" class="section level3" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Fixed-reader random-case (FRRC) analysis</h3>
</div>
<div id="RocSampleSizeOR-RRFCAnalysis" class="section level3" number="9.3.4">
<h3><span class="header-section-number">9.3.4</span> Random-reader fixed-case (RRFC) analysis</h3>
</div>
<div id="RocSampleSizeOR-STMRAnalysis" class="section level3" number="9.3.5">
<h3><span class="header-section-number">9.3.5</span> Single-treatment multiple-reader analysis</h3>
</div>
</div>
<div id="discussionsummary3" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Discussion/Summary/3</h2>
</div>
<div id="RocSampleSizeOR-references" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> References</h2>

</div>
</div>
<h3>REFERENCES</h3>
<div id="refs" class="references">
<div id="ref-RN2027">
<p>Chakraborty, Dev Prasad. 2010. “Prediction Accuracy of a Sample-Size Estimation Method for ROC Studies.” Journal Article. <em>Academic Radiology</em> 17: 628–38. <a href="https://doi.org/10.1016/j.acra.2010.01.007">https://doi.org/10.1016/j.acra.2010.01.007</a>.</p>
</div>
<div id="ref-RN1476">
<p>Hillis, Stephen L., and K. S. Berbaum. 2004. “Power Estimation for the Dorfman-Berbaum-Metz Method.” Journal Article. <em>Acad. Radiol.</em> 11 (11): 1260–73. <a href="https://doi.org/10.1016/j.acra.2004.08.009">https://doi.org/10.1016/j.acra.2004.08.009</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="RocSampleSizeDBM.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="SplitPlotChapter.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["RJafrocBook.pdf", "RJafrocBook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
