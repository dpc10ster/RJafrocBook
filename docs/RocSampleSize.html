<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Sample size estimation for ROC studies | The RJafroc Book</title>
  <meta name="description" content="Extended RJafroc documentation." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Sample size estimation for ROC studies | The RJafroc Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Extended RJafroc documentation." />
  <meta name="github-repo" content="dpc10ster/RJafrocBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Sample size estimation for ROC studies | The RJafroc Book" />
  
  <meta name="twitter:description" content="Extended RJafroc documentation." />
  

<meta name="author" content="Dev P. Chakraborty, PhD" />


<meta name="date" content="2020-06-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ORHAnalysis.html"/>
<link rel="next" href="references-4.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RJafroc documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="a-note-on-the-online-distribution-mechanism-of-the-book.html"><a href="a-note-on-the-online-distribution-mechanism-of-the-book.html"><i class="fa fa-check"></i>A note on the online distribution mechanism of the book</a></li>
<li class="chapter" data-level="" data-path="contributing-to-this-book.html"><a href="contributing-to-this-book.html"><i class="fa fa-check"></i>Contributing to this book</a></li>
<li class="chapter" data-level="1" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html"><i class="fa fa-check"></i><b>1</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="1.1" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#hypothesis-testing-for-a-single-modality-single-reader-roc-study"><i class="fa fa-check"></i><b>1.2</b> Hypothesis testing for a single-modality single-reader ROC study</a></li>
<li class="chapter" data-level="1.3" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#type-i-errors"><i class="fa fa-check"></i><b>1.3</b> Type-I errors</a></li>
<li class="chapter" data-level="1.4" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#one-sided-vs.-two-sided-tests"><i class="fa fa-check"></i><b>1.4</b> One sided vs. two sided tests</a></li>
<li class="chapter" data-level="1.5" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#statistical-power"><i class="fa fa-check"></i><b>1.5</b> Statistical power</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#factors-affecting-statistical-power"><i class="fa fa-check"></i><b>1.5.1</b> Factors affecting statistical power</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#comments"><i class="fa fa-check"></i><b>1.6</b> Comments</a></li>
<li class="chapter" data-level="1.7" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#why-alpha-is-chosen-to-be-5"><i class="fa fa-check"></i><b>1.7</b> Why alpha is chosen to be 5%</a></li>
<li class="chapter" data-level="1.8" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#discussion"><i class="fa fa-check"></i><b>1.8</b> Discussion</a></li>
<li class="chapter" data-level="1.9" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#references"><i class="fa fa-check"></i><b>1.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html"><i class="fa fa-check"></i><b>2</b> Dorfman Berbaum Metz Hillis (DBMH) Analysis</a>
<ul>
<li class="chapter" data-level="2.1" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#historical-background"><i class="fa fa-check"></i><b>2.1.1</b> Historical background</a></li>
<li class="chapter" data-level="2.1.2" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#the-wagner-analogy"><i class="fa fa-check"></i><b>2.1.2</b> The Wagner analogy</a></li>
<li class="chapter" data-level="2.1.3" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#the-shortage-of-numbers-to-analyze-and-a-pivotal-breakthrough"><i class="fa fa-check"></i><b>2.1.3</b> The shortage of numbers to analyze and a pivotal breakthrough</a></li>
<li class="chapter" data-level="2.1.4" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#organization-of-the-chapter"><i class="fa fa-check"></i><b>2.1.4</b> Organization of the chapter</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#random-and-fixed-factors"><i class="fa fa-check"></i><b>2.2</b> Random and fixed factors</a></li>
<li class="chapter" data-level="2.3" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#reader-and-case-populations-and-data-correlations"><i class="fa fa-check"></i><b>2.3</b> Reader and case populations and data correlations</a></li>
<li class="chapter" data-level="2.4" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#three-types-of-analyses"><i class="fa fa-check"></i><b>2.4</b> Three types of analyses</a></li>
<li class="chapter" data-level="2.5" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#general-approach"><i class="fa fa-check"></i><b>2.5</b> General approach</a></li>
<li class="chapter" data-level="2.6" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#the-dorfman-berbaum-metz-dbm-method"><i class="fa fa-check"></i><b>2.6</b> The Dorfman-Berbaum-Metz (DBM) method</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#explanation-of-terms-in-the-model"><i class="fa fa-check"></i><b>2.6.1</b> Explanation of terms in the model</a></li>
<li class="chapter" data-level="2.6.2" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#meanings-of-variance-components-in-the-dbm-model-tba-this-section-can-be-improved"><i class="fa fa-check"></i><b>2.6.2</b> Meanings of variance components in the DBM model (TBA this section can be improved)</a></li>
<li class="chapter" data-level="2.6.3" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#definitions-of-mean-squares"><i class="fa fa-check"></i><b>2.6.3</b> Definitions of mean-squares</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#expected-values-of-mean-squares"><i class="fa fa-check"></i><b>2.7</b> Expected values of mean squares</a></li>
<li class="chapter" data-level="2.8" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#random-reader-random-case-rrrc-analysis"><i class="fa fa-check"></i><b>2.8</b> Random-reader random-case (RRRC) analysis</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#example-1-calculation-of-mean-squares"><i class="fa fa-check"></i><b>2.8.1</b> Example 1: Calculation of mean squares</a></li>
<li class="chapter" data-level="2.8.2" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#significance-testing"><i class="fa fa-check"></i><b>2.8.2</b> Significance testing</a></li>
<li class="chapter" data-level="2.8.3" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#the-satterthwaite-approximation"><i class="fa fa-check"></i><b>2.8.3</b> The Satterthwaite approximation</a></li>
<li class="chapter" data-level="2.8.4" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#decision-rules-p-value-and-confidence-intervals"><i class="fa fa-check"></i><b>2.8.4</b> Decision rules, p-value and confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#fixed-reader-random-case-frrc-analysis"><i class="fa fa-check"></i><b>2.9</b> Fixed-reader random-case (FRRC) analysis</a>
<ul>
<li class="chapter" data-level="2.9.1" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#single-reader-multiple-treatment-analysis"><i class="fa fa-check"></i><b>2.9.1</b> Single-reader multiple-treatment analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#random-reader-fixed-case-rrfc-analysis"><i class="fa fa-check"></i><b>2.10</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="2.11" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#dbmh-analysis-example-1-van-dyke-data"><i class="fa fa-check"></i><b>2.11</b> DBMH analysis: Example 1, Van Dyke Data</a></li>
<li class="chapter" data-level="2.12" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#dbmh-analysis-example-2-volumerad-data"><i class="fa fa-check"></i><b>2.12</b> DBMH analysis: Example 2, VolumeRad data</a></li>
<li class="chapter" data-level="2.13" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#validation-of-dbmh-analysis"><i class="fa fa-check"></i><b>2.13</b> Validation of DBMH analysis</a></li>
<li class="chapter" data-level="2.14" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#the-meaning-of-pseudovalues"><i class="fa fa-check"></i><b>2.14</b> The meaning of pseudovalues</a></li>
<li class="chapter" data-level="2.15" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#summary"><i class="fa fa-check"></i><b>2.15</b> Summary</a></li>
<li class="chapter" data-level="2.16" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#things-for-me-to-think-about"><i class="fa fa-check"></i><b>2.16</b> Things for me to think about</a>
<ul>
<li class="chapter" data-level="2.16.1" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#expected-values-of-mean-squares-1"><i class="fa fa-check"></i><b>2.16.1</b> Expected values of mean squares</a></li>
</ul></li>
<li class="chapter" data-level="2.17" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#references-1"><i class="fa fa-check"></i><b>2.17</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html"><i class="fa fa-check"></i><b>3</b> Obuchowski Rockette Hillis (ORH) Analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#OR1RMTModel"><i class="fa fa-check"></i><b>3.2</b> Single-reader multiple-treatment model</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#definitions-of-covariance-and-correlation"><i class="fa fa-check"></i><b>3.2.1</b> Definitions of covariance and correlation</a></li>
<li class="chapter" data-level="3.2.2" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#special-case-when-variables-have-equal-variances"><i class="fa fa-check"></i><b>3.2.2</b> Special case when variables have equal variances</a></li>
<li class="chapter" data-level="3.2.3" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#estimation-of-the-covariance-matrix"><i class="fa fa-check"></i><b>3.2.3</b> Estimation of the covariance matrix</a></li>
<li class="chapter" data-level="3.2.4" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#meaning-of-the-covariance-matrix-in-refeqexamplesigma"><i class="fa fa-check"></i><b>3.2.4</b> Meaning of the covariance matrix in @ref(eq:ExampleSigma)</a></li>
<li class="chapter" data-level="3.2.5" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#code-illustrating-the-covariance-matrix"><i class="fa fa-check"></i><b>3.2.5</b> Code illustrating the covariance matrix</a></li>
<li class="chapter" data-level="3.2.6" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#significance-testing-1"><i class="fa fa-check"></i><b>3.2.6</b> Significance testing</a></li>
<li class="chapter" data-level="3.2.7" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#p-value-and-confidence-interval-1"><i class="fa fa-check"></i><b>3.2.7</b> p-value and confidence interval</a></li>
<li class="chapter" data-level="3.2.8" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#comparing-dbm-to-obuchowski-and-rockette-for-single-reader-multiple-treatments"><i class="fa fa-check"></i><b>3.2.8</b> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#multiple-reader-multiple-treatment-orh-model"><i class="fa fa-check"></i><b>3.3</b> Multiple-reader multiple-treatment ORH model</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#StrCovMatrix"><i class="fa fa-check"></i><b>3.3.1</b> Structure of the covariance matrix</a></li>
<li class="chapter" data-level="3.3.2" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#physical-meanings-of-the-covariance-terms"><i class="fa fa-check"></i><b>3.3.2</b> Physical meanings of the covariance terms</a></li>
<li class="chapter" data-level="3.3.3" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#orh-random-reader-random-case-analysis"><i class="fa fa-check"></i><b>3.3.3</b> ORH random-reader random-case analysis</a></li>
<li class="chapter" data-level="3.3.4" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#fixed-reader-random-case-frrc-analysis-1"><i class="fa fa-check"></i><b>3.3.4</b> Fixed-reader random-case (FRRC) analysis</a></li>
<li class="chapter" data-level="3.3.5" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#random-reader-fixed-case-rrfc-analysis-1"><i class="fa fa-check"></i><b>3.3.5</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="3.3.6" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#single-treatment-multiple-reader-analysis"><i class="fa fa-check"></i><b>3.3.6</b> Single-treatment multiple-reader analysis</a></li>
<li class="chapter" data-level="3.3.7" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#connection-to-existing-literature"><i class="fa fa-check"></i><b>3.3.7</b> Connection to existing literature</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#discussionsummary"><i class="fa fa-check"></i><b>3.4</b> Discussion/Summary</a></li>
<li class="chapter" data-level="3.5" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#references-2"><i class="fa fa-check"></i><b>3.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="RocSampleSize.html"><a href="RocSampleSize.html"><i class="fa fa-check"></i><b>4</b> Sample size estimation for ROC studies</a>
<ul>
<li class="chapter" data-level="4.1" data-path="RocSampleSize.html"><a href="RocSampleSize.html#introduction-3"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="RocSampleSize.html"><a href="RocSampleSize.html#StatPower1"><i class="fa fa-check"></i><b>4.2</b> Statistical Power</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="RocSampleSize.html"><a href="RocSampleSize.html#sample-size-estimation-for-random-reader-random-cases"><i class="fa fa-check"></i><b>4.2.1</b> Sample size estimation for random-reader random-cases</a></li>
<li class="chapter" data-level="4.2.2" data-path="RocSampleSize.html"><a href="RocSampleSize.html#estimation-of-the-covariance-matrix-1"><i class="fa fa-check"></i><b>4.2.2</b> Estimation of the covariance matrix</a></li>
<li class="chapter" data-level="4.2.3" data-path="RocSampleSize.html"><a href="RocSampleSize.html#meaning-of-the-covariance-matrix-in-refeqexamplesigma-1"><i class="fa fa-check"></i><b>4.2.3</b> Meaning of the covariance matrix in @ref(eq:ExampleSigma)</a></li>
<li class="chapter" data-level="4.2.4" data-path="RocSampleSize.html"><a href="RocSampleSize.html#code-illustrating-the-covariance-matrix-1"><i class="fa fa-check"></i><b>4.2.4</b> Code illustrating the covariance matrix</a></li>
<li class="chapter" data-level="4.2.5" data-path="RocSampleSize.html"><a href="RocSampleSize.html#significance-testing-2"><i class="fa fa-check"></i><b>4.2.5</b> Significance testing</a></li>
<li class="chapter" data-level="4.2.6" data-path="RocSampleSize.html"><a href="RocSampleSize.html#p-value-and-confidence-interval-2"><i class="fa fa-check"></i><b>4.2.6</b> p-value and confidence interval</a></li>
<li class="chapter" data-level="4.2.7" data-path="RocSampleSize.html"><a href="RocSampleSize.html#comparing-dbm-to-obuchowski-and-rockette-for-single-reader-multiple-treatments-1"><i class="fa fa-check"></i><b>4.2.7</b> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="RocSampleSize.html"><a href="RocSampleSize.html#multiple-reader-multiple-treatment-orh-model-1"><i class="fa fa-check"></i><b>4.3</b> Multiple-reader multiple-treatment ORH model</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#StrCovMatrix"><i class="fa fa-check"></i><b>4.3.1</b> Structure of the covariance matrix</a></li>
<li class="chapter" data-level="4.3.2" data-path="RocSampleSize.html"><a href="RocSampleSize.html#physical-meanings-of-the-covariance-terms-1"><i class="fa fa-check"></i><b>4.3.2</b> Physical meanings of the covariance terms</a></li>
<li class="chapter" data-level="4.3.3" data-path="RocSampleSize.html"><a href="RocSampleSize.html#orh-random-reader-random-case-analysis-1"><i class="fa fa-check"></i><b>4.3.3</b> ORH random-reader random-case analysis</a></li>
<li class="chapter" data-level="4.3.4" data-path="RocSampleSize.html"><a href="RocSampleSize.html#fixed-reader-random-case-frrc-analysis-2"><i class="fa fa-check"></i><b>4.3.4</b> Fixed-reader random-case (FRRC) analysis</a></li>
<li class="chapter" data-level="4.3.5" data-path="RocSampleSize.html"><a href="RocSampleSize.html#random-reader-fixed-case-rrfc-analysis-2"><i class="fa fa-check"></i><b>4.3.5</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="4.3.6" data-path="RocSampleSize.html"><a href="RocSampleSize.html#single-treatment-multiple-reader-analysis-1"><i class="fa fa-check"></i><b>4.3.6</b> Single-treatment multiple-reader analysis</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="RocSampleSize.html"><a href="RocSampleSize.html#discussionsummary-1"><i class="fa fa-check"></i><b>4.4</b> Discussion/Summary</a></li>
<li class="chapter" data-level="4.5" data-path="RocSampleSize.html"><a href="RocSampleSize.html#references-3"><i class="fa fa-check"></i><b>4.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-4.html"><a href="references-4.html"><i class="fa fa-check"></i>REFERENCES</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The RJafroc Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="RocSampleSize" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Sample size estimation for ROC studies</h1>
<div id="introduction-3" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Introduction</h2>
<p>The question addressed in this chapter is “how many readers and cases”, usually abbreviated to “sample-size”, should one employ to conduct a “well-planned” ROC study. The reasons for the quotes around “well-planned” will shortly become clear. If cost were no concern, the reply would be: “as many readers and cases as one can get”. There are other causes affecting sample-size, e.g., the data collection paradigm and analysis, however, this chapter is restricted to the MRMC ROC data collection paradigm, with data analyzed by the DBMH or the ORH methods described in previous chapters. It turns out that provided one can specify conceptually valid effect-sizes between different paradigms (i.e., in the same “units”), the methods described in this chapter are extensible to other paradigms; see TBA Chapter 19 for sample size estimation for FROC studies. <em>For this reason it is important to understand the concepts of sample-size estimation in the simpler ROC context.</em></p>
<p>For simplicity and practicality, this chapter is restricted to analysis of two-treatment data (I = 2). The purpose of most imaging system assessment studies is to determine, for a given diagnostic task, whether radiologists perform better using a new treatment over the conventional treatment, and whether the difference is statistically significant. Therefore, the two-treatment case is the most common one encountered. While it is possible to extend the methods to more than two treatments, the extensions are not, in my opinion, clinically interesting.</p>
<p>Assume the figure of merit (FOM) <span class="math inline">\(\theta\)</span> is chosen to be the area AUC under the ROC curve (empirical or fitted is immaterial as far as the formulae are concerned; however, the choice will affect statistical power - the dependence has not been studied). The statistical analysis determines the significance level of the study, i.e., the probability or p-value for incorrectly rejecting the null hypothesis (NH) that the two <span class="math inline">\(\theta\)</span>s are equal: <span class="math inline">\(NH: \theta_1 = \theta_2\)</span>, where the subscripts refer to the two treatments. If the p-value is smaller than a pre-specified <span class="math inline">\(\alpha\)</span>, typically set at 5%, one rejects the NH and declares the treatments different at the <span class="math inline">\(\alpha\)</span> significance level. Statistical power is the probability of correctly rejecting the null hypothesis when the alternative hypothesis <span class="math inline">\(AH: \theta_1 \neq \theta_2\)</span> is true, (TBA Chapter 08).</p>
<p>The value of the <em>true</em> difference between the treatments, i.e., the <em>true effect-size</em> is, of course, unknown. If it were known, there would be no need to conduct the ROC study. One would simply adopt the treatment with the higher <span class="math inline">\(\theta\)</span>. Sample-size estimation involves making an educated guess regarding the true effect-size , called the <em>anticipated effect size</em>, and denoted by <span class="math inline">\(d\)</span>. To quote Harold Kundel <span class="citation">(ICRU <a href="#ref-RN1383" role="doc-biblioref">1996</a>)</span>: “any calculation of power amounts to specification of the anticipated effect-size”. Increasing the anticipated effect size will increase statistical power but may represent an unrealistic expectation of the true difference between the treatments, in the sense that it overestimates the ability of technology to achieve this much improvement. An unduly small might be clinically insignificant, besides requiring a very large sample-size to achieve sufficient statistical power.</p>
<p>Statistical power depends on the magnitude of <span class="math inline">\(d\)</span> divided by the standard deviation <span class="math inline">\(\sigma(d)\)</span> of <span class="math inline">\(d\)</span>, i.e. <span class="math inline">\(D=\frac{\left | d \right |}{\sigma (d)}\)</span>. The sign is relevant as it determines whether the project is worth pursuing at all (see §11.8.4). The ratio is termed <span class="citation">(Cohen <a href="#ref-cohen1988statistical" role="doc-biblioref">1988</a>)</span> Cohen’s D. When this signal-to-noise-ratio-like quantity is large, statistical power approaches 100%. Reader and case variability and data correlations determine <span class="math inline">\(\sigma(d)\)</span>. No matter how small the anticipated <span class="math inline">\(d\)</span>, as long as it is finite, then, using sufficient numbers of readers and cases <span class="math inline">\(\sigma(d)\)</span> can be made sufficiently small to achieve near 100% statistical power. Of course, a very small effect-size may not be clinically significant. There is a key difference between statistical significance and clinical significance. An effect-size in AUC units could be so small, e.g., 0.001, as to be clinically insignificant, but by employing a sufficiently large sample size one could design a study to detect this small and clinically meaningless difference with near unit probability, i.e., high statistical power.</p>
<p>What determines clinical significance? A small effect-size, e.g., 0.01 AUC units, could be clinically significant if it applies to a large population, where the small benefit in detection rate is amplified by the number of patients benefiting from the new treatment. In contrast, for an “orphan” disease, i.e., one with very low prevalence, an effect-size of 0.05 might not be enough to justify the additional cost of the new treatment. The improvement might have to be 0.1 before it is worth it for a new treatment to be brought to market. One hates to monetize life and death issues, but there is no getting away from it, as cost/benefit issues determine clinical significance. The arbiters of clinical significance are engineers, imaging scientists, clinicians, epidemiologists, insurance companies and those who set government health care policies. The engineers and imaging scientists determine whether the effect-size the clinicians would like is feasible from technical and scientific viewpoints. The clinician determines, based on incidence of disease and other considerations, e.g., altruistic, malpractice, cost of the new device and insurance reimbursement, what effect-size is justifiable. Cohen has suggested that d values of 0.2, 0.5, and 0.8 be considered small, medium, and large, respectively, but he has also argued against their indiscriminate usage. However, after a study is completed, clinicians often find that an effect-size that biostatisticians label as small may, in certain circumstances, be clinically significant and an effect-size that they label as large may in other circumstances be clinically insignificant. Clearly, this is a complex issue. Some suggestions on choosing a clinically significant effect size are made in (TBA §11.12).</p>
<p>Having developed a new imaging modality the R&amp;D team wishes to compare it to the existing standard with the short-term goal of making a submission to the FDA to allow them to perform pre-market testing of the device. The long-term goal is to commercialize the device. Assume the R&amp;D team has optimized the device based on physical measurements, (TBA Chapter 01), perhaps supplemented with anecdotal feedback from clinicians based on a few images. Needed at this point is a pilot study. A pilot study, conducted with a relatively small and practical sample size, is intended to provide estimates of different sources of variability and correlations. It also provides an initial estimate of the effect-size, termed the <em>observed effect-size</em>, <span class="math inline">\(d\)</span>. Based on results from the pilot the sample-size tools described in this chapter permit estimation of the numbers of readers and cases that will reduce <span class="math inline">\(\sigma(d)\)</span> sufficiently to achieve the desired power for the larger “pivotal” study. [A distinction could be made in the notation between observed and anticipated effect sizes, but it will be clear from the context. Later, it will be shown how one can make an educated guess about the anticipated effect size from an observed effect size.]</p>
<p>This chapter is concerned with multiple-reader MRMC studies that follow the fully crossed factorial design meaning that each reader interprets a common case-set in all treatments. Since the resulting pairings (i.e., correlations) tend to decrease <span class="math inline">\(\sigma(d)\)</span> (since the variations occur in tandem, they tend to cancel out in the difference, see (TBA Chapter 09, Introduction), for Dr. Robert Wagner’s sailboat analogy) it yields more statistical power compared to an unpaired design, and consequently this design is frequently used. Two sample-size estimation procedures for MRMC are the Hillis-Berbaum method <span class="citation">(Hillis and Berbaum <a href="#ref-RN1476" role="doc-biblioref">2004</a>)</span> and the Obuchowski-Rockette <span class="citation">(Obuchowski <a href="#ref-RN1971" role="doc-biblioref">1998</a>)</span> method. With recent work by Hillis, the two methods have been shown to be substantially equivalent.</p>
<p>This chapter will focus on the DBMH approach. Since it is based on a standard ANOVA model, it is easier to extend the NH testing procedure described in Chapter 09 to the alternative hypothesis, which is relevant for sample size estimation. [TBA Online Appendix 11.A shows how to translate the DBMH formulae to the ORH method <span class="citation">(Hillis, Obuchowski, and Berbaum <a href="#ref-RN2137" role="doc-biblioref">2011</a>)</span>.]</p>
<p>Given an effect-size, and choosing this wisely is the most difficult part of the process, the method described in this chapter uses pseudovalue variance components estimated by the DBMH method to predict sample-sizes (i.e., different combinations of numbers of readers and cases) necessary to achieve a desired power.</p>
</div>
<div id="StatPower1" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Statistical Power</h2>
<p>The concept of statistical power was introduced in [TBA Chapter 08] but it is worth repeating. There are two possible decisions following a test of a null hypothesis (NH): reject or fail to reject the NH. Each decision is associated with a probability on an erroneous conclusion. If the NH is true and one rejects it, the probability of the ensuing Type-I error is <span class="math inline">\(\alpha\)</span>. If the NH is false and one fails to reject it, the probability of the ensuing Type II- error is <span class="math inline">\(\beta\)</span>. Statistical power is the complement of <span class="math inline">\(\beta\)</span>, i.e.,</p>
<p><span class="math display" id="eq:DefinitionStatPower">\[\begin{equation}
Power = 1 - \beta
\tag{4.1}
\end{equation}\]</span></p>
<p>Thus, statistical power is defined as the probability of (correctly) rejecting the null hypothesis when the null hypothesis is false. Typically, one aims for <span class="math inline">\(\beta = 0.2\)</span> or less, i.e., a statistical power of 80% or more. Again, like <span class="math inline">\(\alpha\)</span> = 0.05, this is a convention, and more nuanced cost-benefit considerations may cause the researcher to adopt a different value in the study design.</p>
<div id="sample-size-estimation-for-random-reader-random-cases" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Sample size estimation for random-reader random-cases</h3>
</div>
<div id="estimation-of-the-covariance-matrix-1" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Estimation of the covariance matrix</h3>
</div>
<div id="meaning-of-the-covariance-matrix-in-refeqexamplesigma-1" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Meaning of the covariance matrix in <a href="ORHAnalysis.html#eq:ExampleSigma">(3.5)</a></h3>
</div>
<div id="code-illustrating-the-covariance-matrix-1" class="section level3" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Code illustrating the covariance matrix</h3>
</div>
<div id="significance-testing-2" class="section level3" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Significance testing</h3>
</div>
<div id="p-value-and-confidence-interval-2" class="section level3" number="4.2.6">
<h3><span class="header-section-number">4.2.6</span> p-value and confidence interval</h3>
</div>
<div id="comparing-dbm-to-obuchowski-and-rockette-for-single-reader-multiple-treatments-1" class="section level3" number="4.2.7">
<h3><span class="header-section-number">4.2.7</span> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</h3>
</div>
</div>
<div id="multiple-reader-multiple-treatment-orh-model-1" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Multiple-reader multiple-treatment ORH model</h2>
<div id="StrCovMatrix" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Structure of the covariance matrix</h3>
</div>
<div id="physical-meanings-of-the-covariance-terms-1" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Physical meanings of the covariance terms</h3>
</div>
<div id="orh-random-reader-random-case-analysis-1" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> ORH random-reader random-case analysis</h3>
<div id="decision-rule-p-value-and-confidence-interval-1" class="section level4" number="4.3.3.1">
<h4><span class="header-section-number">4.3.3.1</span> Decision rule, p-value and confidence interval</h4>
</div>
</div>
<div id="fixed-reader-random-case-frrc-analysis-2" class="section level3" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Fixed-reader random-case (FRRC) analysis</h3>
</div>
<div id="random-reader-fixed-case-rrfc-analysis-2" class="section level3" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> Random-reader fixed-case (RRFC) analysis</h3>
</div>
<div id="single-treatment-multiple-reader-analysis-1" class="section level3" number="4.3.6">
<h3><span class="header-section-number">4.3.6</span> Single-treatment multiple-reader analysis</h3>
</div>
</div>
<div id="discussionsummary-1" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Discussion/Summary</h2>
</div>
<div id="references-3" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> References</h2>

</div>
</div>
<h3>REFERENCES</h3>
<div id="refs" class="references">
<div id="ref-cohen1988statistical">
<p>Cohen, Jacob. 1988. “Statistical Power Analysis for the Social Sciences. 1988.” <em>Google Scholar</em>.</p>
</div>
<div id="ref-RN1476">
<p>Hillis, Stephen L., and K. S. Berbaum. 2004. “Power Estimation for the Dorfman-Berbaum-Metz Method.” Journal Article. <em>Acad. Radiol.</em> 11 (11): 1260–73.</p>
</div>
<div id="ref-RN2137">
<p>Hillis, Stephen L., Nancy A. Obuchowski, and Kevin S. Berbaum. 2011. “Power Estimation for Multireader Roc Methods: An Updated and Unified Approach.” Journal Article. <em>Academic Radiology</em> 18 (2): 129–42. <a href="https://doi.org/DOI:%2010.1016/j.acra.2010.09.007">https://doi.org/DOI: 10.1016/j.acra.2010.09.007</a>.</p>
</div>
<div id="ref-RN1383">
<p>ICRU. 1996. “Medical Imaging: The Assessment of Image Quality.” Journal Article. <em>JOURNAL OF THE ICRU</em> 54 (1): 37–40.</p>
</div>
<div id="ref-RN1971">
<p>Obuchowski, Nancy A. 1998. “Sample Size Calculations in Studies of Test Accuracy.” Journal Article. <em>Statistical Methods in Medical Research</em> 7 (4): 371–92. <a href="https://doi.org/10.1177/096228029800700405">https://doi.org/10.1177/096228029800700405</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ORHAnalysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references-4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["RJafrocBook.pdf", "RJafrocBook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
