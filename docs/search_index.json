[
["rocdataformat.html", "Chapter 3 ROC data format 3.1 Introduction 3.2 An actual MRMC ROC dataset 3.3 The ROC Excel data file 3.4 Summary", " Chapter 3 ROC data format 3.1 Introduction In the receiver operating characteristic (ROC) paradigm (Metz 1978) the observer’s task is to rate (i.e., assign an ordered label representing the degree of suspicion) each case for confidence in presence of disease. The rating is frequently called a confidence level. The rating can be an integer or quasi- continuous (e.g., 0 – 100), or a floating point value, as long as higher numbers represent greater confidence in presence of one or more lesions in the case.1 For human observer studies a 6-point rating scale is recommended, collected via two questions (Chakraborty 2017): Is the case diseased? Binary response: Yes or No. What is your confidence in the preceding decisions? Three level response: Low, Medium or High. With algorithmic readers, e.g., computer aided detection algorithms a floating point rating, if possible, should be retained. In the most common study design, termed multiple-reader multiple-case (MRMC), the rating collection procedure is repeated for all cases, treatments and readers. 3.2 An actual MRMC ROC dataset An actual MRMC ROC dataset (Van Dyke et al. 1993) is included as dataset02. It has the following structure: str(dataset02) #&gt; List of 8 #&gt; $ NL : num [1:2, 1:5, 1:114, 1] 1 3 2 3 2 2 1 2 3 2 ... #&gt; $ LL : num [1:2, 1:5, 1:45, 1] 5 5 5 5 5 5 5 5 5 5 ... #&gt; $ lesionNum : int [1:45] 1 1 1 1 1 1 1 1 1 1 ... #&gt; $ lesionID : num [1:45, 1] 1 1 1 1 1 1 1 1 1 1 ... #&gt; $ lesionWeight: num [1:45, 1] 1 1 1 1 1 1 1 1 1 1 ... #&gt; $ dataType : chr &quot;ROC&quot; #&gt; $ modalityID : Named chr [1:2] &quot;0&quot; &quot;1&quot; #&gt; ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;0&quot; &quot;1&quot; #&gt; $ readerID : Named chr [1:5] &quot;0&quot; &quot;1&quot; &quot;2&quot; &quot;3&quot; ... #&gt; ..- attr(*, &quot;names&quot;)= chr [1:5] &quot;0&quot; &quot;1&quot; &quot;2&quot; &quot;3&quot; ... 3.2.1 Overview of the data structure The dataset structure is a list variable with 8 members.2 Ratings of non-diseased cases are stored in the NL list member. Ratings of diseased cases are stored in the LL list member. The lesionNum list member is an array of length 45, filled with ones. It lists the number of lesions per case, which for ROC data, is always unity. The length of this array equals the number of diseased cases K2, see below. The lesionID list member is a [45 x 1] array, also filled with ones.3 The LesionWeight list member is also a [45 x 1] array filled with ones. The dataType list member equals the string &quot;ROC&quot;, identifying it as an ROC dataset. The modalityID list member is a string array identifying the names of the treatments (see below). The readerID list member is a string array, identifying the names of the readers (see below). 3.2.2 Details of the modalityID and readerID list members The names of the treatments are in the modalityID list member: attributes(dataset02$modalityID) #&gt; $names #&gt; [1] &quot;0&quot; &quot;1&quot; For example, the name of the first treatment is &quot;0&quot;. The names can be longer strings, but use of very long string names may mess up the output formats of the analysis report. As per the KISS principle,4 keep the names short. The names of the readers are in the readerID array: attributes(dataset02$readerID) #&gt; $names #&gt; [1] &quot;0&quot; &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; For example, the name of the second reader is &quot;1&quot;. A similar caveat regarding long reader names applies. 3.2.3 Details of the NL and LL list members For either NL or LL list members, the fourth dimension has unit length. This dimension, which is strictly speaking unnecessary for ROC data, is retained for ease of generalizability to the FROC and ROC paradigms, where more than one rating per case is possible. dataset02 is a 2-treatment 5-reader dataset (the lengths of the first and second dimensions, respectively, of the NL and LL list members). 3.2.3.1 Numbers of non-diseased and diseased cases K &lt;- length(dataset02$NL[1,1,,1]) K2 &lt;- length(dataset02$LL[1,1,,1]) K1 &lt;- K - K2 K1 is the number of non-diseased cases, while K2 is the number of diseased cases. The third dimension of the NL array is the total number of all cases, i.e., K = 114, and the third dimension of the LL array, i.e., K2 = 45, is the total number of diseased cases. Subtracting the number of diseased cases from the number of all cases yields the number of non-diseased cases. Therefore, in this dataset, there are 45 diseased cases and 69 non-diseased cases. 3.2.3.2 Why dimension the NL array for the total number of cases? Again, this is for ease of generalizability to the FROC and ROI paradigms. 3.2.3.3 Ratings on a non-diseased case For ROC data a non-diseased case can have only one, and exactly one, NL rating. For treatment 1, reader 1 and case 1 (the first non-diseased case), the NL rating is &quot;1&quot;: dataset02$NL[1,1,1,1] #&gt; [1] 1 mean(dataset02$NL[,,1:K1,1]) #&gt; [1] 1.784058 This study utilized a 5-point rating scale, 1 thru 5, so non-diseased cases are expected to have low ratings; in this case the lowest rating was observed. The mean rating over all non-diseased cases, treatments and readers, is 1.784058. 3.2.3.4 Ratings on a diseased case For ROC data a diseased case can have only one, and exactly one, LL rating. For treatment 1, reader 1, case 1 (the first diseased case) the LL rating is: dataset02$LL[1,1,1,1] #&gt; [1] 5 mean(dataset02$LL) #&gt; [1] 4.297778 As noted previously, this study utilized a 5-point rating scale, 1 thru 5, so diseased cases are expected to have high ratings; in this case the highest rating was observed. The mean rating over all diseased cases, treatments and readers, is 4.2977778. 3.3 The ROC Excel data file An Excel file in JAFROC format containing ROC data corresponding to dataset02 is included with the RJafroc package. The first command (below) finds the location of the file and the second command reads it and saves it to a dataset object ds. fileName &lt;- system.file( &quot;extdata&quot;, &quot;includedRocData.xlsx&quot;, package = &quot;RJafroc&quot;, mustWork = TRUE) ds &lt;- DfReadDataFile(fileName) DfReadDataFile is short for Data File Function to Read a Data File. All data file related functions start with Df, and a similar organization applies to other functions. This makes it easier, in my opinion, to find a function in the R help system. To see the online help files, use the following command: help(&quot;RJafroc-package&quot;) Click the &quot;Show in new window&quot; button to see it full screen. This bit of experiential advice applies, of course, to all help files. 3.3.1 The ROC Excel file organization It contains three worksheets, Truth, TP and FP. The Truth worksheet defines the ground-truth of each case. It indicates which cases are diseased and which are non-diseased. The FP worksheet lists the ratings of non-diseased cases. The TP worksheet lists the ratings of diseased cases.5 3.3.1.1 The Truth worksheet organization The CaseID column lists the numeric labels identifying each case. Again, string names are possible, but keep them short. A 1 in the LesionID column denotes a diseased case. A 0 in the LesionID column denotes a non-diseased case. The Weight column is irrelevant for ROC data.6 The contents of the Truth worksheet corresponding to dataset02 are displayed next: There are 69 non-diseased cases (labeled 1-69) under column CaseID. There are 45 diseased cases (labeled 70-114) under column CaseID. The LesionID field for each non-diseased case (e.g., CaseID = 1) is zero. A zero in this field defines a non-diseased case. The LesionID field for each diseased case (e.g., CaseID = 70) is unity. A unit value in this field defines a diseased case. The Weights field is irrelevant for ROC datasets. For convenience it is filled with zeroes. 3.3.1.2 The FP/NL worksheet organization The following screen-shots show different parts of the FP worsheet for dataset02. The FP (or NL) worksheet lists the ratings of non-diseased cases. The ModalityID values range from 0 to 1, corresponding to two treatments. The ReaderID values range from 0 to 4, corresponding to five readers. The CaseID values range from 1 to 69, corresponding to non-diseased cases only. For each reader and treatment, each non-diseased case gets one rating; therefore the length of the column labeled FP-Rating is 69 x 2 x 5 = 690. The FP ratings tend to be low, there are a lot of ones, fewer twos, even fewer threes, and an ocassional four and a five rating may be found. 3.3.1.3 The TP/LL worksheet organization The following screen-shots show different parts of the FP worsheet for dataset02. * The TP (or LL) worksheet lists the ratings of diseased cases. * The ModalityID values range from 0 to 1, corresponding to two treatments. * The ReaderID values range from 0 to 4, corresponding to five readers. * The CaseID values range from 70 to 114, corresponding to diseased cases only. * For each reader and treatment, each non-diseased case gets one rating; therefore the length of the column labeled FP-Rating is 45 x 2 x 5 = 450. * The TP ratings tend to be high, there are a lot of fives, fewer fours, even fewer threes, and an ocassional two and a one rating may be found. 3.4 Summary Since each case gets one rating, the ROC data structure is relatively easy to visualize. For a single treatment and single reader, all of the information in the dataset can be summarize by a two-row five-column table, with one row listing the number of non-diseased cases rated 1, the number rated two, etc., ending with the number rated five, and a corresponding row for diseased cases. These 10 values contain all of the information contained in the Excel file for the specified treatment and reader. The example below is for treatment 0 and reader 0: nl &lt;- dataset02$NL binnedFpCounts &lt;- array(5) for (b in 1:5) binnedFpCounts[b] &lt;- sum(nl[1,1,1:K1,1] == b) ll &lt;- dataset02$LL binnedTpCounts &lt;- array(5) for (b in 1:5) binnedTpCounts[b] &lt;- sum(ll[1,1,1:K2,1] == b) binnedFpCounts #&gt; [1] 47 9 10 2 1 binnedTpCounts #&gt; [1] 4 1 2 10 28 sum(binnedFpCounts) #&gt; [1] 69 sum(binnedTpCounts) #&gt; [1] 45 The values in binnedFpCounts sum to 69. The values in binnedTpCounts sum to 45. A similar table is needed for each treatment-reader combination. The real value of the Excel format is that it allows generalization to other paradigms where the number of ratings per case is variable. References "]
]
