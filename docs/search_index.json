[
["ORExamples.html", "Chapter 7 Illustrations using the Obuchowski Rockette method 7.1 Introduction 7.2 Hand calculation using dataset02 7.3 Using RJafroc: dataset02 7.4 Using RJafroc: dataset04 7.5 Using RJafroc: dataset04, FROC analysis 7.6 Discussion/Summary/5 7.7 References", " Chapter 7 Illustrations using the Obuchowski Rockette method 7.1 Introduction Four examples are given. The first is a hand-calculation (i.e., from first principles, using the relevant formulae in the previous chapter). The next three examples use OR analysis as implemented in the RJafroc package. The first example uses a two-treatment five-reader ROC dataset, well-know in the literature (Van Dyke et al. 1993), as it has been used to illustrate advances in ROC methodology. The second example uses a five-treatment four-reader ROC dataset, showing the effect of multiple treatment pairings on the significance testing (the first dataset has only one treatment pairing). The third example uses a five-treatment four-reader FROC dataset, showing the key difference involved in FROC analysis. Each analysis involves the following steps: Calculate the figure of merit, Calculate the variance-covariance matrix and the mean-squares, and Calculate the NH statistic, p-value and confidence interval(s). Each analysis is illustrated with three generalizations, namely RRRC, FRRC and RRFC. 7.2 Hand calculation using dataset02 dataset02 has 2 modalities and 5 readers. I &lt;- length(dataset02$ratings$NL[,1,1,1]) J &lt;- length(dataset02$ratings$NL[1,,1,1]) modalityID &lt;- dataset02$descriptions$modalityID readerID &lt;- dataset02$descriptions$readerID The first step is to calculate the figures of merit. The following code uses UtilFigureOfMerit() to this end. Note that FOM is explicitly specified as “Wilcoxon”. foms &lt;- UtilFigureOfMerit(dataset02, FOM = &quot;Wilcoxon&quot;) print(foms) #&gt; rdr0 rdr1 rdr2 rdr3 rdr4 #&gt; trt0 0.9196457 0.8587762 0.9038647 0.9731079 0.8297907 #&gt; trt1 0.9478261 0.9053140 0.9217391 0.9993559 0.9299517 For example, for the first treatment, trt0, the second reader, rdr1, figure of merit is 0.8587762. The next step is to calculate the variance-covariance matrix and the mean-squares. The function UtilORVarComponentsFactorial() returns these quantities, which are saved to vc. The Factorial in the function name is due to the fact that this code applies to the factorial design. A different function is used for a split-plot design. Only the first two members of the returned object are displayed in full. The remaining members, vc$IndividualTrt and vc$IndividualRdr, are used in single-treatment and single-reader analyses. vc &lt;- UtilORVarComponentsFactorial( dataset02, FOM = &quot;Wilcoxon&quot;, covEstMethod = &quot;jackknife&quot;) summary(vc) #&gt; Length Class Mode #&gt; TRanova 3 data.frame list #&gt; VarCom 2 data.frame list #&gt; IndividualTrt 4 data.frame list #&gt; IndividualRdr 4 data.frame list print(vc$TRanova) #&gt; SS DF MS #&gt; T 0.004796171 1 0.0047961705 #&gt; R 0.015344800 4 0.0038362000 #&gt; TR 0.002204122 4 0.0005510306 print(vc$VarCom) #&gt; Estimates Rhos #&gt; VarR 0.0015349993 NA #&gt; VarTR 0.0002004025 NA #&gt; Cov1 0.0003466137 0.4320314 #&gt; Cov2 0.0003440748 0.4288668 #&gt; Cov3 0.0002390284 0.2979333 #&gt; Var 0.0008022883 NA 7.2.1 Random-Reader Random-Case (RRRC) analysis The next step is the calculate the NH testing statistic. The relevant equation is Eqn. (??). vc contains the values needed in this equation, as follows: MS(T) is contained in vc$TRanova[\"T\", \"MS\"], whose value is 0.0047962. MS(TR) is contained in vc$TRanova[\"TR\", \"MS\"], whose value is 5.5103062^{-4}. Cov2 is contained in vc$VarCom[\"Cov2\", \"Estimates\"], whose value is 3.4407483^{-4}. Cov3 is contained in vc$VarCom[\"Cov3\", \"Estimates\"], whose value is 2.3902837^{-4}. [Cov1, contained in vc$VarCom[\"Cov2\", \"Estimates\"] is not needed in the current calculation.] Applying Eqn. (??) one gets (den is the denominator on the right hand side of the referenced equation): den &lt;- vc$TRanova[&quot;TR&quot;, &quot;MS&quot;] + J* max(vc$VarCom[&quot;Cov2&quot;, &quot;Estimates&quot;] - vc$VarCom[&quot;Cov3&quot;, &quot;Estimates&quot;],0) F_ORH_RRRC &lt;- vc$TRanova[&quot;T&quot;, &quot;MS&quot;]/den print(F_ORH_RRRC) #&gt; [1] 4.456319 The numerator degrees of freedom is \\(I-1\\). The denominator degrees of freedom, ddf, is calculated using Eqn. (??)). The numerator of ddf is seen to be identical to den^2, where den was calculated in the preceding code block. The implementation follows: ddf &lt;- den^2*(I-1)*(J-1)/(vc$TRanova[&quot;TR&quot;, &quot;MS&quot;])^2 The value of ddf is 15.2596746. The next step is calculation of the p-value for rejecting the NH. The relevant equation is Eqn. (??) whose implementation follows: p_RRRC &lt;- 1 - pf(F_ORH_RRRC, I - 1, ddf) The p-value is 0.0516657. The difference is not significant at \\(\\alpha\\) = 0.05. The next step is calculation of the confidence interval for paired FOM differences. Since I = 2, their is only one paired difference in reader-averaged FOMs, namely, the first treatment minus the second: trtMeans &lt;- rowMeans(foms) trtMeanDiffs &lt;- trtMeans[1] - trtMeans[2] The difference in reader-averaged FOM,s i.e., \\(\\theta_{1 \\bullet} - \\theta_{2 \\bullet}\\), is -0.0438003. The \\((1-\\alpha)\\) confidence interval the difference is given by Eqn. (??). The expression inside the square-root symbol in this equation is 2/J*den. The implementation follows: alpha &lt;- 0.05 stdErr &lt;- sqrt(2 * den/J) t_crit &lt;- abs(qt(alpha/2, ddf)) CI_RRRC &lt;- c(trtMeanDiffs - t_crit*stdErr, trtMeanDiffs + t_crit*stdErr) names(CI_RRRC) &lt;- c(&quot;Lower&quot;, &quot;Upper&quot;) print(CI_RRRC) #&gt; Lower Upper #&gt; -0.0879594986 0.0003588544 The confidence interval includes zero, which confirms that the reader-averaged FOM difference between treatments is not significant. 7.2.2 Fixed-Reader Random-Case (FRRC) analysis The F-statistic for testing the NH of no treatment effect was stated in (??). The quantities needed to evaluate the right hand side are: MS(T), which is contained in vc$TRanova[“T”, “MS”]; Var, which is contained in vc$VarCom[“Var”, “Estimates”]; Cov1, which is contained in vc$VarCom[“Cov1”, “Estimates”]; Cov2, which is contained in vc$VarCom[“Cov2”, “Estimates”]; Cov3, which is contained in vc$VarCom[“Cov3”, “Estimates”]. The implementation follows: den &lt;- vc$VarCom[&quot;Var&quot;, &quot;Estimates&quot;] - vc$VarCom[&quot;Cov1&quot;, &quot;Estimates&quot;] + (J-1) * max(vc$VarCom[&quot;Cov2&quot;, &quot;Estimates&quot;]-vc$VarCom[&quot;Cov3&quot;, &quot;Estimates&quot;],0) F_ORH_FRRC &lt;- vc$TRanova[&quot;T&quot;, &quot;MS&quot;]/den print(F_ORH_FRRC) #&gt; [1] 5.475953 F_ORH_FRRC is distributed as an F-statistic with ndf = I-1 and ddf = infinity. F_ORH_FRRC times (I-1) is distributed as a chi-square-statistic with \\(I-1\\) degrees of freedom. The observed value of the chi-square statistic is 5.4759532. The p-value is calculated using (??), whose implementation follows: p_FRRC &lt;- 1 - pchisq(F_ORH_FRRC * (I - 1), I - 1) The p-value is 0.0192798, which is significant at \\(\\alpha\\) = 0.05. The confidence interval for the difference FOM is in Eqn. (??). Its implementation follows: stdErr &lt;- sqrt(2/J * (vc$VarCom[&quot;Var&quot;, &quot;Estimates&quot;] - vc$VarCom[&quot;Cov1&quot;, &quot;Estimates&quot;] + (J-1)*max(vc$VarCom[&quot;Cov2&quot;, &quot;Estimates&quot;]-vc$VarCom[&quot;Cov3&quot;, &quot;Estimates&quot;],0))) t_crit &lt;- abs(qt(alpha/2, Inf)) CI_FRRC &lt;- c(trtMeanDiffs - t_crit*stdErr, trtMeanDiffs + t_crit*stdErr) names(CI_FRRC) &lt;- c(&quot;Lower&quot;, &quot;Upper&quot;) print(CI_FRRC) #&gt; Lower Upper #&gt; -0.08048591 -0.00711473 Note that this time the confidence interval does not include zero, consistent with the p-value finding. One can calculate confidence intervals for each treatment, using data from that treatment only, Eqn. (??). The required Var_i and Cov2_i, calculated over each treatment, are in vc$IndividualTrt. The implementation follows. CI &lt;- array(dim = c(I,2)) ci &lt;- data.frame() for (i in 1:I) { stdErr &lt;- sqrt(1/J * (vc$IndividualTrt[i, &quot;varEachTrt&quot;] + (J-1)*max(vc$IndividualTrt[i, &quot;cov2EachTrt&quot;],0))) t_crit &lt;- abs(qt(alpha/2, Inf)) CI[i,] &lt;- c(trtMeans[i] - t_crit*stdErr, trtMeans[i] + t_crit*stdErr) rowName &lt;- paste0(&quot;trt&quot;, modalityID[i]) ci &lt;- rbind(ci, data.frame(Estimate = trtMeans[i], CILower = CI[i,1], CIUpper = CI[i,2], row.names = rowName, stringsAsFactors = FALSE)) } print(ci) #&gt; Estimate CILower CIUpper #&gt; trt0 0.8970370 0.8494301 0.9446440 #&gt; trt1 0.9408374 0.9079564 0.9737183 One can calculate confidence intervals for inter-treatment FOM differences for individual readers. The required Var_j and Cov1_j are in vc$IndividualRdr. The implementation follows. diffTRName &lt;- array(dim = choose(I, 2)) ii &lt;- 1 for (i in 1:I) { if (i == I) break for (ip in (i + 1):I) { diffTRName[ii] &lt;- paste0(&quot;trt&quot;, modalityID[i], sep = &quot;-&quot;, &quot;trt&quot;, modalityID[ip]) # !sic ii &lt;- ii + 1 } } trtMeanDiffs &lt;- array(dim = c(J, choose(I, 2))) Reader &lt;- array(dim = c(J, choose(I, 2))) stdErr &lt;- array(dim = c(J, choose(I, 2))) zStat &lt;- array(dim = c(J, choose(I, 2))) trDiffNames &lt;- array(dim = c(J, choose(I, 2))) PrGTz &lt;- array(dim = c(J, choose(I, 2))) CIReader &lt;- array(dim = c(J, choose(I, 2),2)) ci &lt;- data.frame() for (j in 1:J) { Reader[j,] &lt;- rep(readerID[j], choose(I, 2)) stdErr[j,] &lt;- sqrt(2 * (vc$IndividualRdr[j,&quot;varEachRdr&quot;] - vc$IndividualRdr[j,&quot;cov1EachRdr&quot;])) pair &lt;- 1 for (i in 1:I) { if (i == I) break for (ip in (i + 1):I) { trtMeanDiffs[j, pair] &lt;- foms[i, j] - foms[ip, j] trDiffNames[j,pair] &lt;- diffTRName[pair] zStat[j,pair] &lt;- trtMeanDiffs[j,pair]/stdErr[j,pair] PrGTz[j,pair] &lt;- 2 * pnorm(abs(zStat[j,pair]), lower.tail = FALSE) CIReader[j, pair,] &lt;- c(trtMeanDiffs[j,pair] + qnorm(alpha/2) * stdErr[j,pair], trtMeanDiffs[j,pair] + qnorm(1-alpha/2) * stdErr[j,pair]) rowName &lt;- paste0(&quot;rdr&quot;, Reader[j,pair], &quot;::&quot;, trDiffNames[j, pair]) ci &lt;- rbind(ci, data.frame(Estimate = trtMeanDiffs[j, pair], StdErr = stdErr[j,pair], z = zStat[j, pair], PrGTz = PrGTz[j, pair], CILower = CIReader[j, pair,1], CIUpper = CIReader[j, pair,2], row.names = rowName, stringsAsFactors = FALSE)) pair &lt;- pair + 1 } } } print(ci) #&gt; Estimate StdErr z PrGTz CILower #&gt; rdr0::trt0-trt1 -0.02818035 0.02551213 -1.1045864 0.26933885 -0.07818322 #&gt; rdr1::trt0-trt1 -0.04653784 0.02630183 -1.7693768 0.07683102 -0.09808848 #&gt; rdr2::trt0-trt1 -0.01787440 0.03120965 -0.5727202 0.56683414 -0.07904418 #&gt; rdr3::trt0-trt1 -0.02624799 0.01729129 -1.5179891 0.12901715 -0.06013829 #&gt; rdr4::trt0-trt1 -0.10016103 0.04405746 -2.2734182 0.02300099 -0.18651207 #&gt; CIUpper #&gt; rdr0::trt0-trt1 0.021822507 #&gt; rdr1::trt0-trt1 0.005012792 #&gt; rdr2::trt0-trt1 0.043295388 #&gt; rdr3::trt0-trt1 0.007642316 #&gt; rdr4::trt0-trt1 -0.013809995 7.2.3 Random-Reader Fixed-Case (RRFC) analysis TBA 7.3 Using RJafroc: dataset02 7.3.1 Random-Reader Random-Case (RRRC) analysis This is accomplished using the significance testing function StSignificanceTesting(). Since analysisOption is not explicitly specified in the following code, the function StSignificanceTesting performs all three analyses: RRRC, FRRC and RRFC. The significance level of the test, also an argument, alpha, defaults to 0.05. The code below applies this function and saves the returned object to st1. The first member of this object, a list object named FOMs, is then displayed. FOMs contains three data frames: FOMS$foms, the figures of merit for each treatment and reader, FOMS$trtMeans, the figures of merit for each treatment averaged over readers, and FOMS$trtMeanDiffs, the inter-treatment difference figures of merit averaged over readers. The difference is always the first treatment minus the second, etc., in this example, trt0 minus trt1. st1 &lt;- StSignificanceTesting(dataset02, FOM = &quot;Wilcoxon&quot;, method = &quot;OR&quot;) print(st1$FOMs) #&gt; $foms #&gt; rdr0 rdr1 rdr2 rdr3 rdr4 #&gt; trt0 0.91964573 0.85877617 0.90386473 0.97310789 0.82979066 #&gt; trt1 0.94782609 0.90531401 0.92173913 0.99935588 0.92995169 #&gt; #&gt; $trtMeans #&gt; Estimate #&gt; trt0 0.89703704 #&gt; trt1 0.94083736 #&gt; #&gt; $trtMeanDiffs #&gt; Estimate #&gt; trt0-trt1 -0.043800322 Displayed next are the variance components and mean-squares. These are contained in the ANOVA list object. ANOVA$TRanova contains the treatment-reader ANOVA table, i.e. the sum of squares, the degrees of freedom and the mean-squares, listed for the treatment, reader and treatment-reader factors, i.e., T, R and TR. ANOVA$VarCom contains the OR variance components and the correlations. ANOVA$IndividualTrt contains the quantities necessary for individual treatment analyses. ANOVA$IndividualRdr contains the quantities necessary for individual reader analyses. print(st1$ANOVA) #&gt; $TRanova #&gt; SS DF MS #&gt; T 0.0047961705 1 0.00479617053 #&gt; R 0.0153448000 4 0.00383619999 #&gt; TR 0.0022041225 4 0.00055103062 #&gt; #&gt; $VarCom #&gt; Estimates Rhos #&gt; VarR 0.00153499935 NA #&gt; VarTR 0.00020040252 NA #&gt; Cov1 0.00034661371 0.43203138 #&gt; Cov2 0.00034407483 0.42886683 #&gt; Cov3 0.00023902837 0.29793328 #&gt; Var 0.00080228827 NA #&gt; #&gt; $IndividualTrt #&gt; DF msREachTrt varEachTrt cov2EachTrt #&gt; trt0 4 0.0030826287 0.00101410277 0.00048396180 #&gt; trt1 4 0.0013046019 0.00059047376 0.00020418785 #&gt; #&gt; $IndividualRdr #&gt; DF msTEachRdr varEachRdr cov1EachRdr #&gt; rdr0 1 0.00039706618 0.00069890056 3.7346610e-04 #&gt; rdr1 1 0.00108288538 0.00110605283 7.6015978e-04 #&gt; rdr2 1 0.00015974702 0.00084234345 3.5532241e-04 #&gt; rdr3 1 0.00034447841 0.00015057773 1.0833995e-06 #&gt; rdr4 1 0.00501611603 0.00121356676 2.4303685e-04 Displayed next are the results of RRRC analysis, contained in the RRRC list object. RRRC$FTests contains the results of the F-tests. RRRC$ciDiffTrt contains the results of the confidence intervals for the inter-treatment difference FOMs, averaged over readers. RRRC$ciAvgRdrEachTrt contains the results of the confidence intervals for the treatments, averaged over readers. print(st1$RRRC$FTests) #&gt; DF MS FStat p #&gt; Treatment 1.000000 0.0047961705 4.4563187 0.051665686 #&gt; Error 15.259675 0.0010762629 NA NA TBA print(st1$RRRC$ciDiffTrt[,-c(2:5)]) #&gt; Estimate CILower CIUpper #&gt; trt0-trt1 -0.043800322 -0.087959499 0.00035885444 TBA print(st1$RRRC$ciAvgRdrEachTrt[,-c(2,3,6)]) #&gt; Estimate CILower CIUpper #&gt; trt0 0.89703704 0.82522360 0.96885048 #&gt; trt1 0.94083736 0.89413783 0.98753689 TBA 7.3.2 Fixed-Reader Random-Case (FRRC) analysis TBA print(st1$FRRC$FTests) #&gt; MS Chisq DF p #&gt; Treatment 0.00479617053 5.4759532 1 0.019279843 #&gt; Error 0.00087586039 NA NA NA TBA print(st1$FRRC$ciDiffTrt[,-c(2:4)]) #&gt; Estimate CILower CIUpper #&gt; trt0-trt1 -0.043800322 -0.080485914 -0.0071147303 TBA print(st1$FRRC$ciAvgRdrEachTrt[,-c(2,3,5)]) #&gt; Estimate CILower #&gt; trt0 0.89703704 0.84943008 #&gt; trt1 0.94083736 0.90795637 7.3.3 Random-Reader Fixed-Case (RRFC) analysis print(st1$RRFC$FTests) #&gt; DF MS F p #&gt; T 1 0.00479617053 8.704 0.041958752 #&gt; TR 4 0.00055103062 NA NA TBA print(st1$RRFC$ciDiffTrt[,-c(2,3,4,5)]) #&gt; Estimate CILower CIUpper #&gt; trt0-trt1 -0.043800322 -0.085020224 -0.0025804202 7.4 Using RJafroc: dataset04 The second example uses the Federica Zanca dataset (Zanca et al. 2009), i.e., dataset04, which has five modalities and four readers. This illustrates the situation when multiple treatment pairings are involved. In contrast, the previous example had only one treatment pairing. Since this is an FROC dataset, in order to keep this comparable with the previous example, one converts it to an inferred-ROC dataset. The function DfFroc2Roc(dataset04) converts, using the highest-rating, the FROC dataset to an inferred-ROC dataset. The results are contained in the returned list object st2. ds &lt;- DfFroc2Roc(dataset04) # convert to ROC I &lt;- length(ds$ratings$NL[,1,1,1]) J &lt;- length(ds$ratings$NL[1,,1,1]) cat(&quot;I = &quot;, I, &quot;, J = &quot;, J, &quot;\\n&quot;) #&gt; I = 5 , J = 4 st2 &lt;- StSignificanceTesting(ds, FOM = &quot;Wilcoxon&quot;, method = &quot;OR&quot;) print(st2$FOMs) #&gt; $foms #&gt; rdr1 rdr2 rdr3 rdr4 #&gt; trt1 0.90425 0.79820 0.81175 0.86645 #&gt; trt2 0.86425 0.84470 0.82050 0.87160 #&gt; trt3 0.81295 0.81635 0.75275 0.85730 #&gt; trt4 0.90235 0.83150 0.78865 0.87980 #&gt; trt5 0.84140 0.77300 0.77115 0.84800 #&gt; #&gt; $trtMeans #&gt; Estimate #&gt; trt1 0.8451625 #&gt; trt2 0.8502625 #&gt; trt3 0.8098375 #&gt; trt4 0.8505750 #&gt; trt5 0.8083875 #&gt; #&gt; $trtMeanDiffs #&gt; Estimate #&gt; trt1-trt2 -0.0051000 #&gt; trt1-trt3 0.0353250 #&gt; trt1-trt4 -0.0054125 #&gt; trt1-trt5 0.0367750 #&gt; trt2-trt3 0.0404250 #&gt; trt2-trt4 -0.0003125 #&gt; trt2-trt5 0.0418750 #&gt; trt3-trt4 -0.0407375 #&gt; trt3-trt5 0.0014500 #&gt; trt4-trt5 0.0421875 print(st2$ANOVA$TRanova) #&gt; SS DF MS #&gt; T 0.0075878295 4 0.00189695737 #&gt; R 0.0218825325 3 0.00729417750 #&gt; TR 0.0055464825 12 0.00046220687 print(st2$ANOVA$VarCom) #&gt; Estimates Rhos #&gt; VarR 1.2837211e-03 NA #&gt; VarTR -1.0925227e-05 NA #&gt; Cov1 2.9480096e-04 0.37358228 #&gt; Cov2 2.3331406e-04 0.29566389 #&gt; Cov3 2.1212789e-04 0.26881601 #&gt; Var 7.8911924e-04 NA 7.4.1 Random-Reader Random-Case (RRRC) analysis print(st2$RRRC$FTests) #&gt; DF MS FStat p #&gt; Treatment 4.000000 0.00189695737 3.4682364 0.030544556 #&gt; Error 16.803749 0.00054695157 NA NA TBA print(st2$RRRC$ciDiffTrt[,-c(2:5)]) #&gt; Estimate CILower CIUpper #&gt; trt1-trt2 -0.0051000 -0.04002130451 0.0298213045 #&gt; trt1-trt3 0.0353250 0.00040369549 0.0702463045 #&gt; trt1-trt4 -0.0054125 -0.04033380451 0.0295088045 #&gt; trt1-trt5 0.0367750 0.00185369549 0.0716963045 #&gt; trt2-trt3 0.0404250 0.00550369549 0.0753463045 #&gt; trt2-trt4 -0.0003125 -0.03523380451 0.0346088045 #&gt; trt2-trt5 0.0418750 0.00695369549 0.0767963045 #&gt; trt3-trt4 -0.0407375 -0.07565880451 -0.0058161955 #&gt; trt3-trt5 0.0014500 -0.03347130451 0.0363713045 #&gt; trt4-trt5 0.0421875 0.00726619549 0.0771088045 TBA print(st2$RRRC$ciAvgRdrEachTrt[,-c(2,3,6)]) #&gt; Estimate CILower CIUpper #&gt; trt1 0.8451625 0.77351391 0.91681109 #&gt; trt2 0.8502625 0.80942311 0.89110189 #&gt; trt3 0.8098375 0.74689261 0.87278239 #&gt; trt4 0.8505750 0.77664342 0.92450658 #&gt; trt5 0.8083875 0.74706746 0.86970754 TBA 7.4.2 Fixed-Reader Random-Case (FRRC) analysis print(st2$FRRC$FTests) #&gt; MS Chisq DF p #&gt; Treatment 0.0018969574 13.601264 4 0.0086826618 #&gt; Error 0.0005578768 NA NA NA TBA print(st2$FRRC$ciDiffTrt[,-c(2:4)]) #&gt; Estimate CILower CIUpper #&gt; trt1-trt2 -0.0051000 -0.0378342386 0.0276342386 #&gt; trt1-trt3 0.0353250 0.0025907614 0.0680592386 #&gt; trt1-trt4 -0.0054125 -0.0381467386 0.0273217386 #&gt; trt1-trt5 0.0367750 0.0040407614 0.0695092386 #&gt; trt2-trt3 0.0404250 0.0076907614 0.0731592386 #&gt; trt2-trt4 -0.0003125 -0.0330467386 0.0324217386 #&gt; trt2-trt5 0.0418750 0.0091407614 0.0746092386 #&gt; trt3-trt4 -0.0407375 -0.0734717386 -0.0080032614 #&gt; trt3-trt5 0.0014500 -0.0312842386 0.0341842386 #&gt; trt4-trt5 0.0421875 0.0094532614 0.0749217386 TBA print(st2$FRRC$ciAvgRdrEachTrt[,-c(2,3,5)]) #&gt; Estimate CILower #&gt; trt1 0.8451625 0.80923466 #&gt; trt2 0.8502625 0.81167398 #&gt; trt3 0.8098375 0.77045178 #&gt; trt4 0.8505750 0.81406752 #&gt; trt5 0.8083875 0.76983500 TBA print(st2$FRRC$FTests) #&gt; MS Chisq DF p #&gt; Treatment 0.0018969574 13.601264 4 0.0086826618 #&gt; Error 0.0005578768 NA NA NA TBA 7.4.3 Random-Reader Fixed-Case (RRFC) analysis print(st2$RRFC$FTests) #&gt; DF MS F p #&gt; T 4 0.00189695737 4.1041306 0.025328308 #&gt; TR 12 0.00046220687 NA NA TBA print(st2$RRFC$ciDiffTrt[,-c(2,3,4,5)]) #&gt; Estimate CILower CIUpper #&gt; trt1-trt2 -0.0051000 -0.0382225014 0.0280225014 #&gt; trt1-trt3 0.0353250 0.0022024986 0.0684475014 #&gt; trt1-trt4 -0.0054125 -0.0385350014 0.0277100014 #&gt; trt1-trt5 0.0367750 0.0036524986 0.0698975014 #&gt; trt2-trt3 0.0404250 0.0073024986 0.0735475014 #&gt; trt2-trt4 -0.0003125 -0.0334350014 0.0328100014 #&gt; trt2-trt5 0.0418750 0.0087524986 0.0749975014 #&gt; trt3-trt4 -0.0407375 -0.0738600014 -0.0076149986 #&gt; trt3-trt5 0.0014500 -0.0316725014 0.0345725014 #&gt; trt4-trt5 0.0421875 0.0090649986 0.0753100014 7.5 Using RJafroc: dataset04, FROC analysis The third example uses dataset04, but this time we use the FROC data, i.e, we do not convert it to inferred-ROC. Since this is an FROC dataset, one needs to use an FROC figure of merit. In this example the weighted AFROC figure of merit FOM = \"wAFROC\" is specified. This is the recommended figure of merit when both normal and abnormal cases are present in the dataset. If the dataset does not contain normal cases, then the weighted AFROC1 figure of merit FOM = \"wAFROC1\" should be specified. ds1 &lt;- dataset04 # do NOT convert to ROC # comment/uncomment following code to disable/enable unequal weights # K2 &lt;- length(ds1$ratings$LL[1,1,,1]) # weights &lt;- array(dim = c(K2, max(ds1$lesions$perCase))) # perCase &lt;- ds1$lesions$perCase # for (k2 in 1:K2) { # sum &lt;- 0 # for (el in 1:perCase[k2]) { # weights[k2,el] &lt;- 1/el # sum &lt;- sum + 1/el # } # weights[k2,1:perCase[k2]] &lt;- weights[k2,1:perCase[k2]] / sum # } # ds1$lesions$weights &lt;- weights ds &lt;- ds1 FOM &lt;- &quot;wAFROC&quot; # also try wAFROC1, MaxLLF and MaxNLF st3 &lt;- StSignificanceTesting(ds, FOM = FOM, method = &quot;OR&quot;) print(st3$FOMs) #&gt; $foms #&gt; rdr1 rdr3 rdr4 rdr5 #&gt; trt1 0.77926667 0.72489167 0.70362500 0.80509167 #&gt; trt2 0.78700000 0.72690000 0.72261667 0.80378333 #&gt; trt3 0.72969167 0.71575833 0.67230833 0.77265833 #&gt; trt4 0.81013333 0.74311667 0.69435833 0.82940833 #&gt; trt5 0.74880000 0.68227500 0.65517500 0.77125000 #&gt; #&gt; $trtMeans #&gt; Estimate #&gt; trt1 0.75321875 #&gt; trt2 0.76007500 #&gt; trt3 0.72260417 #&gt; trt4 0.76925417 #&gt; trt5 0.71437500 #&gt; #&gt; $trtMeanDiffs #&gt; Estimate #&gt; trt1-trt2 -0.0068562500 #&gt; trt1-trt3 0.0306145833 #&gt; trt1-trt4 -0.0160354167 #&gt; trt1-trt5 0.0388437500 #&gt; trt2-trt3 0.0374708333 #&gt; trt2-trt4 -0.0091791667 #&gt; trt2-trt5 0.0457000000 #&gt; trt3-trt4 -0.0466500000 #&gt; trt3-trt5 0.0082291667 #&gt; trt4-trt5 0.0548791667 print(st3$ANOVA$TRanova) #&gt; SS DF MS #&gt; T 0.0092661660 4 0.00231654149 #&gt; R 0.0354043662 3 0.01180145539 #&gt; TR 0.0020352419 12 0.00016960349 print(st3$ANOVA$VarCom) #&gt; Estimates Rhos #&gt; VarR 0.00220864564 NA #&gt; VarTR -0.00030459978 NA #&gt; Cov1 0.00042203598 0.45473916 #&gt; Cov2 0.00033615564 0.36220403 #&gt; Cov3 0.00030431124 0.32789204 #&gt; Var 0.00092808365 NA 7.5.1 Random-Reader Random-Case (RRRC) analysis print(st3$RRRC$FTests) #&gt; DF MS FStat p #&gt; Treatment 4.000000 0.00231654149 7.8002997 0.000117105 #&gt; Error 36.793343 0.00029698109 NA NA TBA print(st3$RRRC$ciDiffTrt[,-c(2:5)]) #&gt; Estimate CILower CIUpper #&gt; trt1-trt2 -0.0068562500 -0.0315514439 0.0178389439 #&gt; trt1-trt3 0.0306145833 0.0059193894 0.0553097773 #&gt; trt1-trt4 -0.0160354167 -0.0407306106 0.0086597773 #&gt; trt1-trt5 0.0388437500 0.0141485561 0.0635389439 #&gt; trt2-trt3 0.0374708333 0.0127756394 0.0621660273 #&gt; trt2-trt4 -0.0091791667 -0.0338743606 0.0155160273 #&gt; trt2-trt5 0.0457000000 0.0210048061 0.0703951939 #&gt; trt3-trt4 -0.0466500000 -0.0713451939 -0.0219548061 #&gt; trt3-trt5 0.0082291667 -0.0164660273 0.0329243606 #&gt; trt4-trt5 0.0548791667 0.0301839727 0.0795743606 TBA print(st3$RRRC$ciAvgRdrEachTrt[,-c(2,3,6)]) #&gt; Estimate CILower CIUpper #&gt; trt1 0.75321875 0.68413193 0.82230557 #&gt; trt2 0.76007500 0.69727167 0.82287833 #&gt; trt3 0.72260417 0.66128414 0.78392420 #&gt; trt4 0.76925417 0.67869638 0.85981195 #&gt; trt5 0.71437500 0.63473415 0.79401585 TBA 7.5.2 Fixed-Reader Random-Case (FRRC) analysis print(st3$FRRC$FTests) #&gt; MS Chisq DF p #&gt; Treatment 0.00231654149 15.403026 4 0.0039343238 #&gt; Error 0.00060158087 NA NA NA TBA print(st3$FRRC$ciDiffTrt[,-c(2:4)]) #&gt; Estimate CILower CIUpper #&gt; trt1-trt2 -0.0068562500 -0.0408485147 0.027136015 #&gt; trt1-trt3 0.0306145833 -0.0033776814 0.064606848 #&gt; trt1-trt4 -0.0160354167 -0.0500276814 0.017956848 #&gt; trt1-trt5 0.0388437500 0.0048514853 0.072836015 #&gt; trt2-trt3 0.0374708333 0.0034785686 0.071463098 #&gt; trt2-trt4 -0.0091791667 -0.0431714314 0.024813098 #&gt; trt2-trt5 0.0457000000 0.0117077353 0.079692265 #&gt; trt3-trt4 -0.0466500000 -0.0806422647 -0.012657735 #&gt; trt3-trt5 0.0082291667 -0.0257630981 0.042221431 #&gt; trt4-trt5 0.0548791667 0.0208869019 0.088871431 TBA print(st3$FRRC$ciAvgRdrEachTrt[,-c(2,3,5)]) #&gt; Estimate CILower #&gt; trt1 0.75321875 0.71076166 #&gt; trt2 0.76007500 0.71538552 #&gt; trt3 0.72260417 0.68032336 #&gt; trt4 0.76925417 0.72777924 #&gt; trt5 0.71437500 0.66975007 TBA print(st3$FRRC$FTests) #&gt; MS Chisq DF p #&gt; Treatment 0.00231654149 15.403026 4 0.0039343238 #&gt; Error 0.00060158087 NA NA NA TBA 7.5.3 Random-Reader Fixed-Case (RRFC) analysis print(st3$RRFC$FTests) #&gt; DF MS F p #&gt; T 4 0.00231654149 13.658572 0.00020192224 #&gt; TR 12 0.00016960349 NA NA TBA print(st3$RRFC$ciDiffTrt[,-c(2,3,4,5)]) #&gt; Estimate CILower CIUpper #&gt; trt1-trt2 -0.0068562500 -0.026920472 0.0132079720 #&gt; trt1-trt3 0.0306145833 0.010550361 0.0506788053 #&gt; trt1-trt4 -0.0160354167 -0.036099639 0.0040288053 #&gt; trt1-trt5 0.0388437500 0.018779528 0.0589079720 #&gt; trt2-trt3 0.0374708333 0.017406611 0.0575350553 #&gt; trt2-trt4 -0.0091791667 -0.029243389 0.0108850553 #&gt; trt2-trt5 0.0457000000 0.025635778 0.0657642220 #&gt; trt3-trt4 -0.0466500000 -0.066714222 -0.0265857780 #&gt; trt3-trt5 0.0082291667 -0.011835055 0.0282933886 #&gt; trt4-trt5 0.0548791667 0.034814945 0.0749433886 7.6 Discussion/Summary/5 7.7 References References "]
]
