<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Obuchowski Rockette Hillis2 (ORH) Analysis | The RJafroc Book</title>
  <meta name="description" content="Extended RJafroc documentation." />
  <meta name="generator" content="bookdown 0.18.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Obuchowski Rockette Hillis2 (ORH) Analysis | The RJafroc Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Extended RJafroc documentation." />
  <meta name="github-repo" content="dpc10ster/RJafrocBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Obuchowski Rockette Hillis2 (ORH) Analysis | The RJafroc Book" />
  
  <meta name="twitter:description" content="Extended RJafroc documentation." />
  

<meta name="author" content="Dev P. Chakraborty, PhD" />


<meta name="date" content="2020-06-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="DBMHnalysis.html"/>
<link rel="next" href="references-3.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RJafroc documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="a-note-on-the-online-distribution-mechanism-of-the-book.html"><a href="a-note-on-the-online-distribution-mechanism-of-the-book.html"><i class="fa fa-check"></i>A note on the online distribution mechanism of the book</a></li>
<li class="chapter" data-level="" data-path="contributing-to-this-book.html"><a href="contributing-to-this-book.html"><i class="fa fa-check"></i>Contributing to this book</a></li>
<li class="chapter" data-level="1" data-path="example-running-external-scripts.html"><a href="example-running-external-scripts.html"><i class="fa fa-check"></i><b>1</b> Example running external scripts</a></li>
<li class="chapter" data-level="2" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html"><i class="fa fa-check"></i><b>2</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="2.1" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#hypothesis-testing-for-a-single-modality-single-reader-roc-study"><i class="fa fa-check"></i><b>2.2</b> Hypothesis testing for a single-modality single-reader ROC study</a></li>
<li class="chapter" data-level="2.3" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#type-i-errors"><i class="fa fa-check"></i><b>2.3</b> Type-I errors</a></li>
<li class="chapter" data-level="2.4" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#one-sided-vs.-two-sided-tests"><i class="fa fa-check"></i><b>2.4</b> One sided vs. two sided tests</a></li>
<li class="chapter" data-level="2.5" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#statistical-power"><i class="fa fa-check"></i><b>2.5</b> Statistical power</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#factors-affecting-statistical-power"><i class="fa fa-check"></i><b>2.5.1</b> Factors affecting statistical power</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#comments"><i class="fa fa-check"></i><b>2.6</b> Comments</a></li>
<li class="chapter" data-level="2.7" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#why-alpha-is-chosen-to-be-5"><i class="fa fa-check"></i><b>2.7</b> Why alpha is chosen to be 5%</a></li>
<li class="chapter" data-level="2.8" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#discussion"><i class="fa fa-check"></i><b>2.8</b> Discussion</a></li>
<li class="chapter" data-level="2.9" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#references"><i class="fa fa-check"></i><b>2.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html"><i class="fa fa-check"></i><b>3</b> Dorfman Berbaum Metz Hillis (DBMH) Analysis</a>
<ul>
<li class="chapter" data-level="3.1" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#historical-background"><i class="fa fa-check"></i><b>3.1.1</b> Historical background</a></li>
<li class="chapter" data-level="3.1.2" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#the-wagner-analogy"><i class="fa fa-check"></i><b>3.1.2</b> The Wagner analogy</a></li>
<li class="chapter" data-level="3.1.3" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#the-shortage-of-numbers-to-analyze-and-a-pivotal-breakthrough"><i class="fa fa-check"></i><b>3.1.3</b> The shortage of numbers to analyze and a pivotal breakthrough</a></li>
<li class="chapter" data-level="3.1.4" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#organization-of-the-chapter"><i class="fa fa-check"></i><b>3.1.4</b> Organization of the chapter</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#random-and-fixed-factors"><i class="fa fa-check"></i><b>3.2</b> Random and fixed factors</a></li>
<li class="chapter" data-level="3.3" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#reader-and-case-populations-and-data-correlations"><i class="fa fa-check"></i><b>3.3</b> Reader and case populations and data correlations</a></li>
<li class="chapter" data-level="3.4" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#three-types-of-analyses"><i class="fa fa-check"></i><b>3.4</b> Three types of analyses</a></li>
<li class="chapter" data-level="3.5" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#general-approach"><i class="fa fa-check"></i><b>3.5</b> General approach</a></li>
<li class="chapter" data-level="3.6" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#the-dorfman-berbaum-metz-dbm-method"><i class="fa fa-check"></i><b>3.6</b> The Dorfman-Berbaum-Metz (DBM) method</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#explanation-of-terms-in-the-model"><i class="fa fa-check"></i><b>3.6.1</b> Explanation of terms in the model</a></li>
<li class="chapter" data-level="3.6.2" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#meanings-of-variance-components-in-the-dbm-model-tba-this-section-can-be-improved"><i class="fa fa-check"></i><b>3.6.2</b> Meanings of variance components in the DBM model (TBA this section can be improved)</a></li>
<li class="chapter" data-level="3.6.3" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#definitions-of-mean-squares"><i class="fa fa-check"></i><b>3.6.3</b> Definitions of mean-squares</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#expected-values-of-mean-squares"><i class="fa fa-check"></i><b>3.7</b> Expected values of mean squares</a></li>
<li class="chapter" data-level="3.8" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#random-reader-random-case-rrrc-analysis"><i class="fa fa-check"></i><b>3.8</b> Random-reader random-case (RRRC) analysis</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#example-1-calculation-of-mean-squares"><i class="fa fa-check"></i><b>3.8.1</b> Example 1: Calculation of mean squares</a></li>
<li class="chapter" data-level="3.8.2" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#significance-testing"><i class="fa fa-check"></i><b>3.8.2</b> Significance testing</a></li>
<li class="chapter" data-level="3.8.3" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#the-satterthwaite-approximation"><i class="fa fa-check"></i><b>3.8.3</b> The Satterthwaite approximation</a></li>
<li class="chapter" data-level="3.8.4" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#decision-rules-p-value-and-confidence-intervals"><i class="fa fa-check"></i><b>3.8.4</b> Decision rules, p-value and confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#fixed-reader-random-case-frrc-analysis"><i class="fa fa-check"></i><b>3.9</b> Fixed-reader random-case (FRRC) analysis</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#single-reader-multiple-treatment-analysis"><i class="fa fa-check"></i><b>3.9.1</b> Single-reader multiple-treatment analysis</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#random-reader-fixed-case-rrfc-analysis"><i class="fa fa-check"></i><b>3.10</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="3.11" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#dbmh-analysis-example-1-van-dyke-data"><i class="fa fa-check"></i><b>3.11</b> DBMH analysis: Example 1, Van Dyke Data</a></li>
<li class="chapter" data-level="3.12" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#dbmh-analysis-example-2-volumerad-data"><i class="fa fa-check"></i><b>3.12</b> DBMH analysis: Example 2, VolumeRad data</a></li>
<li class="chapter" data-level="3.13" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#validation-of-dbmh-analysis"><i class="fa fa-check"></i><b>3.13</b> Validation of DBMH analysis</a></li>
<li class="chapter" data-level="3.14" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#the-meaning-of-pseudovalues"><i class="fa fa-check"></i><b>3.14</b> The meaning of pseudovalues</a></li>
<li class="chapter" data-level="3.15" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#summary"><i class="fa fa-check"></i><b>3.15</b> Summary</a></li>
<li class="chapter" data-level="3.16" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#things-for-me-to-think-about"><i class="fa fa-check"></i><b>3.16</b> Things for me to think about</a>
<ul>
<li class="chapter" data-level="3.16.1" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#expected-values-of-mean-squares-1"><i class="fa fa-check"></i><b>3.16.1</b> Expected values of mean squares</a></li>
</ul></li>
<li class="chapter" data-level="3.17" data-path="DBMHnalysis.html"><a href="DBMHnalysis.html#references-1"><i class="fa fa-check"></i><b>3.17</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html"><i class="fa fa-check"></i><b>4</b> Obuchowski Rockette Hillis2 (ORH) Analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#OR1RMTModel"><i class="fa fa-check"></i><b>4.2</b> Single-reader multiple-treatment model</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#definitions-of-covariance-and-correlation"><i class="fa fa-check"></i><b>4.2.1</b> Definitions of covariance and correlation</a></li>
<li class="chapter" data-level="4.2.2" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#special-case-when-variables-have-equal-variances"><i class="fa fa-check"></i><b>4.2.2</b> Special case when variables have equal variances</a></li>
<li class="chapter" data-level="4.2.3" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#estimation-of-the-covariance-matrix"><i class="fa fa-check"></i><b>4.2.3</b> Estimation of the covariance matrix</a></li>
<li class="chapter" data-level="4.2.4" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#meaning-of-the-covariance-matrix-in-refeqexamplesigma"><i class="fa fa-check"></i><b>4.2.4</b> Meaning of the covariance matrix in @ref(eq:ExampleSigma)</a></li>
<li class="chapter" data-level="4.2.5" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#code-illustrating-the-covariance-matrix-tba"><i class="fa fa-check"></i><b>4.2.5</b> Code illustrating the covariance matrix (TBA)</a></li>
<li class="chapter" data-level="4.2.6" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#significance-testing-1"><i class="fa fa-check"></i><b>4.2.6</b> Significance testing</a></li>
<li class="chapter" data-level="4.2.7" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#p-value-and-confidence-interval-1"><i class="fa fa-check"></i><b>4.2.7</b> p-value and confidence interval</a></li>
<li class="chapter" data-level="4.2.8" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#comparing-dbm-to-obuchowski-and-rockette-for-single-reader-multiple-treatments"><i class="fa fa-check"></i><b>4.2.8</b> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#multiple-reader-multiple-treatment-orh-model"><i class="fa fa-check"></i><b>4.3</b> Multiple-reader multiple-treatment ORH model</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#StrCovMatrix"><i class="fa fa-check"></i><b>4.3.1</b> Structure of the covariance matrix</a></li>
<li class="chapter" data-level="4.3.2" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#physical-meanings-of-the-covariance-terms"><i class="fa fa-check"></i><b>4.3.2</b> Physical meanings of the covariance terms</a></li>
<li class="chapter" data-level="4.3.3" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#orh-random-reader-random-case-analysis"><i class="fa fa-check"></i><b>4.3.3</b> ORH random-reader random-case analysis</a></li>
<li class="chapter" data-level="4.3.4" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#fixed-reader-random-case-frrc-analysis-1"><i class="fa fa-check"></i><b>4.3.4</b> Fixed-reader random-case (FRRC) analysis</a></li>
<li class="chapter" data-level="4.3.5" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#random-reader-fixed-case-rrfc-analysis-1"><i class="fa fa-check"></i><b>4.3.5</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="4.3.6" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#single-treatment-multiple-reader-analysis"><i class="fa fa-check"></i><b>4.3.6</b> Single-treatment multiple-reader analysis</a></li>
<li class="chapter" data-level="4.3.7" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#connection-to-existing-literature"><i class="fa fa-check"></i><b>4.3.7</b> Connection to existing literature</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#discussionsummary"><i class="fa fa-check"></i><b>4.4</b> Discussion/Summary</a></li>
<li class="chapter" data-level="4.5" data-path="ORHAnalysis.html"><a href="ORHAnalysis.html#references-2"><i class="fa fa-check"></i><b>4.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-3.html"><a href="references-3.html"><i class="fa fa-check"></i>REFERENCES</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The RJafroc Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ORHAnalysis" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Obuchowski Rockette Hillis2 (ORH) Analysis</h1>
<div id="introduction-2" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Introduction</h2>
<p>The previous chapter described the DBM significance testing procedure <span class="citation">(Dorfman, Berbaum, and Metz <a href="#ref-RN204" role="doc-biblioref">1992</a>)</span> for analyzing MRMC ROC data, along with improvements suggested by Hillis. Because the method assumes that jackknife pseudovalues can be regarded as independent and identically distributed case-level figures of merit, it has been criticized by Hillis who states that the method “works” but lacks firm statistical foundations <span class="citation">(Hillis et al. <a href="#ref-RN1772" role="doc-biblioref">2005</a>; Hillis <a href="#ref-RN1865" role="doc-biblioref">2007</a>; Hillis, Berbaum, and Metz <a href="#ref-RN1866" role="doc-biblioref">2008</a>)</span>. If a method works there must be good reasons why it works and the last section of the previous chapter, §9.13, gave a justification for why the method works. Specifically, the empirical AUC pseudovalues qualify as case-level FOMs - this property was also noted by <span class="citation">(Hajian-Tilaki et al. <a href="#ref-RN1395" role="doc-biblioref">1997</a>)</span>. However, this property applies only to the empirical AUC, so an alternate approach that applies to any figure of merit is desirable.</p>
<p>This chapter presents Hillis’ preferred alternative to the DBMH approach. He has argued that the DBMH method can be regarded as a “working model that gives the right results”, but a method based on an earlier publication <span class="citation">(Obuchowski and Rockette <a href="#ref-RN1450" role="doc-biblioref">1995</a>)</span> by Obuchowski and Rockette, which does not depend on pseudovalues, and predicts more or less the same results, is preferable from a conceptual viewpoint. Since, besides showing the correspondence, Hillis has made significant improvements to the original methodology, this chapter is named “ORH Analysis”, where ORH stands for Obuchowski, Rockette and Hillis. The ORH method has advantages in being able to handle more complex study designs <span class="citation">(Hillis <a href="#ref-RN2508" role="doc-biblioref">2014</a>)</span> that are outside the scope of this book (the author acknowledges a private communication from Dr. Obuchowski, ca. 2006, that demonstrated the flexibility afforded by the OR approach) and it is likely that applications to other FOMs (e.g., the FROC paradigm uses a rather different FOM from empirical ROC-AUC) are better performed with the ORH method.</p>
<p>This chapter starts with a gentle introduction to the Obuchowski and Rockette method. The reason is that the method was rather opaque to me, an I suspect, most users. Part of the problem, in my opinion, is the notation, namely lack of usage of the <em>case-set</em> index <span class="math inline">\(\{c\}\)</span>. A key difference of the Obuchowski and Rockette method from DBMH is in how the error term is modeled by a non-diagonal covariance matrix. The structure of the covariance matrix is examined in some detail as it is key to understanding the ORH method.</p>
<p>In the first step of the introduction a single reader interpreting a case-set in multiple treatments is modeled and the results compared to those obtained using DBMH fixed-reader analysis described in the previous chapter. In the second step multiple readers interpreting a case-set in multiple treatments is modeled. The two analyses, DBMH and ORH, are compared for the same dataset. The special cases of fixed-reader and fixed-case analyses are described. Single treatment analysis, where interest is in comparing average performance of readers to a fixed value, is described. Three methods of estimating the covariance matrix are described.</p>
</div>
<div id="OR1RMTModel" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Single-reader multiple-treatment model</h2>
<p>Consider a single-reader providing ROC interpretations of a common case-set <span class="math inline">\(\{c\}\)</span> in multiple-treatments <span class="math inline">\(i\)</span> (<span class="math inline">\(i\)</span> = 1, 2, …, <span class="math inline">\(I\)</span>). Before proceeding, we note that this is not homologous (i.e., formally equivalent) to multiple-readers providing ROC interpretations in a single treatment, §10.7; this is because reader is a random factor while treatment is not. The figure of merit <span class="math inline">\(\theta\)</span> is modeled as:</p>
<p><span class="math display" id="eq:ORModel1RMT">\[\begin{equation}
\theta_{i\{c\}}=\mu+\tau_i+\epsilon_{i\{c\}}
\tag{4.1}
\end{equation}\]</span></p>
<p><em>In the <span class="citation">(Obuchowski and Rockette <a href="#ref-RN1450" role="doc-biblioref">1995</a>)</span> one models the figure-of-merit, not the pseudovalues, indeed this is one of the key differences from the DBMH method.</em></p>
<p>Recall that <span class="math inline">\(\{c\}\)</span> denotes a <em>set of cases</em>. <a href="ORHAnalysis.html#eq:ORModel1RMT">(4.1)</a> models the observed figure-of-merit <span class="math inline">\(\theta_{i\{c\}}\)</span> as a constant term <span class="math inline">\(\mu\)</span> plus a treatment dependent term <span class="math inline">\(\tau_i\)</span> (the treatment-effect) with the constraint:</p>
<p><span class="math display" id="eq:ConstraintTau">\[\begin{equation}
\sum_{i=1}^{I}\tau_i=0
\tag{4.2}
\end{equation}\]</span></p>
<p>The <em>c-index</em> was introduced in (book) Chapter 07. The left hand side of <a href="ORHAnalysis.html#eq:ORModel1RMT">(4.1)</a> is the figure-of-merit <span class="math inline">\(\theta_i\{c\}\)</span> for treatment <span class="math inline">\(i\)</span> and case-set index <span class="math inline">\(\{c\}\)</span>, where <span class="math inline">\(c\)</span> = 1, 2, …, <span class="math inline">\(C\)</span> denotes different independent case-sets sampled from the population, i.e., different collections of <span class="math inline">\(K_1\)</span> non-diseased and <span class="math inline">\(K_2\)</span> diseased cases, <em>not individual cases</em>.</p>
<p><em>This is one place the case-set index is essential for clarity; without it <span class="math inline">\(\theta_i\)</span> is a fixed quantity - the figure of merit estimate for treatment <span class="math inline">\(i\)</span> - lacking any index allowing for sampling related variability.</em></p>
<p>Obuchowski and Rockette use a <em>k-index</em>, defined as the “kth repetition of the study involving the same diagnostic test, reader and patient (sic)”. In the author’s opinion, what is meant is a case-set index instead of a repetition index. Repeating a study with the same treatment, reader and cases yields <em>within-reader</em> variability, which is different from sampling the population of cases with new case-sets, which yields <em>case-sampling plus within-reader</em> variability. As noted earlier, within-reader variability cannot be “turned off” and affects the interpretations of all case-sets.</p>
<p><em>Interest is in extrapolating to the population of cases and the only way to do this is to sample different case-sets. It is shown below that usage of the case-set index interpretation yields the same results using the DBMH or the ORH methods.</em></p>
<p>Finally, and this is where I had some difficulty understanding what is going on, there is an additive random error term <span class="math inline">\(\epsilon_{i\{c\}}\)</span> whose sampling behavior is described by a multivariate normal distribution with an I-dimensional zero mean vector and an <span class="math inline">\(I \times I\)</span> dimensional covariance matrix <span class="math inline">\(\Sigma\)</span>:</p>
<p><span class="math display" id="eq:DefinitionEpsilon">\[\begin{equation}
\epsilon_{i\{c\}} \sim N_I\left ( \vec{0} ,  \Sigma\right )
\tag{4.3}
\end{equation}\]</span></p>
<p>Here <span class="math inline">\(N_I\)</span> is the I-variate normal distribution (i.e., each sample yields <span class="math inline">\(I\)</span> random numbers). Obuchowski and Rockette assumed the following structure for the covariance matrix (they describe a more general multi-reader model, but here one restricts to the simpler single-reader case):</p>
<p><span class="math display" id="eq:DefinitionSigma">\[\begin{equation}
\Sigma_{ii&#39;}=Cov\left ( \epsilon_{i\{c\}}, \epsilon_{i&#39;\{c\}} \right )=\left\{\begin{matrix}
Var \qquad (i=i&#39;)\\ 
Cov_1 \qquad (i\neq i&#39;)
\end{matrix}\right.
\tag{4.4}
\end{equation}\]</span></p>
<p>The reason for the subscript “1” in <span class="math inline">\(Cov_1\)</span> will become clear when one extends this model to multiple readers. The <span class="math inline">\(I \times I\)</span> covariance matrix <span class="math inline">\(\Sigma\)</span> is:</p>
<p><span class="math display" id="eq:ExampleSigma">\[\begin{equation}
\Sigma=
\begin{pmatrix}
Var &amp; Cov_1   &amp; \ldots &amp; Cov_1 &amp; Cov_1 \\
Cov_1 &amp; Var   &amp; \ldots &amp;Cov_1 &amp; Cov_1 \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
Cov_1 &amp; Cov_1 &amp; \ldots &amp; Var &amp; Cov_1 \\
Cov_1 &amp; Cov_1 &amp; \ldots &amp; Cov_1 &amp; Var
\end{pmatrix}
\tag{4.5}
\end{equation}\]</span></p>
<p>If <span class="math inline">\(I\)</span> = 2 then <span class="math inline">\(\Sigma\)</span> is a symmetric 2 x 2 matrix, whose diagonal terms are the common variances in the two treatments (each assumed equal to <span class="math inline">\(Var\)</span>) and whose off-diagonal terms (each assumed equal to <span class="math inline">\(Cov_1\)</span>) are the co-variances. With <span class="math inline">\(I\)</span> = 3 one has a 3 x 3 symmetric matrix with all diagonal elements equal to <span class="math inline">\(Var\)</span> and all off-diagonal terms are equal to <span class="math inline">\(Cov_1\)</span>, etc.</p>
<p><em>An important aspect of the Obuchowski and Rockette model is that the variances and co-variances are assumed to be treatment independent. This implies that <span class="math inline">\(Var\)</span> estimates need to be averaged over all treatments. Likewise, <span class="math inline">\(Cov_1\)</span> estimates need to be averaged over all distinct treatment-treatment pairings.</em></p>
<p>A more complex model, with more parameters and therefore more difficult to work with, would allow the variances to be treatment dependent, and the covariances to depend on the specific treatment pairings. For obvious reasons (“Occam’s Razor” or the law of parsimony ) one wishes to start with the simplest model that, one hopes, captures essential characteristics of the data.</p>
<p>Some elementary statistical results are presented next.</p>
<div id="definitions-of-covariance-and-correlation" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Definitions of covariance and correlation</h3>
<p>The covariance of two scalar random variables X and Y is defined by:</p>
<p><span class="math display" id="eq:DefinitionCovariance">\[\begin{equation}
Cov(X,Y) =\frac{\sum_{i=1}^{N}(x_{i}-x_{\bullet})(y_{i}-y_{\bullet})}{N-1}=E(XY)-E(X)-E(Y)
\tag{4.6}
\end{equation}\]</span></p>
<p>Here <span class="math inline">\(E(X)\)</span> is the expectation value of the random variable <span class="math inline">\(X\)</span>, i.e., the integral of x multiplied by its <span class="math inline">\(pdf\)</span> over the range of <span class="math inline">\(x\)</span>:</p>
<p><span class="math display">\[E(X)=\int pdf(x) x dx\]</span></p>
<p>The covariance can be thought of as the <em>common</em> part of the variance of two random variables. The variance, a special case of covariance, of <span class="math inline">\(X\)</span> is defined by:</p>
<p><span class="math display">\[Var(X,Y) = Cov(X,X)=E(X^2)-(E(X))^2=\sigma_x^2\]</span></p>
<p>It can be shown, using the Cauchy–Schwarz inequality, that:</p>
<p><span class="math display">\[\mid Cov(X,Y) \mid^2 \le Var(X)Var(Y)\]</span></p>
<p>A related quantity, the correlation <span class="math inline">\(\rho\)</span> is defined by (the <span class="math inline">\(\sigma\)</span>s are standard deviations):</p>
<p><span class="math display">\[\rho_{XY} \equiv Cor(X,Y)=\frac{Cov(X,Y)}{\sigma_X \sigma_Y}\]</span></p>
<p>It has the property:</p>
<p><span class="math display">\[\mid \rho_{XY} \mid \le 1\]</span></p>
</div>
<div id="special-case-when-variables-have-equal-variances" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Special case when variables have equal variances</h3>
<p>Assuming <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> have the same variance:</p>
<p><span class="math display">\[Var(X)=Var(Y)\equiv Var\equiv \sigma^2\]</span></p>
<p>A useful theorem applicable to the OR single-reader multiple-treatment model is:</p>
<p><span class="math display" id="eq:UsefulTheorem">\[\begin{equation}
Var(X-Y)=Var(X)+Var(Y)-2Cov(X,Y)=2(Var-Cov)
\tag{4.7}
\end{equation}\]</span></p>
<p>The left part of the above equation is general, the right part specializes to the OR single-reader multiple-treatment model where the variances are equal and likewise all covariances in <a href="ORHAnalysis.html#eq:ExampleSigma">(4.5)</a> are equal) The correlation <span class="math inline">\(\rho_1\)</span> is defined by (the reason for the subscript 1 on <span class="math inline">\(\rho\)</span> is the same as the reason for the subscript 1 on <span class="math inline">\(Cov_1\)</span>, which will be explained later):</p>
<p><span class="math display">\[\rho_1=\frac{Cov_1}{Var}\]</span></p>
<p>The I x I covariance matrix <span class="math inline">\(\Sigma\)</span> can be written alternatively as (shown below is the matrix for I = 5; as the matrix is symmetric elements at and above the diagonal are shown):</p>
<p><span class="math display" id="eq:ExampleSigmaRho">\[\begin{equation}
\Sigma = 
\begin{bmatrix}
\sigma^2 &amp; \rho_1\sigma^2 &amp; \rho_1\sigma^2 &amp; \rho_1\sigma^2 &amp; \rho_1\sigma^2\\
&amp; \sigma^2 &amp; \rho_1\sigma^2 &amp; \rho_1\sigma^2 &amp; \rho_1\sigma^2\\
&amp;  &amp; \sigma^2 &amp; \rho_1\sigma^2 &amp; \rho_1\sigma^2\\
&amp;  &amp;  &amp; \sigma^2 &amp; \rho_1\sigma^2\\
&amp;  &amp;  &amp;  &amp; \sigma^2
\end{bmatrix}
\tag{4.8}
\end{equation}\]</span></p>
</div>
<div id="estimation-of-the-covariance-matrix" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Estimation of the covariance matrix</h3>
<p>An unbiased estimate of the covariance <a href="ORHAnalysis.html#eq:DefinitionSigma">(4.4)</a> follows from:</p>
<p><span class="math display" id="eq:EstimateSigmaPopulation">\[\begin{equation}
\Sigma_{ii&#39;}=\frac{1}{C-1}\sum_{c=1}^{C} \left ( \theta_{i\{c\}} - \theta_{i\{\bullet\}} \right) \left ( \theta_{i&#39;\{c\}} - \theta_{i&#39;\{\bullet\}} \right)
\tag{4.9}
\end{equation}\]</span></p>
<p>Sampling different case-sets, as required <a href="ORHAnalysis.html#eq:EstimateSigmaPopulation">(4.9)</a>, is unrealistic and in reality one is stuck with <span class="math inline">\(C\)</span> = 1, i.e., a single dataset. Therefore, direct application of this formula is impossible. However, as seen when this situation was encountered before in (book) Chapter 07, one can use resampling methods to realize, for example, different bootstrap samples, which are resampling-based “stand-ins” for actual case-sets. If <span class="math inline">\(B\)</span> is the total number of bootstraps, then the estimation formula is:</p>
<p><span class="math display" id="eq:EstimateSigmaBootstrap">\[\begin{equation}
\Sigma_{ii&#39;}\mid_{bs} =\frac{1}{B-1}\sum_{b=1}^{B} \left ( \theta_{i\{b\}} - \theta_{i\{\bullet\}} \right) \left ( \theta_{i&#39;\{b\}} - \theta_{i&#39;\{\bullet\}} \right)
\tag{4.10}
\end{equation}\]</span></p>
<p><a href="ORHAnalysis.html#eq:EstimateSigmaBootstrap">(4.10)</a>, the bootstrap method of estimating the covariance matrix, is a direct translation of <a href="ORHAnalysis.html#eq:EstimateSigmaPopulation">(4.9)</a>. Alternatively, one could have used the jackknife FOM values <span class="math inline">\(\theta_{i(k)}\)</span>, i.e., the figure of merit with a particular case removed, for all cases, to estimate the covariance matrix:</p>
<p><span class="math display" id="eq:EstimateSigmaJackknife">\[\begin{equation}
\Sigma_{ii&#39;}\mid_{jk} =\frac{(K-1)^2}{K} \left [ \frac{1}{K-1}\sum_{k=1}^{K} \left ( \theta_{i(k)} - \theta_{i(\bullet)} \right) \left ( \theta_{i&#39;(k)} - \theta_{i&#39;(\bullet)} \right) \right ]
\tag{4.11}
\end{equation}\]</span></p>
<p>Note the subtle difference in notation between <a href="ORHAnalysis.html#eq:EstimateSigmaPopulation">(4.9)</a> and EstimateSigmaJackknife and. In the former, the subscript <span class="math inline">\(\{c\}\)</span> denotes a set of <span class="math inline">\(K\)</span> cases while in the latter, <span class="math inline">\((k)\)</span> denotes the original case set with a particular case <span class="math inline">\(k\)</span> removed, leaving <span class="math inline">\(K-1\)</span> cases.</p>
<p>For simplicity, in this section we depart from the usual two-subscript convention to index each case. So <span class="math inline">\(k\)</span> ranges from 1 to <span class="math inline">\(K\)</span>, where the first <span class="math inline">\(K_1\)</span> values represent non-diseased and the following <span class="math inline">\(K_2\)</span> values represent diseased cases. Jackknife figure of merit values are not to be confused with jackknife pseudovalues. The jackknife FOM value corresponding to a particular case is the FOM with the particular case removed. Unlike pseudovalues, jackknife FOM values cannot be regarded as independent and identically distributed. Notice the use of the subscript enclosed in parenthesis <span class="math inline">\((k)\)</span> to denote the FOM with case <span class="math inline">\(k\)</span> removed, i.e., a single case, while in the bootstrap equation one uses the curly brackets <span class="math inline">\(\{b\}\)</span> to denote the bth bootstrap <em>case-set</em>, i.e., a whole set of <span class="math inline">\(K_1\)</span> non-diseased and <span class="math inline">\(K_2\)</span> diseased cases, sampled with replacement from the original dataset. Furthermore, the expression for the jackknife covariance contains a <em>variance inflation factor</em>:</p>
<p><span class="math display" id="eq:JKVarianceInflationFactor">\[\begin{equation}
\frac{(K-1)^2}{K}
\tag{4.12}
\end{equation}\]</span></p>
<p>This factor multiplies the traditional expression for the covariance, shown in square brackets in <a href="ORHAnalysis.html#eq:EstimateSigmaJackknife">(4.11)</a>. A third method of estimating the covariance, namely the DeLong et al. method <span class="citation">(DeLong, DeLong, and Clarke-Pearson <a href="#ref-RN112" role="doc-biblioref">1988</a>)</span>, applicable only to the empirical AUC, is described later.</p>
</div>
<div id="meaning-of-the-covariance-matrix-in-refeqexamplesigma" class="section level3" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Meaning of the covariance matrix in <a href="ORHAnalysis.html#eq:ExampleSigma">(4.5)</a></h3>
<p>Suppose one has the luxury of repeatedly sampling case-sets, each consisting of <span class="math inline">\(K\)</span> cases from the population. A single radiologist interprets these cases in <span class="math inline">\(I\)</span> treatments. Therefore, each case-set <span class="math inline">\(\{c\}\)</span> yields <span class="math inline">\(I\)</span> figures of merit. The final numbers at ones disposal are <span class="math inline">\(\theta_{i\{c\}}\)</span>, where <span class="math inline">\(i\)</span> = 1,2,…,<span class="math inline">\(I\)</span> and <span class="math inline">\(c\)</span> = 1,2,…,<span class="math inline">\(C\)</span>. Considering treatment <span class="math inline">\(i\)</span>, the variance of the FOM-values for the different case-sets <span class="math inline">\(c\)</span> = 1,2,…,<span class="math inline">\(C\)</span>, is an estimate of <span class="math inline">\(Var_i\)</span> for this treatment:</p>
<p><span class="math display" id="eq:EstimateVari">\[\begin{equation}
\sigma_i^2 \equiv Var_i = \frac{1}{C-1}\sum_{c=1}^{C}\left ( \theta_{i\{c\}} - \theta_{i\{\bullet\}} \right) \left ( \theta_{i\{c\}} - \theta_{i\{\bullet\}} \right)
\tag{4.13}
\end{equation}\]</span></p>
<p>The process is repeated for all treatments and the <span class="math inline">\(I\)</span>-variance values are averaged. This is the final estimate of <span class="math inline">\(Var\)</span> appearing in <a href="ORHAnalysis.html#eq:DefinitionEpsilon">(4.3)</a>.</p>
<p>To estimate the covariance matrix one considers pairs of FOM values for the same case-set <span class="math inline">\(\{c\}\)</span> but different treatments, i.e., <span class="math inline">\(\theta_{i\{c\}}\)</span> and <span class="math inline">\(\theta_{i&#39;\{c\}}\)</span>; <em>by definition primed and un-primed indices are different</em>. Since they are derived from the same case-set, one expects the values to be correlated. For a particularly easy case-set one expects all I-estimates to be collectively higher than usual. The process is repeated for different case-sets and one calculates the correlation <span class="math inline">\(\rho_{1;ii&#39;}\)</span> between the two <span class="math inline">\(C\)</span>-length arrays <span class="math inline">\(\theta_{i\{c\}}\)</span> and <span class="math inline">\(\theta_{i&#39;\{c\}}\)</span>:</p>
<p><span class="math display" id="eq:EstimateRho">\[\begin{equation}
\rho_{1;ii&#39;} = \frac{1}{C-1}\sum_{c=1}^{C} \frac {\left ( \theta_{i\{c\}} - \theta_{i\{\bullet\}} \right) \left ( \theta_{i&#39;\{c\}} - \theta_{i&#39;\{\bullet\}} \right)}{\sigma_i \sigma_{i&#39;} }
\tag{4.14}
\end{equation}\]</span></p>
<p>The entire process is repeated for different treatment pairings and the resulting <span class="math inline">\(I(I-1)/2\)</span> distinct values are averaged yielding the final estimate of <span class="math inline">\(\rho_1\)</span> in <a href="ORHAnalysis.html#eq:ExampleSigmaRho">(4.8)</a>. According to @ref(eq: EstimateRho) one expects the covariance to be smaller than the variance determined as in the previous paragraph.</p>
<p>In most situations one expects <span class="math inline">\(\rho_1\)</span> (for ROC studies) to be positive. There is, perhaps unlikely, a scenario that could lead to anti-correlation and negative. This could occur, with “complementary” treatments, e.g., CT vs. MRI, where one treatment is good for bone imaging and the other for soft-tissue imaging. In this situation what constitutes an easy case-set in one treatment could be a difficult case-set in the other treatment.</p>
</div>
<div id="code-illustrating-the-covariance-matrix-tba" class="section level3" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Code illustrating the covariance matrix (TBA)</h3>
<p>As indicated above, the covariance matrix can be estimated using the jackknife or the bootstrap. If the figure of merit is the Wilcoxon statistic, then one can also use the DeLong et al method <span class="citation">(DeLong, DeLong, and Clarke-Pearson <a href="#ref-RN112" role="doc-biblioref">1988</a>)</span>. In (book) Chapter 07, these methods were described in the context of estimating the variance of AUC. <a href="ORHAnalysis.html#eq:EstimateSigmaBootstrap">(4.10)</a> and <a href="ORHAnalysis.html#eq:EstimateSigmaJackknife">(4.11)</a> extend the jackknife and the bootstrap methods, respectively, to estimating the covariance of AUC (whose diagonal elements are the variances estimated in the earlier chapter). The extension of the DeLong method to covariances is described in Online Appendix 10.A (TBA) and implemented in file <code>VarCovMtrxDLStr.R</code>. The file name stands for “variance covariance matrix according to the DeLong structural components method” <em>described in five unnumbered equations following Eqn. 4 in the cited reference</em>.</p>
<ul>
<li>To minimize clutter, the functions (for <code>Var</code> and <code>Cov1</code> using bootstrap, jackknife, and the DeLong methods) are not shown, but they are compiled. To display them download the book repository and look at the <code>Rmd</code> file corresponding to this output and the sourced <code>R</code> files listed below:</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="ORHAnalysis.html#cb17-1"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH10-ORH/Wilcoxon.R&quot;</span>))</span>
<span id="cb17-2"><a href="ORHAnalysis.html#cb17-2"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH10-ORH/VarCov1Bs.R&quot;</span>))</span>
<span id="cb17-3"><a href="ORHAnalysis.html#cb17-3"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH10-ORH/VarCov1Bs.R&quot;</span>))</span>
<span id="cb17-4"><a href="ORHAnalysis.html#cb17-4"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH10-ORH/VarCov1Jk.R&quot;</span>)) </span>
<span id="cb17-5"><a href="ORHAnalysis.html#cb17-5"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH10-ORH/VarCovMtrxDLStr.R&quot;</span>))</span>
<span id="cb17-6"><a href="ORHAnalysis.html#cb17-6"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH10-ORH/VarCovs.R&quot;</span>))</span></code></pre></div>
<p>The following code chunk extracts (using the <code>DfExtractDataset</code> function) a single-reader multiple-treatment ROC dataset corresponding to the first reader from <code>dataset02</code>, i.e., the Van Dyke or <code>VD</code> dataset.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="ORHAnalysis.html#cb18-1"></a>rocData1R &lt;-<span class="st"> </span><span class="kw">DfExtractDataset</span>(dataset02, <span class="dt">rdrs =</span> <span class="dv">1</span>) <span class="co">#select the 1st reader to be analyzed</span></span>
<span id="cb18-2"><a href="ORHAnalysis.html#cb18-2"></a>zik1 &lt;-<span class="st"> </span>rocData1R<span class="op">$</span>ratings<span class="op">$</span>NL[,<span class="dv">1</span>,,<span class="dv">1</span>];K &lt;-<span class="st"> </span><span class="kw">dim</span>(zik1)[<span class="dv">2</span>];I &lt;-<span class="st"> </span><span class="kw">dim</span>(zik1)[<span class="dv">1</span>]</span>
<span id="cb18-3"><a href="ORHAnalysis.html#cb18-3"></a>zik2 &lt;-<span class="st"> </span>rocData1R<span class="op">$</span>ratings<span class="op">$</span>LL[,<span class="dv">1</span>,,<span class="dv">1</span>];K2 &lt;-<span class="st"> </span><span class="kw">dim</span>(zik2)[<span class="dv">2</span>];K1 &lt;-<span class="st"> </span>K<span class="op">-</span>K2;zik1 &lt;-<span class="st"> </span>zik1[,<span class="dv">1</span><span class="op">:</span>K1]</span></code></pre></div>
<p>The following notation is used in the code below:</p>
<ul>
<li>jk = jackknife method</li>
<li>bs = boostrap method, with B = number of bootstraps and <code>seed</code> = value.</li>
<li>dl = DeLong method</li>
<li>rjjk = RJafroc, covEstMethod = “jackknife”</li>
<li>rjbs = RJafroc, covEstMethod = “bootstrap”</li>
</ul>
<p>For exammple, <code>Cov1_jk</code> is the jackknife estimate of <code>Cov1</code>.</p>
<p>Shown below are the results of the jackknife method, first using the code in this repository and next, as a cross-check, using <code>RJafroc</code> function <code>UtilVarComponentsOR</code>:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="ORHAnalysis.html#cb19-1"></a>ret1 &lt;-<span class="st"> </span><span class="kw">VarCov1_Jk</span>(zik1, zik2)</span>
<span id="cb19-2"><a href="ORHAnalysis.html#cb19-2"></a>Var &lt;-<span class="st"> </span>ret1<span class="op">$</span>Var</span>
<span id="cb19-3"><a href="ORHAnalysis.html#cb19-3"></a>Cov1 &lt;-<span class="st"> </span>ret1<span class="op">$</span>Cov1 <span class="co"># use these (i.e., jackknife) as default values in subsequent code</span></span>
<span id="cb19-4"><a href="ORHAnalysis.html#cb19-4"></a><span class="kw">data.frame</span> (<span class="st">&quot;Cov1_jk&quot;</span> =<span class="st"> </span>Cov1, <span class="st">&quot;Var_jk&quot;</span> =<span class="st"> </span>Var)</span>
<span id="cb19-5"><a href="ORHAnalysis.html#cb19-5"></a><span class="co">#&gt;        Cov1_jk       Var_jk</span></span>
<span id="cb19-6"><a href="ORHAnalysis.html#cb19-6"></a><span class="co">#&gt; 1 0.0003734661 0.0006989006</span></span>
<span id="cb19-7"><a href="ORHAnalysis.html#cb19-7"></a></span>
<span id="cb19-8"><a href="ORHAnalysis.html#cb19-8"></a>ret4 &lt;-<span class="st"> </span><span class="kw">UtilVarComponentsOR</span>(rocData1R, <span class="dt">FOM =</span> <span class="st">&quot;Wilcoxon&quot;</span>)<span class="op">$</span>varComp <span class="co"># default `covEstMethod` is jackknife</span></span>
<span id="cb19-9"><a href="ORHAnalysis.html#cb19-9"></a><span class="kw">data.frame</span> (<span class="st">&quot;Cov_rjjk&quot;</span> =<span class="st"> </span>ret4<span class="op">$</span>cov1, <span class="st">&quot;Var_rjjk&quot;</span> =<span class="st"> </span>ret4<span class="op">$</span>var)</span>
<span id="cb19-10"><a href="ORHAnalysis.html#cb19-10"></a><span class="co">#&gt; data frame with 0 columns and 0 rows</span></span></code></pre></div>
<p>Note that the estimates are identical and that the <span class="math inline">\(Cov_1\)</span> estimate is smaller than the <span class="math inline">\(Var\)</span> estimate (their ratio is the correlation <span class="math inline">\(\rho_1 = Cov_1/Var\)</span> = 0.5343623).</p>
<p>Shown next are bootstrap method estimates with increasing number of bootstraps (200, 2000 and 20,000):</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="ORHAnalysis.html#cb20-1"></a>ret2 &lt;-<span class="st"> </span><span class="kw">VarCov1_Bs</span>(zik1, zik2, <span class="dv">200</span>, <span class="dt">seed =</span> <span class="dv">100</span>)</span>
<span id="cb20-2"><a href="ORHAnalysis.html#cb20-2"></a><span class="kw">data.frame</span> (<span class="st">&quot;Cov_bs&quot;</span> =<span class="st"> </span>ret2<span class="op">$</span>Cov1, <span class="st">&quot;Var_bs&quot;</span> =<span class="st"> </span>ret2<span class="op">$</span>Var) </span>
<span id="cb20-3"><a href="ORHAnalysis.html#cb20-3"></a><span class="co">#&gt;        Cov_bs       Var_bs</span></span>
<span id="cb20-4"><a href="ORHAnalysis.html#cb20-4"></a><span class="co">#&gt; 1 0.000283905 0.0005845354</span></span>
<span id="cb20-5"><a href="ORHAnalysis.html#cb20-5"></a></span>
<span id="cb20-6"><a href="ORHAnalysis.html#cb20-6"></a>ret2 &lt;-<span class="st"> </span><span class="kw">VarCov1_Bs</span>(zik1, zik2, <span class="dv">2000</span>, <span class="dt">seed =</span> <span class="dv">100</span>)</span>
<span id="cb20-7"><a href="ORHAnalysis.html#cb20-7"></a><span class="kw">data.frame</span> (<span class="st">&quot;Cov_bs&quot;</span> =<span class="st"> </span>ret2<span class="op">$</span>Cov1, <span class="st">&quot;Var_bs&quot;</span> =<span class="st"> </span>ret2<span class="op">$</span>Var) </span>
<span id="cb20-8"><a href="ORHAnalysis.html#cb20-8"></a><span class="co">#&gt;         Cov_bs       Var_bs</span></span>
<span id="cb20-9"><a href="ORHAnalysis.html#cb20-9"></a><span class="co">#&gt; 1 0.0003466804 0.0006738506</span></span>
<span id="cb20-10"><a href="ORHAnalysis.html#cb20-10"></a></span>
<span id="cb20-11"><a href="ORHAnalysis.html#cb20-11"></a>ret2 &lt;-<span class="st"> </span><span class="kw">VarCov1_Bs</span>(zik1, zik2, <span class="dv">20000</span>, <span class="dt">seed =</span> <span class="dv">100</span>)</span>
<span id="cb20-12"><a href="ORHAnalysis.html#cb20-12"></a><span class="kw">data.frame</span> (<span class="st">&quot;Cov_bs&quot;</span> =<span class="st"> </span>ret2<span class="op">$</span>Cov1, <span class="st">&quot;Var_bs&quot;</span> =<span class="st"> </span>ret2<span class="op">$</span>Var) </span>
<span id="cb20-13"><a href="ORHAnalysis.html#cb20-13"></a><span class="co">#&gt;         Cov_bs       Var_bs</span></span>
<span id="cb20-14"><a href="ORHAnalysis.html#cb20-14"></a><span class="co">#&gt; 1 0.0003680714 0.0006862668</span></span></code></pre></div>
<p>With increasing number of bootstraps the values approach the jackknife estimates.</p>
<p>Following, as a cross check, are results of bootstrap method as calculated by the <code>RJafroc</code> function <code>UtilVarComponentsOR</code>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="ORHAnalysis.html#cb21-1"></a>ret5 &lt;-<span class="st"> </span><span class="kw">UtilVarComponentsOR</span>(rocData1R, <span class="dt">FOM =</span> <span class="st">&quot;Wilcoxon&quot;</span>, <span class="dt">covEstMethod =</span> <span class="st">&quot;bootstrap&quot;</span>, <span class="dt">nBoots =</span> <span class="dv">2000</span>, <span class="dt">seed =</span> <span class="dv">100</span>)<span class="op">$</span>varComp</span>
<span id="cb21-2"><a href="ORHAnalysis.html#cb21-2"></a><span class="kw">data.frame</span> (<span class="st">&quot;Cov_rjbs&quot;</span> =<span class="st"> </span>ret5<span class="op">$</span>cov1, <span class="st">&quot;Var_rjbs&quot;</span> =<span class="st"> </span>ret5<span class="op">$</span>var)</span>
<span id="cb21-3"><a href="ORHAnalysis.html#cb21-3"></a><span class="co">#&gt; data frame with 0 columns and 0 rows</span></span></code></pre></div>
<p>Note that the two estimates are identical <em>provided the seeds are identical</em>.</p>
<p>Following are results of the DeLong covariance estimation method, the first output using this repository code and the second using the <code>RJafroc</code> function <code>UtilVarComponentsOR</code> with appropriate arguments:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="ORHAnalysis.html#cb22-1"></a>mtrxDLStr &lt;-<span class="st"> </span><span class="kw">VarCovMtrxDLStr</span>(rocData1R)</span>
<span id="cb22-2"><a href="ORHAnalysis.html#cb22-2"></a>ret3 &lt;-<span class="st"> </span><span class="kw">VarCovs</span>(mtrxDLStr)</span>
<span id="cb22-3"><a href="ORHAnalysis.html#cb22-3"></a><span class="kw">data.frame</span> (<span class="st">&quot;Cov_dl&quot;</span> =<span class="st"> </span>ret3<span class="op">$</span>cov1, <span class="st">&quot;Var_dl&quot;</span> =<span class="st"> </span>ret3<span class="op">$</span>var)</span>
<span id="cb22-4"><a href="ORHAnalysis.html#cb22-4"></a><span class="co">#&gt;         Cov_dl       Var_dl</span></span>
<span id="cb22-5"><a href="ORHAnalysis.html#cb22-5"></a><span class="co">#&gt; 1 0.0003684357 0.0006900766</span></span>
<span id="cb22-6"><a href="ORHAnalysis.html#cb22-6"></a></span>
<span id="cb22-7"><a href="ORHAnalysis.html#cb22-7"></a>ret5 &lt;-<span class="st"> </span><span class="kw">UtilVarComponentsOR</span>(rocData1R, <span class="dt">FOM =</span> <span class="st">&quot;Wilcoxon&quot;</span>, <span class="dt">covEstMethod =</span> <span class="st">&quot;DeLong&quot;</span>)<span class="op">$</span>varComp</span>
<span id="cb22-8"><a href="ORHAnalysis.html#cb22-8"></a><span class="kw">data.frame</span> (<span class="st">&quot;Cov_rjdl&quot;</span> =<span class="st"> </span>ret5<span class="op">$</span>cov1, <span class="st">&quot;Var_rjdl&quot;</span> =<span class="st"> </span>ret5<span class="op">$</span>var)</span>
<span id="cb22-9"><a href="ORHAnalysis.html#cb22-9"></a><span class="co">#&gt; data frame with 0 columns and 0 rows</span></span></code></pre></div>
<p>Note that the two estimates are identical and that the DeLong estimate are close to the bootstrap estimates using 20,000 bootstraps. The close correspondence is only expected when using the Wilcoxon figure of merit.</p>
</div>
<div id="significance-testing-1" class="section level3" number="4.2.6">
<h3><span class="header-section-number">4.2.6</span> Significance testing</h3>
<p>The covariance matrix is needed for significance testing. Define the mean square corresponding to the treatment effect, denoted <span class="math inline">\(MS(T)\)</span>, by:</p>
<p><span class="math display" id="eq:DefinitionMST">\[\begin{equation}
MS(T)=\frac{1}{I-1}\sum_{i=1}^{I}(\theta_i-\theta_\bullet)^2
\tag{4.15}
\end{equation}\]</span></p>
<p><em>Unlike the previous chapter, all mean square quantities defined in this chapter are based on FOMs, not pseudovalues.</em></p>
<p>It can be shown that under the null hypothesis (that all treatments have identical performances) the test statistic <span class="math inline">\(\chi_{1R}\)</span> defined below (the <span class="math inline">\(1R\)</span> subscript denotes single-reader analysis) is distributed approximately as a <span class="math inline">\(\chi^2\)</span> distribution with <span class="math inline">\(I-1\)</span> degrees of freedom, i.e.,</p>
<p><span class="math display" id="eq:F-1RMT">\[\begin{equation}
\chi_{1R} \equiv \frac{(I-1)MS(T)}{Var-Cov_1} \sim \chi_{I-1}^{2}
\tag{4.16}
\end{equation}\]</span></p>
<p><a href="ORHAnalysis.html#eq:F-1RMT">(4.16)</a> is from §5.4 <span class="citation">(Hillis <a href="#ref-RN1865" role="doc-biblioref">2007</a>)</span> with two covariance terms “zeroed out” because they are multiplied by <span class="math inline">\(J-1 = 0\)</span> (since, in this example, we are restricting to <span class="math inline">\(J=1\)</span>).</p>
<p>Or equivalently, in terms of the F-distribution <span class="citation">(Hillis et al. <a href="#ref-RN1772" role="doc-biblioref">2005</a>)</span>:</p>
<p><span class="math display" id="eq:DefF-1RMT">\[\begin{equation}
F_{1R} \equiv \frac{MS(T)}{Var-Cov_1} \sim F_{I-1, \infty}
\tag{4.17}
\end{equation}\]</span></p>
<div id="an-aside-on-the-relation-between-the-chisquare-and-the-f-distribution-with-infinite-ddf" class="section level4" number="4.2.6.1">
<h4><span class="header-section-number">4.2.6.1</span> An aside on the relation between the chisquare and the F-distribution with infinite ddf</h4>
<p>Define <span class="math inline">\(D_{1-\alpha}\)</span>, the <span class="math inline">\((1-\alpha)\)</span> quantile of distribution <span class="math inline">\(D\)</span>, as that “cutoff” value such that the probability of observing a random sample <span class="math inline">\(d\)</span> less than or equal to <span class="math inline">\(D_{1-\alpha}\)</span> is <span class="math inline">\((1-\alpha)\)</span>. In other words,</p>
<p><span class="math display" id="eq:DefQuantile">\[\begin{equation}
\Pr(d\leq D_{1-alpha} \mid d \sim D)=1-\alpha
\tag{4.18}
\end{equation}\]</span></p>
<p>With definition <a href="ORHAnalysis.html#eq:DefQuantile">(4.18)</a>, the <span class="math inline">\((1-\alpha)\)</span> quantile of the <span class="math inline">\(\chi_{I-1}^2\)</span> distribution, i.e., <span class="math inline">\(\chi_{1-\alpha,I-1}^2\)</span>, is related to the <span class="math inline">\((1-\alpha)\)</span> quantile of the <span class="math inline">\(F_{I-1,\infty}\)</span> distribution, i.e., <span class="math inline">\(F_{1-\alpha,I-1,\infty}\)</span>, as follows <span class="citation">(see Hillis et al. <a href="#ref-RN1772" role="doc-biblioref">2005</a>, Eq. 22)</span>:</p>
<p><span class="math display" id="eq:Chisqr2F">\[\begin{equation}
\frac{\chi_{1-\alpha,I-1}^{2}}{I-1} = F_{1-\alpha,I-1,\infty}
\tag{4.19}
\end{equation}\]</span></p>
<p><a href="ORHAnalysis.html#eq:Chisqr2F">(4.19)</a> implies that the <span class="math inline">\((1-\alpha)\)</span> quantile of the F-distribution with <span class="math inline">\(ndf=(I-1)\)</span> and <span class="math inline">\(ddf=\infty\)</span> equals the <span class="math inline">\((1-\alpha)\)</span> quantile of the <span class="math inline">\(\chi_{I-1}^2\)</span> distribution <em>divided by <span class="math inline">\((I-1)\)</span></em>.</p>
<p>Here is an <code>R</code> illustration of this theorem for <span class="math inline">\(I-1 = 4\)</span> and <span class="math inline">\(\alpha = 0.05\)</span>:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="ORHAnalysis.html#cb23-1"></a><span class="kw">qf</span>(<span class="fl">0.05</span>, <span class="dv">4</span>, <span class="ot">Inf</span>)</span>
<span id="cb23-2"><a href="ORHAnalysis.html#cb23-2"></a><span class="co">#&gt; [1] 0.1776808</span></span>
<span id="cb23-3"><a href="ORHAnalysis.html#cb23-3"></a><span class="kw">qchisq</span>(<span class="fl">0.05</span>,<span class="dv">4</span>)<span class="op">/</span><span class="dv">4</span></span>
<span id="cb23-4"><a href="ORHAnalysis.html#cb23-4"></a><span class="co">#&gt; [1] 0.1776808</span></span></code></pre></div>
</div>
</div>
<div id="p-value-and-confidence-interval-1" class="section level3" number="4.2.7">
<h3><span class="header-section-number">4.2.7</span> p-value and confidence interval</h3>
<p>The p-value is the probability that a sample from the <span class="math inline">\(F_{I-1,\infty}\)</span> distribution is greater than the observed value of the test statistic, namely:</p>
<p><span class="math display" id="eq:pValue1RMT">\[\begin{equation}
p\equiv \Pr(f&gt;F_{1R} \mid f \sim F_{I-1,\infty})
\tag{4.20}
\end{equation}\]</span></p>
<p>The <span class="math inline">\((1-\alpha)\)</span> confidence interval for the inter-treatment FOM difference is given by:</p>
<p><span class="math display" id="eq:CIalpha1RMT">\[\begin{equation}
CI_{1-\alpha,1RMT} = (\theta_{i\bullet} - \theta_{i&#39;\bullet}) \pm t_{\alpha/2,\infty} \sqrt{2(Var-Cov_1)}
\tag{4.21}
\end{equation}\]</span></p>
<p>Comparing <a href="ORHAnalysis.html#eq:CIalpha1RMT">(4.21)</a> to <a href="ORHAnalysis.html#eq:UsefulTheorem">(4.7)</a> shows that the term <span class="math inline">\(\sqrt{2(Var-Cov_1)}\)</span> is the standard error of the inter-treatment FOM difference, whose square root is the standard deviation. The term <span class="math inline">\(t_{\alpha/2,\infty}\)</span> is -1.96. Therefore, the confidence interval is constructed by adding and subtracting 1.96 times the standard deviation of the difference from the central value. [One has probably encountered the rule that a 95% confidence interval is plus or minus two standard deviations from the central value. The “2” comes from rounding up 1.96.]</p>
</div>
<div id="comparing-dbm-to-obuchowski-and-rockette-for-single-reader-multiple-treatments" class="section level3" number="4.2.8">
<h3><span class="header-section-number">4.2.8</span> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</h3>
<p>We have shown two methods for analyzing a single reader in multiple treatments: the DBMH method, involving jackknife derived pseudovalues and the Obuchowski and Rockette method that does not have to use the jackknife, since it could use the bootstrap to get the covariance matrix, or some other methods such as the DeLong method, if one restricts to the Wilcoxon statistic for the figure of merit (empirical ROC-AUC). Since one is dealing with a single reader in multiple treatments, for DBMH one needs the fixed-reader random-case analysis described in §9.8 of the previous chapter (with one reader the conclusions obviousl apply to the specific reader, so reader must be regarded as a fixed factor).</p>
<p>Shown below are results obtained using RJafroc function <code>StSignificanceTesting</code> with <code>analysisOption = "FRRC"</code> for DBMH (which uses the jackknife), and for ORH using 3 different ways of estimating the covarince matrix (i.e., <span class="math inline">\(Cov_1\)</span> and <span class="math inline">\(Var\)</span>).</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="ORHAnalysis.html#cb24-1"></a>ret1 &lt;-<span class="st"> </span><span class="kw">StSignificanceTesting</span>(rocData1R,<span class="dt">FOM =</span> <span class="st">&quot;Wilcoxon&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;DBMH&quot;</span>, <span class="dt">analysisOption =</span> <span class="st">&quot;FRRC&quot;</span>)</span>
<span id="cb24-2"><a href="ORHAnalysis.html#cb24-2"></a><span class="kw">data.frame</span>(<span class="st">&quot;DBMH:F&quot;</span> =<span class="st"> </span>ret1<span class="op">$</span>FTestStatsFRRC<span class="op">$</span>fFRRC, </span>
<span id="cb24-3"><a href="ORHAnalysis.html#cb24-3"></a>           <span class="st">&quot;DBMH:ddf&quot;</span> =<span class="st"> </span>ret1<span class="op">$</span>FTestStatsFRRC<span class="op">$</span>ddfFRRC, </span>
<span id="cb24-4"><a href="ORHAnalysis.html#cb24-4"></a>           <span class="st">&quot;DBMH:P-val&quot;</span> =<span class="st"> </span>ret1<span class="op">$</span>FTestStatsFRRC<span class="op">$</span>pFRRC)</span>
<span id="cb24-5"><a href="ORHAnalysis.html#cb24-5"></a><span class="co">#&gt; data frame with 0 columns and 0 rows</span></span>
<span id="cb24-6"><a href="ORHAnalysis.html#cb24-6"></a></span>
<span id="cb24-7"><a href="ORHAnalysis.html#cb24-7"></a>ret2 &lt;-<span class="st"> </span><span class="kw">StSignificanceTesting</span>(rocData1R,<span class="dt">FOM =</span> <span class="st">&quot;Wilcoxon&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;ORH&quot;</span>, <span class="dt">analysisOption =</span> <span class="st">&quot;FRRC&quot;</span>)</span>
<span id="cb24-8"><a href="ORHAnalysis.html#cb24-8"></a><span class="kw">data.frame</span>(<span class="st">&quot;ORHJack:F&quot;</span> =<span class="st"> </span>ret2<span class="op">$</span>FTestStatsFRRC<span class="op">$</span>fFRRC, </span>
<span id="cb24-9"><a href="ORHAnalysis.html#cb24-9"></a>           <span class="st">&quot;ORHJack:ddf&quot;</span> =<span class="st"> </span>ret2<span class="op">$</span>FTestStatsFRRC<span class="op">$</span>ddfFRRC, </span>
<span id="cb24-10"><a href="ORHAnalysis.html#cb24-10"></a>           <span class="st">&quot;ORHJack:P-val&quot;</span> =<span class="st"> </span>ret2<span class="op">$</span>FTestStatsFRRC<span class="op">$</span>pFRRC)</span>
<span id="cb24-11"><a href="ORHAnalysis.html#cb24-11"></a><span class="co">#&gt; data frame with 0 columns and 0 rows</span></span>
<span id="cb24-12"><a href="ORHAnalysis.html#cb24-12"></a></span>
<span id="cb24-13"><a href="ORHAnalysis.html#cb24-13"></a>ret3 &lt;-<span class="st"> </span><span class="kw">StSignificanceTesting</span>(rocData1R,<span class="dt">FOM =</span> <span class="st">&quot;Wilcoxon&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;ORH&quot;</span>, <span class="dt">analysisOption =</span> <span class="st">&quot;FRRC&quot;</span>, </span>
<span id="cb24-14"><a href="ORHAnalysis.html#cb24-14"></a>                              <span class="dt">covEstMethod =</span> <span class="st">&quot;DeLong&quot;</span>)</span>
<span id="cb24-15"><a href="ORHAnalysis.html#cb24-15"></a><span class="kw">data.frame</span>(<span class="st">&quot;ORHDeLong:F&quot;</span> =<span class="st"> </span>ret3<span class="op">$</span>FTestStatsFRRC<span class="op">$</span>fFRRC, </span>
<span id="cb24-16"><a href="ORHAnalysis.html#cb24-16"></a>           <span class="st">&quot;ORHDeLong:ddf&quot;</span> =<span class="st"> </span>ret3<span class="op">$</span>FTestStatsFRRC<span class="op">$</span>ddfFRRC, </span>
<span id="cb24-17"><a href="ORHAnalysis.html#cb24-17"></a>           <span class="st">&quot;ORHDeLong:P-val&quot;</span> =<span class="st"> </span>ret3<span class="op">$</span>FTestStatsFRRC<span class="op">$</span>pFRRC)</span>
<span id="cb24-18"><a href="ORHAnalysis.html#cb24-18"></a><span class="co">#&gt; data frame with 0 columns and 0 rows</span></span>
<span id="cb24-19"><a href="ORHAnalysis.html#cb24-19"></a></span>
<span id="cb24-20"><a href="ORHAnalysis.html#cb24-20"></a>ret4 &lt;-<span class="st"> </span><span class="kw">StSignificanceTesting</span>(rocData1R,<span class="dt">FOM =</span> <span class="st">&quot;Wilcoxon&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;ORH&quot;</span>, <span class="dt">analysisOption =</span> <span class="st">&quot;FRRC&quot;</span>, </span>
<span id="cb24-21"><a href="ORHAnalysis.html#cb24-21"></a>                              <span class="dt">covEstMethod =</span> <span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb24-22"><a href="ORHAnalysis.html#cb24-22"></a><span class="kw">data.frame</span>(<span class="st">&quot;ORHBoot:F&quot;</span> =<span class="st"> </span>ret4<span class="op">$</span>FTestStatsFRRC<span class="op">$</span>fFRRC, </span>
<span id="cb24-23"><a href="ORHAnalysis.html#cb24-23"></a>           <span class="st">&quot;ORHBoot:ddf&quot;</span> =<span class="st"> </span>ret4<span class="op">$</span>FTestStatsFRRC<span class="op">$</span>ddfFRRC, </span>
<span id="cb24-24"><a href="ORHAnalysis.html#cb24-24"></a>           <span class="st">&quot;ORHBoot:P-val&quot;</span> =<span class="st"> </span>ret4<span class="op">$</span>FTestStatsFRRC<span class="op">$</span>pFRRC)</span>
<span id="cb24-25"><a href="ORHAnalysis.html#cb24-25"></a><span class="co">#&gt; data frame with 0 columns and 0 rows</span></span></code></pre></div>
<p>The DBMH and ORH-jackknife methods yield identical F-statistics, but the denominator degrees of freedom are different, <span class="math inline">\((I-1)(K-1)\)</span> = 113 for DBMH and <span class="math inline">\(\infty\)</span> for ORH. The F-statistics for ORH-bootstrap and ORH-DeLong are different.</p>
<p>Shown below is a first-principles implementation of signficance testing for the one-reader case.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="ORHAnalysis.html#cb25-1"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb25-2"><a href="ORHAnalysis.html#cb25-2"></a>theta_i &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>);<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>I) theta_i[i] &lt;-<span class="st"> </span><span class="kw">Wilcoxon</span>(zik1[i,], zik2[i,])</span>
<span id="cb25-3"><a href="ORHAnalysis.html#cb25-3"></a></span>
<span id="cb25-4"><a href="ORHAnalysis.html#cb25-4"></a>MS_T &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb25-5"><a href="ORHAnalysis.html#cb25-5"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>I) {</span>
<span id="cb25-6"><a href="ORHAnalysis.html#cb25-6"></a>  MS_T &lt;-<span class="st"> </span>MS_T <span class="op">+</span><span class="st"> </span>(theta_i[i]<span class="op">-</span><span class="kw">mean</span>(theta_i))<span class="op">^</span><span class="dv">2</span></span>
<span id="cb25-7"><a href="ORHAnalysis.html#cb25-7"></a>}</span>
<span id="cb25-8"><a href="ORHAnalysis.html#cb25-8"></a>MS_T &lt;-<span class="st"> </span>MS_T<span class="op">/</span>(I<span class="dv">-1</span>)</span>
<span id="cb25-9"><a href="ORHAnalysis.html#cb25-9"></a></span>
<span id="cb25-10"><a href="ORHAnalysis.html#cb25-10"></a>F_1R &lt;-<span class="st"> </span>MS_T<span class="op">/</span>(Var <span class="op">-</span><span class="st"> </span>Cov1)</span>
<span id="cb25-11"><a href="ORHAnalysis.html#cb25-11"></a>pValue &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pf</span>(F_1R, I<span class="dv">-1</span>, <span class="ot">Inf</span>)</span>
<span id="cb25-12"><a href="ORHAnalysis.html#cb25-12"></a></span>
<span id="cb25-13"><a href="ORHAnalysis.html#cb25-13"></a>trtDiff &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">c</span>(I,I))</span>
<span id="cb25-14"><a href="ORHAnalysis.html#cb25-14"></a><span class="cf">for</span> (i1 <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(I<span class="dv">-1</span>)) {    </span>
<span id="cb25-15"><a href="ORHAnalysis.html#cb25-15"></a>  <span class="cf">for</span> (i2 <span class="cf">in</span> (i1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>I) {</span>
<span id="cb25-16"><a href="ORHAnalysis.html#cb25-16"></a>    trtDiff[i1,i2] &lt;-<span class="st"> </span>theta_i[i1]<span class="op">-</span><span class="st"> </span>theta_i[i2]    </span>
<span id="cb25-17"><a href="ORHAnalysis.html#cb25-17"></a>  }</span>
<span id="cb25-18"><a href="ORHAnalysis.html#cb25-18"></a>}</span>
<span id="cb25-19"><a href="ORHAnalysis.html#cb25-19"></a>trtDiff &lt;-<span class="st"> </span>trtDiff[<span class="op">!</span><span class="kw">is.na</span>(trtDiff)]</span>
<span id="cb25-20"><a href="ORHAnalysis.html#cb25-20"></a>nDiffs &lt;-<span class="st"> </span>I<span class="op">*</span>(I<span class="dv">-1</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb25-21"><a href="ORHAnalysis.html#cb25-21"></a>CI_DIFF_FOM_1RMT &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">c</span>(nDiffs, <span class="dv">3</span>))</span>
<span id="cb25-22"><a href="ORHAnalysis.html#cb25-22"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="op">:</span><span class="st"> </span>nDiffs) {</span>
<span id="cb25-23"><a href="ORHAnalysis.html#cb25-23"></a>  CI_DIFF_FOM_1RMT[i,<span class="dv">1</span>] &lt;-<span class="st"> </span>trtDiff[i] <span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(alpha<span class="op">/</span><span class="dv">2</span>,  <span class="dt">df =</span> <span class="ot">Inf</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>(Var <span class="op">-</span><span class="st"> </span>Cov1))</span>
<span id="cb25-24"><a href="ORHAnalysis.html#cb25-24"></a>  CI_DIFF_FOM_1RMT[i,<span class="dv">2</span>] &lt;-<span class="st"> </span>trtDiff[i]</span>
<span id="cb25-25"><a href="ORHAnalysis.html#cb25-25"></a>  CI_DIFF_FOM_1RMT[i,<span class="dv">3</span>] &lt;-<span class="st"> </span>trtDiff[i] <span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dt">df =</span> <span class="ot">Inf</span>)<span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>(Var <span class="op">-</span><span class="st"> </span>Cov1))</span>
<span id="cb25-26"><a href="ORHAnalysis.html#cb25-26"></a>  <span class="kw">print</span>(<span class="kw">data.frame</span>(<span class="st">&quot;theta_1&quot;</span> =<span class="st"> </span>theta_i[<span class="dv">1</span>],</span>
<span id="cb25-27"><a href="ORHAnalysis.html#cb25-27"></a>                   <span class="st">&quot;theta_2&quot;</span> =<span class="st"> </span>theta_i[<span class="dv">2</span>],</span>
<span id="cb25-28"><a href="ORHAnalysis.html#cb25-28"></a>                   <span class="st">&quot;Var&quot;</span> =<span class="st"> </span>Var,</span>
<span id="cb25-29"><a href="ORHAnalysis.html#cb25-29"></a>                   <span class="st">&quot;Cov1&quot;</span> =<span class="st"> </span>Cov1,</span>
<span id="cb25-30"><a href="ORHAnalysis.html#cb25-30"></a>                   <span class="st">&quot;MS_T&quot;</span> =<span class="st"> </span>MS_T,</span>
<span id="cb25-31"><a href="ORHAnalysis.html#cb25-31"></a>                   <span class="st">&quot;F_1R&quot;</span> =<span class="st"> </span>F_1R, </span>
<span id="cb25-32"><a href="ORHAnalysis.html#cb25-32"></a>                   <span class="st">&quot;pValue&quot;</span> =<span class="st"> </span>pValue,</span>
<span id="cb25-33"><a href="ORHAnalysis.html#cb25-33"></a>                   <span class="st">&quot;Lower&quot;</span> =<span class="st"> </span>CI_DIFF_FOM_1RMT[i,<span class="dv">1</span>], </span>
<span id="cb25-34"><a href="ORHAnalysis.html#cb25-34"></a>                   <span class="st">&quot;Mid&quot;</span> =<span class="st"> </span>CI_DIFF_FOM_1RMT[i,<span class="dv">2</span>], </span>
<span id="cb25-35"><a href="ORHAnalysis.html#cb25-35"></a>                   <span class="st">&quot;Upper&quot;</span> =<span class="st"> </span>CI_DIFF_FOM_1RMT[i,<span class="dv">3</span>]))</span>
<span id="cb25-36"><a href="ORHAnalysis.html#cb25-36"></a>}</span>
<span id="cb25-37"><a href="ORHAnalysis.html#cb25-37"></a><span class="co">#&gt;      theta_1    theta_2           Var         Cov1          MS_T      F_1R</span></span>
<span id="cb25-38"><a href="ORHAnalysis.html#cb25-38"></a><span class="co">#&gt; 1 0.91964573 0.94782609 0.00069890056 0.0003734661 0.00039706618 1.2201111</span></span>
<span id="cb25-39"><a href="ORHAnalysis.html#cb25-39"></a><span class="co">#&gt;       pValue        Lower          Mid       Upper</span></span>
<span id="cb25-40"><a href="ORHAnalysis.html#cb25-40"></a><span class="co">#&gt; 1 0.26933885 -0.078183215 -0.028180354 0.021822507</span></span></code></pre></div>
<p>Next, how does it compare to <code>RJafroc</code> <code>FRRC</code> analysis using the <code>StSignificanceTesting</code> function?</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="ORHAnalysis.html#cb26-1"></a>ret_rj &lt;-<span class="st"> </span><span class="kw">StSignificanceTesting</span>(rocData1R, <span class="dt">FOM =</span> <span class="st">&quot;Wilcoxon&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;ORH&quot;</span>, <span class="dt">analysisOption =</span> <span class="st">&quot;FRRC&quot;</span>)</span>
<span id="cb26-2"><a href="ORHAnalysis.html#cb26-2"></a><span class="kw">print</span>(<span class="kw">data.frame</span>(<span class="st">&quot;theta_1&quot;</span> =<span class="st"> </span>ret_rj<span class="op">$</span>fomArray[<span class="dv">1</span>],</span>
<span id="cb26-3"><a href="ORHAnalysis.html#cb26-3"></a>                <span class="st">&quot;theta_2&quot;</span> =<span class="st"> </span>ret_rj<span class="op">$</span>fomArray[<span class="dv">2</span>],</span>
<span id="cb26-4"><a href="ORHAnalysis.html#cb26-4"></a>                <span class="st">&quot;Var&quot;</span> =<span class="st"> </span>ret_rj<span class="op">$</span>varComp<span class="op">$</span>var,</span>
<span id="cb26-5"><a href="ORHAnalysis.html#cb26-5"></a>                <span class="st">&quot;Cov1&quot;</span> =<span class="st"> </span>ret_rj<span class="op">$</span>varComp<span class="op">$</span>cov,</span>
<span id="cb26-6"><a href="ORHAnalysis.html#cb26-6"></a>                <span class="st">&quot;MS_T&quot;</span> =<span class="st"> </span>ret_rj<span class="op">$</span>msT,</span>
<span id="cb26-7"><a href="ORHAnalysis.html#cb26-7"></a>                <span class="st">&quot;F_1R&quot;</span> =<span class="st"> </span>ret_rj<span class="op">$</span>FTestStatsFRRC<span class="op">$</span>fFRRC, </span>
<span id="cb26-8"><a href="ORHAnalysis.html#cb26-8"></a>                <span class="st">&quot;pValue&quot;</span> =<span class="st"> </span>ret_rj<span class="op">$</span>FTestStatsFRRC<span class="op">$</span>pFRRC,</span>
<span id="cb26-9"><a href="ORHAnalysis.html#cb26-9"></a>                <span class="st">&quot;Lower&quot;</span> =<span class="st"> </span>ret_rj<span class="op">$</span>ciDiffTrtFRRC<span class="op">$</span>CILower, </span>
<span id="cb26-10"><a href="ORHAnalysis.html#cb26-10"></a>                <span class="st">&quot;Mid&quot;</span> =<span class="st"> </span>ret_rj<span class="op">$</span>ciDiffTrtFRRC<span class="op">$</span>Estimate, </span>
<span id="cb26-11"><a href="ORHAnalysis.html#cb26-11"></a>                <span class="st">&quot;Upper&quot;</span> =<span class="st"> </span>ret_rj<span class="op">$</span>ciDiffTrtFRRC<span class="op">$</span>CIUpper))</span>
<span id="cb26-12"><a href="ORHAnalysis.html#cb26-12"></a><span class="co">#&gt; data frame with 0 columns and 0 rows</span></span></code></pre></div>
<p>The first-principles and the <code>RJafroc</code> values agree exactly with each other. This above code also shows how to extract the different estimates (<span class="math inline">\(Var\)</span>, <span class="math inline">\(Cov_1\)</span>, etc.) from the object <code>ret_rj</code> returned by <code>RJafroc</code>.</p>
<ul>
<li>Var: ret_rj$varComp$var</li>
<li>Cov1: ret_rj$varComp$cov</li>
<li>F-statistic: ret_rj$FTestStatsFRRC$fFRRC</li>
<li>ddf: ret_rj$FTestStatsFRRC$ddfFRRC</li>
<li>p-value: ret_rj$FTestStatsFRRC$pFRRC</li>
<li>CI Lower: ret_rj$ciDiffTrtFRRC$CILower</li>
<li>Mid Value: ret_rj$ciDiffTrtFRRC$Estimate</li>
<li>CI Upper: ret_rj$ciDiffTrtFRRC$CIUpper</li>
</ul>
<div id="jumping-ahead" class="section level4" number="4.2.8.1">
<h4><span class="header-section-number">4.2.8.1</span> Jumping ahead</h4>
<p>If RRRC analysis were conducted, the values would be:</p>
<ul>
<li>msR: ret_rj$meanSquares$msR</li>
<li>msT: ret_rj$meanSquares$msT</li>
<li>msTR: ret_rj$meanSquares$msTR</li>
<li>Var: ret_rj$varComp$var</li>
<li>Cov1: ret_rj$varComp$cov</li>
<li>Cov2: ret_rj$varComp$cov2</li>
<li>Cov3: ret_rj$varComp$cov3</li>
<li>varR: ret_rj$varComp$varR</li>
<li>varTR: ret_rj$varComp$varTR</li>
<li>F-statistic: ret_rj$FTestStatsRRRC$fRRRC</li>
<li>ddf: ret_rj$FTestStatsRRRC$ddfRRRC</li>
<li>p-value: ret_rj$FTestStatsRRRC$pRRRC</li>
<li>CI Lower: ret_rj$ciDiffTrtRRRC$CILower</li>
<li>Mid Value: ret_rj$ciDiffTrtRRRC$Estimate</li>
<li>CI Upper: ret_rj$ciDiffTrtRRRC$CIUpper</li>
</ul>
<p>And similarly, for RRFC analysis, one replaces RRRC with RRFC.]</p>
</div>
</div>
</div>
<div id="multiple-reader-multiple-treatment-orh-model" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Multiple-reader multiple-treatment ORH model</h2>
<p>The previous sections served as a gentle introduction to the single-reader multiple-treatment Obuchowski and Rockette method. This section extends it to multiple-readers interpreting a common case-set in multiple-treatments (MRMC). The extension is, in principle, fairly straightforward. Compared to <a href="ORHAnalysis.html#eq:ORModel1RMT">(4.1)</a>, one needs an additional <span class="math inline">\(j\)</span> index to index readers, and additional random terms to model reader and treatment-reader variability, and the error term needs to be modified to account for the additional random reader factor.</p>
<p>The general Obuchowski and Rockette model for fully paired multiple-reader multiple-treatment interpretations is:</p>
<p><span class="math display" id="eq:ORModel">\[\begin{equation}
\theta_{ij\{c\}}=\mu+\tau_i+R_j+(\tau R)_{ij}+\epsilon_{ij\{c\}}
\tag{4.22}
\end{equation}\]</span></p>
<p>The fixed treatment effect <span class="math inline">\(\tau_i\)</span> is subject to the usual constraint, <a href="ORHAnalysis.html#eq:ConstraintTau">(4.2)</a>. The first two terms on the right hand side of <a href="ORHAnalysis.html#eq:ORModel">(4.22)</a> have their usual meanings: a constant term <span class="math inline">\(\mu\)</span> representing performance averaged over treatments and readers, and a treatment effect <span class="math inline">\(\tau_i\)</span> (<span class="math inline">\(i\)</span> = 1,2, …, <span class="math inline">\(I\)</span>). The following two terms are, by assumption, mutually independent random samples specified as follows: <span class="math inline">\(R_j\)</span> denotes the random treatment-independent contribution to the figure-of-merit of reader <span class="math inline">\(j\)</span> (<span class="math inline">\(j\)</span> = 1,2, …, <span class="math inline">\(J\)</span>), modeled as a sample from a zero-mean normal distribution with variance <span class="math inline">\(\sigma_R^2\)</span>; <span class="math inline">\((\tau R)_{ij}\)</span> denotes the treatment-dependent random contribution of reader <span class="math inline">\(j\)</span> in treatment <span class="math inline">\(i\)</span>, modeled as a sample from a zero-mean normal distribution with variance <span class="math inline">\(\sigma_{\tau R}^2\)</span>. There could be a perceived notational clash with similar variance component terms defined for the DBMH model – except in that case they applied to pseudovalues. The meaning should be clear from the context. Summarizing:</p>
<p><span class="math display" id="eq:ORVariances">\[\begin{equation}
\left\{\begin{matrix}
R_j \sim N(0,\sigma_R^2)\\ 
{\tau R} \sim N(0,\sigma_{\tau R}^2)
\end{matrix}\right.
\tag{4.23}
\end{equation}\]</span></p>
<p>For a single dataset <span class="math inline">\(c\)</span> = 1. An estimate of <span class="math inline">\(\mu\)</span> follows from averaging over the <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> indices (the averages over the random terms are zeroes):</p>
<p><span class="math display" id="eq:ORmuEstimate">\[\begin{equation}
\mu = \theta_{\bullet \bullet \{1\}}
\tag{4.24}
\end{equation}\]</span></p>
<p>As before the dot subscript denotes an average over the replaced index. Averaging over the j index and performing a subtraction yields an estimate of :</p>
<p><span class="math display" id="eq:ORtauEstimate">\[\begin{equation}
\tau_i = \theta_{i \bullet \{1\}} - \theta_{\bullet \bullet \{1\}}
\tag{4.25}
\end{equation}\]</span></p>
<p>The <span class="math inline">\(\tau_i\)</span> estimates obey the constraint <a href="ORHAnalysis.html#eq:ConstraintTau">(4.2)</a>. For example, with two treatments, the values of <span class="math inline">\(\tau_i\)</span> must be the negatives of each other: <span class="math inline">\(\tau_1=-\tau_2\)</span>.</p>
<p>The error term on the right hand side of <a href="ORHAnalysis.html#eq:ORModel">(4.22)</a> is more complex than the corresponding DBM model error term. Obuchowski and Rockette model this term with a multivariate normal distribution with a length <span class="math inline">\((IJ)\)</span> zero-mean vector and a <span class="math inline">\((IJ \times IJ)\)</span> dimensional covariance matrix <span class="math inline">\(\Sigma\)</span>. In other words,</p>
<p><span class="math display" id="eq:OREpsSampling">\[\begin{equation}
\epsilon_{ij\{c\}} \sim N_{IJ}(\vec{0},\Sigma)
\tag{4.26}
\end{equation}\]</span></p>
<p>Here <span class="math inline">\(N_{IJ}\)</span> is the <span class="math inline">\(N_{IJ}\)</span> variate normal distribution. The covariance matrix <span class="math inline">\(\Sigma\)</span> is defined by 4 parameters, <span class="math inline">\(Var, Cov_1, Cov_2, Cov_3\)</span>, defined as follows:</p>
<p><span class="math display" id="eq:ORVarCov">\[\begin{equation}
Cov(\epsilon_{ij\{c\}},\epsilon_{i&#39;j&#39;\{c\}}) =
\left\{\begin{matrix}
Var \; (i=i&#39;,j=j&#39;) \\
Cov1 \; (i\ne i&#39;,j=j&#39;)\\ 
Cov2 \; (i = i&#39;,j \ne j&#39;)\\ 
Cov3 \; (i\ne i&#39;,j \ne j&#39;)
\end{matrix}\right\}
\tag{4.27}
\end{equation}\]</span></p>
<p>Apart from fixed effects, the model implied by <a href="ORHAnalysis.html#eq:ORModel">(4.22)</a> and <a href="ORHAnalysis.html#eq:ORVarCov">(4.27)</a> contains 6 parameters:</p>
<p><span class="math display">\[\sigma_R^2,\sigma_{\tau R}^2,Var,Cov_1,Cov_2,Cov_3\]</span></p>
<p>This is the same number of variance component parameters as in the DBMH model, which should not be a surprise since one is modeling the data with equivalent models. The Obuchowski and Rockette model <a href="ORHAnalysis.html#eq:ORModel">(4.22)</a> “looks” simpler because four covariance terms are encapsulated in the <span class="math inline">\(\epsilon\)</span> term. As with the singe-reader multiple-treatment model, the covariance matrix is assumed to be independent of treatment or reader, as allowing treatment and reader dependencies would greatly increase the number of parameters that would need to be estimated.</p>
<p><em>It is implicit in the Obuchowski-Rockette model that the <span class="math inline">\(Var\)</span>, <span class="math inline">\(Cov_1\)</span>, Cov_2$, and <span class="math inline">\(Cov_3\)</span>, estimates need to be averaged over all applicable treatment-reader combinations.</em></p>
<div id="StrCovMatrix" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Structure of the covariance matrix</h3>
<p>To understand the structure of this matrix, recall that the diagonal elements of a (square) covariance matrix are variances and the off-diagonal elements are covariances. With two indices <span class="math inline">\(ij\)</span> one can still imagine a square matrix where each dimension is labeled by a pair of indices <span class="math inline">\(ij\)</span>. One <span class="math inline">\(ij\)</span> pair corresponds to the horizontal direction, and the other <span class="math inline">\(ij\)</span> pair corresponds to the vertical direction. To visualize this let consider the simpler situation of two treatments (<span class="math inline">\(I = 2\)</span>) and three readers (<span class="math inline">\(J = 3\)</span>). The resulting 6x6 covariance matrix would look like this:</p>
<p><span class="math display">\[
\Sigma=
\begin{bmatrix}
(11,11) &amp; (12,11) &amp; (13,11) &amp; (21,11) &amp; (22,11) &amp; (23,11) \\
&amp; (12,12) &amp; (13,12) &amp; (21,12) &amp; (22,12) &amp; (23,12) \\ 
&amp; &amp; (13,13) &amp; (21,13) &amp; (22,13) &amp; (23,13) \\ 
&amp; &amp; &amp; (21,21) &amp; (22,21) &amp; (23,21) \\
&amp; &amp; &amp; &amp; (22,22) &amp; (23,22) \\ 
&amp; &amp; &amp; &amp; &amp; (23,23)
\end{bmatrix}
\]</span></p>
<p>Shown in each cell of the matrix is a pair of ij-values, serving as column indices, followed by a pair of ij-values serving as row indices, and a comma separates the pairs. For example, the first column is labeled by (11,xx), where xx depends on the row. The second column is labeled (12,xx), the third column is labeled (13,xx), and the remaining columns are successively labeled (21,xx), (22,xx) and (23,xx). Likewise, the first row is labeled by (yy,11), where yy depends on the column. The following rows are labeled (yy,12), (yy,13), (yy,21), (yy,22)and (yy,23). Note that the reader index increments faster than the treatment index.</p>
<p>The diagonal elements are evidently those cells where the row and column index-pairs are equal. These are (11,11), (12,12), (13,13), (21,21), (22,22) and (23,23). According to <a href="ORHAnalysis.html#eq:ORVarCov">(4.27)</a> the entries in these cells would be <span class="math inline">\(Var\)</span>.</p>
<p><span class="math display">\[
\Sigma=
\begin{bmatrix}
Var &amp; (12,11) &amp; (13,11) &amp; (21,11) &amp; (22,11) &amp; (23,11) \\
&amp; Var &amp; (13,12) &amp; (21,12) &amp; (22,12) &amp; (23,12) \\ 
&amp; &amp; Var &amp; (21,13) &amp; (22,13) &amp; (23,13) \\ 
&amp; &amp; &amp; Var &amp; (22,21) &amp; (23,21) \\
&amp; &amp; &amp; &amp; Var &amp; (23,22) \\ 
&amp; &amp; &amp; &amp; &amp; Var
\end{bmatrix}
\]</span></p>
<p>According to <a href="ORHAnalysis.html#eq:ORVarCov">(4.27)</a> the entries in cells with <em>different treatment index pairs but identical reader index pairs</em> would be <span class="math inline">\(Cov_1\)</span> (as an example, the cell (21,11) has the same reader index, namely reader 1, but different treatment indices, namely 2 and 1, so it is replaced by <span class="math inline">\(Cov_1\)</span>):</p>
<p><span class="math display">\[
\Sigma=
\begin{bmatrix}
Var &amp; (12,11) &amp; (13,11) &amp; Cov_1 &amp; (22,11) &amp; (23,11) \\
&amp; Var &amp; (13,12) &amp; (21,12) &amp; Cov_1 &amp; (23,12) \\ 
&amp; &amp; Var &amp; (21,13) &amp; (22,13) &amp; Cov_1 \\ 
&amp; &amp; &amp; Var &amp; (22,21) &amp; (23,21) \\
&amp; &amp; &amp; &amp; Var &amp; (23,22) \\ 
&amp; &amp; &amp; &amp; &amp; Var
\end{bmatrix}
\]</span></p>
<p>Similarly, the entries in cells with identical treatment index pairs but different reader index pairs would be <span class="math inline">\(Cov_2\)</span>:</p>
<p><span class="math display">\[
\Sigma=
\begin{bmatrix}
Var &amp; Cov_2 &amp; Cov_2 &amp; Cov_1 &amp; (22,11) &amp; (23,11) \\
&amp; Var &amp; Cov_2 &amp; (21,12) &amp; Cov_1 &amp; (23,12) \\ 
&amp;  &amp; Var &amp; (21,13) &amp; (22,13) &amp; Cov_1 \\ 
&amp;  &amp;  &amp; Var &amp; Cov_2 &amp; Cov_2 \\
&amp;  &amp;  &amp;  &amp; Var &amp; Cov_2 \\ 
&amp;  &amp;  &amp;  &amp;  &amp; Var
\end{bmatrix}
\]</span></p>
<p>Finally, the entries in cells with different treatment index pairs and different reader index pairs would be <span class="math inline">\(Cov_3\)</span>:</p>
<p><span class="math display">\[
\Sigma=
\begin{bmatrix}
Var &amp; Cov_2 &amp; Cov_2 &amp; Cov_1 &amp; Cov_3 &amp; Cov_3 \\
&amp; Var &amp; Cov_2 &amp; Cov_3 &amp; Cov_1 &amp; Cov_3 \\ 
&amp;  &amp; Var &amp; Cov_3 &amp; Cov_3 &amp; Cov_1 \\ 
&amp;  &amp;  &amp; Var &amp; Cov_2 &amp; Cov_2 \\
&amp;  &amp;  &amp;  &amp; Var &amp; Cov_2 \\ 
&amp;  &amp;  &amp;  &amp;  &amp; Var
\end{bmatrix}
\]</span></p>
<p>To understand these terms consider how they might be estimated. Suppose one had the luxury of repeating the study with different case-sets, c = 1, 2, …, C. Then the variance term <span class="math inline">\(Var\)</span> can be estimated as follows:</p>
<p><span class="math display" id="eq:EstVariance">\[\begin{equation}
Var=
\left \langle \frac{1}{C-1}\sum_{c=1}^{C} (\theta_{ij\{c\}}-\theta_{ij\{\bullet\}})^2 (\theta_{ij\{c\}}-\theta_{ij\{\bullet\}})^2 \right \rangle_{ij}
\epsilon_{ij\{c\}} \sim N_{IJ}(\vec{0},\Sigma)
\tag{4.28}
\end{equation}\]</span></p>
<p>Of course, in practice one would use the bootstrap or the jackknife as a stand-in for the c-index, but for pedagogic purpose, one maintains the fiction that one has a large number of case-sets at one’s disposal (not to mention the time spent by the readers interpreting them). Notice that the left-hand-side of <a href="ORHAnalysis.html#eq:EstVariance">(4.28)</a> lacks treatment or reader indices. This is because implicit in the notation is averaging the observed variances over all treatments and readers, as implied by <span class="math inline">\(\left \langle \right \rangle _{ij}\)</span>. Likewise, the covariance terms are estimated as follows:</p>
<p><span class="math display" id="eq:EstCov">\[\begin{equation}
Cov=\left\{\begin{matrix}
Cov_1=\left \langle \frac{1}{C-1}\sum_{c=1}^{C} (\theta_{ij\{c\}}-\theta_{ij\{\bullet\}})^2 (\theta_{i&#39;j\{c\}}-\theta_{i&#39;j\{\bullet\}})^2 \right \rangle_{ii&#39;,jj}\\ 
Cov_2=\left \langle \frac{1}{C-1}\sum_{c=1}^{C} (\theta_{ij\{c\}}-\theta_{ij\{\bullet\}})^2 (\theta_{ij&#39;\{c\}}-\theta_{ij&#39;\{\bullet\}})^2 \right \rangle_{ii,jj&#39;}\\ 
Cov_3=\left \langle \frac{1}{C-1}\sum_{c=1}^{C} (\theta_{ij\{c\}}-\theta_{ij\{\bullet\}})^2 (\theta_{i&#39;j&#39;\{c\}}-\theta_{i&#39;j&#39;\{\bullet\}})^2 \right \rangle_{ii&#39;,jj&#39;}
\end{matrix}\right.
\tag{4.29}
\end{equation}\]</span></p>
<p><em>In <a href="ORHAnalysis.html#eq:EstCov">(4.29)</a> the convention is that primed and unprimed variables are always different.</em></p>
<p>Since there are no treatment and reader dependencies on the left-hand-sides of the above equations, one averages the estimates as follows:</p>
<ul>
<li>For <span class="math inline">\(Cov_1\)</span> one averages over all combinations of <em>different treatments and same readers</em>, as denoted by <span class="math inline">\(\left \langle \right \rangle_{ii&#39;,jj}\)</span>.</li>
<li>For <span class="math inline">\(Cov_2\)</span> one averages over all combinations of <em>same treatment and different readers</em>, as denoted by <span class="math inline">\(\left \langle \right \rangle_{ii,jj&#39;}\)</span>.</li>
<li>For <span class="math inline">\(Cov_3\)</span> one averages over all combinations of <em>different treatments and different readers</em>, as denoted by <span class="math inline">\(\left \langle \right \rangle_{ii&#39;,jj&#39;}\)</span>.</li>
</ul>
</div>
<div id="physical-meanings-of-the-covariance-terms" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Physical meanings of the covariance terms</h3>
<p>The meanings of the different terms follow a similar description to that given in <a href="ORHAnalysis.html#StrCovMatrix">4.3.1</a>. The diagonal term <span class="math inline">\(Var\)</span> of the covariance matrix <span class="math inline">\(\Sigma\)</span> is the variance of the figure-of-merit values obtained when reader <span class="math inline">\(j\)</span> interprets different case-sets in treatment <span class="math inline">\(i\)</span>: each case-set yields a number <span class="math inline">\(\theta_{ij\{c\}}\)</span> and the variance of the <span class="math inline">\(C\)</span> numbers, averaged over the <span class="math inline">\(I \times J\)</span> treatments and readers, is <span class="math inline">\(Var\)</span>. It captures the total variability due to varying difficulty levels of the case-sets and within-reader variability.</p>
<p><span class="math inline">\(\rho_{1;ii&#39;jj}\)</span> is the correlation of the figure-of-merit values obtained when the same reader <span class="math inline">\(j\)</span> interprets a case-set in different treatment <span class="math inline">\(i,i&#39;\)</span>. Each case-set, starting with <span class="math inline">\(c = 1\)</span>, yields two numbers <span class="math inline">\(\theta_{ij\{1\}}\)</span> and <span class="math inline">\(\theta_{i&#39;j\{1\}}\)</span>; the process is repeated for <span class="math inline">\(C\)</span> case-sets. The correlation of the two pairs of C-length arrays, averaged over all pairings of different treatments and same readers, is <span class="math inline">\(\rho_1\)</span>. Because of the common contribution due to the shared reader, <span class="math inline">\(\rho_1\)</span> will be non-zero. For large common variation, the two arrays become almost perfectly correlated, and <span class="math inline">\(\rho_1\)</span> approaches unity. For zero common variation, the two arrays become independent, and <span class="math inline">\(\rho_1\)</span> equals zero. Translating to covariances, one has <span class="math inline">\(Cov_1 &lt; Var\)</span>.</p>
<p><span class="math inline">\(\rho_{2;iijj&#39;}\)</span> is the correlation of the figure-of-merit values obtained when different readers <span class="math inline">\(j,j&#39;\)</span> interpret the same case-set in the same treatment <span class="math inline">\(i\)</span>. As before this yields two numbers and upon repeating over <span class="math inline">\(C\)</span> case-sets one has two C-length arrays, whose correlation, upon averaging over all distinct treatment pairings and same readers, yields <span class="math inline">\(\rho_2\)</span>. If one assumes that common variation between different-reader same-treatment FOMs is smaller than the common variation between same-reader different-treatment FOMs, then <span class="math inline">\(\rho_2\)</span> will be smaller than <span class="math inline">\(\rho_1\)</span>. This is equivalent to stating that readers agree more with themselves on different treatments than they do with other readers on the same treatment. Translating to covariances, one has <span class="math inline">\(Cov_2 &lt; Cov_1 &lt; Var\)</span>.</p>
<p><span class="math inline">\(\rho_{3;ii&#39;jj&#39;}\)</span> is the correlation of the figure-of-merit values obtained when different readers <span class="math inline">\(j,j&#39;\)</span> interpret the same case set in different treatments <span class="math inline">\(i,i&#39;\)</span>, etc., yielding <span class="math inline">\(\rho_3\)</span>. This is expected to yield the least correlation.</p>
<p>Summarizing, one expects the following ordering for the terms in the covariance matrix:</p>
<p><span class="math display" id="eq:CovOrderings">\[\begin{equation}
Cov_3 &lt; Cov_2 &lt; Cov_1 &lt; Var
\tag{4.30}
\end{equation}\]</span></p>
</div>
<div id="orh-random-reader-random-case-analysis" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> ORH random-reader random-case analysis</h3>
<p>A model such as <a href="ORHAnalysis.html#eq:ORModel">(4.22)</a> cannot be analyzed by standard analysis of variance (ANOVA) techniques. Because of the correlated structure of the error term a customized ANOVA is needed (in standard ANOVA models, such as used in DBMH, the covariance matrix of the error term is diagonal with all diagonal elements equal to a common variance, represented by the epsilon term in the DBM model).</p>
<p>One starts with the null hypothesis (NH) that the true figures-of-merit of all treatments are identical, i.e.,</p>
<p><span class="math display" id="eq:ORModelNH">\[\begin{equation}
NH:\tau_i=0\;\; (i=1,2,...,I)
\tag{4.31}
\end{equation}\]</span></p>
<p>The analysis described next considers both readers and cases as random effects. Because of the special nature of the covariance matrix, a modified F-statistic is needed 1-4,7, denoted <span class="math inline">\(F_{ORH}\)</span>, defined by:</p>
<p><span class="math display" id="eq:F-ORH">\[\begin{equation}
F_{ORH}=\frac{MS(T)}{MS(TR)+J\max(Cov_2-Cov_3,0)}
\tag{4.32}
\end{equation}\]</span></p>
<p><a href="ORHAnalysis.html#eq:F-ORH">(4.32)</a> incorporates Hillis’ modification, which ensures that the constraint <a href="ORHAnalysis.html#eq:CovOrderings">(4.30)</a> is always obeyed and avoids a possibly negative (hence illegal) F-statistic. The mean square (MS) terms are defined by (these are calculated directly using FOM values, not pseudovalues):</p>
<p><span class="math display" id="eq:MS-ORH">\[\begin{equation}
\left.\begin{matrix}
MS(T)=\frac{J}{I-1}\sum_{i=1}^{I}(\theta_{i\bullet}-\theta_{\bullet\bullet})^2\\
\\ 
MS(TR)=\frac{1}{(I-1)(J-1)}\sum_{i=1}^{I}\sum_{j=1}^{J}(\theta_{ij}-\theta_{i\bullet}-\theta_{\bullet j}+\theta_{\bullet\bullet})
\end{matrix}\right\}
\tag{4.33}
\end{equation}\]</span></p>
<p>In their original paper <span class="citation">(Obuchowski and Rockette <a href="#ref-RN1450" role="doc-biblioref">1995</a>)</span> Obuchowski and Rockette state that their proposed test statistic F (basically <a href="ORHAnalysis.html#eq:F-ORH">(4.32)</a> without the constraint implied by the <span class="math inline">\(\max\)</span> function) is distributed as an F-statistic with numerator degree of freedom <span class="math inline">\(ndf=I-1\)</span> and denominator degree of freedom <span class="math inline">\(ddf=(I-1)(J-1)\)</span>. It turns out that then the test is unduly conservative, meaning it is unusually reluctant to reject the null hypothesis.</p>
<p>In this connection the author has two historical anecdotes. The late Dr. Robert F. Wagner once stated to the author (ca. 2001) that the sample-size tables published by Obuchowski <span class="citation">(Obuchowski <a href="#ref-RN1971" role="doc-biblioref">1998</a>, <a href="#ref-RN1972" role="doc-biblioref">2000</a>)</span>, using the unmodified version of <a href="ORHAnalysis.html#eq:F-ORH">(4.32)</a>, predicted such high number of readers and cases that he was doubtful about the chances of anyone conducting a practical ROC study.</p>
<p>The second story is that the author once conducted NH simulations using the Roe-Metz simulator described in the preceding chapter and the significance testing as described in the Obuchowski-Rockette paper: the method did not reject the null hypothesis even once in 2000 trials! Recall that with <span class="math inline">\(\alpha = 0.05\)</span> a valid test should reject the null hypothesis about <span class="math inline">\(100\pm20\)</span> times in 2000 trials. The author recalls (ca. 2004) telling Dr. Steve Hillis about this issue, and he suggested a different value for the denominator degrees of freedom (ddf), substitution of which magically solved the problem, i.e., the simulations rejected the null hypothesis about 5% of the time; the new <span class="math inline">\(ddf\)</span> is defined below (<span class="math inline">\(ndf\)</span> is unchanged), with the subscript H denoting the Hillis modification:</p>
<p><span class="math display" id="eq:ndf">\[\begin{equation}
ndf=I-1
\tag{4.34}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:ddfH">\[\begin{equation}
ddf_H=\frac{\left [ MS(TR) + J \max(Cov_2-Cov_3)\right ]^2}{\frac{\left [ MS(TR) \right ]^2}{(I-1)(J-1)}}
\tag{3.19}
\end{equation}\]</span></p>
<p>If <span class="math inline">\(Cov_2&lt;Cov_3\)</span> this reduces to the expression originally suggested by Obuchowski and Rockette. With these changes, under the null hypothesis, the observed statistic <span class="math inline">\(F_{ORH}\)</span>, defined in <a href="ORHAnalysis.html#eq:F-ORH">(4.32)</a>, is distributed as an F-statistic with <span class="math inline">\(I-1\)</span> and <span class="math inline">\(ddf_H\)</span> degrees of freedom <span class="citation">(Hillis et al. <a href="#ref-RN1772" role="doc-biblioref">2005</a>; Hillis <a href="#ref-RN1865" role="doc-biblioref">2007</a>; Hillis, Berbaum, and Metz <a href="#ref-RN1866" role="doc-biblioref">2008</a>)</span>:</p>
<p><span class="math display" id="eq:SamplingDistrF-ORH">\[\begin{equation}
F_{ORH}\sim F_{ndf,ddf_H}
\tag{4.35}
\end{equation}\]</span></p>
<div id="decision-rule-p-value-and-confidence-interval" class="section level4" number="4.3.3.1">
<h4><span class="header-section-number">4.3.3.1</span> Decision rule, p-value and confidence interval</h4>
<p>The critical value of the F-statistic for rejection of the null hypothesis is <span class="math inline">\(F_{1-\alpha,ndf,ddf_H}\)</span>, i.e., that value such that fraction <span class="math inline">\((1-\alpha)\)</span> of the area under the distribution lies to the left of the critical value. From definition <a href="ORHAnalysis.html#eq:F-ORH">(4.32)</a>, rejection of the NH is more likely if <span class="math inline">\(MS(T)\)</span> increases, meaning the treatment effect is larger; <span class="math inline">\(MS(TR)\)</span> decreases meaning there is less contamination of the treatment effect by treatment-reader variability; the greater of <span class="math inline">\(Cov2\)</span> or <span class="math inline">\(Cov3\)</span> decreases, meaning there is less contamination of the treatment effect by between-reader and treatment-reader variability, <span class="math inline">\(\alpha\)</span> increases, meaning one is allowing a greater probability of Type I errors, <span class="math inline">\(ndf\)</span> increases, meaning the more the number of treatment pairings, the greater the chance that at least one pair will reject the NH or <span class="math inline">\(ddf_H\)</span> increases, as this lowers the critical value of the F-statistic.</p>
<p>The p-value of the test is the probability, under the NH, that an equal or larger value of the F-statistic than <span class="math inline">\(F_{ORH}\)</span> could be observed by chance. In other words, it is the area under the F-distribution <span class="math inline">\(F_{ndf,ddf_H}\)</span> that lies above the observed value <span class="math inline">\(F_{ORH}\)</span>:</p>
<p><span class="math display" id="eq:pValueORHRRRC">\[\begin{equation}
p=\Pr(F&gt;F_{ORH} \mid F\sim F_{ndf,ddf_H})
\tag{4.36}
\end{equation}\]</span></p>
<p>The <span class="math inline">\((1-\alpha)\)</span> confidence interval for <span class="math inline">\(\theta_{i \bullet} - \theta_{i&#39; \bullet}\)</span> is given by (the average is over the reader index; the case-set index <span class="math inline">\(\{1\}\)</span> is suppressed):</p>
<p><span class="math display" id="eq:CIalpha-RRRC">\[\begin{equation}
CI_{1-\alpha,RRRC}=(\theta_{i \bullet} - \theta_{i&#39; \bullet}) \pm t_{\alpha/2, (ddf_H}\sqrt{\frac{2}{J}(MS(TR)+J\max(Cov_2-Cov_3,0))}
\tag{4.37}
\end{equation}\]</span></p>
</div>
</div>
<div id="fixed-reader-random-case-frrc-analysis-1" class="section level3" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Fixed-reader random-case (FRRC) analysis</h3>
<p>Using the vertical bar notation <span class="math inline">\(\mid R\)</span> to denote that reader is regarded as a fixed effect <span class="citation">(Roe and Metz <a href="#ref-RN1124" role="doc-biblioref">1997</a>)</span>, the appropriate F -statistic for testing the null hypothesis <span class="math inline">\(NH: \tau_i = 0 \; (i=1,1,2,...I)\)</span> is <span class="citation">(Hillis <a href="#ref-RN1865" role="doc-biblioref">2007</a>)</span>:</p>
<p><span class="math display" id="eq:DefFStatFRRC">\[\begin{equation}
F_{ORH \mid R}=\frac{MS(T)}{Var-Cov_1+(J-1)\max(Cov_2-Cov_3,0)}
\tag{4.38}
\end{equation}\]</span></p>
<p><span class="math inline">\(F_{ORH \mid R}\)</span>, a realization (i.e., observation) of a random variable, is distributed as an F-statistic with:</p>
<p><span class="math display" id="eq:FStatFRRC">\[\begin{equation}
\left.\begin{matrix}
ndf=I-1\\ 
ddf=\infty\\
F_{ORH \mid R} \sim F_{ndf,ddf}
\end{matrix}\right\}
\tag{3.25}
\end{equation}\]</span></p>
<p>Alternatively, as with <a href="ORHAnalysis.html#eq:F-1RMT">(4.16)</a>,</p>
<p><span class="math display">\[(I-1)F_{ORH \mid R} \sim t_{I-1}\]</span>
For <span class="math inline">\(J\)</span> = 1, <a href="ORHAnalysis.html#eq:DefFStatFRRC">(4.38)</a> reduces to <a href="ORHAnalysis.html#eq:DefF-1RMT">(4.17)</a>.</p>
<p>The critical value of the statistic is <span class="math inline">\(F_{1-\alpha,I-1,\infty}\)</span> which is that value such that fraction <span class="math inline">\((1-\alpha)\)</span> of the area under the distribution lies to the left of the critical value. The null hypothesis is rejected if the observed value of the F- statistic exceeds the critical value, i.e.,:</p>
<p><span class="math display">\[F_{ORH \mid R}&gt;F_{1-\alpha,I-1,\infty}\]</span></p>
<p>The p-value of the test is the probability that a random sample from the distribution <span class="math inline">\(F_{I-1,\infty}\)</span> exceeds the observed value of the F statistic defined in <a href="ORHAnalysis.html#eq:DefFStatFRRC">(4.38)</a>:</p>
<p><span class="math display" id="eq:pValueaphaFRRC">\[\begin{equation}
p=\Pr(F&gt;F_{ORH \mid R} \mid F \sim F_{I-1,\infty})
\tag{4.39}
\end{equation}\]</span></p>
<p>The <span class="math inline">\((1-\alpha)\)</span> (symmetric) confidence interval for the difference figure of merit is given by:</p>
<p><span class="math display" id="eq:CIalphaFRRC">\[\begin{equation}
CI_{1-\alpha,FRRC}=(\theta_{i \bullet} - \theta_{i&#39; \bullet}) \pm t_{\alpha/2, \infty}\sqrt{\frac{2}{J}(Var-Cov_1+(J-1)\max(Cov_2-Cov_3,0))}
\tag{4.40}
\end{equation}\]</span></p>
<p>One can think of the numerator terms on the right hand side of <a href="ORHAnalysis.html#eq:CIalphaFRRC">(4.40)</a> as the variance of the inter-treatment FOM difference per reader, and the division by <span class="math inline">\(J\)</span> is needed as the readers, as a group, have smaller variance in inverse proportion to their numbers.</p>
<p>The NH is rejected if any of the following equivalent conditions is met:</p>
<ul>
<li>The observed value of the F-statistic exceeds the critical value <span class="math inline">\(F_{1-\alpha,I-1,\infty}\)</span>.</li>
<li>The p-value defined by <a href="ORHAnalysis.html#eq:pValueaphaFRRC">(4.39)</a> is less than <span class="math inline">\(\alpha\)</span>.</li>
<li>The <span class="math inline">\((1-\alpha)\)</span> confidence interval does not include zero.</li>
</ul>
<p>Notice that for J = 1, <a href="ORHAnalysis.html#eq:CIalphaFRRC">(4.40)</a> reduces to <a href="ORHAnalysis.html#eq:CIalpha1RMT">(4.21)</a>.</p>
</div>
<div id="random-reader-fixed-case-rrfc-analysis-1" class="section level3" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> Random-reader fixed-case (RRFC) analysis</h3>
<p>When case is treated as a fixed factor, the appropriate F-statistic for testing the null hypothesis <span class="math inline">\(NH: \tau_i = 0 \; (i=1,1,2,...I)\)</span> is:</p>
<p><span class="math display" id="eq:DefFStatRRFC">\[\begin{equation}
F_{ORH \mid C}=\frac{MS(T)}{MS(TR)}
\tag{4.41}
\end{equation}\]</span></p>
<p><span class="math inline">\(F_{ORH \mid C}\)</span> is distributed as an F-statistic with:</p>
<p><span class="math display" id="eq:FStatRRFC">\[\begin{equation}
\left.\begin{matrix}
ndf=I-1\\ 
ddf=(I-1)(J-1)\\
F_{ORH \mid C} \sim F_{ndf,ddf}
\end{matrix}\right\}
\tag{3.30}
\end{equation}\]</span></p>
<p>The critical value of the statistic is <span class="math inline">\(F_{1-\alpha,I-1,(I-1)(J-1)}\)</span>, which is that value such that fraction <span class="math inline">\((1-\alpha)\)</span> of the distribution lies to the left of the critical value. The null hypothesis is rejected if the observed value of the F statistic exceeds the critical value:</p>
<p><span class="math display">\[F_{ORH \mid C}&gt;F_{1-\alpha,I-1,(I-1)(J-1)}\]</span></p>
<p>The p-value of the test is the probability that a random sample from the distribution exceeds the observed value:</p>
<p><span class="math display">\[p=\Pr(F&gt;F_{ORH \mid C} \mid F \sim F_{1-\alpha,I-1,(I-1)(J-1)})\]</span></p>
<p>The <span class="math inline">\((1-\alpha)\)</span> confidence interval is given by:</p>
<p><span class="math display" id="eq:CIalphaRRFC">\[\begin{equation}
CI_{1-\alpha,RRFC}=(\theta_{i \bullet} - \theta_{i&#39; \bullet}) \pm t_{\alpha/2, (I-1)(J-1)}\sqrt{\frac{2}{J}MS(TR)}
\tag{4.42}
\end{equation}\]</span></p>
<p>It is time to reinforce the formulae with examples.</p>
</div>
<div id="single-treatment-multiple-reader-analysis" class="section level3" number="4.3.6">
<h3><span class="header-section-number">4.3.6</span> Single-treatment multiple-reader analysis</h3>
<p>Suppose one has data in a single treatment <span class="math inline">\(i\)</span> and multiple readers are involved. One wishes to determine if the performance of the readers as a group equals some specified value. <em>Since only a single treatment is involved, an implicit <span class="math inline">\(i\)</span> dependence in subsequent formulae is ignored.</em></p>
<p>In <a href="ORHAnalysis.html#OR1RMTModel">4.2</a> single-reader multiple-treatment analysis was described. It is not identical to single-treatment multiple-reader analysis. Treatment is a fixed factor while reader is a random factor. Therefore, one cannot simply use the previous analysis with reader and treatment interchanged (a graduate student tried to do just that, and he is quite smart, hence the reason for this warning; one can use the previous analysis if reader is regarded as a fixed factor, and a function in RJafroc called TBA <code>StSignificanceTestingSingleFixedFactor()</code> does just that).</p>
<p>In the analysis described in this section reader is regarded as a random effect. The average performance of the readers is estimated and compared to a specified value. Hillis has described the appropriate modifications. [TBA Two approaches are described, one using the DBM pseudovalue based model and the other based on the OR model with appropriate modification. The second approach is summarized below. TBA]</p>
<p>For single-treatment multiple-reader ORH analysis, the figure of merit model is (contrast the following equation to <a href="ORHAnalysis.html#eq:ORModel1RMT">(4.1)</a> noting the absence of an <span class="math inline">\(i\)</span> index. If multiple modalities are present the current analysis is applicable to data in each treatment analyzed one at a time):</p>
<p><span class="math display" id="eq:OrModel1T">\[\begin{equation}
\theta_{j\{c\}}=\mu+R_j+\epsilon_{j\{c\}}
\tag{4.43}
\end{equation}\]</span></p>
<p>One wishes to test the NH: <span class="math inline">\(\mu=\mu_0\)</span> where <span class="math inline">\(\mu_0\)</span> is some pre-specified value. (since <span class="math inline">\(C\)</span> = 1, in the interest of brevity one can suppress the <span class="math inline">\(c\)</span> index):</p>
<p><span class="math display" id="eq:OrModel1REstmu">\[\begin{equation}
\mu=\theta_{\bullet}
\tag{4.44}
\end{equation}\]</span></p>
<p>The variance of the reader-averaged FOM can be shown <span class="citation">(Obuchowski and Rockette <a href="#ref-RN1450" role="doc-biblioref">1995</a>)</span> to be given by (the reference is to the original OR publication, specifically Eqn. 2.3):</p>
<p><span class="math display" id="eq:VarThetaiDot">\[\begin{equation}
\sigma_{\theta_{\bullet}}^{2}=\frac{1}{J}(\sigma_{R}^{2}+Var+(J-1)Cov_2)
\tag{4.45}
\end{equation}\]</span></p>
</div>
<div id="connection-to-existing-literature" class="section level3" number="4.3.7">
<h3><span class="header-section-number">4.3.7</span> Connection to existing literature</h3>
<p>Rather than attempt to derive the preceding equation, it is shown how it follows from the existing literature <span class="citation">(Obuchowski and Rockette <a href="#ref-RN1450" role="doc-biblioref">1995</a>)</span>. For convenience Eqn. 2.3 in cited reference is reproduced below.</p>
<p><span class="math display" id="eq:VarThetaiDotDot">\[\begin{equation}
Var(\theta_{i \bullet \bullet}) =\frac{1}{J}(\sigma_{b}^{2}+\sigma_{ab}^{2}+(\sigma_{w}^{2}/K) + \sigma_{c}^{2}(1+J(J-1)r_2))
\tag{4.46}
\end{equation}\]</span></p>
<p>In the OR notation, the FOM has three indices, <span class="math inline">\(\theta_{ijk}\)</span>. One deletes the <span class="math inline">\(i\)</span> index as one is dealing with a single treatment and one can drop the average over the <span class="math inline">\(k\)</span> index, as one is dealing with a single dataset; <span class="math inline">\(\sigma_{b}^{2}\)</span> in the OR notation is what we are calling <span class="math inline">\(\sigma_{R}^{2}\)</span>; for single treatment the treatment-reader interaction term <span class="math inline">\(\sigma_{ab}^{2}\)</span> is absent; and for single “replication” the term <span class="math inline">\(\sigma_{w}^{2}/K\)</span> (in OR notation <span class="math inline">\(K\)</span> is the number of replications) is absent, or, more accurately, the within-reader variance <span class="math inline">\(\sigma_{w}^{2}\)</span> is absorbed into the case sampling variance <span class="math inline">\(\sigma_{c}^{2}\)</span> as the two are inseparable); the term <span class="math inline">\(\sigma_{\epsilon}^{2}\)</span> is what we are calling <span class="math inline">\(Var\)</span>; and <span class="math inline">\(\sigma_{c}^{2}r_2\)</span> in OR paper is what we are calling <span class="math inline">\(Cov_2\)</span>.</p>
<p>An alternative first principles derivation, due to Mr. Xuetong Zhai, is given in TBA Online Appendix 10.E.</p>
<p>One needs to replace <span class="math inline">\(\sigma_{R}^{2}\)</span> in <a href="ORHAnalysis.html#eq:VarThetaDot">(4.47)</a> with an expected value. Again, rather than attempt to derive the following equation, it is shown how it follows from the existing literature <span class="citation">(Hillis <a href="#ref-RN2508" role="doc-biblioref">2014</a>)</span>. We start with Table I ibid: this is a table of expected means squares for the OR model, analogous to TBA Table 9.1 in Chapter 09, for the DBM model. For a single treatment (in the notation of the cited reference, <span class="math inline">\(t\)</span> = 1 and the treatment-reader variance component goes away and the term <span class="math inline">\(\sigma_{\epsilon}^{2}\)</span> is what we are calling <span class="math inline">\(Var\)</span>), it follows that:</p>
<p><span class="math display">\[E(MS(R))=\sigma_{R}^{2}+Var=Cov_2\]</span></p>
<p>Substituting this equation in <a href="ORHAnalysis.html#eq:VarThetaDot">(4.47)</a> yields,</p>
<p><span class="math display" id="eq:VarThetaDot">\[\begin{equation}
\sigma_{\theta_{\bullet}}^{2}=\frac{1}{J}(E(MS(R))+JCov_2)
\tag{4.47}
\end{equation}\]</span></p>
<p>An estimate of <span class="math inline">\(MS(R)\)</span> is given by (from here on it is understood that <span class="math inline">\(MSR\)</span> is an estimate defined by:</p>
<p><span class="math display" id="eq:EstMsR1T">\[\begin{equation}
MS(R)=\frac{1}{J-1}\sum_{j=1}^{J}(\theta_j - \theta_{\bullet})^2
\tag{4.48}
\end{equation}\]</span></p>
<p>Replacing the expected mean-square value with the estimate and avoiding negative covariance, which could lead to a negative variance estimate, one has:</p>
<p><span class="math display" id="eq:EstVarThetaDot">\[\begin{equation}
\sigma_{\theta_{\bullet}}^{2}=\frac{1}{J}(MS(R)+J\max(Cov_2,0))
\tag{4.49}
\end{equation}\]</span></p>
<p>The observed value of the t-statistic for testing the NH is <span class="math inline">\(t_{1T}\)</span> (the supbscript means that this statistic applies to single treatment analysis):</p>
<p><span class="math display" id="eq:DefTStat1T">\[\begin{equation}
t_{1T}=\frac{\mu-\mu_0}{\sigma_{\theta_{\bullet}}}=(\theta_{\bullet}-\mu_0)\sqrt{\frac{J}{(MS(R)+J\max(Cov_2,0)}}
\tag{4.50}
\end{equation}\]</span></p>
<p>This is distributed as a t-statistic with <span class="math inline">\(df_{H}^{I=1}\)</span> degrees of freedom:</p>
<p><span class="math display" id="eq:DistTStat1T">\[\begin{equation}
t_{1T} \sim t_{df_{H}^{1T}}
\tag{4.51}
\end{equation}\]</span></p>
<p>In the above equation, Hillis single-treatment degree of freedom <span class="math inline">\(t_{df_{H}^{1T}}\)</span> is defined by <span class="citation">(Hillis <a href="#ref-RN2508" role="doc-biblioref">2014</a>)</span>:</p>
<p><span class="math display" id="eq:DefdfHI1">\[\begin{equation}
df_{H}^{1T}=(J-1)\left [\frac{MS(R)+J \max(Cov_2,0)}{MS(R)} \right ]^2
\tag{4.52}
\end{equation}\]</span></p>
<p>The p-value of the test is the probability that the a random sample from the specified t-distribution exceeds the magnitude of the observed value:</p>
<p><span class="math display" id="eq:pValue1T">\[\begin{equation}
p=\Pr(t&gt;\left | t \right |\mid t \sim t_{df_{H}^{1T}})
\tag{4.53}
\end{equation}\]</span></p>
<p>Therefore, a <span class="math inline">\(100 \times (1-\alpha)\)</span> percent confidence interval for <span class="math inline">\(\theta_{\bullet}-\mu_0\)</span> is:</p>
<p><span class="math display" id="eq:CIalpha1T">\[\begin{equation}
\theta_{\bullet}-\mu_0 \pm t_{\alpha/2,df_{H}^{1T}} \sqrt{ \frac{MS(R)+\max(Cov_2,0)}{J}}
\tag{4.54}
\end{equation}\]</span></p>
<p>The single treatment method is implemented in mainSingleTreatment.R. The relevant code is listed in Online Appendix 10.F. Source the code to get the following output.</p>
</div>
</div>
<div id="discussionsummary" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Discussion/Summary</h2>
<p>This chapter described the Obuchowski-Rockette method as modified by Hillis. As noted earlier, it has the same number of parameters as the DBMH method described in the preceding chapter, but the model <a href="ORHAnalysis.html#eq:ORModel">(4.22)</a> <em>appears</em> simpler as some terms are “hidden” in the structure of the error term. In this chapter the NH condition was considered. Extension to the alternative hypothesis, i.e., estimating statistical power, is deferred to online appendices to Chapter 11. The extension is a little simpler with the DBMH model, as it is a standard ANOVA model. For example the expressions for the DBMH non-centrality parameter was readily defined in Chapter 09, e.g., §9.7.4. Hillis has derived expressions allowing transformation between quantities in the two methods, and this is the approach adopted in this book and implemented in the cited online appendix.</p>
<p>Online Appendix 10.A describes R implementation of the DeLong method for estimating the covariance matrix for empirical AUC. Since the main difficulty understanding the original OR method is conceptualizing the covariance matrix, the author has explained this at an elementary level, using a case-set index which is implicit in the original OR paper4. This was the reason for the gentle introduction analyzing performance of a single reader in multiple treatments. The jackknife, bootstrap and the DeLong methods, all implemented in Online Appendix 10.B, should reinforce understanding of the covariance matrix. The DBM and ORH methods are compared for this special case in Online Appendix 10.C. A minimal implementation of the ORH method for MRMC data is given in Online Appendix 10.D, which is a literal implementation of the relevant formulae. The special case of multiple readers in a single treatment is coded in Online Appendix 10.F. This will be used in Chapter 22 where standalone CAD performance is compared to a group of radiologists interpreting the same cases.</p>
<p>The original publication <span class="citation">(Dorfman, Berbaum, and Metz <a href="#ref-RN204" role="doc-biblioref">1992</a>)</span> and a subsequent one <span class="citation">(Obuchowski and Rockette <a href="#ref-RN1450" role="doc-biblioref">1995</a>)</span> were major advances. Hillis’ work showing their equivalence unified the two apparently disparate analyses, and this was a major advance. The Hillis papers, while difficult reads, are ones the author goes to repeatedly.</p>
<p>This concludes two methods used to analyze ROC MRMC datasets. A third method, restricted to the empirical AUC, is also available <span class="citation">(Clarkson, Kupinski, and Barrett <a href="#ref-RN2253" role="doc-biblioref">2006</a>; Kupinski, Clarkson, and Barrett <a href="#ref-RN2254" role="doc-biblioref">2006</a>; Gallas <a href="#ref-RN2080" role="doc-biblioref">2006</a>; Gallas et al. <a href="#ref-RN2081" role="doc-biblioref">2009</a>)</span>. As noted earlier, the author prefers methods that are applicable to other estimates of AUC, not just the empirical area, and to other data collection paradigms.</p>
<p>The next chapter takes on the subject of sample size estimation using either DBMH or the ORH method.</p>
</div>
<div id="references-2" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> References</h2>

</div>
</div>
<h3>REFERENCES</h3>
<div id="refs" class="references">
<div id="ref-RN2253">
<p>Clarkson, Eric, Matthew A. Kupinski, and Harrison H. Barrett. 2006. “A Probabilistic Model for the Mrmc Method, Part 1: Theoretical Development.” Journal Article. <em>Academic Radiology</em> 13 (11): 1410–21. <a href="https://doi.org/10.1016/j.acra.2006.07.016">https://doi.org/10.1016/j.acra.2006.07.016</a>.</p>
</div>
<div id="ref-RN112">
<p>DeLong, E. R., D. M. DeLong, and D. L. Clarke-Pearson. 1988. “Comparing the Areas Under Two or More Correlated Receiver Operating Characteristic Curves: A Nonparametric Approach.” Journal Article. <em>Biometrics</em> 44: 837–45.</p>
</div>
<div id="ref-RN204">
<p>Dorfman, D. D., K. S. Berbaum, and C. E. Metz. 1992. “ROC Characteristic Rating Analysis: Generalization to the Population of Readers and Patients with the Jackknife Method.” Journal Article. <em>Invest. Radiol.</em> 27 (9): 723–31.</p>
</div>
<div id="ref-RN2080">
<p>Gallas, Brandon D. 2006. “One-Shot Estimate of Mrmc Variance: AUC.” Journal Article. <em>Academic Radiology</em> 13 (3): 353–62. <a href="http://www.sciencedirect.com/science/article/B75BK-4J915RW-C/2/11387ee9975e90e6ae25bef247c817de">http://www.sciencedirect.com/science/article/B75BK-4J915RW-C/2/11387ee9975e90e6ae25bef247c817de</a>.</p>
</div>
<div id="ref-RN2081">
<p>Gallas, Brandon D., Andriy Bandos, Frank W. Samuelson, and Robert F. Wagner. 2009. “A Framework for Random-Effects Roc Analysis: Biases with the Bootstrap and Other Variance Estimators.” Journal Article. <em>Communications in Statistics - Theory and Methods</em> 38 (15): 2586–2603. <a href="http://www.informaworld.com/10.1080/03610920802610084">http://www.informaworld.com/10.1080/03610920802610084</a>.</p>
</div>
<div id="ref-RN1395">
<p>Hajian-Tilaki, K. O., James A. Hanley, L. Joseph, and J. P. Collet. 1997. “Extension of Receiver Operating Characteristic Analysis to Data Concerning Multiple Signal Detection Tasks.” Journal Article. <em>Acad Radiol</em> 4: 222–29.</p>
</div>
<div id="ref-RN1772">
<p>Hillis, S. L., N. A. Obuchowski, K. M. Schartz, and K. S. Berbaum. 2005. “A Comparison of the Dorfman-Berbaum-Metz and Obuchowski-Rockette Methods for Receiver Operating Characteristic (Roc) Data.” Journal Article. <em>Statistics in Medicine</em> 24 (10): 1579–1607.</p>
</div>
<div id="ref-RN1865">
<p>Hillis, Stephen L. 2007. “A Comparison of Denominator Degrees of Freedom Methods for Multiple Observer Roc Studies.” Journal Article. <em>Statistics in Medicine</em> 26: 596–619.</p>
</div>
<div id="ref-RN2508">
<p>Hillis, Stephen L. 2014. “A Marginal‐mean Anova Approach for Analyzing Multireader Multicase Radiological Imaging Data.” Journal Article. <em>Statistics in Medicine</em> 33 (2): 330–60.</p>
</div>
<div id="ref-RN1866">
<p>Hillis, Stephen L., K. S. Berbaum, and C. E. Metz. 2008. “Recent Developments in the Dorfman-Berbaum-Metz Procedure for Multireader Roc Study Analysis.” Journal Article. <em>Acad Radiol</em> 15 (5): 647–61.</p>
</div>
<div id="ref-RN2254">
<p>Kupinski, Matthew A., Eric Clarkson, and Harrison H. Barrett. 2006. “A Probabilistic Model for the Mrmc Method, Part 2: Validation and Applications.” Journal Article. <em>Academic Radiology</em> 13 (11): 1422–30. <a href="https://doi.org/10.1016/j.acra.2006.07.015">https://doi.org/10.1016/j.acra.2006.07.015</a>.</p>
</div>
<div id="ref-RN1971">
<p>Obuchowski, Nancy A. 1998. “Sample Size Calculations in Studies of Test Accuracy.” Journal Article. <em>Statistical Methods in Medical Research</em> 7 (4): 371–92. <a href="https://doi.org/10.1177/096228029800700405">https://doi.org/10.1177/096228029800700405</a>.</p>
</div>
<div id="ref-RN1972">
<p>Obuchowski, Nancy A. 2000. “Sample Size Tables for Receiver Operating Characteristic Studies.” Journal Article. <em>Am. J. Roentgenol.</em> 175 (3): 603–8. <a href="http://www.ajronline.org/cgi/content/abstract/175/3/603">http://www.ajronline.org/cgi/content/abstract/175/3/603</a>.</p>
</div>
<div id="ref-RN1450">
<p>Obuchowski, N. A., and H. E. Rockette. 1995. “Hypothesis Testing of the Diagnostic Accuracy for Multiple Diagnostic Tests: An Anova Approach with Dependent Observations.” Journal Article. <em>Communications in Statistics: Simulation and Computation</em> 24: 285–308.</p>
</div>
<div id="ref-RN1124">
<p>Roe, C. A., and C. E. Metz. 1997. “Variance-Component Modeling in the Analysis of Receiver Operating Characteristic Index Estimates.” Journal Article. <em>Acad. Radiol.</em> 4 (8): 587–600.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="DBMHnalysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references-3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["RJafrocBook.pdf", "RJafrocBook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
