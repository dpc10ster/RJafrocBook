<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 13 FROC sample size estimation and comparison to ROC | RJafroc Documentation</title>
  <meta name="description" content="Extended RJafroc documentation." />
  <meta name="generator" content="bookdown 0.18.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 13 FROC sample size estimation and comparison to ROC | RJafroc Documentation" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Extended RJafroc documentation." />
  <meta name="github-repo" content="dpc10ster/RJafrocBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 13 FROC sample size estimation and comparison to ROC | RJafroc Documentation" />
  
  <meta name="twitter:description" content="Extended RJafroc documentation." />
  

<meta name="author" content="Dev P. Chakraborty, PhD" />


<meta name="date" content="2020-03-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="SSJafrocEffectSize.html"/>
<link rel="next" href="SSFroc2.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RJafroc documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#references"><i class="fa fa-check"></i><b>1.1</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rocdataformat.html"><a href="rocdataformat.html"><i class="fa fa-check"></i><b>2</b> ROC DATA FORMAT</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rocdataformat.html"><a href="rocdataformat.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="rocdataformat.html"><a href="rocdataformat.html#note-to-existing-users"><i class="fa fa-check"></i><b>2.2</b> Note to existing users</a></li>
<li class="chapter" data-level="2.3" data-path="rocdataformat.html"><a href="rocdataformat.html#the-excel-data-format"><i class="fa fa-check"></i><b>2.3</b> The Excel data format</a></li>
<li class="chapter" data-level="2.4" data-path="rocdataformat.html"><a href="rocdataformat.html#illustrative-toy-file"><i class="fa fa-check"></i><b>2.4</b> Illustrative toy file</a></li>
<li class="chapter" data-level="2.5" data-path="rocdataformat.html"><a href="rocdataformat.html#the-truth-worksheet"><i class="fa fa-check"></i><b>2.5</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="2.6" data-path="rocdataformat.html"><a href="rocdataformat.html#the-structure-of-an-roc-dataset"><i class="fa fa-check"></i><b>2.6</b> The structure of an ROC dataset</a></li>
<li class="chapter" data-level="2.7" data-path="rocdataformat.html"><a href="rocdataformat.html#the-false-positive-fp-ratings"><i class="fa fa-check"></i><b>2.7</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="2.8" data-path="rocdataformat.html"><a href="rocdataformat.html#the-true-positive-tp-ratings"><i class="fa fa-check"></i><b>2.8</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="2.9" data-path="rocdataformat.html"><a href="rocdataformat.html#correspondence-between-nl-member-of-dataset-and-the-fp-worksheet"><i class="fa fa-check"></i><b>2.9</b> Correspondence between <code>NL</code> member of dataset and the <code>FP</code> worksheet</a></li>
<li class="chapter" data-level="2.10" data-path="rocdataformat.html"><a href="rocdataformat.html#correspondence-between-ll-member-of-dataset-and-the-tp-worksheet"><i class="fa fa-check"></i><b>2.10</b> Correspondence between <code>LL</code> member of dataset and the <code>TP</code> worksheet</a></li>
<li class="chapter" data-level="2.11" data-path="rocdataformat.html"><a href="rocdataformat.html#correspondence-using-the-which-function"><i class="fa fa-check"></i><b>2.11</b> Correspondence using the <code>which</code> function</a></li>
<li class="chapter" data-level="2.12" data-path="rocdataformat.html"><a href="rocdataformat.html#references-1"><i class="fa fa-check"></i><b>2.12</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="frocdataformat.html"><a href="frocdataformat.html"><i class="fa fa-check"></i><b>3</b> FROC data format</a>
<ul>
<li class="chapter" data-level="3.1" data-path="frocdataformat.html"><a href="frocdataformat.html#purpose"><i class="fa fa-check"></i><b>3.1</b> Purpose</a></li>
<li class="chapter" data-level="3.2" data-path="frocdataformat.html"><a href="frocdataformat.html#introduction-1"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="frocdataformat.html"><a href="frocdataformat.html#the-excel-data-format-1"><i class="fa fa-check"></i><b>3.3</b> The Excel data format</a></li>
<li class="chapter" data-level="3.4" data-path="frocdataformat.html"><a href="frocdataformat.html#the-truth-worksheet-1"><i class="fa fa-check"></i><b>3.4</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="3.5" data-path="frocdataformat.html"><a href="frocdataformat.html#the-structure-of-an-froc-dataset"><i class="fa fa-check"></i><b>3.5</b> The structure of an FROC dataset</a></li>
<li class="chapter" data-level="3.6" data-path="frocdataformat.html"><a href="frocdataformat.html#the-false-positive-fp-ratings-1"><i class="fa fa-check"></i><b>3.6</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="3.7" data-path="frocdataformat.html"><a href="frocdataformat.html#the-true-positive-tp-ratings-1"><i class="fa fa-check"></i><b>3.7</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="3.8" data-path="frocdataformat.html"><a href="frocdataformat.html#on-the-distribution-of-numbers-of-lesions-in-abnormal-cases"><i class="fa fa-check"></i><b>3.8</b> On the distribution of numbers of lesions in abnormal cases</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="frocdataformat.html"><a href="frocdataformat.html#definition-of-lesdistr-array"><i class="fa fa-check"></i><b>3.8.1</b> Definition of <code>lesDistr</code> array</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="frocdataformat.html"><a href="frocdataformat.html#definition-of-leswghtdistr-array"><i class="fa fa-check"></i><b>3.9</b> Definition of <code>lesWghtDistr</code> array</a></li>
<li class="chapter" data-level="3.10" data-path="frocdataformat.html"><a href="frocdataformat.html#summary"><i class="fa fa-check"></i><b>3.10</b> Summary</a></li>
<li class="chapter" data-level="3.11" data-path="frocdataformat.html"><a href="frocdataformat.html#references-2"><i class="fa fa-check"></i><b>3.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html"><i class="fa fa-check"></i><b>4</b> ROC split plot data format</a>
<ul>
<li class="chapter" data-level="4.1" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-excel-data-format-2"><i class="fa fa-check"></i><b>4.2</b> The Excel data format</a></li>
<li class="chapter" data-level="4.3" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-truth-worksheet-2"><i class="fa fa-check"></i><b>4.3</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="4.4" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-structure-of-the-roc-split-plot-dataset"><i class="fa fa-check"></i><b>4.4</b> The structure of the ROC split plot dataset</a></li>
<li class="chapter" data-level="4.5" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-truthtablestr-member"><i class="fa fa-check"></i><b>4.5</b> The <code>truthTableStr</code> member</a></li>
<li class="chapter" data-level="4.6" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-false-positive-fp-ratings-2"><i class="fa fa-check"></i><b>4.6</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="4.7" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-true-positive-tp-ratings-2"><i class="fa fa-check"></i><b>4.7</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="4.8" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#summary-1"><i class="fa fa-check"></i><b>4.8</b> Summary</a></li>
<li class="chapter" data-level="4.9" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#references-3"><i class="fa fa-check"></i><b>4.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html"><i class="fa fa-check"></i><b>5</b> FROC ROC DATA FORMAT SPLIT PLOT</a>
<ul>
<li class="chapter" data-level="5.1" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-excel-data-format-3"><i class="fa fa-check"></i><b>5.2</b> The Excel data format</a></li>
<li class="chapter" data-level="5.3" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-truth-worksheet-3"><i class="fa fa-check"></i><b>5.3</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="5.4" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-structure-of-the-froc-split-plot-dataset"><i class="fa fa-check"></i><b>5.4</b> The structure of the FROC split plot dataset</a></li>
<li class="chapter" data-level="5.5" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-false-positive-fp-ratings-3"><i class="fa fa-check"></i><b>5.5</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="5.6" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-true-positive-tp-ratings-3"><i class="fa fa-check"></i><b>5.6</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="5.7" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#summary-2"><i class="fa fa-check"></i><b>5.7</b> Summary</a></li>
<li class="chapter" data-level="5.8" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#references-4"><i class="fa fa-check"></i><b>5.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html"><i class="fa fa-check"></i><b>6</b> QUICK START DBM1</a>
<ul>
<li class="chapter" data-level="6.1" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#an-roc-dataset"><i class="fa fa-check"></i><b>6.2</b> An ROC dataset</a></li>
<li class="chapter" data-level="6.3" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#creating-a-dataset-from-a-jafroc-format-file"><i class="fa fa-check"></i><b>6.3</b> Creating a dataset from a JAFROC format file</a></li>
<li class="chapter" data-level="6.4" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#analyzing-the-roc-dataset"><i class="fa fa-check"></i><b>6.4</b> Analyzing the ROC dataset</a></li>
<li class="chapter" data-level="6.5" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#explanation-of-the-output"><i class="fa fa-check"></i><b>6.5</b> Explanation of the output</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#foms"><i class="fa fa-check"></i><b>6.5.1</b> FOMs</a></li>
<li class="chapter" data-level="6.5.2" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#pseudovalue-anova-table"><i class="fa fa-check"></i><b>6.5.2</b> Pseudovalue ANOVA table</a></li>
<li class="chapter" data-level="6.5.3" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#pseudovalue-anova-table-each-treatment"><i class="fa fa-check"></i><b>6.5.3</b> Pseudovalue ANOVA table, each treatment</a></li>
<li class="chapter" data-level="6.5.4" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#pseudovalue-variance-components"><i class="fa fa-check"></i><b>6.5.4</b> Pseudovalue Variance Components</a></li>
<li class="chapter" data-level="6.5.5" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#random-reader-random-case-rrrc-analysis"><i class="fa fa-check"></i><b>6.5.5</b> Random-reader random-case (RRRC) analysis</a></li>
<li class="chapter" data-level="6.5.6" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#fixed-reader-random-case-frrc-analysis"><i class="fa fa-check"></i><b>6.5.6</b> Fixed-reader random-case (FRRC) analysis</a></li>
<li class="chapter" data-level="6.5.7" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#random-reader-fixed-case-rrfc-analysis"><i class="fa fa-check"></i><b>6.5.7</b> Random-reader fixed-case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#orh-significance-testing"><i class="fa fa-check"></i><b>6.6</b> ORH significance testing</a></li>
<li class="chapter" data-level="6.7" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#references-5"><i class="fa fa-check"></i><b>6.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="QuickStartDBM2.html"><a href="QuickStartDBM2.html"><i class="fa fa-check"></i><b>7</b> QUICK START DBM2</a>
<ul>
<li class="chapter" data-level="7.1" data-path="QuickStartDBM2.html"><a href="QuickStartDBM2.html#introduction-5"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="QuickStartDBM2.html"><a href="QuickStartDBM2.html#generating-the-excel-output-file"><i class="fa fa-check"></i><b>7.2</b> Generating the Excel output file</a></li>
<li class="chapter" data-level="7.3" data-path="QuickStartDBM2.html"><a href="QuickStartDBM2.html#orh-significance-testing-1"><i class="fa fa-check"></i><b>7.3</b> ORH significance testing</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="SSFDistr.html"><a href="SSFDistr.html"><i class="fa fa-check"></i><b>8</b> BACKGROUND ON THE F-DISTRIBUTION</a>
<ul>
<li class="chapter" data-level="8.1" data-path="SSFDistr.html"><a href="SSFDistr.html#introduction-6"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="SSFDistr.html"><a href="SSFDistr.html#effect-of-ncp-for-ndf-2-and-ddf-10"><i class="fa fa-check"></i><b>8.2</b> Effect of <code>ncp</code> for <code>ndf</code> = 2 and <code>ddf</code> = 10</a></li>
<li class="chapter" data-level="8.3" data-path="SSFDistr.html"><a href="SSFDistr.html#comments"><i class="fa fa-check"></i><b>8.3</b> Comments</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-a"><i class="fa fa-check"></i><b>8.3.1</b> Fig. A</a></li>
<li class="chapter" data-level="8.3.2" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-b"><i class="fa fa-check"></i><b>8.3.2</b> Fig. B</a></li>
<li class="chapter" data-level="8.3.3" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-c"><i class="fa fa-check"></i><b>8.3.3</b> Fig. C</a></li>
<li class="chapter" data-level="8.3.4" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-d"><i class="fa fa-check"></i><b>8.3.4</b> Fig. D</a></li>
<li class="chapter" data-level="8.3.5" data-path="SSFDistr.html"><a href="SSFDistr.html#summary-3"><i class="fa fa-check"></i><b>8.3.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="SSFDistr.html"><a href="SSFDistr.html#effect-of-ncp-for-ndf-2-and-ddf-100"><i class="fa fa-check"></i><b>8.4</b> Effect of <code>ncp</code> for <code>ndf</code> = 2 and <code>ddf</code> = 100</a></li>
<li class="chapter" data-level="8.5" data-path="SSFDistr.html"><a href="SSFDistr.html#comments-1"><i class="fa fa-check"></i><b>8.5</b> Comments</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-e"><i class="fa fa-check"></i><b>8.5.1</b> Fig. E</a></li>
<li class="chapter" data-level="8.5.2" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-f"><i class="fa fa-check"></i><b>8.5.2</b> Fig. F</a></li>
<li class="chapter" data-level="8.5.3" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-g"><i class="fa fa-check"></i><b>8.5.3</b> Fig. G</a></li>
<li class="chapter" data-level="8.5.4" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-h"><i class="fa fa-check"></i><b>8.5.4</b> Fig. H</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="SSFDistr.html"><a href="SSFDistr.html#effect-of-ncp-for-ndf-1-ddf-100"><i class="fa fa-check"></i><b>8.6</b> Effect of <code>ncp</code> for <code>ndf</code> = 1, <code>ddf</code> = 100</a></li>
<li class="chapter" data-level="8.7" data-path="SSFDistr.html"><a href="SSFDistr.html#comments-2"><i class="fa fa-check"></i><b>8.7</b> Comments</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-i"><i class="fa fa-check"></i><b>8.7.1</b> Fig. I</a></li>
<li class="chapter" data-level="8.7.2" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-j"><i class="fa fa-check"></i><b>8.7.2</b> Fig. J</a></li>
<li class="chapter" data-level="8.7.3" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-k"><i class="fa fa-check"></i><b>8.7.3</b> Fig. K</a></li>
<li class="chapter" data-level="8.7.4" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-l"><i class="fa fa-check"></i><b>8.7.4</b> Fig. L</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="SSFDistr.html"><a href="SSFDistr.html#summary-4"><i class="fa fa-check"></i><b>8.8</b> Summary</a></li>
<li class="chapter" data-level="8.9" data-path="SSFDistr.html"><a href="SSFDistr.html#references-6"><i class="fa fa-check"></i><b>8.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html"><i class="fa fa-check"></i><b>9</b> ROC-DBMH sample size from first principles</a>
<ul>
<li class="chapter" data-level="9.1" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#introduction-7"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#sample-size-estimation-using-the-dbmh-method"><i class="fa fa-check"></i><b>9.2</b> Sample size estimation using the DBMH method</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#random-reader-random-case-rrrc"><i class="fa fa-check"></i><b>9.2.1</b> Random reader random case (RRRC)</a></li>
<li class="chapter" data-level="9.2.2" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#fixed-reader-random-case-frrc"><i class="fa fa-check"></i><b>9.2.2</b> Fixed reader random case (FRRC)</a></li>
<li class="chapter" data-level="9.2.3" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#random-reader-fixed-case-rrfc"><i class="fa fa-check"></i><b>9.2.3</b> Random reader fixed case (RRFC)</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#summary-5"><i class="fa fa-check"></i><b>9.3</b> Summary</a></li>
<li class="chapter" data-level="9.4" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#references-7"><i class="fa fa-check"></i><b>9.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html"><i class="fa fa-check"></i><b>10</b> ROC-DBMH sample size using RJafroc</a>
<ul>
<li class="chapter" data-level="10.1" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#introduction-8"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#illustration-of-sspowergivenjk-using-method-dbmh"><i class="fa fa-check"></i><b>10.2</b> Illustration of <code>SsPowerGivenJK()</code> using <code>method = "DBMH"</code></a></li>
<li class="chapter" data-level="10.3" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#illustration-of-sspowertable-using-method-dbmh"><i class="fa fa-check"></i><b>10.3</b> Illustration of <code>SsPowerTable()</code> using <code>method = "DBMH"</code></a></li>
<li class="chapter" data-level="10.4" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#illustration-of-sssamplesizekgivenj-using-method-dbmh"><i class="fa fa-check"></i><b>10.4</b> Illustration of <code>SsSampleSizeKGivenJ()</code> using <code>method = "DBMH"</code></a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#rrrc"><i class="fa fa-check"></i><b>10.4.1</b> RRRC</a></li>
<li class="chapter" data-level="10.4.2" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#frrc"><i class="fa fa-check"></i><b>10.4.2</b> FRRC</a></li>
<li class="chapter" data-level="10.4.3" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#rrfc"><i class="fa fa-check"></i><b>10.4.3</b> RRFC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html"><i class="fa fa-check"></i><b>11</b> ROC-ORH sample size using RJafroc</a>
<ul>
<li class="chapter" data-level="11.1" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#introduction-9"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#illustration-of-sspowergivenjk-using-method-orh"><i class="fa fa-check"></i><b>11.2</b> Illustration of <code>SsPowerGivenJK()</code> using <code>method = "ORH"</code></a></li>
<li class="chapter" data-level="11.3" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#illustration-of-sspowertable-using-method-orh"><i class="fa fa-check"></i><b>11.3</b> Illustration of <code>SsPowerTable()</code> using <code>method = "ORH"</code></a></li>
<li class="chapter" data-level="11.4" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#illustrations-of-sssamplesizekgivenj-using-method-orh"><i class="fa fa-check"></i><b>11.4</b> Illustrations of <code>SsSampleSizeKGivenJ()</code> using <code>method = "ORH"</code></a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#for-rrrc-generalization"><i class="fa fa-check"></i><b>11.4.1</b> For RRRC generalization</a></li>
<li class="chapter" data-level="11.4.2" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#for-frrc-generalization"><i class="fa fa-check"></i><b>11.4.2</b> For FRRC generalization</a></li>
<li class="chapter" data-level="11.4.3" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#for-rrfc-generalization"><i class="fa fa-check"></i><b>11.4.3</b> For RRFC generalization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="SSJafrocEffectSize.html"><a href="SSJafrocEffectSize.html"><i class="fa fa-check"></i><b>12</b> Choosing a realistic effect size</a>
<ul>
<li class="chapter" data-level="12.1" data-path="SSJafrocEffectSize.html"><a href="SSJafrocEffectSize.html#introduction-10"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="SSJafrocEffectSize.html"><a href="SSJafrocEffectSize.html#illustration-of-sspowergivenjk-using-method-orh-1"><i class="fa fa-check"></i><b>12.2</b> Illustration of <code>SsPowerGivenJK()</code> using <code>method = "ORH"</code></a></li>
<li class="chapter" data-level="12.3" data-path="SSJafrocEffectSize.html"><a href="SSJafrocEffectSize.html#references-8"><i class="fa fa-check"></i><b>12.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="SSFroc1.html"><a href="SSFroc1.html"><i class="fa fa-check"></i><b>13</b> FROC sample size estimation and comparison to ROC</a>
<ul>
<li class="chapter" data-level="13.1" data-path="SSFroc1.html"><a href="SSFroc1.html#introduction-11"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="SSFroc1.html"><a href="SSFroc1.html#relating-an-roc-effect-size-to-a-wafroc-effect-size"><i class="fa fa-check"></i><b>13.2</b> Relating an ROC effect-size to a wAFROC effect-size</a></li>
<li class="chapter" data-level="13.3" data-path="SSFroc1.html"><a href="SSFroc1.html#computing-the-respective-variance-components"><i class="fa fa-check"></i><b>13.3</b> Computing the respective variance components</a></li>
<li class="chapter" data-level="13.4" data-path="SSFroc1.html"><a href="SSFroc1.html#comparing-roc-power-to-wafroc-power-for-equivalent-effect-sizes"><i class="fa fa-check"></i><b>13.4</b> Comparing ROC power to wAFROC power for equivalent effect-sizes</a></li>
<li class="chapter" data-level="13.5" data-path="SSFroc1.html"><a href="SSFroc1.html#references-9"><i class="fa fa-check"></i><b>13.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="SSFroc2.html"><a href="SSFroc2.html"><i class="fa fa-check"></i><b>14</b> FROC sample size estimation using specified ROC effect</a>
<ul>
<li class="chapter" data-level="14.1" data-path="SSFroc2.html"><a href="SSFroc2.html#introduction-12"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="SSFroc2.html"><a href="SSFroc2.html#constructing-the-nh-model-for-the-dataset"><i class="fa fa-check"></i><b>14.2</b> Constructing the NH model for the dataset</a></li>
<li class="chapter" data-level="14.3" data-path="SSFroc2.html"><a href="SSFroc2.html#extracting-the-wafroc-variance-components"><i class="fa fa-check"></i><b>14.3</b> Extracting the wAFROC variance components</a></li>
<li class="chapter" data-level="14.4" data-path="SSFroc2.html"><a href="SSFroc2.html#wafroc-power-for-specified-roc-effect-size-number-of-readers-j-and-number-of-cases-k"><i class="fa fa-check"></i><b>14.4</b> wAFROC power for specified ROC effect size, number of readers J and number of cases K</a></li>
<li class="chapter" data-level="14.5" data-path="SSFroc2.html"><a href="SSFroc2.html#wafroc-number-of-cases-for-80-power-for-a-given-number-of-readers-j"><i class="fa fa-check"></i><b>14.5</b> wAFROC number of cases for 80% power for a given number of readers J</a></li>
<li class="chapter" data-level="14.6" data-path="SSFroc2.html"><a href="SSFroc2.html#wafroc-power-for-a-given-number-of-readers-j-and-cases-k"><i class="fa fa-check"></i><b>14.6</b> wAFROC Power for a given number of readers J and cases K</a></li>
<li class="chapter" data-level="14.7" data-path="SSFroc2.html"><a href="SSFroc2.html#references-10"><i class="fa fa-check"></i><b>14.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="RsmOpCh.html"><a href="RsmOpCh.html"><i class="fa fa-check"></i><b>15</b> RSM predicted operating characteristics</a>
<ul>
<li class="chapter" data-level="15.1" data-path="RsmOpCh.html"><a href="RsmOpCh.html#introduction-13"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="RsmOpCh.html"><a href="RsmOpCh.html#the-distinction-between-predicted-curves-and-empirical-curves"><i class="fa fa-check"></i><b>15.2</b> The distinction between predicted curves and empirical curves</a></li>
<li class="chapter" data-level="15.3" data-path="RsmOpCh.html"><a href="RsmOpCh.html#the-rsm-model"><i class="fa fa-check"></i><b>15.3</b> The RSM model</a></li>
<li class="chapter" data-level="15.4" data-path="RsmOpCh.html"><a href="RsmOpCh.html#the-empirical-wafroc"><i class="fa fa-check"></i><b>15.4</b> The empirical wAFROC</a></li>
<li class="chapter" data-level="15.5" data-path="RsmOpCh.html"><a href="RsmOpCh.html#the-predicted-wafroc"><i class="fa fa-check"></i><b>15.5</b> The predicted wAFROC</a></li>
<li class="chapter" data-level="15.6" data-path="RsmOpCh.html"><a href="RsmOpCh.html#the-distribution-of-number-of-lesions-and-weights"><i class="fa fa-check"></i><b>15.6</b> The distribution of number of lesions and weights</a></li>
<li class="chapter" data-level="15.7" data-path="RsmOpCh.html"><a href="RsmOpCh.html#other-operating-characteristics"><i class="fa fa-check"></i><b>15.7</b> Other operating characteristics</a></li>
<li class="chapter" data-level="15.8" data-path="RsmOpCh.html"><a href="RsmOpCh.html#summary-6"><i class="fa fa-check"></i><b>15.8</b> Summary</a></li>
<li class="chapter" data-level="15.9" data-path="RsmOpCh.html"><a href="RsmOpCh.html#references-11"><i class="fa fa-check"></i><b>15.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="ImproperROCs.html"><a href="ImproperROCs.html"><i class="fa fa-check"></i><b>16</b> Improper ROCs</a>
<ul>
<li class="chapter" data-level="16.1" data-path="ImproperROCs.html"><a href="ImproperROCs.html#the-binormal-model"><i class="fa fa-check"></i><b>16.1</b> The binormal model</a></li>
<li class="chapter" data-level="16.2" data-path="ImproperROCs.html"><a href="ImproperROCs.html#improper-rocs"><i class="fa fa-check"></i><b>16.2</b> Improper ROCs</a></li>
<li class="chapter" data-level="16.3" data-path="ImproperROCs.html"><a href="ImproperROCs.html#reason-for-improper-rocs"><i class="fa fa-check"></i><b>16.3</b> Reason for improper ROCs</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html"><i class="fa fa-check"></i><b>17</b> Degenerate datasets in the binormal model</a>
<ul>
<li class="chapter" data-level="17.1" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#two-helper-functions"><i class="fa fa-check"></i><b>17.1</b> Two helper functions</a></li>
<li class="chapter" data-level="17.2" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#degenerate-datasets"><i class="fa fa-check"></i><b>17.2</b> Degenerate datasets</a></li>
<li class="chapter" data-level="17.3" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#understanding-degenerate-datasets"><i class="fa fa-check"></i><b>17.3</b> Understanding degenerate datasets</a></li>
<li class="chapter" data-level="17.4" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#the-exact-fit-is-not-unique"><i class="fa fa-check"></i><b>17.4</b> The exact fit is not unique</a></li>
<li class="chapter" data-level="17.5" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#comments-on-degeneracy"><i class="fa fa-check"></i><b>17.5</b> Comments on degeneracy</a></li>
<li class="chapter" data-level="17.6" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#a-reasonable-fit-to-the-degenerate-dataset"><i class="fa fa-check"></i><b>17.6</b> A reasonable fit to the degenerate dataset</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="ProperROCs.html"><a href="ProperROCs.html"><i class="fa fa-check"></i><b>18</b> Proper ROCs</a>
<ul>
<li class="chapter" data-level="18.1" data-path="ProperROCs.html"><a href="ProperROCs.html#helper-functions"><i class="fa fa-check"></i><b>18.1</b> Helper functions</a></li>
<li class="chapter" data-level="18.2" data-path="ProperROCs.html"><a href="ProperROCs.html#definitions-of-proproc-parameters-in-terms-of-binormal-model-parameters"><i class="fa fa-check"></i><b>18.2</b> Definitions of PROPROC parameters in terms of binormal model parameters</a></li>
<li class="chapter" data-level="18.3" data-path="ProperROCs.html"><a href="ProperROCs.html#main-code-and-output"><i class="fa fa-check"></i><b>18.3</b> Main code and output</a></li>
<li class="chapter" data-level="18.4" data-path="ProperROCs.html"><a href="ProperROCs.html#discussion"><i class="fa fa-check"></i><b>18.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="MetzEqn36.html"><a href="MetzEqn36.html"><i class="fa fa-check"></i><b>19</b> Metz Eqn36 numerical check</a>
<ul>
<li class="chapter" data-level="19.1" data-path="MetzEqn36.html"><a href="MetzEqn36.html#helper-functions-1"><i class="fa fa-check"></i><b>19.1</b> Helper functions</a></li>
<li class="chapter" data-level="19.2" data-path="MetzEqn36.html"><a href="MetzEqn36.html#main-code-and-output-1"><i class="fa fa-check"></i><b>19.2</b> Main code and output</a></li>
<li class="chapter" data-level="19.3" data-path="MetzEqn36.html"><a href="MetzEqn36.html#discussion-1"><i class="fa fa-check"></i><b>19.3</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="CbmPlots.html"><a href="CbmPlots.html"><i class="fa fa-check"></i><b>20</b> CBM Plots</a>
<ul>
<li class="chapter" data-level="20.1" data-path="CbmPlots.html"><a href="CbmPlots.html#helper-functions-2"><i class="fa fa-check"></i><b>20.1</b> Helper functions</a></li>
<li class="chapter" data-level="20.2" data-path="CbmPlots.html"><a href="CbmPlots.html#main-code-and-output-2"><i class="fa fa-check"></i><b>20.2</b> Main code and output</a></li>
<li class="chapter" data-level="20.3" data-path="CbmPlots.html"><a href="CbmPlots.html#comments-3"><i class="fa fa-check"></i><b>20.3</b> Comments</a></li>
<li class="chapter" data-level="20.4" data-path="CbmPlots.html"><a href="CbmPlots.html#pdf-plots"><i class="fa fa-check"></i><b>20.4</b> pdf plots</a></li>
<li class="chapter" data-level="20.5" data-path="CbmPlots.html"><a href="CbmPlots.html#comments-4"><i class="fa fa-check"></i><b>20.5</b> Comments</a></li>
<li class="chapter" data-level="20.6" data-path="CbmPlots.html"><a href="CbmPlots.html#likelihood-ratio-plots"><i class="fa fa-check"></i><b>20.6</b> likelihood ratio plots</a></li>
<li class="chapter" data-level="20.7" data-path="CbmPlots.html"><a href="CbmPlots.html#comments-5"><i class="fa fa-check"></i><b>20.7</b> Comments</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="ROIDataStr.html"><a href="ROIDataStr.html"><i class="fa fa-check"></i><b>21</b> ROI paradigm data</a>
<ul>
<li class="chapter" data-level="21.1" data-path="ROIDataStr.html"><a href="ROIDataStr.html#introduction-this-vignette-is-under-construction"><i class="fa fa-check"></i><b>21.1</b> Introduction; this vignette is under construction!</a></li>
<li class="chapter" data-level="21.2" data-path="ROIDataStr.html"><a href="ROIDataStr.html#an-example-roi-dataset"><i class="fa fa-check"></i><b>21.2</b> An example ROI dataset</a></li>
<li class="chapter" data-level="21.3" data-path="ROIDataStr.html"><a href="ROIDataStr.html#the-roi-excel-data-file"><i class="fa fa-check"></i><b>21.3</b> The ROI Excel data file</a></li>
<li class="chapter" data-level="21.4" data-path="ROIDataStr.html"><a href="ROIDataStr.html#next-tba"><i class="fa fa-check"></i><b>21.4</b> Next, TBA</a></li>
<li class="chapter" data-level="21.5" data-path="ROIDataStr.html"><a href="ROIDataStr.html#references-12"><i class="fa fa-check"></i><b>21.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html"><i class="fa fa-check"></i><b>22</b> Analyzing data acquired according to the ROI paradigm</a>
<ul>
<li class="chapter" data-level="22.1" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#introduction-this-vignette-is-under-construction-1"><i class="fa fa-check"></i><b>22.1</b> Introduction; this vignette is under construction!</a></li>
<li class="chapter" data-level="22.2" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#note-to-self-102919-dpc"><i class="fa fa-check"></i><b>22.2</b> Note to self (10/29/19) !!!DPC!!!</a></li>
<li class="chapter" data-level="22.3" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#introduction-14"><i class="fa fa-check"></i><b>22.3</b> Introduction</a></li>
<li class="chapter" data-level="22.4" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#the-roi-figure-of-merit"><i class="fa fa-check"></i><b>22.4</b> The ROI figure of merit</a></li>
<li class="chapter" data-level="22.5" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#calculation-of-the-roi-figure-of-merit."><i class="fa fa-check"></i><b>22.5</b> Calculation of the ROI figure of merit.</a></li>
<li class="chapter" data-level="22.6" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#significance-testing"><i class="fa fa-check"></i><b>22.6</b> Significance testing</a>
<ul>
<li class="chapter" data-level="22.6.1" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#rrrc-analysis"><i class="fa fa-check"></i><b>22.6.1</b> RRRC analysis</a></li>
<li class="chapter" data-level="22.6.2" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#frrc-analysis"><i class="fa fa-check"></i><b>22.6.2</b> FRRC analysis</a></li>
<li class="chapter" data-level="22.6.3" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#rrfc-analysis"><i class="fa fa-check"></i><b>22.6.3</b> RRFC analysis</a></li>
</ul></li>
<li class="chapter" data-level="22.7" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#summary-7"><i class="fa fa-check"></i><b>22.7</b> Summary</a></li>
<li class="chapter" data-level="22.8" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#references-13"><i class="fa fa-check"></i><b>22.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="myEquations.html"><a href="myEquations.html"><i class="fa fa-check"></i><b>23</b> EQUATIONS</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">RJafroc Documentation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="SSFroc1" class="section level1" number="13">
<h1><span class="header-section-number">Chapter 13</span> FROC sample size estimation and comparison to ROC</h1>
<div id="introduction-11" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> Introduction</h2>
<ul>
<li><p>FROC sample size estimation is not fundamentally different from the previously outlined procedure (see vignettes corresponding to Chapter 11) for the ROC paradigm. To recapitulate, based on analysis of a pilot ROC dataset and using a specified FOM, e.g., <code>FOM = Wilcoxon</code>, and either <code>method = "DBMH"</code> or <code>method = "ORH"</code> for significance testing, one estimates the intrinsic variability of the data expressed in terms of variance components or the covariance matrix. The second step is to postulate a clinically realistic effect-size, e.g., the anticipated AUC difference between the two treatments. Given these values, the sample size functions implemented in <code>RJafroc</code> (beginning with <code>Ss</code>) allow one to estimate the number of readers and cases necessary to detect (i.e., reject the null hypothesis) the specified effect size at specified Type II error rate, typically chosen to be 20% (corresponding to 80% statistical power) and specified Type I error rate, typically chosen to be 5%.</p></li>
<li><p>In FROC analysis the only difference, <strong>indeed the critical difference</strong>, is the choice of FOM; e.g., <code>FOM = "wAFROC"</code> instead of the inferred ROC-AUC, <code>FOM = "HrAuc"</code>. The FROC dataset is analyzed using either the DBMH or the ORH method. This yields the necessary variance components or the covariance matrix corresponding to the wAFROC-AUC. The next step is to specify the effect-size <strong>in wAFROC-AUC units</strong>, and therein lies the rub. What value does one use? The ROC-AUC has a historically well-known interpretation: the classification ability at separating diseased patients from non-diseased patients, while the wAFROC-AUC does not. Needed is a way of relating the effect-size in ROC-AUC units to one in wAFROC-AUC units: as should be obvious this requires a physical model, e.g., the RSM, that predicts both ROC and wAFROC curves and the respective AUCs.</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>One chooses an ROC-AUC effect-size that is realistic, one that clinicians understand and can therefore participate in, in the effect-size postulation process.</li>
<li>One converts the ROC effect-size to a wAFROC-AUC effect-size. The method for this is described in the next section.</li>
<li>One uses the sample size tools in in <code>RJafroc</code> to determine sample size or power.</li>
</ol>
<ul>
<li><p><strong>It is important to recognize is that all quantities have to be in the same units</strong>. When performing ROC analysis, everything (variance components and effect-size) has to be in units of the selected FOM, e.g., <code>FOM = "Wilcoxon"</code> which is identical to the empirical ROC-AUC. When doing wAFROC analysis, everything has to be in units of the wAFROC-AUC. The variance components and effect-size in wAFROC-AUC units will be different from their corresponding ROC counterparts. In particular, as shown next, an ROC-AUC effect-size of 0.05 generally corresponds to a larger effect-size in wAFROC-AUC units. The reason for this is that the range over which wAFROC-AUC can vary, namely 0 to 1, is twice the corresponding ROC-AUC range.</p></li>
<li><p>The next section explains the steps used to implement step #2 above.</p></li>
</ul>
</div>
<div id="relating-an-roc-effect-size-to-a-wafroc-effect-size" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> Relating an ROC effect-size to a wAFROC effect-size</h2>
<ul>
<li><p>If the original data is FROC, one needs to first convert it to ROC, using <code>DfFroc2Roc()</code>: <strong>the RSM fits ROC data</strong>.</p></li>
<li><p>For each treatment and reader the inferred ROC data is fitted by <code>FitRsmRoc()</code>, yielding estimates of the RSM <em>physical</em> (or primed) parameters (not the <em>intrinsic</em> values).</p></li>
<li><p>The following example uses the <em>first two</em> treatments of the “FED” dataset, <code>dataset04</code>, which is a 5 treatment 4 radiologist FROC dataset acquired by Dr. Federica Zanca et. al. <span class="citation">(Zanca et al. <a href="#ref-RN1882" role="doc-biblioref">2009</a>)</span>. The dataset has 5 treatments and 4 readers and 200 cases and was acquired on a 5-point integer scale, i.e., it is already binned. If not one needs to bin the dataset using <code>DfBinDataset()</code>. I need to emphasize this point: <strong>if the dataset represents continuous ratings, as with a CAD algorithm, one must bin the dataset to (ideally) about 5 bins</strong>. The number of parameters that must be estimated increases with the number of bins (for each bin one needs to estimate a cutoff parameter).</p></li>
<li><p>The reason for using RSM parameter values only for the first two treatments is that these were found <span class="citation">(Zanca et al. <a href="#ref-RN1882" role="doc-biblioref">2009</a>)</span> to be almost equivalent (more precisely, the NH could not be rejected for the first two treatments, so it makes sense to regard them as “almost” NH treatments.</p></li>
<li><p>The following code block defines the pilot FROC data <code>frocData</code> (corresponding to <code>dataset04</code>, which is the “FED” dataset, but with only treatments 1 and 2 extracted, using <code>DfExtractDataset()</code>) and <code>rocData</code>, i.e., the highest-rating ROC dataset inferred from the FROC dataset using <code>DfFroc2Roc()</code>.</p></li>
</ul>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="SSFroc1.html#cb85-1"></a>frocData &lt;-<span class="st"> </span><span class="kw">DfExtractDataset</span>(dataset04, <span class="dt">trts =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb85-2"><a href="SSFroc1.html#cb85-2"></a>rocData &lt;-<span class="st"> </span><span class="kw">DfFroc2Roc</span>(frocData)</span></code></pre></div>
<p>The next code block determines <code>lesDist</code>, the lesion distribution array, which has <code>Lmax</code> (maximum number of lesions per diseased case over the dataset) rows and two columns. The first column contains the integers 1, 2, …, <code>Lmax</code> and the second column contains the fraction of diseased cases with the number of lesions per case specified in the first column. The second column will sum to unity. The RSM fitting algorithm needs to know how lesion-rich the dataset is, as the RSM predicted ROC-AUC depends on the lesion-richness of the dataset. For reasons that will become clear below, one also needs <code>lesWghts</code>, the distribution of the lesion weights.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="SSFroc1.html#cb86-1"></a>lesDistr &lt;-<span class="st"> </span><span class="kw">UtilLesionDistr</span>(frocData)</span>
<span id="cb86-2"><a href="SSFroc1.html#cb86-2"></a>lesWghts &lt;-<span class="st"> </span><span class="kw">UtilLesionWeightsDistr</span>(frocData) <span class="co"># this is needed later</span></span></code></pre></div>
<p>The meanings of <code>lesDistr</code> and <code>lesWghts</code> is clear from examining their values:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="SSFroc1.html#cb87-1"></a><span class="kw">print</span>(lesDistr)</span>
<span id="cb87-2"><a href="SSFroc1.html#cb87-2"></a><span class="co">#&gt;      [,1] [,2]</span></span>
<span id="cb87-3"><a href="SSFroc1.html#cb87-3"></a><span class="co">#&gt; [1,]    1 0.69</span></span>
<span id="cb87-4"><a href="SSFroc1.html#cb87-4"></a><span class="co">#&gt; [2,]    2 0.20</span></span>
<span id="cb87-5"><a href="SSFroc1.html#cb87-5"></a><span class="co">#&gt; [3,]    3 0.11</span></span>
<span id="cb87-6"><a href="SSFroc1.html#cb87-6"></a><span class="kw">print</span>(lesWghts)</span>
<span id="cb87-7"><a href="SSFroc1.html#cb87-7"></a><span class="co">#&gt;      [,1]      [,2]      [,3]      [,4]</span></span>
<span id="cb87-8"><a href="SSFroc1.html#cb87-8"></a><span class="co">#&gt; [1,]    1 1.0000000      -Inf      -Inf</span></span>
<span id="cb87-9"><a href="SSFroc1.html#cb87-9"></a><span class="co">#&gt; [2,]    2 0.5000000 0.5000000      -Inf</span></span>
<span id="cb87-10"><a href="SSFroc1.html#cb87-10"></a><span class="co">#&gt; [3,]    3 0.3333333 0.3333333 0.3333333</span></span></code></pre></div>
<p>For this dataset <code>Lmax</code> is 3, and 69 percent of the diseased cases have one lesion, 20 percent have two lesions and 11 percent have three lesions. Since the lesions are equally weighted, on cases with one lesion the weight of the lesion is unity, on cases with two lesions the weights of each lesion is 0.5 and on cases with three lesions the weight of each lesion is 1/3.</p>
<p>The next code block determines the number of treatments and readers (<code>I</code> and <code>J</code>) from the dimensions of the <code>frocData$NL</code> array. It creates an array <code>RsmParms</code> to hold the RSM fitted parameter values. For each treatment and reader it applies the fitting algorithm <code>FitRsmRoc()</code>. The first three returned values are <code>mu</code>, <code>lambdaP</code> and <code>nuP</code>, corresponding to RSM parameters <span class="math inline">\({\mu}\)</span>, <span class="math inline">\({\lambda^{&#39;}}\)</span> and <span class="math inline">\({\nu^{&#39;}}\)</span> .</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="SSFroc1.html#cb88-1"></a>I &lt;-<span class="st"> </span><span class="kw">dim</span>(frocData<span class="op">$</span>NL)[<span class="dv">1</span>]</span>
<span id="cb88-2"><a href="SSFroc1.html#cb88-2"></a>J &lt;-<span class="st"> </span><span class="kw">dim</span>(frocData<span class="op">$</span>NL)[<span class="dv">2</span>]</span>
<span id="cb88-3"><a href="SSFroc1.html#cb88-3"></a>RsmParms &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">c</span>(I,J,<span class="dv">3</span>))</span>
<span id="cb88-4"><a href="SSFroc1.html#cb88-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>I) {</span>
<span id="cb88-5"><a href="SSFroc1.html#cb88-5"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>J)  {</span>
<span id="cb88-6"><a href="SSFroc1.html#cb88-6"></a>    x1 &lt;-<span class="st"> </span><span class="kw">FitRsmRoc</span>(rocData, <span class="dt">trt =</span> i, <span class="dt">rdr =</span> j, lesDistr)</span>
<span id="cb88-7"><a href="SSFroc1.html#cb88-7"></a>    RsmParms[i,j,<span class="dv">1</span>] &lt;-<span class="st"> </span>x1[[<span class="dv">1</span>]] <span class="co"># mu</span></span>
<span id="cb88-8"><a href="SSFroc1.html#cb88-8"></a>    RsmParms[i,j,<span class="dv">2</span>] &lt;-<span class="st"> </span>x1[[<span class="dv">2</span>]] <span class="co"># lambdaP</span></span>
<span id="cb88-9"><a href="SSFroc1.html#cb88-9"></a>    RsmParms[i,j,<span class="dv">3</span>] &lt;-<span class="st"> </span>x1[[<span class="dv">3</span>]] <span class="co"># nuP</span></span>
<span id="cb88-10"><a href="SSFroc1.html#cb88-10"></a>  }</span>
<span id="cb88-11"><a href="SSFroc1.html#cb88-11"></a>}</span></code></pre></div>
<p>I recommend taking the median of each of the parameters, over all treatment-reader indices, as representing the average NH dataset. The median is less sensitive to outliers than the mean.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="SSFroc1.html#cb89-1"></a>muMed &lt;-<span class="st"> </span><span class="kw">median</span>(RsmParms[,,<span class="dv">1</span>]) </span>
<span id="cb89-2"><a href="SSFroc1.html#cb89-2"></a>lambdaPMed &lt;-<span class="st"> </span><span class="kw">median</span>(RsmParms[,,<span class="dv">2</span>])</span>
<span id="cb89-3"><a href="SSFroc1.html#cb89-3"></a>nuPMed &lt;-<span class="st"> </span><span class="kw">median</span>(RsmParms[,,<span class="dv">3</span>])</span></code></pre></div>
<p>The defining values of the fitting model are <code>muMed</code> = 3.3105557, <code>lambdaPMed</code> = 1.714368 and <code>nuPMed</code> = 0.7036567. Note that these obey the constraints <code>lambdaPMed &gt; 0</code> and <code>0 &lt; nuP &lt; 1</code>. One then converts the physical parameters to the intrinsic values:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="SSFroc1.html#cb90-1"></a>temp &lt;-<span class="st"> </span><span class="kw">UtilPhysical2IntrinsicRSM</span>(muMed, lambdaPMed, nuPMed)</span>
<span id="cb90-2"><a href="SSFroc1.html#cb90-2"></a>lambdaMed &lt;-<span class="st"> </span>temp<span class="op">$</span>lambda</span>
<span id="cb90-3"><a href="SSFroc1.html#cb90-3"></a>nuMed &lt;-<span class="st"> </span>temp<span class="op">$</span>nu</span></code></pre></div>
<p>In terms of intrinsic parameters, the defining values of the fitting model are <code>muMed</code> = 3.3105557, <code>lambdaMed</code> = 5.6755108 and <code>nuMed</code> = 0.3673814. We are now ready to calcuate the expected NH FOMs using the ROC -AUC and the wAFROC FOM.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="SSFroc1.html#cb91-1"></a>aucRocNH &lt;-<span class="st"> </span><span class="kw">PlotRsmOperatingCharacteristics</span>(muMed, lambdaMed, nuMed, </span>
<span id="cb91-2"><a href="SSFroc1.html#cb91-2"></a>                                            <span class="dt">lesDistr =</span> lesDistr, </span>
<span id="cb91-3"><a href="SSFroc1.html#cb91-3"></a>                                            <span class="dt">lesWghtDistr =</span> lesWghts, <span class="dt">OpChType =</span> <span class="st">&quot;ROC&quot;</span>)<span class="op">$</span>aucROC</span>
<span id="cb91-4"><a href="SSFroc1.html#cb91-4"></a>aucwAfrocNH &lt;-<span class="st"> </span><span class="kw">PlotRsmOperatingCharacteristics</span>(muMed, lambdaMed, nuMed, </span>
<span id="cb91-5"><a href="SSFroc1.html#cb91-5"></a>                                              <span class="dt">lesDistr =</span> lesDistr, </span>
<span id="cb91-6"><a href="SSFroc1.html#cb91-6"></a>                                              <span class="dt">lesWghtDistr =</span> lesWghts, <span class="dt">OpChType =</span> <span class="st">&quot;wAFROC&quot;</span>)<span class="op">$</span>aucwAFROC</span></code></pre></div>
<ul>
<li><p>The plotting function <code>PlotRsmOperatingCharacteristics()</code> returns a number of other objects, most importantly the plot, but here we use only the AUC, which is obtained by numerical integration of the predicted operating characteristics. However, it calls for the <strong>intrinsic</strong> RSM parameters, which is why we had to convert the <strong>physical</strong> to the <strong>intrinsic</strong> values.</p></li>
<li><p>One has <code>aucRocNH = 0.8791301</code> and <code>aucwAfrocNH = 0.7198311</code>. Note that the wAFROC-FOM is smaller than the ROC-FOM as it includes the localization constraint.</p></li>
<li><p>To induce the alternative hypothesis condition, one increments <span class="math inline">\(\mu_{NH}\)</span> by <span class="math inline">\(\Delta_{\mu}\)</span>. The resulting ROC-AUC and wAFROC-AUC are calculated, again by numerical integration of the RSM predicted ROC and wAFROC curves, leading to the corresponding effect-sizes (note that in each equation below one takes the difference between the AH value minus the NH value):</p></li>
<li><p>The next step is to calculate the effect size (new value minus the NH value) using ROC and wAFROC FOMs for a series of specifed <code>deltaMu</code> values. This generates values that can be used to interpolate a wAFROC effect size for a specified ROC effect size.</p></li>
</ul>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="SSFroc1.html#cb92-1"></a>deltaMu &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.2</span>, <span class="fl">0.01</span>) <span class="co"># values of deltaMu to scan below</span></span>
<span id="cb92-2"><a href="SSFroc1.html#cb92-2"></a>esRoc &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">length</span>(deltaMu));eswAfroc &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">length</span>(deltaMu))</span>
<span id="cb92-3"><a href="SSFroc1.html#cb92-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(deltaMu)) {</span>
<span id="cb92-4"><a href="SSFroc1.html#cb92-4"></a>  esRoc[i] &lt;-<span class="st"> </span><span class="kw">PlotRsmOperatingCharacteristics</span>(</span>
<span id="cb92-5"><a href="SSFroc1.html#cb92-5"></a>    muMed <span class="op">+</span><span class="st"> </span>deltaMu[i], lambdaMed, nuMed, <span class="dt">lesDistr =</span> lesDistr, </span>
<span id="cb92-6"><a href="SSFroc1.html#cb92-6"></a>    <span class="dt">lesWghtDistr =</span> lesWghts, <span class="dt">OpChType =</span> <span class="st">&quot;ROC&quot;</span>)<span class="op">$</span>aucROC <span class="op">-</span><span class="st"> </span>aucRocNH</span>
<span id="cb92-7"><a href="SSFroc1.html#cb92-7"></a>  eswAfroc[i] &lt;-<span class="st"> </span><span class="kw">PlotRsmOperatingCharacteristics</span>(</span>
<span id="cb92-8"><a href="SSFroc1.html#cb92-8"></a>    muMed<span class="op">+</span><span class="st"> </span>deltaMu[i], lambdaMed, nuMed, <span class="dt">lesDistr =</span> lesDistr, </span>
<span id="cb92-9"><a href="SSFroc1.html#cb92-9"></a>    <span class="dt">lesWghtDistr =</span> lesWghts, <span class="dt">OpChType =</span> <span class="st">&quot;wAFROC&quot;</span>)<span class="op">$</span>aucwAFROC <span class="op">-</span><span class="st"> </span>aucwAfrocNH</span>
<span id="cb92-10"><a href="SSFroc1.html#cb92-10"></a>  <span class="kw">cat</span>(<span class="st">&quot;ES_ROC = &quot;</span>, esRoc[i], <span class="st">&quot;, ES_wAFROC = &quot;</span>, eswAfroc[i],<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb92-11"><a href="SSFroc1.html#cb92-11"></a>}</span>
<span id="cb92-12"><a href="SSFroc1.html#cb92-12"></a><span class="co">#&gt; ES_ROC =  0.0006197813 , ES_wAFROC =  0.001329066 </span></span>
<span id="cb92-13"><a href="SSFroc1.html#cb92-13"></a><span class="co">#&gt; ES_ROC =  0.001234752 , ES_wAFROC =  0.002650005 </span></span>
<span id="cb92-14"><a href="SSFroc1.html#cb92-14"></a><span class="co">#&gt; ES_ROC =  0.00184496 , ES_wAFROC =  0.003962878 </span></span>
<span id="cb92-15"><a href="SSFroc1.html#cb92-15"></a><span class="co">#&gt; ES_ROC =  0.002450451 , ES_wAFROC =  0.005267748 </span></span>
<span id="cb92-16"><a href="SSFroc1.html#cb92-16"></a><span class="co">#&gt; ES_ROC =  0.003051273 , ES_wAFROC =  0.006564677 </span></span>
<span id="cb92-17"><a href="SSFroc1.html#cb92-17"></a><span class="co">#&gt; ES_ROC =  0.003647472 , ES_wAFROC =  0.007853725 </span></span>
<span id="cb92-18"><a href="SSFroc1.html#cb92-18"></a><span class="co">#&gt; ES_ROC =  0.004239094 , ES_wAFROC =  0.009134954 </span></span>
<span id="cb92-19"><a href="SSFroc1.html#cb92-19"></a><span class="co">#&gt; ES_ROC =  0.004826184 , ES_wAFROC =  0.01040842 </span></span>
<span id="cb92-20"><a href="SSFroc1.html#cb92-20"></a><span class="co">#&gt; ES_ROC =  0.005408788 , ES_wAFROC =  0.0116742 </span></span>
<span id="cb92-21"><a href="SSFroc1.html#cb92-21"></a><span class="co">#&gt; ES_ROC =  0.00598695 , ES_wAFROC =  0.01293233 </span></span>
<span id="cb92-22"><a href="SSFroc1.html#cb92-22"></a><span class="co">#&gt; ES_ROC =  0.006560717 , ES_wAFROC =  0.01418289 </span></span>
<span id="cb92-23"><a href="SSFroc1.html#cb92-23"></a><span class="co">#&gt; ES_ROC =  0.007130131 , ES_wAFROC =  0.01542592 </span></span>
<span id="cb92-24"><a href="SSFroc1.html#cb92-24"></a><span class="co">#&gt; ES_ROC =  0.007695238 , ES_wAFROC =  0.0166615 </span></span>
<span id="cb92-25"><a href="SSFroc1.html#cb92-25"></a><span class="co">#&gt; ES_ROC =  0.00825608 , ES_wAFROC =  0.01788967 </span></span>
<span id="cb92-26"><a href="SSFroc1.html#cb92-26"></a><span class="co">#&gt; ES_ROC =  0.008812702 , ES_wAFROC =  0.0191105 </span></span>
<span id="cb92-27"><a href="SSFroc1.html#cb92-27"></a><span class="co">#&gt; ES_ROC =  0.009365145 , ES_wAFROC =  0.02032404 </span></span>
<span id="cb92-28"><a href="SSFroc1.html#cb92-28"></a><span class="co">#&gt; ES_ROC =  0.009913453 , ES_wAFROC =  0.02153036 </span></span>
<span id="cb92-29"><a href="SSFroc1.html#cb92-29"></a><span class="co">#&gt; ES_ROC =  0.01045767 , ES_wAFROC =  0.0227295 </span></span>
<span id="cb92-30"><a href="SSFroc1.html#cb92-30"></a><span class="co">#&gt; ES_ROC =  0.01099783 , ES_wAFROC =  0.02392152 </span></span>
<span id="cb92-31"><a href="SSFroc1.html#cb92-31"></a><span class="co">#&gt; ES_ROC =  0.01153399 , ES_wAFROC =  0.02510649</span></span></code></pre></div>
<p>Here is a plot of wAFROC effect size (y-axis) vs. ROC effect size.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="SSFroc1.html#cb93-1"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">es_ROC =</span> esRoc, <span class="dt">es_wAFROC =</span> eswAfroc)</span>
<span id="cb93-2"><a href="SSFroc1.html#cb93-2"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> df, <span class="kw">aes</span>(<span class="dt">x =</span> es_ROC, <span class="dt">y =</span> es_wAFROC)) <span class="op">+</span></span>
<span id="cb93-3"><a href="SSFroc1.html#cb93-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span>x) <span class="op">+</span></span>
<span id="cb93-4"><a href="SSFroc1.html#cb93-4"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>) <span class="op">+</span></span>
<span id="cb93-5"><a href="SSFroc1.html#cb93-5"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb93-6"><a href="SSFroc1.html#cb93-6"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb93-7"><a href="SSFroc1.html#cb93-7"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="op">+</span></span>
<span id="cb93-8"><a href="SSFroc1.html#cb93-8"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb93-9"><a href="SSFroc1.html#cb93-9"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) </span>
<span id="cb93-10"><a href="SSFroc1.html#cb93-10"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="17-FrocSampleSize1_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The plot is very close to linear. This makes it easy to design an interpolation function. In the following code block the first line fits <code>eswAfroc</code> vs. <code>esRoc</code> using the linear model <code>lm()</code> function constrained to pass through the origin (the minus one): <code>scaleFactor &lt;- lm(eswAfroc ~ -1 + esRoc)</code>. One expects this constraint since for <code>deltaMu = 0</code> the effect size must be zero no matter how it is measured.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="SSFroc1.html#cb94-1"></a>scaleFactor&lt;-<span class="kw">lm</span>(eswAfroc<span class="op">~-</span><span class="dv">1</span><span class="op">+</span>esRoc) <span class="co"># fit values to straight line thru origin</span></span>
<span id="cb94-2"><a href="SSFroc1.html#cb94-2"></a>effectSizeROC &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.01</span>)</span>
<span id="cb94-3"><a href="SSFroc1.html#cb94-3"></a>effectSizewAFROC &lt;-<span class="st"> </span>effectSizeROC<span class="op">*</span>scaleFactor<span class="op">$</span>coefficients[<span class="dv">1</span>] <span class="co"># r2 = summary(scaleFactor)$r.squared</span></span></code></pre></div>
<p>The scaleFactor of the straight line fit is <code>scaleFactor</code>, where scaleFactor = 2.1688609 and <code>R2</code> = 0.9999904. Therefore, the conversion from ROC to wAFROC effect size is: <code>effectSizewAFROC = scaleFactor * effectSizeROC</code>. <strong>The wAFROC effect size is twice the ROC effect size.</strong> All that remains is to calculate the variance componenents using the two FOMs:</p>
</div>
<div id="computing-the-respective-variance-components" class="section level2" number="13.3">
<h2><span class="header-section-number">13.3</span> Computing the respective variance components</h2>
<p>The code block applies <code>StSignificanceTesting()</code> to <code>rocData</code> and <code>frocData</code>, using the appropriate FOM, and extracts the variance components.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="SSFroc1.html#cb95-1"></a>temp1 &lt;-<span class="st"> </span><span class="kw">StSignificanceTesting</span>(rocData, <span class="dt">FOM =</span> <span class="st">&quot;Wilcoxon&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;DBMH&quot;</span>, <span class="dt">option =</span> <span class="st">&quot;RRRC&quot;</span>)</span>
<span id="cb95-2"><a href="SSFroc1.html#cb95-2"></a>temp2 &lt;-<span class="st"> </span><span class="kw">StSignificanceTesting</span>(frocData, <span class="dt">FOM =</span> <span class="st">&quot;wAFROC&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;DBMH&quot;</span>, <span class="dt">option =</span> <span class="st">&quot;RRRC&quot;</span>)</span>
<span id="cb95-3"><a href="SSFroc1.html#cb95-3"></a>varCompROC &lt;-<span class="st"> </span>temp1<span class="op">$</span>varComp</span>
<span id="cb95-4"><a href="SSFroc1.html#cb95-4"></a>varCompwAFROC &lt;-<span class="st"> </span>temp2<span class="op">$</span>varComp</span></code></pre></div>
<p>The observed wAFROC effect-size is -0.0068562. This is a very small effect size; the corresponding ROC effect-size is -0.0051; the sign does not affect the calculations, which is too small to reach 80% power. It is not surprising that the study <span class="citation">(Zanca et al. <a href="#ref-RN1882" role="doc-biblioref">2009</a>)</span> did not find a significant difference between these two treatments</p>
<p>The respective variance components are:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="SSFroc1.html#cb96-1"></a><span class="kw">print</span>(varCompROC)</span>
<span id="cb96-2"><a href="SSFroc1.html#cb96-2"></a><span class="co">#&gt;          varR       varC        varTR       varTC       varRC     varErr</span></span>
<span id="cb96-3"><a href="SSFroc1.html#cb96-3"></a><span class="co">#&gt; 1 0.000827738 0.03812335 0.0001526507 0.009644327 0.003544196 0.09484637</span></span>
<span id="cb96-4"><a href="SSFroc1.html#cb96-4"></a><span class="kw">print</span>(varCompwAFROC)</span>
<span id="cb96-5"><a href="SSFroc1.html#cb96-5"></a><span class="co">#&gt;          varR       varC         varTR      varTC      varRC    varErr</span></span>
<span id="cb96-6"><a href="SSFroc1.html#cb96-6"></a><span class="co">#&gt; 1 0.001854229 0.06117805 -0.0004439279 0.01016519 0.01355883 0.0967256</span></span></code></pre></div>
<p>Only terms involving treatment are relevant to sample size. The wAFROC <code>varTC</code> and <code>varError</code> values are slightly larger than the ROC ones - as expected because, again, the range of the wAFROC FOM is twice that of the ROC FOM.</p>
</div>
<div id="comparing-roc-power-to-wafroc-power-for-equivalent-effect-sizes" class="section level2" number="13.4">
<h2><span class="header-section-number">13.4</span> Comparing ROC power to wAFROC power for equivalent effect-sizes</h2>
<p>We are now ready to compare ROC and wAFROC powers for equivalent effect sizes. The following example is for 5 readers (<code>JTest</code>) and 100 cases (<code>KTest</code>) in the <strong>pivotal study</strong>.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="SSFroc1.html#cb97-1"></a>powerROC &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">length</span>(effectSizeROC));powerwAFROC &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">length</span>(effectSizeROC))</span>
<span id="cb97-2"><a href="SSFroc1.html#cb97-2"></a></span>
<span id="cb97-3"><a href="SSFroc1.html#cb97-3"></a>JTest &lt;-<span class="st"> </span><span class="dv">5</span>;KTest &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb97-4"><a href="SSFroc1.html#cb97-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(effectSizeROC)) {</span>
<span id="cb97-5"><a href="SSFroc1.html#cb97-5"></a>  varYTR &lt;-<span class="st"> </span>varCompROC<span class="op">$</span>varTR <span class="co"># these are pseudovalue based variance components assuming FOM = &quot;Wilcoxon&quot;</span></span>
<span id="cb97-6"><a href="SSFroc1.html#cb97-6"></a>  varYTC &lt;-<span class="st"> </span>varCompROC<span class="op">$</span>varTC</span>
<span id="cb97-7"><a href="SSFroc1.html#cb97-7"></a>  varYEps &lt;-<span class="st"> </span>varCompROC<span class="op">$</span>varErr</span>
<span id="cb97-8"><a href="SSFroc1.html#cb97-8"></a>  ret &lt;-<span class="st"> </span><span class="kw">SsPowerGivenJKDbmVarComp</span> (<span class="dt">J =</span> JTest, <span class="dt">K =</span> KTest, <span class="dt">effectSize =</span> effectSizeROC[i], varYTR, varYTC, varYEps, <span class="dt">option =</span> <span class="st">&quot;RRRC&quot;</span>)</span>
<span id="cb97-9"><a href="SSFroc1.html#cb97-9"></a>  powerROC[i] &lt;-<span class="st"> </span>ret<span class="op">$</span>powerRRRC</span>
<span id="cb97-10"><a href="SSFroc1.html#cb97-10"></a>  </span>
<span id="cb97-11"><a href="SSFroc1.html#cb97-11"></a>  varYTR &lt;-<span class="st"> </span>varCompwAFROC<span class="op">$</span>varTR <span class="co"># these are pseudovalue based variance components assuming FOM = &quot;wAFROC&quot;</span></span>
<span id="cb97-12"><a href="SSFroc1.html#cb97-12"></a>  varYTC &lt;-<span class="st"> </span>varCompwAFROC<span class="op">$</span>varTC</span>
<span id="cb97-13"><a href="SSFroc1.html#cb97-13"></a>  varYEps &lt;-<span class="st"> </span>varCompwAFROC<span class="op">$</span>varErr</span>
<span id="cb97-14"><a href="SSFroc1.html#cb97-14"></a>  ret &lt;-<span class="st"> </span><span class="kw">SsPowerGivenJKDbmVarComp</span> (<span class="dt">J =</span> JTest, <span class="dt">K =</span> KTest, <span class="dt">effectSize =</span> effectSizewAFROC[i], varYTR, varYTC, varYEps, <span class="dt">option =</span> <span class="st">&quot;RRRC&quot;</span>)</span>
<span id="cb97-15"><a href="SSFroc1.html#cb97-15"></a>  powerwAFROC[i] &lt;-<span class="st"> </span>ret<span class="op">$</span>powerRRRC</span>
<span id="cb97-16"><a href="SSFroc1.html#cb97-16"></a>  </span>
<span id="cb97-17"><a href="SSFroc1.html#cb97-17"></a>  <span class="kw">cat</span>(<span class="st">&quot;ROC-ES = &quot;</span>, effectSizeROC[i], <span class="st">&quot;, wAFROC-ES = &quot;</span>, effectSizewAFROC[i], </span>
<span id="cb97-18"><a href="SSFroc1.html#cb97-18"></a>      <span class="st">&quot;, Power-ROC = &quot;</span>, powerROC[i], <span class="st">&quot;, Power-wAFROC = &quot;</span>, powerwAFROC[i], <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb97-19"><a href="SSFroc1.html#cb97-19"></a>}</span>
<span id="cb97-20"><a href="SSFroc1.html#cb97-20"></a><span class="co">#&gt; ROC-ES =  0.01 , wAFROC-ES =  0.02168861 , Power-ROC =  0.06443046 , Power-wAFROC =  0.1266316 </span></span>
<span id="cb97-21"><a href="SSFroc1.html#cb97-21"></a><span class="co">#&gt; ROC-ES =  0.02 , wAFROC-ES =  0.04337722 , Power-ROC =  0.108789 , Power-wAFROC =  0.3605744 </span></span>
<span id="cb97-22"><a href="SSFroc1.html#cb97-22"></a><span class="co">#&gt; ROC-ES =  0.03 , wAFROC-ES =  0.06506583 , Power-ROC =  0.1847115 , Power-wAFROC =  0.6686874 </span></span>
<span id="cb97-23"><a href="SSFroc1.html#cb97-23"></a><span class="co">#&gt; ROC-ES =  0.04 , wAFROC-ES =  0.08675444 , Power-ROC =  0.2907927 , Power-wAFROC =  0.8897125 </span></span>
<span id="cb97-24"><a href="SSFroc1.html#cb97-24"></a><span class="co">#&gt; ROC-ES =  0.05 , wAFROC-ES =  0.108443 , Power-ROC =  0.4195443 , Power-wAFROC =  0.9777308 </span></span>
<span id="cb97-25"><a href="SSFroc1.html#cb97-25"></a><span class="co">#&gt; ROC-ES =  0.06 , wAFROC-ES =  0.1301317 , Power-ROC =  0.5573812 , Power-wAFROC =  0.9973522 </span></span>
<span id="cb97-26"><a href="SSFroc1.html#cb97-26"></a><span class="co">#&gt; ROC-ES =  0.07 , wAFROC-ES =  0.1518203 , Power-ROC =  0.6881601 , Power-wAFROC =  0.9998172 </span></span>
<span id="cb97-27"><a href="SSFroc1.html#cb97-27"></a><span class="co">#&gt; ROC-ES =  0.08 , wAFROC-ES =  0.1735089 , Power-ROC =  0.7983611 , Power-wAFROC =  0.9999927 </span></span>
<span id="cb97-28"><a href="SSFroc1.html#cb97-28"></a><span class="co">#&gt; ROC-ES =  0.09 , wAFROC-ES =  0.1951975 , Power-ROC =  0.8809508 , Power-wAFROC =  0.9999998 </span></span>
<span id="cb97-29"><a href="SSFroc1.html#cb97-29"></a><span class="co">#&gt; ROC-ES =  0.1 , wAFROC-ES =  0.2168861 , Power-ROC =  0.936068 , Power-wAFROC =  1</span></span></code></pre></div>
<p>Since the wAFROC effect size is about a factor of two larger than the ROC effect size, wAFROC power is larger than that for ROC. The effect is magnified as the effect size enters as the square in the formula for the power (this overwhelms the slight increase in variability of wAFROC-FOM relative to ROC-FOM noted previously). The following is a plot of the respective powers.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="SSFroc1.html#cb98-1"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">power_ROC =</span> powerROC, <span class="dt">power_wAFROC =</span> powerwAFROC)</span>
<span id="cb98-2"><a href="SSFroc1.html#cb98-2"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> power_ROC, <span class="dt">y =</span> power_wAFROC)) <span class="op">+</span></span>
<span id="cb98-3"><a href="SSFroc1.html#cb98-3"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> df, <span class="dt">size =</span> <span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb98-4"><a href="SSFroc1.html#cb98-4"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb98-5"><a href="SSFroc1.html#cb98-5"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb98-6"><a href="SSFroc1.html#cb98-6"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>))  <span class="op">+</span></span>
<span id="cb98-7"><a href="SSFroc1.html#cb98-7"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb98-8"><a href="SSFroc1.html#cb98-8"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb98-9"><a href="SSFroc1.html#cb98-9"></a><span class="kw">print</span>(p)</span></code></pre></div>
<p><img src="17-FrocSampleSize1_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="references-9" class="section level2" number="13.5">
<h2><span class="header-section-number">13.5</span> References</h2>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-RN1882">
<p>Zanca, Federica, Jurgen Jacobs, Chantal Van Ongeval, Filip Claus, Valerie Celis, Catherine Geniets, Veerle Provost, Herman Pauwels, Guy Marchal, and Hilde Bosmans. 2009. “Evaluation of Clinical Image Processing Algorithms Used in Digital Mammography.” Journal Article. <em>Medical Physics</em> 36 (3): 765–75.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="SSJafrocEffectSize.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="SSFroc2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["RJafrocBook.pdf", "RJafrocBook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
