<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 FROC data format | RJafroc documentation</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.12.1 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 FROC data format | RJafroc documentation" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="dpc10ster/RJafrocBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 FROC data format | RJafroc documentation" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Dev P. Chakraborty" />


<meta name="date" content="2019-08-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="tba-roi-paradigm.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RJafroc documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="frocdataformat.html"><a href="frocdataformat.html"><i class="fa fa-check"></i><b>3</b> FROC data format</a><ul>
<li class="chapter" data-level="3.1" data-path="frocdataformat.html"><a href="frocdataformat.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="frocdataformat.html"><a href="frocdataformat.html#an-actual-froc-dataset"><i class="fa fa-check"></i><b>3.2</b> An actual FROC dataset</a><ul>
<li class="chapter" data-level="3.2.1" data-path="frocdataformat.html"><a href="frocdataformat.html#numbers-of-non-diseased-and-diseased-cases"><i class="fa fa-check"></i><b>3.2.1</b> Numbers of non-diseased and diseased cases</a></li>
<li class="chapter" data-level="3.2.2" data-path="frocdataformat.html"><a href="frocdataformat.html#why-dimension-the-nl-array-for-the-total-number-of-cases"><i class="fa fa-check"></i><b>3.2.2</b> Why dimension the <code>NL</code> array for the total number of cases?</a></li>
<li class="chapter" data-level="3.2.3" data-path="frocdataformat.html"><a href="frocdataformat.html#ratings-on-a-non-diseased-case"><i class="fa fa-check"></i><b>3.2.3</b> Ratings on a non-diseased case</a></li>
<li class="chapter" data-level="3.2.4" data-path="frocdataformat.html"><a href="frocdataformat.html#the-meaning-of-a-negative-infinity-rating"><i class="fa fa-check"></i><b>3.2.4</b> The meaning of a negative infinity rating</a></li>
<li class="chapter" data-level="3.2.5" data-path="frocdataformat.html"><a href="frocdataformat.html#ratings-on-a-non-diseased-case-1"><i class="fa fa-check"></i><b>3.2.5</b> Ratings on a non-diseased case</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="frocdataformat.html"><a href="frocdataformat.html#the-froc-excel-data-file"><i class="fa fa-check"></i><b>3.3</b> The FROC Excel data file</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tba-roi-paradigm.html"><a href="tba-roi-paradigm.html"><i class="fa fa-check"></i><b>4</b> TBA ROI paradigm</a><ul>
<li class="chapter" data-level="4.1" data-path="tba-roi-paradigm.html"><a href="tba-roi-paradigm.html#references"><i class="fa fa-check"></i><b>4.1</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">RJafroc documentation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="frocdataformat" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> FROC data format</h1>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">3.1</span> Introduction</h2>
<ul>
<li><p>In the free-response ROC (__FROC__) paradigm <span class="citation">(Bunch et al. <a href="#ref-RN85">1978</a>)</span> the observer’s task is to indicate (i.e., <strong>mark</strong> the location of) and <strong>rate</strong> (i.e., assign an ordered label - or confidence level - representing the degree of suspicion) regions in the image that are perceived as suspicious for presence of disease. Accordingly, FROC data consists of <strong>mark-rating pairs</strong>, where each mark indicates a region<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> that was considered suspicious for presence of a localized lesion and the rating is the corresponding confidence level. The number of mark-rating pairs on any particular case is a-priori unpredictable. It is a non-negative random integer (i.e., 0, 1, 2, …) that depends on the case, the reader and the modality. The relatively unstructured nature of FROC data makes FROC paradigm data more difficult to analyze than ROC paradigm data.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p></li>
<li>By adopting a proximity criterion, each mark is classified by the investigator as a lesion localization (LL) - if it is close to a real lesion - or a non-lesion localization (NL) otherwise.</li>
<li><p>The rating can be an integer or quasi- continuous (e.g., 0 – 100), or a floating point value, as long as higher numbers represent greater confidence in presence of one or more lesions in the ROI.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p></li>
<li><p>Region-level-normal ratings are stored in the <code>NL</code> field and region-level-abnormal ratings are stored in the <code>LL</code> field.</p></li>
</ul>
</div>
<div id="an-actual-froc-dataset" class="section level2">
<h2><span class="header-section-number">3.2</span> An actual FROC dataset</h2>
<p>An actual FROC dataset <span class="citation">(Zanca et al. <a href="#ref-RN1882">2009</a>)</span> is included as <code>dataset04</code>, which has the following <code>dataset</code> structure:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">str</span>(dataset04)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="co">#&gt; List of 8</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co">#&gt;  $ NL          : num [1:5, 1:4, 1:200, 1:7] -Inf -Inf 1 -Inf -Inf ...</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co">#&gt;  $ LL          : num [1:5, 1:4, 1:100, 1:3] 4 5 4 5 4 3 5 4 4 3 ...</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co">#&gt;  $ lesionNum   : int [1:100] 1 1 1 1 1 1 1 1 1 1 ...</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co">#&gt;  $ lesionID    : num [1:100, 1:3] 1 1 1 1 1 1 1 1 1 1 ...</span></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#&gt;  $ lesionWeight: num [1:100, 1:3] 1 1 1 1 1 1 1 1 1 1 ...</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co">#&gt;  $ dataType    : chr &quot;FROC&quot;</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co">#&gt;  $ modalityID  : Named chr [1:5] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:5] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="co">#&gt;  $ readerID    : Named chr [1:4] &quot;1&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot;</span></a>
<a class="sourceLine" id="cb1-12" title="12"><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:4] &quot;1&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot;</span></a></code></pre></div>
<p>Examination of the output reveals that:</p>
<ul>
<li>The <code>dataset</code> structure is a list with 8 members.</li>
<li>This is a 5-treatment 4-reader dataset (the lengths of the first and second dimensions, respectively, of the <code>NL</code> and <code>LL</code> arrays). The names of the treatments are in the <code>modalityID</code> array:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">attributes</span>(dataset04<span class="op">$</span>modalityID)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">#&gt; $names</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#&gt; [1] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot;</span></a></code></pre></div>
<p>For example, the name of the second treatment is <code>&quot;2&quot;</code>.</p>
<ul>
<li>The names of the readers are in the <code>readerID</code> array:</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">attributes</span>(dataset04<span class="op">$</span>readerID)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="co">#&gt; $names</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#&gt; [1] &quot;1&quot; &quot;3&quot; &quot;4&quot; &quot;5&quot;</span></a></code></pre></div>
<p>For example, the name of the second reader is <code>&quot;3&quot;</code>. Apparently reader <code>&quot;2&quot;</code> “dropped out” of the study.</p>
<div id="numbers-of-non-diseased-and-diseased-cases" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Numbers of non-diseased and diseased cases</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">length</span>(dataset04<span class="op">$</span>NL[<span class="dv">1</span>,<span class="dv">1</span>,,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">#&gt; [1] 200</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">length</span>(dataset04<span class="op">$</span>LL[<span class="dv">1</span>,<span class="dv">1</span>,,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">#&gt; [1] 100</span></a></code></pre></div>
<ul>
<li><p>The third dimension of the <code>NL</code> array is the total number of <strong>all</strong> cases, i.e., 200, and the third dimension of the <code>LL</code> array, i.e., 100, is the total number of diseased cases.</p></li>
<li><p>Subtracting the number of diseased cases from the number of all cases yields the number of non-diseased cases.</p></li>
<li><p>Therefore, in this dataset, there are 100 diseased cases and 100 non-diseased cases.</p></li>
</ul>
</div>
<div id="why-dimension-the-nl-array-for-the-total-number-of-cases" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Why dimension the <code>NL</code> array for the total number of cases?</h3>
<ul>
<li>Because, in addition to <code>LLs</code>, <code>NLs</code> are possible on diseased cases.</li>
<li>Only <code>LLs</code> are possible on diseased cases.</li>
<li>Only <code>NLs</code> are possible on non-diseased cases.</li>
<li>The missing values are filled in with <code>-Inf</code>.</li>
</ul>
</div>
<div id="ratings-on-a-non-diseased-case" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Ratings on a non-diseased case</h3>
<ul>
<li>For treatment 1, reader 1 and case 1 (the first non-diseased case), the NL ratings are:</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">dataset04<span class="op">$</span>NL[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co">#&gt; [1] -Inf -Inf -Inf -Inf -Inf -Inf -Inf</span></a></code></pre></div>
</div>
<div id="the-meaning-of-a-negative-infinity-rating" class="section level3">
<h3><span class="header-section-number">3.2.4</span> The meaning of a negative infinity rating</h3>
<ul>
<li>Obviously, a real rating cannot be negative infinity.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> This value is reserved for <strong>missing ratings</strong>, and more generally, <strong>missing marks</strong>.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a> For example, since all values in the above code chunk are negative infinities, this means this treatment-reader-case combination did not yield any mark-rating pairs. This possibility, alluded to above, is only possible with FROC data. All other paradigms (ROC, LROC and ROI) yield at least one rating per case.</li>
<li>The length of the fourth dimension of the <code>NL</code> array is determined by that treatment-reader-case combination yielding the maximum number of <code>NLs</code>. Consider the following chunk:</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) </a>
<a class="sourceLine" id="cb6-2" title="2">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) </a>
<a class="sourceLine" id="cb6-3" title="3">    <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">200</span>) </a>
<a class="sourceLine" id="cb6-4" title="4">      <span class="cf">if</span> (<span class="kw">all</span>(dataset04<span class="op">$</span>NL[i,j,k,] <span class="op">!=</span><span class="st"> </span><span class="op">-</span><span class="ot">Inf</span>)) </a>
<a class="sourceLine" id="cb6-5" title="5">        <span class="kw">cat</span>(i, j, k, <span class="kw">all</span>(dataset04<span class="op">$</span>NL[i,j,k,] <span class="op">!=</span><span class="st"> </span><span class="op">-</span><span class="ot">Inf</span>),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt; 5 4 192 TRUE</span></a></code></pre></div>
<ul>
<li>This shows that the fourth dimension of the <code>NL</code> array has to be of length 7 because <em>one, and only reader</em>, specifically reader “4”, made 7 <code>NL</code> marks on a diseased case in treatment “5”!</li>
</ul>
</div>
<div id="ratings-on-a-non-diseased-case-1" class="section level3">
<h3><span class="header-section-number">3.2.5</span> Ratings on a non-diseased case</h3>
<p>Unlike non-diseased cases, diseased cases can have both <code>NL</code> and <code>LL</code> ratings.</p>
<ul>
<li>For treatment 1, reader 1, case 51 (the 1st diseased case) the NL ratings are:</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">dataset04<span class="op">$</span>NL[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">51</span>,]</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co">#&gt; [1] -Inf -Inf -Inf -Inf -Inf -Inf -Inf</span></a>
<a class="sourceLine" id="cb7-3" title="3">dataset04<span class="op">$</span>lesionNum[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb7-5" title="5">dataset04<span class="op">$</span>LL[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; [1]    4 -Inf -Inf</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="kw">mean</span>(<span class="kw">is.finite</span>(dataset04<span class="op">$</span>LL))</a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt; [1] 0.3043333</span></a></code></pre></div>
<p>. There are only two finite values because this case has two ROI-level-abnormal regions, and 2 plus 2 makes for the assumed 4-regions per case. The corresponding <code>$lesionNum</code> field is 1.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">mean</span>(<span class="kw">is.finite</span>(dataset04<span class="op">$</span>NL[,,<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>,]))</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt; [1] 0.05942857</span></a>
<a class="sourceLine" id="cb8-3" title="3">dataset04<span class="op">$</span>NL[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">51</span>,]</a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt; [1] -Inf -Inf -Inf -Inf -Inf -Inf -Inf</span></a>
<a class="sourceLine" id="cb8-5" title="5">dataset04<span class="op">$</span>lesionNum[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb8-7" title="7">dataset04<span class="op">$</span>LL[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co">#&gt; [1]    4 -Inf -Inf</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="kw">mean</span>(<span class="kw">is.finite</span>(dataset04<span class="op">$</span>LL))</a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co">#&gt; [1] 0.3043333</span></a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">mean</span>(<span class="kw">is.finite</span>(dataset04<span class="op">$</span>NL[,,<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>,]))</a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co">#&gt; [1] 0.05942857</span></a>
<a class="sourceLine" id="cb9-3" title="3">dataset04<span class="op">$</span>NL[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">51</span>,]</a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#&gt; [1] -Inf -Inf -Inf -Inf -Inf -Inf -Inf</span></a>
<a class="sourceLine" id="cb9-5" title="5">dataset04<span class="op">$</span>lesionNum[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb9-6" title="6"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb9-7" title="7">dataset04<span class="op">$</span>LL[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">#&gt; [1]    4 -Inf -Inf</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="kw">mean</span>(<span class="kw">is.finite</span>(dataset04<span class="op">$</span>LL))</a>
<a class="sourceLine" id="cb9-10" title="10"><span class="co">#&gt; [1] 0.3043333</span></a></code></pre></div>
<ul>
<li>The ratings of the 2 ROI-level-abnormal ROIs on this case are 4. The mean rating over all ROI-level-abnormal ROIs is 3.6785323.</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">mean</span>(<span class="kw">is.finite</span>(dataset04<span class="op">$</span>NL[,,<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>,]))</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="co">#&gt; [1] 0.05942857</span></a>
<a class="sourceLine" id="cb10-3" title="3">dataset04<span class="op">$</span>NL[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">51</span>,]</a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">#&gt; [1] -Inf -Inf -Inf -Inf -Inf -Inf -Inf</span></a>
<a class="sourceLine" id="cb10-5" title="5">dataset04<span class="op">$</span>lesionNum[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb10-6" title="6"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb10-7" title="7">dataset04<span class="op">$</span>LL[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,]</a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt; [1]    4 -Inf -Inf</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="kw">mean</span>(<span class="kw">is.finite</span>(dataset04<span class="op">$</span>LL))</a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co">#&gt; [1] 0.3043333</span></a></code></pre></div>
</div>
</div>
<div id="the-froc-excel-data-file" class="section level2">
<h2><span class="header-section-number">3.3</span> The FROC Excel data file</h2>
<p>An Excel file in JAFROC format containing simulated ROI data corresponding to <code>dataset04</code>, is included with the distribution. The first command (below) finds the location of the file and the second command reads it and saves it to a dataset object <code>ds</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">fileName &lt;-<span class="st"> </span><span class="kw">system.file</span>(</a>
<a class="sourceLine" id="cb11-2" title="2">    <span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;includedFrocData.xlsx&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;RJafroc&quot;</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb11-3" title="3">ds &lt;-<span class="st"> </span><span class="kw">DfReadDataFile</span>(fileName)</a>
<a class="sourceLine" id="cb11-4" title="4">ds<span class="op">$</span>dataType</a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co">#&gt; [1] &quot;FROC&quot;</span></a></code></pre></div>
<p>The <code>DfReadDataFile</code> function automatically recognizes that this is an <em>ROI</em> dataset. Its structure is similar to the JAFROC format Excel file, with some important differences, noted below. It contains three worksheets:</p>
<p><img src="images/FROC-TP-Truth-1.png" style="width:40.0%" /><img src="images/FROC-TP-Truth-2.png" style="width:40.0%" />
<img src="images/FROC-TP-Truth-3.png" style="width:40.0%" /><img src="images/FROC-TP-Truth-4.png" style="width:40.0%" />
<img src="images/FROC-TP-Truth-5.png" style="width:40.0%" /></p>
<ul>
<li>The <code>Truth</code> worksheet - this indicates which cases are diseased and which are non-diseased and the number of ROI-level-abnormal region on each case.
<ul>
<li>There are 50 normal cases (labeled 1-50) under column <code>CaseID</code> and 40 abnormal cases (labeled 51-90).<br />
</li>
<li>The <code>LesionID</code> field for each normal case (e.g., <code>CaseID</code> = 1) is zero and there is one row per case. For abnormal cases, this field has a variable number of entries, ranging from 1 to 4. As an example, there are two rows for <code>CaseID</code> = 51 in the Excel file: one with <code>LesionID</code> = 2 and one with <code>LesionID</code> = 3.<br />
</li>
<li>The <code>Weights</code> field is always zero (this field is not used in ROI analysis).</li>
</ul></li>
</ul>
<p><img src="images/ROI-FP-1.png" style="width:40.0%" />
<img src="images/ROI-FP-2.png" style="width:40.0%" /></p>
<ul>
<li>The <code>FP</code> (or <code>NL</code>) worksheet - this lists the ratings of ROI-level-normal regions.
<ul>
<li>For <code>ReaderID</code> = 1, <code>ModalityID</code> = 1 and <code>CaseID</code> = 1 there are 4 rows, corresponding to the 4 ROI-level-normal regions in this case. The corresponding ratings are . The pattern repeats for other treatments and readers, but the rating are, of course, different.<br />
</li>
<li>Each <code>CaseID</code> is represented in the <code>FP</code> worksheet (a rare exception could occur if a case-level abnormal case has 4 abnormal regions).</li>
</ul></li>
</ul>
<p><img src="images/ROI-TP-1.png" style="width:40.0%" /></p>
<ul>
<li>The <code>TP</code> (or <code>LL</code>) worksheet - this lists the ratings of ROI-level-abnormal regions.
<ul>
<li>Because normal cases generate TPs, one does not find any entry with <code>CaseID</code> = 1-50 in the <code>TP</code> worksheet.<br />
</li>
<li>The lowest <code>CaseID</code> in the <code>TP</code> worksheet is 51, which corresponds to the first abnormal case.<br />
</li>
<li>There are two entries for this case, corresponding to the two ROI-level-abnormal regions present in this case. Recall that corresponding to this <code>CaseID</code> in the <code>Truth</code> worksheet there were two entries with <code>LesionID</code> = 2 and 3. These must match the <code>LesionID</code>’s listed for this case in the <code>TP</code> worksheet. Complementing these two entries, in the <code>FP</code> worksheet for <code>CaseID</code> = 51, there are 2 entries corresponding to the two ROI-level-normal regions in this case.<br />
</li>
<li>One should be satisfied that for each abnormal case the sum of the number of entries in the <code>TP</code> and <code>FP</code> worksheets is always 4.</li>
</ul></li>
</ul>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-RN85">
<p>Bunch, P. C., J. F. Hamilton, G. K. Sanderson, and A. H. Simmons. 1978. “A Free-Response Approach to the Measurement and Characterization of Radiographic-Observer Performance.” Journal Article. <em>J of Appl Photogr. Eng.</em> 4: 166–71.</p>
</div>
<div id="ref-RN1882">
<p>Zanca, Federica, Jurgen Jacobs, Van OngevalChantal, Filip Claus, Valerie Celis, Catherine Geniets, Veerle Provost, Herman Pauwels, Guy Marchal, and Hilde Bosmans. 2009. “Evaluation of Clinical Image Processing Algorithms Used in Digital Mammography.” Journal Article. <em>Medical Physics</em> 36 (3): 765–75.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>In order to avoid confusion with the ROI-paradigm, I do not like to use the term ROI to describe the marks made by the observer.<a href="frocdataformat.html#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Recall that the ROC paradigm always yields a single rating per case.<a href="frocdataformat.html#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>The directionaliy of the rating is not a limitation. If lower values correspond to increased confidence level, it is only necessary to transform the observed rating by subtracting it from a constant value. The constant value can be chosen arbitrarily, typically as the maximum of all observed ratings, thereby ensuring that the transformed value is always non-negative.<a href="frocdataformat.html#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>If an observer is so highly confident in the <em>absence</em> of a localized lesion, he will simply <em>not mark</em> the location in question; if he did, then, logically, he should mark <em>all</em> areas in the image that are definitely not lesions; in the FROC paradigm only regions with a reasonable degree of suspicion are marked. The radiologist only wishes to draw attention to regions that are reasonably suspicious; the definition of “reasonable” is determined by clinical considerations.<a href="frocdataformat.html#fnref4" class="footnote-back">↩</a></p></li>
<li id="fn5"><p>Since there is a one-to-one correspondence between marks and ratings.<a href="frocdataformat.html#fnref5" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tba-roi-paradigm.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["RJafrocBook.pdf", "RJafrocBook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
