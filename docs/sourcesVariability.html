<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Sources of AUC variability | The RJafroc Book</title>
  <meta name="description" content="Updated observer-performance book based on RJafroc." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Sources of AUC variability | The RJafroc Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Updated observer-performance book based on RJafroc." />
  <meta name="github-repo" content="dpc10ster/RJafrocBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Sources of AUC variability | The RJafroc Book" />
  
  <meta name="twitter:description" content="Updated observer-performance book based on RJafroc." />
  

<meta name="author" content="Dev P. Chakraborty, PhD" />


<meta name="date" content="2020-09-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="BinormalModel.html"/>
<link rel="next" href="HypothesisTesting.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RJafroc documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#a-note-on-the-online-distribution-mechanism-of-the-book"><i class="fa fa-check"></i>A note on the online distribution mechanism of the book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributing-to-this-book"><i class="fa fa-check"></i>Contributing to this book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#is-this-book-relevant-to-you-and-what-are-the-alternatives"><i class="fa fa-check"></i>Is this book relevant to you and what are the alternatives?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#todos"><i class="fa fa-check"></i>ToDos</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="preliminaries.html"><a href="preliminaries.html"><i class="fa fa-check"></i><b>1</b> Preliminaries</a>
<ul>
<li class="chapter" data-level="1.1" data-path="preliminaries.html"><a href="preliminaries.html#preliminariesIntro"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="preliminaries.html"><a href="preliminaries.html#clinical-tasks"><i class="fa fa-check"></i><b>1.2</b> Clinical tasks</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="preliminaries.html"><a href="preliminaries.html#workflow-in-an-imaging-study"><i class="fa fa-check"></i><b>1.2.1</b> Workflow in an imaging study</a></li>
<li class="chapter" data-level="1.2.2" data-path="preliminaries.html"><a href="preliminaries.html#the-screening-and-diagnostic-workup-tasks"><i class="fa fa-check"></i><b>1.2.2</b> The screening and diagnostic workup tasks</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="preliminaries.html"><a href="preliminaries.html#imaging-device-development-and-its-clinical-deployment"><i class="fa fa-check"></i><b>1.3</b> Imaging device development and its clinical deployment</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="preliminaries.html"><a href="preliminaries.html#physical-measurements"><i class="fa fa-check"></i><b>1.3.1</b> Physical measurements</a></li>
<li class="chapter" data-level="1.3.2" data-path="preliminaries.html"><a href="preliminaries.html#quality-control-and-image-quality-optimization"><i class="fa fa-check"></i><b>1.3.2</b> Quality Control and Image quality optimization</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="preliminaries.html"><a href="preliminaries.html#image-quality-vs.-task-performance"><i class="fa fa-check"></i><b>1.4</b> Image quality vs. task performance</a></li>
<li class="chapter" data-level="1.5" data-path="preliminaries.html"><a href="preliminaries.html#why-physical-measures-of-image-quality-are-not-enough"><i class="fa fa-check"></i><b>1.5</b> Why physical measures of image quality are not enough</a></li>
<li class="chapter" data-level="1.6" data-path="preliminaries.html"><a href="preliminaries.html#model-observers"><i class="fa fa-check"></i><b>1.6</b> Model observers</a></li>
<li class="chapter" data-level="1.7" data-path="preliminaries.html"><a href="preliminaries.html#measuring-observer-performance-four-paradigms"><i class="fa fa-check"></i><b>1.7</b> Measuring observer performance: four paradigms</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="preliminaries.html"><a href="preliminaries.html#basic-approach-to-the-analysis"><i class="fa fa-check"></i><b>1.7.1</b> Basic approach to the analysis</a></li>
<li class="chapter" data-level="1.7.2" data-path="preliminaries.html"><a href="preliminaries.html#historical-notes"><i class="fa fa-check"></i><b>1.7.2</b> Historical notes</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="preliminaries.html"><a href="preliminaries.html#hierarchy-of-assessment-methods"><i class="fa fa-check"></i><b>1.8</b> Hierarchy of assessment methods</a></li>
<li class="chapter" data-level="1.9" data-path="preliminaries.html"><a href="preliminaries.html#overview-of-the-book-and-how-to-use-it"><i class="fa fa-check"></i><b>1.9</b> Overview of the book and how to use it</a>
<ul>
<li class="chapter" data-level="1.9.1" data-path="preliminaries.html"><a href="preliminaries.html#overview-of-the-book"><i class="fa fa-check"></i><b>1.9.1</b> Overview of the book</a></li>
<li class="chapter" data-level="1.9.2" data-path="preliminaries.html"><a href="preliminaries.html#how-to-use-the-book"><i class="fa fa-check"></i><b>1.9.2</b> How to use the book</a></li>
</ul></li>
<li class="chapter" data-level="1.10" data-path="preliminaries.html"><a href="preliminaries.html#preliminaries-Summary"><i class="fa fa-check"></i><b>1.10</b> Summary</a></li>
<li class="chapter" data-level="1.11" data-path="preliminaries.html"><a href="preliminaries.html#preliminaries-Discussion"><i class="fa fa-check"></i><b>1.11</b> Discussion</a></li>
<li class="chapter" data-level="1.12" data-path="preliminaries.html"><a href="preliminaries.html#preliminaries-references"><i class="fa fa-check"></i><b>1.12</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="binaryTask0.html"><a href="binaryTask0.html"><i class="fa fa-check"></i><b>2</b> The Binary Task</a>
<ul>
<li class="chapter" data-level="2.1" data-path="binaryTask0.html"><a href="binaryTask0.html#binaryTask0Intro"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="binaryTask0.html"><a href="binaryTask0.html#binaryTask0Truth"><i class="fa fa-check"></i><b>2.2</b> The fundamental 2x2 table</a></li>
<li class="chapter" data-level="2.3" data-path="binaryTask0.html"><a href="binaryTask0.html#sensitivity-and-specificity"><i class="fa fa-check"></i><b>2.3</b> Sensitivity and specificity</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="binaryTask0.html"><a href="binaryTask0.html#reasons-for-the-names-sensitivity-and-specificity"><i class="fa fa-check"></i><b>2.3.1</b> Reasons for the names sensitivity and specificity</a></li>
<li class="chapter" data-level="2.3.2" data-path="binaryTask0.html"><a href="binaryTask0.html#estimating-sensitivity-and-specificity"><i class="fa fa-check"></i><b>2.3.2</b> Estimating sensitivity and specificity</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="binaryTask0.html"><a href="binaryTask0.html#disease-prevalence"><i class="fa fa-check"></i><b>2.4</b> Disease prevalence</a></li>
<li class="chapter" data-level="2.5" data-path="binaryTask0.html"><a href="binaryTask0.html#accuracy"><i class="fa fa-check"></i><b>2.5</b> Accuracy</a></li>
<li class="chapter" data-level="2.6" data-path="binaryTask0.html"><a href="binaryTask0.html#negative-and-positive-predictive-values"><i class="fa fa-check"></i><b>2.6</b> Negative and positive predictive values</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="binaryTask0.html"><a href="binaryTask0.html#binaryTask0NpvPpvCode"><i class="fa fa-check"></i><b>2.6.1</b> Example calculation of PPV, NPV and accuracy</a></li>
<li class="chapter" data-level="2.6.2" data-path="binaryTask0.html"><a href="binaryTask0.html#binaryTask0NpvPpvComments"><i class="fa fa-check"></i><b>2.6.2</b> Comments</a></li>
<li class="chapter" data-level="2.6.3" data-path="binaryTask0.html"><a href="binaryTask0.html#binaryTask0NpvPpvIrrel2LabTasks"><i class="fa fa-check"></i><b>2.6.3</b> PPV and NPV are irrelevant to laboratory tasks</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="binaryTask0.html"><a href="binaryTask0.html#binaryTask0-Summary"><i class="fa fa-check"></i><b>2.7</b> Summary</a></li>
<li class="chapter" data-level="2.8" data-path="binaryTask0.html"><a href="binaryTask0.html#binaryTask0-Discussion"><i class="fa fa-check"></i><b>2.8</b> Discussion</a></li>
<li class="chapter" data-level="2.9" data-path="binaryTask0.html"><a href="binaryTask0.html#binaryTask0-references"><i class="fa fa-check"></i><b>2.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="binaryTask.html"><a href="binaryTask.html"><i class="fa fa-check"></i><b>3</b> Modeling the Binary Task</a>
<ul>
<li class="chapter" data-level="3.1" data-path="binaryTask.html"><a href="binaryTask.html#binaryTaskIntro"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="binaryTask.html"><a href="binaryTask.html#decision-variable-and-decision-threshold"><i class="fa fa-check"></i><b>3.2</b> Decision variable and decision threshold</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="binaryTask.html"><a href="binaryTask.html#existence-of-a-decision-variable"><i class="fa fa-check"></i><b>3.2.1</b> Existence of a decision variable</a></li>
<li class="chapter" data-level="3.2.2" data-path="binaryTask.html"><a href="binaryTask.html#existence-of-a-decision-threshold"><i class="fa fa-check"></i><b>3.2.2</b> Existence of a decision threshold</a></li>
<li class="chapter" data-level="3.2.3" data-path="binaryTask.html"><a href="binaryTask.html#adequacy-of-the-training-session"><i class="fa fa-check"></i><b>3.2.3</b> Adequacy of the training session</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="binaryTask.html"><a href="binaryTask.html#changing-the-decision-threshold-example-i"><i class="fa fa-check"></i><b>3.3</b> Changing the decision threshold: Example I</a></li>
<li class="chapter" data-level="3.4" data-path="binaryTask.html"><a href="binaryTask.html#changing-the-decision-threshold-example-ii"><i class="fa fa-check"></i><b>3.4</b> Changing the decision threshold: Example II</a></li>
<li class="chapter" data-level="3.5" data-path="binaryTask.html"><a href="binaryTask.html#the-equal-variance-binormal-model"><i class="fa fa-check"></i><b>3.5</b> The equal-variance binormal model</a></li>
<li class="chapter" data-level="3.6" data-path="binaryTask.html"><a href="binaryTask.html#the-normal-distribution"><i class="fa fa-check"></i><b>3.6</b> The normal distribution</a></li>
<li class="chapter" data-level="3.7" data-path="binaryTask.html"><a href="binaryTask.html#analytic-expressions-for-specificity-and-sensitivity"><i class="fa fa-check"></i><b>3.7</b> Analytic expressions for specificity and sensitivity</a></li>
<li class="chapter" data-level="3.8" data-path="binaryTask.html"><a href="binaryTask.html#demonstration-of-the-concepts-of-sensitivity-and-specificity"><i class="fa fa-check"></i><b>3.8</b> Demonstration of the concepts of sensitivity and specificity</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="binaryTask.html"><a href="binaryTask.html#estimating-mu-from-a-finite-sample"><i class="fa fa-check"></i><b>3.8.1</b> Estimating mu from a finite sample</a></li>
<li class="chapter" data-level="3.8.2" data-path="binaryTask.html"><a href="binaryTask.html#changing-the-seed-variable-case-sampling-variability"><i class="fa fa-check"></i><b>3.8.2</b> Changing the seed variable: case-sampling variability</a></li>
<li class="chapter" data-level="3.8.3" data-path="binaryTask.html"><a href="binaryTask.html#increasing-the-numbers-of-cases"><i class="fa fa-check"></i><b>3.8.3</b> Increasing the numbers of cases</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="binaryTask.html"><a href="binaryTask.html#inverse-variation-of-sensitivity-and-specificity-and-the-need-for-a-single-fom"><i class="fa fa-check"></i><b>3.9</b> Inverse variation of sensitivity and specificity and the need for a single FOM</a></li>
<li class="chapter" data-level="3.10" data-path="binaryTask.html"><a href="binaryTask.html#the-roc-curve"><i class="fa fa-check"></i><b>3.10</b> The ROC curve</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="binaryTask.html"><a href="binaryTask.html#the-chance-diagonal"><i class="fa fa-check"></i><b>3.10.1</b> The chance diagonal</a></li>
<li class="chapter" data-level="3.10.2" data-path="binaryTask.html"><a href="binaryTask.html#the-guessing-observer"><i class="fa fa-check"></i><b>3.10.2</b> The guessing observer</a></li>
<li class="chapter" data-level="3.10.3" data-path="binaryTask.html"><a href="binaryTask.html#symmetry-with-respect-to-negative-diagonal"><i class="fa fa-check"></i><b>3.10.3</b> Symmetry with respect to negative diagonal</a></li>
<li class="chapter" data-level="3.10.4" data-path="binaryTask.html"><a href="binaryTask.html#area-under-the-roc-curve"><i class="fa fa-check"></i><b>3.10.4</b> Area under the ROC curve</a></li>
<li class="chapter" data-level="3.10.5" data-path="binaryTask.html"><a href="binaryTask.html#properties-of-the-equal-variance-binormal-model-roc-curve"><i class="fa fa-check"></i><b>3.10.5</b> Properties of the equal-variance binormal model ROC curve</a></li>
<li class="chapter" data-level="3.10.6" data-path="binaryTask.html"><a href="binaryTask.html#comments"><i class="fa fa-check"></i><b>3.10.6</b> Comments</a></li>
<li class="chapter" data-level="3.10.7" data-path="binaryTask.html"><a href="binaryTask.html#physical-interpretation-of-the-mu-parameter"><i class="fa fa-check"></i><b>3.10.7</b> Physical interpretation of the mu-parameter</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="binaryTask.html"><a href="binaryTask.html#assigning-confidence-intervals-to-an-operating-point"><i class="fa fa-check"></i><b>3.11</b> Assigning confidence intervals to an operating point</a></li>
<li class="chapter" data-level="3.12" data-path="binaryTask.html"><a href="binaryTask.html#variability-in-sensitivity-and-specificity-the-beam-et-al-study"><i class="fa fa-check"></i><b>3.12</b> Variability in sensitivity and specificity: the Beam et al study</a></li>
<li class="chapter" data-level="3.13" data-path="binaryTask.html"><a href="binaryTask.html#binaryTask-Summary"><i class="fa fa-check"></i><b>3.13</b> Summary</a></li>
<li class="chapter" data-level="3.14" data-path="binaryTask.html"><a href="binaryTask.html#binaryTask-Discussion"><i class="fa fa-check"></i><b>3.14</b> Discussion</a></li>
<li class="chapter" data-level="3.15" data-path="binaryTask.html"><a href="binaryTask.html#binaryTask-references"><i class="fa fa-check"></i><b>3.15</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html"><i class="fa fa-check"></i><b>4</b> Ratings Paradigm</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#the-roc-counts-table"><i class="fa fa-check"></i><b>4.2</b> The ROC counts table</a></li>
<li class="chapter" data-level="4.3" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#operating-points-from-counts-table"><i class="fa fa-check"></i><b>4.3</b> Operating points from counts table</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#labeling-the-points"><i class="fa fa-check"></i><b>4.3.1</b> Labeling the points</a></li>
<li class="chapter" data-level="4.3.2" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#examples"><i class="fa fa-check"></i><b>4.3.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#automating-all-this"><i class="fa fa-check"></i><b>4.4</b> Automating all this</a></li>
<li class="chapter" data-level="4.5" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#relation-between-ratings-paradigm-and-the-binary-paradigm"><i class="fa fa-check"></i><b>4.5</b> Relation between ratings paradigm and the binary paradigm</a></li>
<li class="chapter" data-level="4.6" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#ratings-are-not-numerical-values"><i class="fa fa-check"></i><b>4.6</b> Ratings are not numerical values</a></li>
<li class="chapter" data-level="4.7" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#a-single-clinical-operating-point-from-ratings-data"><i class="fa fa-check"></i><b>4.7</b> A single “clinical” operating point from ratings data</a></li>
<li class="chapter" data-level="4.8" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#the-forced-choice-paradigm"><i class="fa fa-check"></i><b>4.8</b> The forced choice paradigm</a></li>
<li class="chapter" data-level="4.9" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#observer-performance-studies-as-laboratory-simulations-of-clinical-tasks"><i class="fa fa-check"></i><b>4.9</b> Observer performance studies as laboratory simulations of clinical tasks</a></li>
<li class="chapter" data-level="4.10" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#discrete-vs.-continuous-ratings-the-miller-study"><i class="fa fa-check"></i><b>4.10</b> Discrete vs. continuous ratings: the Miller study</a></li>
<li class="chapter" data-level="4.11" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#the-controversy"><i class="fa fa-check"></i><b>4.11</b> The controversy</a></li>
<li class="chapter" data-level="4.12" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#ratingsParadigm-discussion"><i class="fa fa-check"></i><b>4.12</b> Discussion</a></li>
<li class="chapter" data-level="4.13" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#ratingsParadigm-references"><i class="fa fa-check"></i><b>4.13</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="empiricalAUC.html"><a href="empiricalAUC.html"><i class="fa fa-check"></i><b>5</b> Empirical AUC</a>
<ul>
<li class="chapter" data-level="5.1" data-path="empiricalAUC.html"><a href="empiricalAUC.html#empiricalAUC-Intro"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="empiricalAUC.html"><a href="empiricalAUC.html#empirical-ROC-plot"><i class="fa fa-check"></i><b>5.2</b> The empirical ROC plot</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="empiricalAUC.html"><a href="empiricalAUC.html#notation-for-cases"><i class="fa fa-check"></i><b>5.2.1</b> Notation for cases</a></li>
<li class="chapter" data-level="5.2.2" data-path="empiricalAUC.html"><a href="empiricalAUC.html#an-empirical-operating-point"><i class="fa fa-check"></i><b>5.2.2</b> An empirical operating point</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="empiricalAUC.html"><a href="empiricalAUC.html#empirical-operating-points-from-ratings-data"><i class="fa fa-check"></i><b>5.3</b> Empirical operating points from ratings data</a></li>
<li class="chapter" data-level="5.4" data-path="empiricalAUC.html"><a href="empiricalAUC.html#auc-under-the-empirical-roc-plot"><i class="fa fa-check"></i><b>5.4</b> AUC under the empirical ROC plot</a></li>
<li class="chapter" data-level="5.5" data-path="empiricalAUC.html"><a href="empiricalAUC.html#the-wilcoxon-statistic"><i class="fa fa-check"></i><b>5.5</b> The Wilcoxon statistic</a></li>
<li class="chapter" data-level="5.6" data-path="empiricalAUC.html"><a href="empiricalAUC.html#bambers-equivalence-theorem"><i class="fa fa-check"></i><b>5.6</b> Bamber’s Equivalence theorem</a></li>
<li class="chapter" data-level="5.7" data-path="empiricalAUC.html"><a href="empiricalAUC.html#importance-of-bambers-theorem"><i class="fa fa-check"></i><b>5.7</b> Importance of Bamber’s theorem</a></li>
<li class="chapter" data-level="5.8" data-path="empiricalAUC.html"><a href="empiricalAUC.html#discussion-summary"><i class="fa fa-check"></i><b>5.8</b> Discussion / Summary</a></li>
<li class="chapter" data-level="5.9" data-path="empiricalAUC.html"><a href="empiricalAUC.html#appendix-5.a-details-of-wilcoxon-theorem"><i class="fa fa-check"></i><b>5.9</b> Appendix 5.A: Details of Wilcoxon theorem</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="empiricalAUC.html"><a href="empiricalAUC.html#upper-triangle"><i class="fa fa-check"></i><b>5.9.1</b> Upper triangle</a></li>
<li class="chapter" data-level="5.9.2" data-path="empiricalAUC.html"><a href="empiricalAUC.html#lowest-trapezoid"><i class="fa fa-check"></i><b>5.9.2</b> Lowest trapezoid</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="empiricalAUC.html"><a href="empiricalAUC.html#empiricalAUC-references"><i class="fa fa-check"></i><b>5.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="BinormalModel.html"><a href="BinormalModel.html"><i class="fa fa-check"></i><b>6</b> Binormal model</a>
<ul>
<li class="chapter" data-level="6.1" data-path="BinormalModel.html"><a href="BinormalModel.html#BinormalModelIntro"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="BinormalModel.html"><a href="BinormalModel.html#BinormalModelTheModel"><i class="fa fa-check"></i><b>6.2</b> The binormal model</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="BinormalModel.html"><a href="BinormalModel.html#binning-the-data"><i class="fa fa-check"></i><b>6.2.1</b> Binning the data</a></li>
<li class="chapter" data-level="6.2.2" data-path="BinormalModel.html"><a href="BinormalModel.html#invariance-of-the-binormal-model-to-arbitrary-monotone-transformations"><i class="fa fa-check"></i><b>6.2.2</b> Invariance of the binormal model to arbitrary monotone transformations</a></li>
<li class="chapter" data-level="6.2.3" data-path="BinormalModel.html"><a href="BinormalModel.html#expressions-for-sensitivity-and-specificity"><i class="fa fa-check"></i><b>6.2.3</b> Expressions for sensitivity and specificity</a></li>
<li class="chapter" data-level="6.2.4" data-path="BinormalModel.html"><a href="BinormalModel.html#binormal-model-in-standard-notation"><i class="fa fa-check"></i><b>6.2.4</b> Binormal model in standard notation</a></li>
<li class="chapter" data-level="6.2.5" data-path="BinormalModel.html"><a href="BinormalModel.html#properties-of-the-binormal-model-roc-curve"><i class="fa fa-check"></i><b>6.2.5</b> Properties of the binormal model ROC curve</a></li>
<li class="chapter" data-level="6.2.6" data-path="BinormalModel.html"><a href="BinormalModel.html#density-functions-pdfs-of-the-binormal-model"><i class="fa fa-check"></i><b>6.2.6</b> Density functions (pdfs) of the binormal model</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="BinormalModel.html"><a href="BinormalModel.html#fitting-an-roc-curve-to-data-points"><i class="fa fa-check"></i><b>6.3</b> Fitting an ROC curve to data points</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="BinormalModel.html"><a href="BinormalModel.html#a-java-fitted-roc-curve"><i class="fa fa-check"></i><b>6.3.1</b> A JAVA fitted ROC curve</a></li>
<li class="chapter" data-level="6.3.2" data-path="BinormalModel.html"><a href="BinormalModel.html#a-simplistic-straight-line-fit-to-the-roc-curve"><i class="fa fa-check"></i><b>6.3.2</b> A simplistic straight line fit to the ROC curve</a></li>
<li class="chapter" data-level="6.3.3" data-path="BinormalModel.html"><a href="BinormalModel.html#maximum-likelihood-estimation-mle"><i class="fa fa-check"></i><b>6.3.3</b> Maximum likelihood estimation (MLE)</a></li>
<li class="chapter" data-level="6.3.4" data-path="BinormalModel.html"><a href="BinormalModel.html#code-implementing-mle"><i class="fa fa-check"></i><b>6.3.4</b> Code implementing MLE</a></li>
<li class="chapter" data-level="6.3.5" data-path="BinormalModel.html"><a href="BinormalModel.html#validating-the-fitting-model"><i class="fa fa-check"></i><b>6.3.5</b> Validating the fitting model</a></li>
<li class="chapter" data-level="6.3.6" data-path="BinormalModel.html"><a href="BinormalModel.html#estimating-the-covariance-matrix"><i class="fa fa-check"></i><b>6.3.6</b> Estimating the covariance matrix</a></li>
<li class="chapter" data-level="6.3.7" data-path="BinormalModel.html"><a href="BinormalModel.html#estimating-the-variance-of-az"><i class="fa fa-check"></i><b>6.3.7</b> Estimating the variance of Az</a></li>
<li class="chapter" data-level="6.3.8" data-path="BinormalModel.html"><a href="BinormalModel.html#single-fom-derived-from-roc-curve"><i class="fa fa-check"></i><b>6.3.8</b> Single FOM derived from ROC curve</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="BinormalModel.html"><a href="BinormalModel.html#BinormalModel-Discussion"><i class="fa fa-check"></i><b>6.4</b> Discussion</a></li>
<li class="chapter" data-level="6.5" data-path="BinormalModel.html"><a href="BinormalModel.html#BinormalModel-references"><i class="fa fa-check"></i><b>6.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sourcesVariability.html"><a href="sourcesVariability.html"><i class="fa fa-check"></i><b>7</b> Sources of AUC variability</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sourcesVariability.html"><a href="sourcesVariability.html#sourcesVariabilityIntro"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="sourcesVariability.html"><a href="sourcesVariability.html#sourcesVariability3sources"><i class="fa fa-check"></i><b>7.2</b> Three sources of variability</a></li>
<li class="chapter" data-level="7.3" data-path="sourcesVariability.html"><a href="sourcesVariability.html#dependence-of-auc-on-the-case-sample"><i class="fa fa-check"></i><b>7.3</b> Dependence of AUC on the case sample</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="sourcesVariability.html"><a href="sourcesVariability.html#case-sampling-variability-of-auc"><i class="fa fa-check"></i><b>7.3.1</b> Case sampling variability of AUC</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="sourcesVariability.html"><a href="sourcesVariability.html#sourcesVariabilityDeLong"><i class="fa fa-check"></i><b>7.4</b> DeLong method</a></li>
<li class="chapter" data-level="7.5" data-path="sourcesVariability.html"><a href="sourcesVariability.html#sourcesVariabilityBootstrap"><i class="fa fa-check"></i><b>7.5</b> Bootstrap method</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="sourcesVariability.html"><a href="sourcesVariability.html#demonstration-of-the-bootstrap-method"><i class="fa fa-check"></i><b>7.5.1</b> Demonstration of the bootstrap method</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="sourcesVariability.html"><a href="sourcesVariability.html#sourcesVariabilityJackknife"><i class="fa fa-check"></i><b>7.6</b> Jackknife method</a></li>
<li class="chapter" data-level="7.7" data-path="sourcesVariability.html"><a href="sourcesVariability.html#sourcesVariabilityCalSimulator"><i class="fa fa-check"></i><b>7.7</b> Calibrated simulator</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="sourcesVariability.html"><a href="sourcesVariability.html#tba"><i class="fa fa-check"></i><b>7.7.1</b> TBA</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="sourcesVariability.html"><a href="sourcesVariability.html#comparison-of-methods-of-estimating-variability"><i class="fa fa-check"></i><b>7.8</b> Comparison of methods of estimating variability</a></li>
<li class="chapter" data-level="7.9" data-path="sourcesVariability.html"><a href="sourcesVariability.html#sourcesVariabilityreaderExpertise"><i class="fa fa-check"></i><b>7.9</b> Dependence of AUC on reader expertise</a></li>
<li class="chapter" data-level="7.10" data-path="sourcesVariability.html"><a href="sourcesVariability.html#sourcesVariabilityModalityEffect"><i class="fa fa-check"></i><b>7.10</b> Dependence of AUC on modality</a></li>
<li class="chapter" data-level="7.11" data-path="sourcesVariability.html"><a href="sourcesVariability.html#sourcesVariabilityBinning"><i class="fa fa-check"></i><b>7.11</b> Effect of binning</a></li>
<li class="chapter" data-level="7.12" data-path="sourcesVariability.html"><a href="sourcesVariability.html#sourcesVariabilityEmpiricalVsFitted"><i class="fa fa-check"></i><b>7.12</b> Empirical vs. fitted AUCs</a></li>
<li class="chapter" data-level="7.13" data-path="sourcesVariability.html"><a href="sourcesVariability.html#sourcesVariability-Discussion"><i class="fa fa-check"></i><b>7.13</b> Discussion</a></li>
<li class="chapter" data-level="7.14" data-path="sourcesVariability.html"><a href="sourcesVariability.html#sourcesVariability-references"><i class="fa fa-check"></i><b>7.14</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html"><i class="fa fa-check"></i><b>8</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="8.1" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#HypothesisTesting-introduction"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#single-modality-single-reader-roc-study"><i class="fa fa-check"></i><b>8.2</b> Single-modality single-reader ROC study</a></li>
<li class="chapter" data-level="8.3" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#type-i-errors"><i class="fa fa-check"></i><b>8.3</b> Type-I errors</a></li>
<li class="chapter" data-level="8.4" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#one-vs.-two-sided-tests"><i class="fa fa-check"></i><b>8.4</b> One vs. two sided tests</a></li>
<li class="chapter" data-level="8.5" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#statistical-power"><i class="fa fa-check"></i><b>8.5</b> Statistical power</a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#factors-affecting-statistical-power"><i class="fa fa-check"></i><b>8.5.1</b> Factors affecting statistical power</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#HypothesisTestingComments"><i class="fa fa-check"></i><b>8.6</b> Comments</a></li>
<li class="chapter" data-level="8.7" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#why-alpha-is-chosen-as-5"><i class="fa fa-check"></i><b>8.7</b> Why alpha is chosen as 5%</a></li>
<li class="chapter" data-level="8.8" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#HypothesisTestingDiscussion"><i class="fa fa-check"></i><b>8.8</b> Discussion</a></li>
<li class="chapter" data-level="8.9" data-path="HypothesisTesting.html"><a href="HypothesisTesting.html#HypothesisTesting-references"><i class="fa fa-check"></i><b>8.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html"><i class="fa fa-check"></i><b>9</b> DBM method background</a>
<ul>
<li class="chapter" data-level="9.1" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#DBMAnalysisBkgrnd-introduction"><i class="fa fa-check"></i><b>9.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#historical-background"><i class="fa fa-check"></i><b>9.1.1</b> Historical background</a></li>
<li class="chapter" data-level="9.1.2" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#the-wagner-analogy"><i class="fa fa-check"></i><b>9.1.2</b> The Wagner analogy</a></li>
<li class="chapter" data-level="9.1.3" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#the-shortage-of-numbers-to-analyze-and-a-pivotal-breakthrough"><i class="fa fa-check"></i><b>9.1.3</b> The shortage of numbers to analyze and a pivotal breakthrough</a></li>
<li class="chapter" data-level="9.1.4" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#organization-of-chapter"><i class="fa fa-check"></i><b>9.1.4</b> Organization of chapter</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#DBMAnalysisBkgrnd-random-fixed-factors"><i class="fa fa-check"></i><b>9.2</b> Random and fixed factors</a></li>
<li class="chapter" data-level="9.3" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#DBMAnalysisBkgrnd-reader-case-populations"><i class="fa fa-check"></i><b>9.3</b> Reader and case populations</a></li>
<li class="chapter" data-level="9.4" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#DBMAnalysisBkgrnd-threeAnalyses"><i class="fa fa-check"></i><b>9.4</b> Three types of analyses</a></li>
<li class="chapter" data-level="9.5" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#DBMAnalysisBkgrnd-approach"><i class="fa fa-check"></i><b>9.5</b> General approach</a></li>
<li class="chapter" data-level="9.6" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#DBMAnalysisBkgrnd-summary"><i class="fa fa-check"></i><b>9.6</b> Summary TBA</a></li>
<li class="chapter" data-level="9.7" data-path="DBMAnalysisBkgrnd.html"><a href="DBMAnalysisBkgrnd.html#DBMAnalysisBkgrnd-references"><i class="fa fa-check"></i><b>9.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html"><i class="fa fa-check"></i><b>10</b> Significance Testing using the DBM Method</a>
<ul>
<li class="chapter" data-level="10.1" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#the-dbm-sampling-model"><i class="fa fa-check"></i><b>10.1</b> The DBM sampling model</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#explanation-of-terms-in-the-model"><i class="fa fa-check"></i><b>10.1.1</b> Explanation of terms in the model</a></li>
<li class="chapter" data-level="10.1.2" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#meanings-of-variance-components-in-the-dbm-model-tba-this-section-can-be-improved"><i class="fa fa-check"></i><b>10.1.2</b> Meanings of variance components in the DBM model (<strong>TBA this section can be improved</strong>)</a></li>
<li class="chapter" data-level="10.1.3" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#definitions-of-mean-squares"><i class="fa fa-check"></i><b>10.1.3</b> Definitions of mean-squares</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#expected-values-of-mean-squares"><i class="fa fa-check"></i><b>10.2</b> Expected values of mean squares</a></li>
<li class="chapter" data-level="10.3" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#DBMAnalysisSigtesting-RRRC-analysis"><i class="fa fa-check"></i><b>10.3</b> Random-reader random-case (RRRC) analysis</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#calculation-of-mean-squares-an-example"><i class="fa fa-check"></i><b>10.3.1</b> Calculation of mean squares: an example</a></li>
<li class="chapter" data-level="10.3.2" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#DBMAnalysisSigtesting-sig-testing"><i class="fa fa-check"></i><b>10.3.2</b> Significance testing</a></li>
<li class="chapter" data-level="10.3.3" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#the-satterthwaite-approximation"><i class="fa fa-check"></i><b>10.3.3</b> The Satterthwaite approximation</a></li>
<li class="chapter" data-level="10.3.4" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#decision-rules-p-value-and-confidence-intervals"><i class="fa fa-check"></i><b>10.3.4</b> Decision rules, p-value and confidence intervals</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#sample-size-estimation-for-random-reader-random-case-generalization"><i class="fa fa-check"></i><b>10.4</b> Sample size estimation for random-reader random-case generalization</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#the-non-centrality-parameter"><i class="fa fa-check"></i><b>10.4.1</b> The non-centrality parameter</a></li>
<li class="chapter" data-level="10.4.2" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#the-denominator-degrees-of-freedom"><i class="fa fa-check"></i><b>10.4.2</b> The denominator degrees of freedom</a></li>
<li class="chapter" data-level="10.4.3" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#example-of-sample-size-estimation-rrrc-generalization"><i class="fa fa-check"></i><b>10.4.3</b> Example of sample size estimation, RRRC generalization</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#significance-testing-and-sample-size-estimation-for-fixed-reader-random-case-generalization"><i class="fa fa-check"></i><b>10.5</b> Significance testing and sample size estimation for fixed-reader random-case generalization</a></li>
<li class="chapter" data-level="10.6" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#significance-testing-and-sample-size-estimation-for-random-reader-fixed-case-generalization"><i class="fa fa-check"></i><b>10.6</b> Significance testing and sample size estimation for random-reader fixed-case generalization</a></li>
<li class="chapter" data-level="10.7" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#DBMAnalysisSigtesting-summary"><i class="fa fa-check"></i><b>10.7</b> Summary TBA</a></li>
<li class="chapter" data-level="10.8" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#things-for-me-to-think-about"><i class="fa fa-check"></i><b>10.8</b> Things for me to think about</a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#expected-values-of-mean-squares-1"><i class="fa fa-check"></i><b>10.8.1</b> Expected values of mean squares</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="DBMAnalysisSigtesting.html"><a href="DBMAnalysisSigtesting.html#DBMAnalysisSigtesting-references"><i class="fa fa-check"></i><b>10.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="DBMSpecialCases.html"><a href="DBMSpecialCases.html"><i class="fa fa-check"></i><b>11</b> DBM method special cases</a>
<ul>
<li class="chapter" data-level="11.1" data-path="DBMSpecialCases.html"><a href="DBMSpecialCases.html#FRRCDBMAnalysis"><i class="fa fa-check"></i><b>11.1</b> Fixed-reader random-case (FRRC) analysis</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="DBMSpecialCases.html"><a href="DBMSpecialCases.html#FRRCSingleReaderDBMAnalysis"><i class="fa fa-check"></i><b>11.1.1</b> Single-reader multiple-treatment analysis</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="DBMSpecialCases.html"><a href="DBMSpecialCases.html#DBMSpecialCases-RRFCAnalysis"><i class="fa fa-check"></i><b>11.2</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="11.3" data-path="DBMSpecialCases.html"><a href="DBMSpecialCases.html#DBMSpecialCases-references"><i class="fa fa-check"></i><b>11.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html"><i class="fa fa-check"></i><b>12</b> Introduction to the Obuchowski-Rockette method</a>
<ul>
<li class="chapter" data-level="12.1" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#ORMethodIntro-introduction"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#OR1RMTModel"><i class="fa fa-check"></i><b>12.2</b> Single-reader multiple-treatment</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#definitions-of-covariance-and-correlation"><i class="fa fa-check"></i><b>12.2.1</b> Definitions of covariance and correlation</a></li>
<li class="chapter" data-level="12.2.2" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#special-case-when-variables-have-equal-variances"><i class="fa fa-check"></i><b>12.2.2</b> Special case when variables have equal variances</a></li>
<li class="chapter" data-level="12.2.3" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#estimating-the-variance-covariance-matrix"><i class="fa fa-check"></i><b>12.2.3</b> Estimating the variance-covariance matrix</a></li>
<li class="chapter" data-level="12.2.4" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#the-variance-inflation-factor"><i class="fa fa-check"></i><b>12.2.4</b> The variance inflation factor</a></li>
<li class="chapter" data-level="12.2.5" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#meaning-of-the-covariance-matrix-in-eqn.-refeqexamplesigma"><i class="fa fa-check"></i><b>12.2.5</b> Meaning of the covariance matrix in Eqn. @ref(eq:ExampleSigma)</a></li>
<li class="chapter" data-level="12.2.6" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#code-illustrating-the-covariance-matrix"><i class="fa fa-check"></i><b>12.2.6</b> Code illustrating the covariance matrix</a></li>
<li class="chapter" data-level="12.2.7" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#SignificanceTesting1ROR"><i class="fa fa-check"></i><b>12.2.7</b> Significance testing</a></li>
<li class="chapter" data-level="12.2.8" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#ORMethodIntro-pvalue-ci"><i class="fa fa-check"></i><b>12.2.8</b> p-value and confidence interval</a></li>
<li class="chapter" data-level="12.2.9" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#ORMethodIntro-CompareDBM2OR41R"><i class="fa fa-check"></i><b>12.2.9</b> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#SignificanceTestingORMRMC"><i class="fa fa-check"></i><b>12.3</b> Multiple-reader multiple-treatment</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#StrCovMatrix"><i class="fa fa-check"></i><b>12.3.1</b> Structure of the covariance matrix</a></li>
<li class="chapter" data-level="12.3.2" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#PhysicalMeaningsOfCovMatrix"><i class="fa fa-check"></i><b>12.3.2</b> Physical meanings of the covariance terms</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#ORMethodIntro-Summary"><i class="fa fa-check"></i><b>12.4</b> Summary</a></li>
<li class="chapter" data-level="12.5" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#ORMethodIntro-Discussion"><i class="fa fa-check"></i><b>12.5</b> Discussion</a></li>
<li class="chapter" data-level="12.6" data-path="ORMethodIntro.html"><a href="ORMethodIntro.html#ORMethodIntro-references"><i class="fa fa-check"></i><b>12.6</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html"><i class="fa fa-check"></i><b>13</b> Obuchowski Rockette (OR) Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#ORAnalysisSigTesting-introduction"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#OR_RRRC"><i class="fa fa-check"></i><b>13.2</b> Random-reader random-case</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#TwoAnecdotes"><i class="fa fa-check"></i><b>13.2.1</b> Two anecdotes</a></li>
<li class="chapter" data-level="13.2.2" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#Hills-ddf"><i class="fa fa-check"></i><b>13.2.2</b> Hillis ddf</a></li>
<li class="chapter" data-level="13.2.3" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#decision-rule-p-value-and-confidence-interval"><i class="fa fa-check"></i><b>13.2.3</b> Decision rule, p-value and confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#OR-FRRC"><i class="fa fa-check"></i><b>13.3</b> Fixed-reader random-case</a></li>
<li class="chapter" data-level="13.4" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#ORAnalysisSigTesting-RRFCAnalysis"><i class="fa fa-check"></i><b>13.4</b> Random-reader fixed-case</a></li>
<li class="chapter" data-level="13.5" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#ORAnalysisSigTesting-Summary"><i class="fa fa-check"></i><b>13.5</b> Summary</a></li>
<li class="chapter" data-level="13.6" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#ORAnalysisSigTesting-Discussion"><i class="fa fa-check"></i><b>13.6</b> Discussion</a></li>
<li class="chapter" data-level="13.7" data-path="ORAnalysisSigTesting.html"><a href="ORAnalysisSigTesting.html#ORAnalysisSigTesting-references"><i class="fa fa-check"></i><b>13.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="ORApplications.html"><a href="ORApplications.html"><i class="fa fa-check"></i><b>14</b> Obuchowski Rockette Applications</a>
<ul>
<li class="chapter" data-level="14.1" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-introduction"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-dataset02-hand"><i class="fa fa-check"></i><b>14.2</b> Hand calculation</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRRC-dataset02-hand"><i class="fa fa-check"></i><b>14.2.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="14.2.2" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-FRRC-dataset02-hand"><i class="fa fa-check"></i><b>14.2.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="14.2.3" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRFC-dataset02-hand"><i class="fa fa-check"></i><b>14.2.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-dataset02-RJafroc"><i class="fa fa-check"></i><b>14.3</b> RJafroc: dataset02</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRRC-dataset02-RJafroc"><i class="fa fa-check"></i><b>14.3.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="14.3.2" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-FRRC-dataset02-RJafroc"><i class="fa fa-check"></i><b>14.3.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="14.3.3" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRFC-dataset02-RJafroc"><i class="fa fa-check"></i><b>14.3.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-dataset04-RJafroc"><i class="fa fa-check"></i><b>14.4</b> RJafroc: dataset04</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRRC-dataset04"><i class="fa fa-check"></i><b>14.4.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="14.4.2" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-FRRC-dataset04"><i class="fa fa-check"></i><b>14.4.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="14.4.3" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRFC-dataset04"><i class="fa fa-check"></i><b>14.4.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-dataset04-FROC-RJafroc"><i class="fa fa-check"></i><b>14.5</b> RJafroc: dataset04, FROC</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRRC-dataset04-FROC"><i class="fa fa-check"></i><b>14.5.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="14.5.2" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-FRRC-dataset04-FROC"><i class="fa fa-check"></i><b>14.5.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="14.5.3" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRFC-dataset04-FROC"><i class="fa fa-check"></i><b>14.5.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-dataset04-FROC-DBM-RJafroc"><i class="fa fa-check"></i><b>14.6</b> RJafroc: dataset04, FROC/DBM</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRRC-dataset04-FROC-DBM"><i class="fa fa-check"></i><b>14.6.1</b> Random-Reader Random-Case (RRRC) analysis</a></li>
<li class="chapter" data-level="14.6.2" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-FRRC-dataset04-FROC-DBM"><i class="fa fa-check"></i><b>14.6.2</b> Fixed-Reader Random-Case (FRRC) analysis</a></li>
<li class="chapter" data-level="14.6.3" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-RRFC-dataset04-FROC-DBM"><i class="fa fa-check"></i><b>14.6.3</b> Random-Reader Fixed-Case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-Summary"><i class="fa fa-check"></i><b>14.7</b> Summary</a></li>
<li class="chapter" data-level="14.8" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-Discussion"><i class="fa fa-check"></i><b>14.8</b> Discussion</a></li>
<li class="chapter" data-level="14.9" data-path="ORApplications.html"><a href="ORApplications.html#ToMullOver1-tentative"><i class="fa fa-check"></i><b>14.9</b> Tentative</a></li>
<li class="chapter" data-level="14.10" data-path="ORApplications.html"><a href="ORApplications.html#ORApplications-references"><i class="fa fa-check"></i><b>14.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html"><i class="fa fa-check"></i><b>15</b> Sample size estimation for ROC studies DBM method</a>
<ul>
<li class="chapter" data-level="15.1" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-introduction"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#StatPower1"><i class="fa fa-check"></i><b>15.2</b> Statistical Power</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#observed-vs.-anticipated-effect-size"><i class="fa fa-check"></i><b>15.2.1</b> Observed vs. anticipated effect-size</a></li>
<li class="chapter" data-level="15.2.2" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-dependence-of-stats-power"><i class="fa fa-check"></i><b>15.2.2</b> Dependence of statistical power on estimates of model parameters</a></li>
<li class="chapter" data-level="15.2.3" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-RRRC-sample-size-estimation"><i class="fa fa-check"></i><b>15.2.3</b> Formulae for random-reader random-case (RRRC) sample size estimation</a></li>
<li class="chapter" data-level="15.2.4" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-sig-testing"><i class="fa fa-check"></i><b>15.2.4</b> Significance testing</a></li>
<li class="chapter" data-level="15.2.5" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-pvalue-ci"><i class="fa fa-check"></i><b>15.2.5</b> p-value and confidence interval</a></li>
<li class="chapter" data-level="15.2.6" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-CompareDBM2OR"><i class="fa fa-check"></i><b>15.2.6</b> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-FRRC-sample-size-estimation"><i class="fa fa-check"></i><b>15.3</b> Formulae for fixed-reader random-case (FRRC) sample size estimation</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-RRFC-sample-size-estimation"><i class="fa fa-check"></i><b>15.3.1</b> Formulae for random-reader fixed-case (RRFC) sample size estimation</a></li>
<li class="chapter" data-level="15.3.2" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-FRRCAnalysis"><i class="fa fa-check"></i><b>15.3.2</b> Fixed-reader random-case (FRRC) analysis TBA</a></li>
<li class="chapter" data-level="15.3.3" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-RRFCAnalysis"><i class="fa fa-check"></i><b>15.3.3</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="15.3.4" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-STMRAnalysis"><i class="fa fa-check"></i><b>15.3.4</b> Single-treatment multiple-reader analysis</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#discussionsummary2"><i class="fa fa-check"></i><b>15.4</b> Discussion/Summary/2</a></li>
<li class="chapter" data-level="15.5" data-path="RocSampleSizeDBM.html"><a href="RocSampleSizeDBM.html#RocSampleSizeDBM-references"><i class="fa fa-check"></i><b>15.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html"><i class="fa fa-check"></i><b>16</b> Sample size estimation for ROC studies OR method</a>
<ul>
<li class="chapter" data-level="16.1" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-introduction"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#StatPower2"><i class="fa fa-check"></i><b>16.2</b> Statistical Power</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#sample-size-estimation-for-random-reader-random-cases"><i class="fa fa-check"></i><b>16.2.1</b> Sample size estimation for random-reader random-cases</a></li>
<li class="chapter" data-level="16.2.2" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-dependence-of-stats-power"><i class="fa fa-check"></i><b>16.2.2</b> Dependence of statistical power on estimates of model parameters</a></li>
<li class="chapter" data-level="16.2.3" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-RRRC-sample-size-estimation"><i class="fa fa-check"></i><b>16.2.3</b> Formulae for random-reader random-case (RRRC) sample size estimation</a></li>
<li class="chapter" data-level="16.2.4" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-sig-testing"><i class="fa fa-check"></i><b>16.2.4</b> Significance testing</a></li>
<li class="chapter" data-level="16.2.5" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-pvalue-ci"><i class="fa fa-check"></i><b>16.2.5</b> p-value and confidence interval</a></li>
<li class="chapter" data-level="16.2.6" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-CompareDBM2OR"><i class="fa fa-check"></i><b>16.2.6</b> Comparing DBM to Obuchowski and Rockette for single-reader multiple-treatments</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-FRRC-sample-size-estimation"><i class="fa fa-check"></i><b>16.3</b> Formulae for fixed-reader random-case (FRRC) sample size estimation</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-RRFC-sample-size-estimation"><i class="fa fa-check"></i><b>16.3.1</b> Formulae for random-reader fixed-case (RRFC) sample size estimation</a></li>
<li class="chapter" data-level="16.3.2" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#example-1"><i class="fa fa-check"></i><b>16.3.2</b> Example 1</a></li>
<li class="chapter" data-level="16.3.3" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-FRRCAnalysis"><i class="fa fa-check"></i><b>16.3.3</b> Fixed-reader random-case (FRRC) analysis</a></li>
<li class="chapter" data-level="16.3.4" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-RRFCAnalysis"><i class="fa fa-check"></i><b>16.3.4</b> Random-reader fixed-case (RRFC) analysis</a></li>
<li class="chapter" data-level="16.3.5" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-STMRAnalysis"><i class="fa fa-check"></i><b>16.3.5</b> Single-treatment multiple-reader analysis</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#discussionsummary3"><i class="fa fa-check"></i><b>16.4</b> Discussion/Summary/3</a></li>
<li class="chapter" data-level="16.5" data-path="RocSampleSizeOR.html"><a href="RocSampleSizeOR.html#RocSampleSizeOR-references"><i class="fa fa-check"></i><b>16.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html"><i class="fa fa-check"></i><b>17</b> Split Plot Study Design</a>
<ul>
<li class="chapter" data-level="17.1" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#mean-square-rt"><i class="fa fa-check"></i><b>17.1</b> Mean Square R(T)</a></li>
<li class="chapter" data-level="17.2" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#SplitPlotChapter-references"><i class="fa fa-check"></i><b>17.2</b> References</a></li>
</ul></li>
<li class="part"><span><b>APPENDICES</b></span></li>
<li class="chapter" data-level="" data-path=""><a href="#appendix-appendix"><i class="fa fa-check"></i>(APPENDIX) Appendix</a>
<ul>
<li class="chapter" data-level="17.3" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#rocdataformatIntro"><i class="fa fa-check"></i><b>17.3</b> Introduction</a></li>
<li class="chapter" data-level="17.4" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#note-to-existing-users"><i class="fa fa-check"></i><b>17.4</b> Note to existing users</a></li>
<li class="chapter" data-level="17.5" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#rocExceldataformat"><i class="fa fa-check"></i><b>17.5</b> The Excel data format</a></li>
<li class="chapter" data-level="17.6" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#illustrative-toy-file"><i class="fa fa-check"></i><b>17.6</b> Illustrative toy file</a></li>
<li class="chapter" data-level="17.7" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#rocExcelTruthdataformat"><i class="fa fa-check"></i><b>17.7</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="17.8" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#the-structure-of-an-roc-dataset"><i class="fa fa-check"></i><b>17.8</b> The structure of an ROC dataset</a></li>
<li class="chapter" data-level="17.9" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#rocExcelFPdataformat"><i class="fa fa-check"></i><b>17.9</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="17.10" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#rocExcelTPdataformat"><i class="fa fa-check"></i><b>17.10</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="17.11" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#correspondence-between-nl-member-of-dataset-and-the-fp-worksheet"><i class="fa fa-check"></i><b>17.11</b> Correspondence between <code>NL</code> member of dataset and the <code>FP</code> worksheet</a></li>
<li class="chapter" data-level="17.12" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#correspondence-between-ll-member-of-dataset-and-the-tp-worksheet"><i class="fa fa-check"></i><b>17.12</b> Correspondence between <code>LL</code> member of dataset and the <code>TP</code> worksheet</a></li>
<li class="chapter" data-level="17.13" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#correspondence-using-the-which-function"><i class="fa fa-check"></i><b>17.13</b> Correspondence using the <code>which</code> function</a></li>
<li class="chapter" data-level="17.14" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#rocdataformat-Summary"><i class="fa fa-check"></i><b>17.14</b> Summary</a></li>
<li class="chapter" data-level="17.15" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#rocdataformat-Discussion"><i class="fa fa-check"></i><b>17.15</b> Discussion</a></li>
<li class="chapter" data-level="17.16" data-path="SplitPlotChapter.html"><a href="SplitPlotChapter.html#rocdataformat-references"><i class="fa fa-check"></i><b>17.16</b> References</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="frocdataformat.html"><a href="frocdataformat.html"><i class="fa fa-check"></i><b>18</b> FROC data format</a>
<ul>
<li class="chapter" data-level="18.1" data-path="frocdataformat.html"><a href="frocdataformat.html#purpose"><i class="fa fa-check"></i><b>18.1</b> Purpose</a></li>
<li class="chapter" data-level="18.2" data-path="frocdataformat.html"><a href="frocdataformat.html#frocdataformatIntro"><i class="fa fa-check"></i><b>18.2</b> Introduction</a></li>
<li class="chapter" data-level="18.3" data-path="frocdataformat.html"><a href="frocdataformat.html#frocExceldataformat"><i class="fa fa-check"></i><b>18.3</b> The Excel data format</a></li>
<li class="chapter" data-level="18.4" data-path="frocdataformat.html"><a href="frocdataformat.html#frocExcelTruthdataformat"><i class="fa fa-check"></i><b>18.4</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="18.5" data-path="frocdataformat.html"><a href="frocdataformat.html#the-structure-of-an-froc-dataset"><i class="fa fa-check"></i><b>18.5</b> The structure of an FROC dataset</a></li>
<li class="chapter" data-level="18.6" data-path="frocdataformat.html"><a href="frocdataformat.html#the-false-positive-fp-ratings"><i class="fa fa-check"></i><b>18.6</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="18.7" data-path="frocdataformat.html"><a href="frocdataformat.html#the-true-positive-tp-ratings"><i class="fa fa-check"></i><b>18.7</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="18.8" data-path="frocdataformat.html"><a href="frocdataformat.html#on-the-distribution-of-numbers-of-lesions-in-abnormal-cases"><i class="fa fa-check"></i><b>18.8</b> On the distribution of numbers of lesions in abnormal cases</a>
<ul>
<li class="chapter" data-level="18.8.1" data-path="frocdataformat.html"><a href="frocdataformat.html#definition-of-lesdistr-array"><i class="fa fa-check"></i><b>18.8.1</b> Definition of <code>lesDistr</code> array</a></li>
</ul></li>
<li class="chapter" data-level="18.9" data-path="frocdataformat.html"><a href="frocdataformat.html#definition-of-leswghtdistr-array"><i class="fa fa-check"></i><b>18.9</b> Definition of <code>lesWghtDistr</code> array</a></li>
<li class="chapter" data-level="18.10" data-path="frocdataformat.html"><a href="frocdataformat.html#frocdataformat-Summary"><i class="fa fa-check"></i><b>18.10</b> Summary</a></li>
<li class="chapter" data-level="18.11" data-path="frocdataformat.html"><a href="frocdataformat.html#frocdataformat-Discussion"><i class="fa fa-check"></i><b>18.11</b> Discussion</a></li>
<li class="chapter" data-level="18.12" data-path="frocdataformat.html"><a href="frocdataformat.html#frocdataformat-references"><i class="fa fa-check"></i><b>18.12</b> References</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The RJafroc Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sourcesVariability" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Sources of AUC variability</h1>
<div id="sourcesVariabilityIntro" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Introduction</h2>
<p>In previous chapters the area AUC under the ROC plot was introduced as the preferred way of summarizing performance in the ROC task, as compared to a pair of sensitivity and specificity values. It can be estimated either non-parametrically, as in Chapter <a href="empiricalAUC.html#empiricalAUC">5</a>, or parametrically, as in Chapter <a href="BinormalModel.html#BinormalModel">6</a>, and even better ways of estimating it are described in TBA Chapter 18 and Chapter 20.</p>
<p>Irrespective of how it is estimated AUC is a realization of a random variable, and as such, it is subject to sampling variability. Any measurement based on a finite number of samples from a parent population is subject to sampling variability. This is because no finite sample is unique: someone else conducting a similar study would, in general, obtain a different sample. [Case-sampling variability is estimated by the binormal model in the previous chapter. It is related to the sharpness of the peak of the likelihood function, §6.4.4. The sharper that the peak, the smaller the case sampling variability. This chapter focuses on general sources of variability affecting AUC, regardless of how it is estimated, and other (i.e., not binormal model based) ways of estimating it.]</p>
<p>Here is an outline of this chapter. The starting point is the identification of different sources of variability affecting AUC estimates. Considered next is dependence of AUC on the case-set index <span class="math inline">\(\{c\}\)</span>, <span class="math inline">\(c = 1,2,...,C\)</span>. Considered next is estimating case-sampling variability of the empirical estimate of AUC by an analytic method. This is followed by descriptions of two resampling-based methods, namely the bootstrap and the jackknife, both of which have wide applicability (i.e., they are not restricted to ROC analysis). The methods are demonstrated using <code>R</code> code and the implementation of a calibrated simulator is shown and used to demonstrate their validity, i.e., showing that the different methods of estimating variability agree. The dependence of AUC on reader expertise and modality is considered. An important source of variability, namely the radiologist’s choice of internal sensory thresholds, is described. A cautionary comment is made regarding indiscriminate usage of empirical AUC as a measure of performance.</p>
<p>TBA Online Appendix 7.A describes coding of the bootstrap method; Online Appendix 7.B is the corresponding implementation of the jackknife method. Online Appendix 7.C describes implementation of the calibrated simulator for single-modality single-reader ROC datasets. Online Appendix 7.D describes the code that allows comparison of the different methods of estimating case-sampling variability.</p>
</div>
<div id="sourcesVariability3sources" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Three sources of variability</h2>
<p>Statistics deals with variability. Understanding sources of variability affecting AUC is critical to an appreciation of ROC analysis. Three sources of variability are identified in <span class="citation">(Swets and Pickett <a href="#ref-RN412" role="doc-biblioref">1982</a>)</span>: case sampling, between-reader and within-reader variability.</p>
<ol style="list-style-type: decimal">
<li>Consider a single reader interpreting different case samples. Case-sampling variability arises from the finite number of cases comprising the dataset, compared to the potentially very large population of cases. [If one could sample every case there exists and have them interpreted by the same reader, there would be no case-sampling variability and the poor reader’s AUC values (from repeated interpretations of the entire population) would reflect only within reader variability, see #3 below.] Each case-set <span class="math inline">\(\{c\}\)</span>, consisting of <span class="math inline">\(K_1\)</span> non-diseased and <span class="math inline">\(K_2\)</span> diseased cases interpreted by the reader, yields an AUC value. The notation <span class="math inline">\(\{c\}\)</span> means different <em>case sets</em>. Thus <span class="math inline">\(\{c\}\)</span> = <span class="math inline">\(\{1\}\)</span>, <span class="math inline">\(\{2\}\)</span>, etc., denote different case sets, each consisting of <span class="math inline">\(K_1\)</span> non-diseased and <span class="math inline">\(K_2\)</span> diseased cases.</li>
</ol>
<p>There is much “data compression” in going from individual case ratings to AUC. For a single reader and given case-set <span class="math inline">\(\{c\}\)</span>, the ratings can be converted to an <span class="math inline">\(A_{z\{c\}}\)</span> estimate, TBA Eqn. (6.49). The notation shows explicitly the dependence of the measure on the case-set <span class="math inline">\(\{c\}\)</span>. One can conceptualize the distribution of <span class="math inline">\(A_{z\{c\}}\)</span>’s over different case-sets, each of the same size <span class="math inline">\(K_1+K_2\)</span>, as a normal distribution, i.e.,</p>
<p><span class="math display" id="eq:sourcesVariability-cs-wr">\[\begin{equation} 
A_{z\{c\}}\sim N(A_{z\{\bullet\}},\sigma_{\text{cs+wr}}^2)
\tag{7.1}
\end{equation}\]</span></p>
<p>The dot notation <span class="math inline">\(\{\bullet\}\)</span> denotes an average over all case sets. Thus, <span class="math inline">\(A_{z\{\bullet\}}\)</span> is an estimate of the case-sampling mean of <span class="math inline">\(A_z\)</span> for a single fixed reader and <span class="math inline">\(\sigma_{\text{cs+wr}}^2\)</span> is the <em>case sampling plus within-reader</em> variance. The reason for adding the within-reader variance is explained in #3 below. The concept is that a specified reader interpreting different case-sets effectively samples different parts of the population of cases, resulting in variability in measured <span class="math inline">\(A_z\)</span>. Sometimes easier cases are sampled, and sometimes more difficult ones. This source of variability is expected to decrease with increasing case-set size, i.e., increasing <span class="math inline">\(K_1+K_2\)</span>, which is the reason for seeking large numbers of cases in clinical trials. Case-sampling and within-reader variability also decreases as the cases become more homogenous. An example of a more homogenous case sample would be cases originating from a small geographical region with, for example, limited ethnic variability. This is the reason for seeking multi-institutional clinical trials, because they tend to sample more of the population than patients seen at a single institution.</p>
<ol start="2" style="list-style-type: decimal">
<li>Consider different readers interpreting a fixed case sample. Between-reader variability arises from the finite number of readers compared to the population of readers; the population of readers could be all board certified radiologists interpreting screening mammograms in the US. This time one envisages different readers interpreting a fixed case set <span class="math inline">\(\{1\}\)</span>. The different reader’s <span class="math inline">\(A_{z;j}\)</span> values (<span class="math inline">\(j\)</span> is the reader index, <span class="math inline">\(j = 1, 2, ..., J\)</span>, where <span class="math inline">\(J\)</span> is the total number of readers in the dataset) are distributed:</li>
</ol>
<p><span class="math display" id="eq:sourcesVariability-br-wr">\[\begin{equation} 
A_{z;j}\sim N(A_{z;\bullet},\sigma_{\text{br+wr}}^2)
\tag{7.2}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(A_{z;\bullet}\)</span> is an estimate of the reader population AUC mean (the bullet symbol replacing the reader index averages over a set of readers) for the fixed case-set <span class="math inline">\(\{1\}\)</span> and <span class="math inline">\(\sigma_{\text{br+wr}}^2\)</span> is the <em>between-reader plus within-reader</em> variance. The reason for adding the within-reader variance is explained in #3 below. The concept is that different groups of <span class="math inline">\(J\)</span> readers interpret the same case set <span class="math inline">\(\{1\}\)</span>, thereby sampling different parts of the reader distribution, causing fluctuations in the measured <span class="math inline">\(A_{z;j}\)</span> of the readers. Sometimes better readers are sampled and sometimes not so good ones are sampled. This time there is no “data compression” – each reader in the sample has an associated <span class="math inline">\(A_{z;j}\)</span>. However, variability of the average <span class="math inline">\(A_{z;\bullet}\)</span> over the <span class="math inline">\(J\)</span> readers is expected to decrease with increasing <span class="math inline">\(J\)</span>. This is the reason for seeking large reader-samples.</p>
<ol start="3" style="list-style-type: decimal">
<li>Consider a fixed reader, e.g., <span class="math inline">\(j = 1\)</span>, interpreting a fixed case-sample <span class="math inline">\(\{1\}\)</span>. Within-reader variability is due to variability of the ratings for the same case: the same reader interpreting the same case on different occasions will give different ratings to it, causing fluctuations in the measured AUC. This assumes that memory effects are minimized, for example, by sufficient time between successive interpretations as otherwise, if a case is shown twice in succession, the reader would give it the same rating each time. Since this is an intrinsic source of variability (analogous to the internal noise of a voltmeter) affecting each reader’s interpretations, it cannot be separated from case sampling variability, i.e., it cannot be “turned off”. The last sentence needs further explanation. A measurement of case-sampling variability requires a reader, and the reader comes with an intrinsic source of variability that gets added to the case-sampling variance, so what is measured is the sum of case sampling and within-reader variances, denoted <span class="math inline">\(\sigma_{\text{cs+wr}}^2\)</span>. Likewise, a measurement of between-reader variability requires a fixed case-set interpreted by different readers, each of whom comes with an intrinsic source of variability that gets added to the between-reader variance, yielding <span class="math inline">\(\sigma_{\text{br+wr}}^2\)</span>. To emphasize this point, an estimate of case-sampling variability <em>always</em> includes within reader variability. Likewise, an estimate of between-reader variability <em>always</em> includes within-reader variability.</li>
</ol>
<p>With this background, the purpose of this chapter is to delve into variability in some detail and in particular describe computational methods for estimating them. This chapter introduces the concept of resampling a dataset to estimate variability and the widely used bootstrap and jackknife methods of estimating variance are described. In a later chapter, these are extended to estimating covariance (essentially a scaled version of the correlation) between two random variables.</p>
<p>The starting point is the simplest scenario: a single reader interpreting a case-set.</p>
</div>
<div id="dependence-of-auc-on-the-case-sample" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Dependence of AUC on the case sample</h2>
<p>Suppose a researcher conducts a ROC study with a single reader. The researcher starts by selecting a case-sample, i.e., a set of proven-truth non-diseased and diseased cases. Another researcher conducting another ROC study at the same institution selects a different case-sample, i.e., a different set of proven-truth non-diseased and diseased cases. The two case-sets contain the same numbers <span class="math inline">\(K_1,K_2\)</span> of non-diseased and diseased cases, respectively. Even if the same radiologist interprets the two case-sets, and the reader is perfectly reproducible, the AUC values are expected to be different. Therefore, AUC must depend on a case sample index, which is denoted <span class="math inline">\(\{c\}\)</span>, where <span class="math inline">\(c\)</span> is an integer: <span class="math inline">\(c = 1, 2\)</span>, as there are two case-sets in the study as envisaged.</p>
<p><span class="math display" id="eq:sourcesVariability-case-set">\[\begin{equation} 
AUC\rightarrow AUC_{\{c\}}
\tag{7.3}
\end{equation}\]</span></p>
<p>Note that <span class="math inline">\(\{c\}\)</span> is not an individual <em>case</em> index, rather it is a <em>case-set</em> index, i.e., different integer values of <span class="math inline">\(c\)</span> denote different sets, or samples, or groups, or collections of cases. [The dependence of AUC on the case sample index is not explicitly shown in the literature.]</p>
<p>What does the dependence of AUC on the <span class="math inline">\(c\)</span> index mean? Different case samples differ in their <em>difficulty</em> levels. A difficult case set contains a greater fraction of difficult cases than is usual. A difficult diseased case is one where disease is difficult to detect. For example, the lesions could be partly obscured by overlapping normal structures in the patient anatomy; i.e., the lesion does not “stick out”. Alternatively, variants of normal anatomy could mimic a lesion, like a blood vessel viewed end on in a chest radiograph, causing the radiologist to miss the real lesion(s) and mistake these blood vessels for lesions. An easy diseased case is one where the disease is easy to detect. For example, the lesion is projected over smooth background tissue, because of which it “sticks out”, or is more conspicuous2. How does difficulty level affect non-diseased cases? A difficult non-diseased case is one where variants of normal anatomy mimic actual lesions and could cause the radiologist to falsely diagnose the patient as diseased. Conversely, an easy non-diseased case is like a textbook illustration of normal anatomy. Every structure in it is clearly visualized and accounted for by the radiologist’s knowledge of the patient’s non-diseased anatomy, and the radiologist is confident that any abnormal structure, <em>if present</em>, would be readily seen. The radiologist is unlikely to falsely diagnose the patient as diseased. Difficult cases tend to be rated in the middle of the rating scale, while easy ones tend to be rated at the ends of the rating scale.</p>
<div id="case-sampling-variability-of-auc" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Case sampling variability of AUC</h3>
<p>An easy case sample will cause AUC to increase over its average value; interpreting many case-sets and averaging the AUCs determines the average value. Conversely, a difficult case sample will cause AUC to decrease. Case sampling variability causes variability in the measured AUC. How does one estimate this essential source of variability? One method, totally impractical in the clinic but easy with simulations, is to have the same radiologist interpret repeated samples of case-sets from the population of cases (i.e., patients), termed <em>population sampling</em>, or more viscerally, as the “brute force” method.</p>
<p>Even if one could get a radiologist to interpret different case-sets, it is even more impractical to actually acquire the different case samples of truth-proven cases. Patients do not come conveniently labeled as non-diseased or diseased. Rather, one needs to follow-up on the patients, perhaps do other imaging tests, in order to establish true disease status, or ground-truth. In screening mammography, a woman who continues to be diagnosed as non-diseased on successive yearly screening tests in the US, and has no other symptoms of breast disease, is probably disease-free. Likewise, a woman diagnosed as diseased and the diagnosis is confirmed by biopsy (i.e., the biopsy comes back showing a malignancy in the sampled tissues) is known to be diseased. However, not all patients who are diseased are actually diagnosed as diseased: a typical false negative fraction is 20% in screening mammography3. This is where follow-up imaging can help determine true disease status at the initial screen. A false negative mistake is unlikely to be repeated at the next screen. After a year, the tumor may have grown, and is more likely to be detected. Having detected the tumor in the most recent screen, radiologists can go back and retrospectively view it in the initial screen, at which it was missed during the “live” interpretation. If one knows where to look, the cancer is easier to see. The previous screen images would be an example of a difficult diseased case. In unfortunate instances, the patient may die from the previously undetected cancer, which would establish the truth status at the initial screen, too late to do the patient any good. The process of determining actual truth is often referred to as defining the “gold standard”, the <em>ground truth</em>: or simply <em>truthing</em>.</p>
<p><em>One can appreciate from this discussion that acquiring independently proven cases, particularly diseased ones, is one of the most difficult aspects of conducting an observer performance study</em>.</p>
<p>There has to be a better way of estimating case-sampling variability. With a parametric model, the maximum likelihood procedure provides a means of estimating variability of each of the estimated parameters, which can be used to estimate the variability of <span class="math inline">\(A_z\)</span>, as in Chapter <a href="BinormalModel.html#BinormalModel">6</a>. The estimate corresponds to case-sampling variability (including an inseparable within-reader variability). If unsure about this point, the reader should run some of the examples in Chapter <a href="BinormalModel.html#BinormalModel">6</a> with increased numbers of cases. The variability is seen to decrease.</p>
<p>There are other options available for estimating case-sampling variance of AUC, and this chapter is not intended to be comprehensive. Three commonly used options are described: the DeLong et al method, the bootstrap and the jackknife resampling methods.</p>
</div>
</div>
<div id="sourcesVariabilityDeLong" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> DeLong method</h2>
<p>If the figure-of-merit is the empirical AUC, then a procedure developed by DeLong et al4 (henceforth abbreviated to DeLong) is applicable that is based on earlier work by <span class="citation">(Noether <a href="#ref-RN2530" role="doc-biblioref">1967</a>)</span> and <span class="citation">(Bamber <a href="#ref-RN2174" role="doc-biblioref">1975</a>)</span>. The author will not go into details of this procedure but limit to showing that it “works”. However, before one can show that it “works”, one needs to know the true value of the variance of empirical AUC. Even if data were simulated using the binormal model, one cannot use the binormal model based estimate of variance as it is an estimate, not to be confused with a true value. Estimates are realizations of random numbers and are themselves subject to variability, which decreases with increasing case-set size. Instead, a “brute-force” (i.e., simulated population sampling) approach is adopted to determine the true value of the variance of AUC. The simulator provides a means of repeatedly generating case-sets interpreted by the same radiologist, and by sampling it enough time, e.g., <span class="math inline">\(C\)</span> = 10,000 times, each time calculating AUC, one determines the population mean and standard deviation. The standard deviation determined this way is compared to that yielded by the DeLong method to check if the latter actually works.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="sourcesVariability.html#cb1-1"></a>bruteForceEstimation &lt;-</span>
<span id="cb1-2"><a href="sourcesVariability.html#cb1-2"></a><span class="st">  </span><span class="cf">function</span>(seed, mu, sigma, K1, K2) {</span>
<span id="cb1-3"><a href="sourcesVariability.html#cb1-3"></a>    <span class="co"># brute force method to</span></span>
<span id="cb1-4"><a href="sourcesVariability.html#cb1-4"></a>    <span class="co"># find the population </span></span>
<span id="cb1-5"><a href="sourcesVariability.html#cb1-5"></a>    <span class="co"># meanempAuc and stdDevempAuc</span></span>
<span id="cb1-6"><a href="sourcesVariability.html#cb1-6"></a>    empAuc &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="dv">10000</span>)</span>
<span id="cb1-7"><a href="sourcesVariability.html#cb1-7"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(empAuc)) {</span>
<span id="cb1-8"><a href="sourcesVariability.html#cb1-8"></a>      zk1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K1)</span>
<span id="cb1-9"><a href="sourcesVariability.html#cb1-9"></a>      zk2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K2, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> sigma)</span>
<span id="cb1-10"><a href="sourcesVariability.html#cb1-10"></a>      empAuc[i] &lt;-<span class="st"> </span><span class="kw">Wilcoxon</span>(zk1, zk2)</span>
<span id="cb1-11"><a href="sourcesVariability.html#cb1-11"></a>    }</span>
<span id="cb1-12"><a href="sourcesVariability.html#cb1-12"></a>    stdDevempAuc  &lt;-<span class="st">  </span><span class="kw">sqrt</span>(<span class="kw">var</span>(empAuc))</span>
<span id="cb1-13"><a href="sourcesVariability.html#cb1-13"></a>    meanempAuc   &lt;-<span class="st">  </span><span class="kw">mean</span>(empAuc)</span>
<span id="cb1-14"><a href="sourcesVariability.html#cb1-14"></a>    <span class="kw">return</span>(<span class="kw">list</span>(</span>
<span id="cb1-15"><a href="sourcesVariability.html#cb1-15"></a>      <span class="dt">meanempAuc =</span> meanempAuc,</span>
<span id="cb1-16"><a href="sourcesVariability.html#cb1-16"></a>      <span class="dt">stdDevempAuc =</span> stdDevempAuc</span>
<span id="cb1-17"><a href="sourcesVariability.html#cb1-17"></a>    ))</span>
<span id="cb1-18"><a href="sourcesVariability.html#cb1-18"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="sourcesVariability.html#cb2-1"></a>seed &lt;-<span class="st"> </span><span class="dv">1</span>;<span class="kw">set.seed</span>(seed)</span>
<span id="cb2-2"><a href="sourcesVariability.html#cb2-2"></a>mu &lt;-<span class="st"> </span><span class="fl">1.5</span>;sigma &lt;-<span class="st"> </span><span class="fl">1.3</span>;K1 &lt;-<span class="st"> </span><span class="dv">50</span>;K2 &lt;-<span class="st"> </span><span class="dv">52</span></span>
<span id="cb2-3"><a href="sourcesVariability.html#cb2-3"></a>ret &lt;-<span class="st"> </span><span class="kw">bruteForceEstimation</span>(seed, mu, sigma, K1, K2)</span>
<span id="cb2-4"><a href="sourcesVariability.html#cb2-4"></a><span class="co"># one more trial</span></span>
<span id="cb2-5"><a href="sourcesVariability.html#cb2-5"></a>zk1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K1)</span>
<span id="cb2-6"><a href="sourcesVariability.html#cb2-6"></a>zk2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K2, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> sigma)</span>
<span id="cb2-7"><a href="sourcesVariability.html#cb2-7"></a>empAuc &lt;-<span class="st"> </span><span class="kw">Wilcoxon</span>(zk1, zk2)</span>
<span id="cb2-8"><a href="sourcesVariability.html#cb2-8"></a>ret1  &lt;-<span class="st"> </span><span class="kw">DeLongVar</span>(zk1,zk2)</span>
<span id="cb2-9"><a href="sourcesVariability.html#cb2-9"></a>stdDevDeLong &lt;-<span class="st"> </span><span class="kw">sqrt</span>(ret1)</span>
<span id="cb2-10"><a href="sourcesVariability.html#cb2-10"></a><span class="kw">cat</span>(<span class="st">&quot;brute force estimates:&quot;</span>,</span>
<span id="cb2-11"><a href="sourcesVariability.html#cb2-11"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">empAuc = &quot;</span>,</span>
<span id="cb2-12"><a href="sourcesVariability.html#cb2-12"></a>    ret<span class="op">$</span>meanempAuc,</span>
<span id="cb2-13"><a href="sourcesVariability.html#cb2-13"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">population standard deviation =&quot;</span>,</span>
<span id="cb2-14"><a href="sourcesVariability.html#cb2-14"></a>    ret<span class="op">$</span>stdDevempAuc, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-15"><a href="sourcesVariability.html#cb2-15"></a><span class="co">#&gt; brute force estimates: </span></span>
<span id="cb2-16"><a href="sourcesVariability.html#cb2-16"></a><span class="co">#&gt; empAuc =  0.819178 </span></span>
<span id="cb2-17"><a href="sourcesVariability.html#cb2-17"></a><span class="co">#&gt; population standard deviation = 0.04176683</span></span>
<span id="cb2-18"><a href="sourcesVariability.html#cb2-18"></a></span>
<span id="cb2-19"><a href="sourcesVariability.html#cb2-19"></a><span class="kw">cat</span>(<span class="st">&quot;single sample estimates = &quot;</span>,</span>
<span id="cb2-20"><a href="sourcesVariability.html#cb2-20"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">empirical AUC&quot;</span>,</span>
<span id="cb2-21"><a href="sourcesVariability.html#cb2-21"></a>    empAuc,</span>
<span id="cb2-22"><a href="sourcesVariability.html#cb2-22"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">standard deviation DeLong = &quot;</span>,</span>
<span id="cb2-23"><a href="sourcesVariability.html#cb2-23"></a>    stdDevDeLong, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb2-24"><a href="sourcesVariability.html#cb2-24"></a><span class="co">#&gt; single sample estimates =  </span></span>
<span id="cb2-25"><a href="sourcesVariability.html#cb2-25"></a><span class="co">#&gt; empirical AUC 0.8626923 </span></span>
<span id="cb2-26"><a href="sourcesVariability.html#cb2-26"></a><span class="co">#&gt; standard deviation DeLong =  0.03804135</span></span></code></pre></div>
<p>Two functions needed for this code to work are not shown: <code>Wilcoxon()</code> calculates the Wilcoxon statistic and the <code>DeLongVar()</code> implements the DeLong variance computation method (the DeLong method also calculates co-variances, but these are not needed in the current context). Line 1 sets the <code>seed</code> of the random number generator to 1. The <code>seed</code> variable is completely analogous to the case-set index <code>c</code>. Keeping <code>seed</code> fixed realizes the same random numbers each time the program is run. Different values of <code>seed</code> result in different, i.e., statistically independent, random samples. Line 2 initialize the values <span class="math inline">\((\mu, \sigma, K_1, K_2)\)</span> needed by the data simulator: the normal distributions are separated by <span class="math inline">\(\mu = 1.5\)</span>, the standard deviation of the diseased distribution is <span class="math inline">\(\sigma = 1.3\)</span>, and there are <span class="math inline">\(K_1 = 50\)</span> non-diseased and <span class="math inline">\(K_2 = 52\)</span> diseased cases. Line 3 calls <code>bruteForceEstimation</code>, the “brute force” method for estimating mean and standard deviation of the population distribution of AUC, returned by this function, which are the “correct” value to which the DeLong standard deviation estimate will be compared. Lines 4-9 generates a fresh ROC dataset to which the DeLong method is applied.</p>
<p>Two runs of this code were made, one with the smaller sample size, and the other with 10 times the sample size (the second run takes much longer). A third run was made with the larger sample size but with a different seed value. The results follow:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="sourcesVariability.html#cb3-1"></a>seed &lt;-<span class="st"> </span><span class="dv">2</span>;<span class="kw">set.seed</span>(seed)</span>
<span id="cb3-2"><a href="sourcesVariability.html#cb3-2"></a>mu &lt;-<span class="st"> </span><span class="fl">1.5</span>;sigma &lt;-<span class="st"> </span><span class="fl">1.3</span>;K1 &lt;-<span class="st"> </span><span class="dv">500</span>;K2 &lt;-<span class="st"> </span><span class="dv">520</span></span>
<span id="cb3-3"><a href="sourcesVariability.html#cb3-3"></a>ret &lt;-<span class="st"> </span><span class="kw">bruteForceEstimation</span>(seed, mu, sigma, K1, K2)</span>
<span id="cb3-4"><a href="sourcesVariability.html#cb3-4"></a><span class="co"># one more trial</span></span>
<span id="cb3-5"><a href="sourcesVariability.html#cb3-5"></a>zk1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K1)</span>
<span id="cb3-6"><a href="sourcesVariability.html#cb3-6"></a>zk2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K2, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> sigma)</span>
<span id="cb3-7"><a href="sourcesVariability.html#cb3-7"></a>empAuc &lt;-<span class="st"> </span><span class="kw">Wilcoxon</span>(zk1, zk2)</span>
<span id="cb3-8"><a href="sourcesVariability.html#cb3-8"></a>ret1  &lt;-<span class="st"> </span><span class="kw">DeLongVar</span>(zk1,zk2)</span>
<span id="cb3-9"><a href="sourcesVariability.html#cb3-9"></a>stdDevDeLong &lt;-<span class="st"> </span><span class="kw">sqrt</span>(ret1)</span>
<span id="cb3-10"><a href="sourcesVariability.html#cb3-10"></a><span class="kw">cat</span>(<span class="st">&quot;brute force estimates:&quot;</span>,</span>
<span id="cb3-11"><a href="sourcesVariability.html#cb3-11"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">empAuc = &quot;</span>,</span>
<span id="cb3-12"><a href="sourcesVariability.html#cb3-12"></a>    ret<span class="op">$</span>meanempAuc,</span>
<span id="cb3-13"><a href="sourcesVariability.html#cb3-13"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">population standard deviation =&quot;</span>,</span>
<span id="cb3-14"><a href="sourcesVariability.html#cb3-14"></a>    ret<span class="op">$</span>stdDevempAuc, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-15"><a href="sourcesVariability.html#cb3-15"></a><span class="co">#&gt; brute force estimates: </span></span>
<span id="cb3-16"><a href="sourcesVariability.html#cb3-16"></a><span class="co">#&gt; empAuc =  0.8194988 </span></span>
<span id="cb3-17"><a href="sourcesVariability.html#cb3-17"></a><span class="co">#&gt; population standard deviation = 0.01300203</span></span>
<span id="cb3-18"><a href="sourcesVariability.html#cb3-18"></a></span>
<span id="cb3-19"><a href="sourcesVariability.html#cb3-19"></a><span class="kw">cat</span>(<span class="st">&quot;single sample estimates = &quot;</span>,</span>
<span id="cb3-20"><a href="sourcesVariability.html#cb3-20"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">empirical AUC&quot;</span>,</span>
<span id="cb3-21"><a href="sourcesVariability.html#cb3-21"></a>    empAuc,</span>
<span id="cb3-22"><a href="sourcesVariability.html#cb3-22"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">standard deviation DeLong = &quot;</span>,</span>
<span id="cb3-23"><a href="sourcesVariability.html#cb3-23"></a>    stdDevDeLong, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb3-24"><a href="sourcesVariability.html#cb3-24"></a><span class="co">#&gt; single sample estimates =  </span></span>
<span id="cb3-25"><a href="sourcesVariability.html#cb3-25"></a><span class="co">#&gt; empirical AUC 0.8047269 </span></span>
<span id="cb3-26"><a href="sourcesVariability.html#cb3-26"></a><span class="co">#&gt; standard deviation DeLong =  0.01356696</span></span></code></pre></div>
<ol style="list-style-type: decimal">
<li>An important observation is that as sample-size increases, case-sampling variability decreases: 0.0417 for the smaller sample size vs. 0.01309 for the larger sample size, and the dependence is as the inverse square root of the numbers of cases, as expected from the central limit theorem.</li>
<li>With the smaller sample size (K1/K2 = 50/52; the back-slash notation, not to be confused with division, is a convenient way of summarizing the case-sample size) the estimated standard deviation (0.038) is within 10% of that estimated by population sampling (0.042). With the larger sample size, (K1/K2 = 500/520) the two are practically identical (0.01300203 vs. 0.01356696 – the latter value is for seed = 2).</li>
<li>Notice also that the one sample empirical AUC for the smaller case-size is 0.863, which is less than two standard deviations from the population mean 0.819. The “two standard deviations” comes from rounding up 1.96: as in Eqn. <a href="#eq:binaryTask-def-z-alpha2">(<strong>??</strong>)</a>, where <span class="math inline">\(z_{\alpha/2}\)</span> was defined as the upper <span class="math inline">\(1-\alpha/2\)</span> quantile of the unit normal distribution and <span class="math inline">\(z_{0.025}=1.96\)</span>.</li>
<li>To reiterate, with clinical data the DeLong procedure estimates case sampling plus within reader variability. With simulated data as in this example, there is no within-reader variability as the simulator yields identical values for fixed seed.</li>
</ol>
<p>This demonstration should convince the reader that one does have recourse other than the “brute force” method, at least when the figure of merit is the empirical area under the ROC. That should come as a relief, as population sampling is impractical in the clinical context. It should also impress the reader, as the DeLong method is able to use information present in a <em>single dataset</em> to tease out its variability. [This is not magic: the MLE estimate is also able to tease out variability based on a parametric fit to a single dataset and examination of the sharpness of the peak of the log-likelihood function, Chapter <a href="BinormalModel.html#BinormalModel">6</a>, as are the resampling methods described next.]</p>
<p>Next, two resampling–based methods of estimating case-sampling variance of AUC are introduced. The word “resampling” means that the dataset itself is regarded as containing information regarding its variability, which can be extracted by sampling from the original data (hence the word “resampling”). These are general and powerful techniques, applicable to any scalar statistic, not just the empirical AUC, which one might be able to use in other contexts.</p>
</div>
<div id="sourcesVariabilityBootstrap" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Bootstrap method</h2>
<p>The simplest resampling method, at least at the conceptual level, is the bootstrap. <em>The bootstrap method is based on the assumption that one can regard the observed sample as defining the population from which it was sampled.</em> Since by definition a population cannot be exhausted, the idea is to resample, <em>with replacement</em>, from the observed sample. Each resampling step realizes a particular bootstrap sample set denoted <span class="math inline">\(\{b\}\)</span>, where <span class="math inline">\(b = 1, 2, ..., B\)</span>. The curly brackets emphasize that different integer values of <span class="math inline">\(b\)</span> denote different <em>sets of cases</em>, not individual cases. [In contrast, the notation <span class="math inline">\((k)\)</span> will be used to denote <em>removing</em> a specific case, <span class="math inline">\(k\)</span>, as in the jackknife procedure to be described shortly. The index <span class="math inline">\(b\)</span> should not be confused with the index <span class="math inline">\(c\)</span>, the case sampling index; the latter denotes repeated sampling from the population, which is impractical in real life; the bootstrap index denotes repeated sampling from the dataset, which is quite feasible.] The procedure is repeated <span class="math inline">\(B\)</span> times, typically <span class="math inline">\(B\)</span> can be as small as 200, but to be safe the author generally use about 1000 - 2000 bootstraps. The following example uses Table <a href="#tab:ratingsParadigmExampleTable"><strong>??</strong></a> from Chapter <a href="ratingsParadigm.html#ratingsParadigm">4</a>.</p>
<p>For convenience, let us denote cases as follows. The 30 non-diseased cases that received the 1 rating are denoted <span class="math inline">\(k_{1,1},k_{2,1},...,k_{30,1}\)</span>. The second index denotes the truth state of the cases. Likewise, the 19 non-diseased cases that received the 2 rating are denoted <span class="math inline">\(k_{31,1},k_{32,1},...,k_{49,1}\)</span> and so on for the remaining non-diseased cases. The 5 diseased cases that received the 1 rating are denoted <span class="math inline">\(k_{1,2},k_{2,2},...,k_{5,2}\)</span>, the 6 diseased cases that received the 2 rating are denoted <span class="math inline">\(k_{6,2},k_{7,2},...,k_{11,2}\)</span>, and so on. Let us figuratively “put” all non-diseased cases (think of each case as an index card, with the case notation and rating recorded on it) into one hat (the non-diseased hat) and all the diseased cases into another hat (the diseased hat). Next, one randomly picks one case (card) from the non-diseased hat, records it’s rating, and puts the case back in the hat, so that it is free to be possibly picked again. This is repeated 60 times for the non-diseased hat resulting in 60 ratings from non-diseased cases. A similar procedure is performed using the diseased hat, resulting in 50 ratings from diseased cases. The author has just described, in painful detail (one might say) the realization of the 1st bootstrap sample, denoted <span class="math inline">\(\{b=1\}\)</span>. This is used to construct the 1st bootstrap counts table, Table <a href="sourcesVariability.html#tab:sourcesVariabilitybs1">7.1</a>.</p>
<table>
<caption>
<span id="tab:sourcesVariabilitybs1">TABLE 7.1: </span>Representative counts table.
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
<span class="math inline">\(r = 5\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(r = 4\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(r = 3\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(r = 2\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(r = 1\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
non-diseased
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
35
</td>
</tr>
<tr>
<td style="text-align:left;">
diseased
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
7
</td>
</tr>
</tbody>
</table>
<p>So what happened? Consider the 35 non-diseased cases with a 1 rating. If each non-diseased case rated 1 in Table <a href="#tab:ratingsParadigmExampleTable"><strong>??</strong></a> were picked one time, the total would have been 30, but it is 35. Therefore, some of the original non-diseased cases rated 1 must have been picked multiple times, but one must also make allowance as there is no guarantee that a specific case was picked at all. Still focusing on the 35 non-diseased cases with a 1 rating in the first bootstrap sample, the picked labels, reordered after the fact, with respect to the first index, might be:</p>
<p><span class="math display" id="eq:sourcesVariabilitybs1-bs1-non-diseased">\[\begin{equation} 
k_{2,1},k_{2,1},k_{4,1},k_{4,1},k_{4,1},k_{6,1},k_{7,1},k_{7,1},k_{9,1},...,k_{28,1},k_{28,1},k_{30,1},k_{30,1}
\tag{7.4}
\end{equation}\]</span></p>
<p>In this example, case <span class="math inline">\(k_{1,1}\)</span> was not picked, case <span class="math inline">\(k_{2,1}\)</span> was picked twice, case <span class="math inline">\(k_{3,1}\)</span> was not picked, case <span class="math inline">\(k_{4,1}\)</span> was picked three times, case <span class="math inline">\(k_{5,1}\)</span> was not picked, case <span class="math inline">\(k_{6,1}\)</span> was picked once, etc. The total number of cases in Eqn. <a href="sourcesVariability.html#eq:sourcesVariabilitybs1-bs1-non-diseased">(7.4)</a> is 35, and similarly for the other cells in Table <a href="sourcesVariability.html#tab:sourcesVariabilitybs1">7.1</a>. Next, one estimates AUC for this table. Using the Eng website referred to earlier, one gets AUC = 0.843. [It is OK to use a parametric FOM since the bootstrap is a general procedure applicable, in principle, to any FOM, not just the empirical AUC, unlike the DeLong method, which is restricted to empirical AUC.] The corresponding value for the original data, Table <a href="#tab:ratingsParadigmExampleTable"><strong>??</strong></a>, was AUC = 0.870. The first bootstrapped dataset yielded a smaller value than the original dataset because one happened to have picked an unusually difficult bootstrap sample.</p>
<p>[Notice that in the original data there were 6 + 5 = 11 diseased cases that were rated 1 and 2, but in the bootstrapped dataset there are 7 + 9 = 16 diseased cases that were rated 1 and 2; in other words, the number of incorrect decisions on diseased cases went up, which would tend to lower AUC. Counteracting this effect is the increase in number of correct decisions on diseased cases: 8 + 19 = 27 cases rated 4 and 5, as compared to 12 + 22 = 34 in the original dataset. Reinforcing the effect is that increase in the number of correct decisions on non-diseased cases, albeit minimally: 35 + 16 = 51 rated 1 and 2 vs. 30 + 19 = 49 in the original dataset, and zero counts rated 4 and 5 in the non-diseased vs. 2 + 1 = 3 in the diseased. The complexity of following this <em>post-facto justification</em> illustrates the difficulty, in fact the futility, of correctly predicting which way performance will go from comparison of the two ROC counts tables – too many numbers are changing and in the above one did not even consider the change in counts in the bin labeled 4! Hence, the need for an objective figure of merit, such as the binormal model based AUC or the empirical AUC.]</p>
<p>To complete the description of the bootstrap method, one repeats the procedure described in the preceding paragraphs <span class="math inline">\(B = 200\)</span> times, each time running the website calculator and the final result is <span class="math inline">\(B\)</span> values of AUC, denoted:</p>
<p><span class="math display">\[AUC_{\{1\}},AUC_{\{2\}},...,AUC_{\{B\}}\]</span></p>
<p>where <span class="math inline">\(AUC_{\{1\}}=0.843\)</span>, etc. The bootstrap estimate of the variance of AUC is defined by <span class="citation">(Efron and Tibshirani <a href="#ref-RN2261" role="doc-biblioref">1993</a>)</span>:</p>
<p><span class="math display" id="eq:sourcesVariabilityVar-bs">\[\begin{equation} 
\text{Var}\left ( AUC \right )=\frac{1}{B-1}\sum_{b=1}^{B}\left ( AUC_{\{b\}}-AUC_{\{ \bullet\}} \right )^2
\tag{7.5}
\end{equation}\]</span></p>
<p>The right hand side is the traditional definition of (unbiased) variance. The dot represents the average over the <em>replaced index</em>. Of course, running the website code 200 times and recording the outputs is not a productive use of time. The following code implements two methods for estimating AUC, the empirical AUC, described in Chapter <a href="empiricalAUC.html#empiricalAUC">5</a> and the binormal model estimate of AUC, described in Chapter <a href="BinormalModel.html#BinormalModel">6</a>.</p>
<div id="demonstration-of-the-bootstrap-method" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Demonstration of the bootstrap method</h3>
<p>To minimize clutter, several <code>R</code> functions are not shown, but they are compiled. To display them <code>clone</code> or ‘fork’ the book repository and look at the <code>Rmd</code> file corresponding to this output and the sourced <code>R</code> files listed below:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="sourcesVariability.html#cb4-1"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH07-Variability/Transforms.R&quot;</span>))</span>
<span id="cb4-2"><a href="sourcesVariability.html#cb4-2"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH07-Variability/LL.R&quot;</span>))</span>
<span id="cb4-3"><a href="sourcesVariability.html#cb4-3"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH07-Variability/RocfitR.R&quot;</span>)) </span>
<span id="cb4-4"><a href="sourcesVariability.html#cb4-4"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH07-Variability/RocOperatingPoints.R&quot;</span>))</span>
<span id="cb4-5"><a href="sourcesVariability.html#cb4-5"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH07-Variability/FixRocCountsTable.R&quot;</span>))</span>
<span id="cb4-6"><a href="sourcesVariability.html#cb4-6"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH07-Variability/WilcoxonCountsTable.R&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="sourcesVariability.html#cb5-1"></a>doBootstrap &lt;-<span class="st"> </span><span class="cf">function</span>(parametricFOM, B, seed, RocTable) {</span>
<span id="cb5-2"><a href="sourcesVariability.html#cb5-2"></a>  <span class="co"># this is the K vector </span></span>
<span id="cb5-3"><a href="sourcesVariability.html#cb5-3"></a>  K &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sum</span>(RocTable[<span class="dv">1</span>,]), <span class="kw">sum</span>(RocTable[<span class="dv">2</span>,]))</span>
<span id="cb5-4"><a href="sourcesVariability.html#cb5-4"></a>  </span>
<span id="cb5-5"><a href="sourcesVariability.html#cb5-5"></a>  <span class="cf">if</span> (parametricFOM) {</span>
<span id="cb5-6"><a href="sourcesVariability.html#cb5-6"></a>    ret &lt;-<span class="st"> </span><span class="kw">RocfitR</span>(RocTable)                 </span>
<span id="cb5-7"><a href="sourcesVariability.html#cb5-7"></a>  } <span class="cf">else</span> {</span>
<span id="cb5-8"><a href="sourcesVariability.html#cb5-8"></a>    ret &lt;-<span class="st"> </span><span class="kw">WilcoxonCountsTable</span>(RocTable) </span>
<span id="cb5-9"><a href="sourcesVariability.html#cb5-9"></a>  }</span>
<span id="cb5-10"><a href="sourcesVariability.html#cb5-10"></a>  OrigAUC  &lt;-<span class="st"> </span>ret<span class="op">$</span>AUC</span>
<span id="cb5-11"><a href="sourcesVariability.html#cb5-11"></a>  </span>
<span id="cb5-12"><a href="sourcesVariability.html#cb5-12"></a>  <span class="co"># ready to bootstrap</span></span>
<span id="cb5-13"><a href="sourcesVariability.html#cb5-13"></a>  <span class="co"># first put the counts data into a linear array</span></span>
<span id="cb5-14"><a href="sourcesVariability.html#cb5-14"></a>  <span class="co"># convert counts table to array</span></span>
<span id="cb5-15"><a href="sourcesVariability.html#cb5-15"></a>  z1  &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(RocTable[<span class="dv">1</span>,]),</span>
<span id="cb5-16"><a href="sourcesVariability.html#cb5-16"></a>             RocTable[<span class="dv">1</span>,])</span>
<span id="cb5-17"><a href="sourcesVariability.html#cb5-17"></a>  z2  &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(RocTable[<span class="dv">2</span>,]),</span>
<span id="cb5-18"><a href="sourcesVariability.html#cb5-18"></a>             RocTable[<span class="dv">2</span>,])<span class="co">#do:</span></span>
<span id="cb5-19"><a href="sourcesVariability.html#cb5-19"></a>  AUC &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> B)<span class="co">#to save the bs AUC values</span></span>
<span id="cb5-20"><a href="sourcesVariability.html#cb5-20"></a>  <span class="cf">for</span> ( b <span class="cf">in</span> <span class="dv">1</span> <span class="op">:</span><span class="st"> </span>B){</span>
<span id="cb5-21"><a href="sourcesVariability.html#cb5-21"></a>    <span class="cf">while</span> (<span class="dv">1</span>) {</span>
<span id="cb5-22"><a href="sourcesVariability.html#cb5-22"></a>      RocTable_bs  &lt;-<span class="st"> </span></span>
<span id="cb5-23"><a href="sourcesVariability.html#cb5-23"></a><span class="st">        </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="kw">length</span>(RocTable[<span class="dv">1</span>,])))</span>
<span id="cb5-24"><a href="sourcesVariability.html#cb5-24"></a>      <span class="co"># bs indices for non-diseased    </span></span>
<span id="cb5-25"><a href="sourcesVariability.html#cb5-25"></a>      k1_b &lt;-<span class="st"> </span><span class="kw">ceiling</span>( <span class="kw">runif</span>( K[ <span class="dv">1</span> ] ) <span class="op">*</span><span class="st"> </span>K[ <span class="dv">1</span> ] )</span>
<span id="cb5-26"><a href="sourcesVariability.html#cb5-26"></a>      <span class="co"># bs indices for diseased</span></span>
<span id="cb5-27"><a href="sourcesVariability.html#cb5-27"></a>      k2_b &lt;-<span class="st"> </span><span class="kw">ceiling</span>( <span class="kw">runif</span>( K[ <span class="dv">2</span> ] ) <span class="op">*</span><span class="st"> </span>K[ <span class="dv">2</span> ] )</span>
<span id="cb5-28"><a href="sourcesVariability.html#cb5-28"></a>      bsTable &lt;-<span class="st"> </span><span class="kw">table</span>(z1[k1_b])</span>
<span id="cb5-29"><a href="sourcesVariability.html#cb5-29"></a>      <span class="co">#convert array to frequency table</span></span>
<span id="cb5-30"><a href="sourcesVariability.html#cb5-30"></a>      RocTable_bs[<span class="dv">1</span>,<span class="kw">as.numeric</span>(<span class="kw">names</span>(bsTable))] &lt;-<span class="st"> </span></span>
<span id="cb5-31"><a href="sourcesVariability.html#cb5-31"></a><span class="st">        </span>bsTable</span>
<span id="cb5-32"><a href="sourcesVariability.html#cb5-32"></a>      bsTable &lt;-<span class="st"> </span><span class="kw">table</span>(z2[k2_b])</span>
<span id="cb5-33"><a href="sourcesVariability.html#cb5-33"></a>      <span class="co">#do:</span></span>
<span id="cb5-34"><a href="sourcesVariability.html#cb5-34"></a>      RocTable_bs[<span class="dv">2</span>,<span class="kw">as.numeric</span>(<span class="kw">names</span>(bsTable))] &lt;-<span class="st"> </span></span>
<span id="cb5-35"><a href="sourcesVariability.html#cb5-35"></a><span class="st">        </span>bsTable</span>
<span id="cb5-36"><a href="sourcesVariability.html#cb5-36"></a>      <span class="co">#replace NAs with zeroes</span></span>
<span id="cb5-37"><a href="sourcesVariability.html#cb5-37"></a>      RocTable_bs[<span class="kw">is.na</span>(RocTable_bs )] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb5-38"><a href="sourcesVariability.html#cb5-38"></a>      <span class="cf">if</span> (parametricFOM) {</span>
<span id="cb5-39"><a href="sourcesVariability.html#cb5-39"></a>        temp &lt;-<span class="st"> </span><span class="kw">RocfitR</span>(RocTable_bs)</span>
<span id="cb5-40"><a href="sourcesVariability.html#cb5-40"></a>      } <span class="cf">else</span> {</span>
<span id="cb5-41"><a href="sourcesVariability.html#cb5-41"></a>        temp &lt;-<span class="st"> </span><span class="kw">WilcoxonCountsTable</span>(RocTable_bs) </span>
<span id="cb5-42"><a href="sourcesVariability.html#cb5-42"></a>      }    </span>
<span id="cb5-43"><a href="sourcesVariability.html#cb5-43"></a>      AUC[b]  &lt;-<span class="st"> </span>temp<span class="op">$</span>AUC</span>
<span id="cb5-44"><a href="sourcesVariability.html#cb5-44"></a>      <span class="co"># a return of -1 means AUC did not converge</span></span>
<span id="cb5-45"><a href="sourcesVariability.html#cb5-45"></a>      <span class="cf">if</span> (AUC[b] <span class="op">!=</span><span class="st"> </span><span class="dv">-1</span>) <span class="cf">break</span></span>
<span id="cb5-46"><a href="sourcesVariability.html#cb5-46"></a>    }</span>
<span id="cb5-47"><a href="sourcesVariability.html#cb5-47"></a>  }</span>
<span id="cb5-48"><a href="sourcesVariability.html#cb5-48"></a>  meanAUCboot &lt;-<span class="st"> </span><span class="kw">mean</span>(AUC)</span>
<span id="cb5-49"><a href="sourcesVariability.html#cb5-49"></a>  Var &lt;-<span class="st"> </span><span class="kw">var</span>(AUC)</span>
<span id="cb5-50"><a href="sourcesVariability.html#cb5-50"></a>  stdAUCboot  &lt;-<span class="st"> </span><span class="kw">sqrt</span>(Var)</span>
<span id="cb5-51"><a href="sourcesVariability.html#cb5-51"></a>  <span class="kw">return</span>(<span class="kw">list</span>(</span>
<span id="cb5-52"><a href="sourcesVariability.html#cb5-52"></a>    <span class="dt">OrigAUC =</span> OrigAUC,</span>
<span id="cb5-53"><a href="sourcesVariability.html#cb5-53"></a>    <span class="dt">meanAUCboot =</span> meanAUCboot,</span>
<span id="cb5-54"><a href="sourcesVariability.html#cb5-54"></a>    <span class="dt">stdAUCboot =</span> stdAUCboot</span>
<span id="cb5-55"><a href="sourcesVariability.html#cb5-55"></a>  ))</span>
<span id="cb5-56"><a href="sourcesVariability.html#cb5-56"></a>}</span></code></pre></div>
<p>Since the bootstrap method is applicable to any scalar figure of merit, two options are provided in the code. If <code>parametricFOM</code> is set to <code>TRUE</code>, then the binormal model estimate is used, and if set to <code>FALSE</code>, the empirical AUC is used. The first set of results are obtained with <code>parametricFOM</code> set to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="sourcesVariability.html#cb6-1"></a>parametricFOM &lt;-<span class="st"> </span><span class="ot">TRUE</span></span>
<span id="cb6-2"><a href="sourcesVariability.html#cb6-2"></a>B &lt;-<span class="st"> </span><span class="dv">200</span>;seed &lt;-<span class="st"> </span><span class="dv">1</span>;<span class="kw">set.seed</span>(seed)</span>
<span id="cb6-3"><a href="sourcesVariability.html#cb6-3"></a>RocTable =<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>))</span>
<span id="cb6-4"><a href="sourcesVariability.html#cb6-4"></a>RocTable[<span class="dv">1</span>,]  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">19</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb6-5"><a href="sourcesVariability.html#cb6-5"></a>RocTable[<span class="dv">2</span>,]  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">12</span>,<span class="dv">22</span>)</span>
<span id="cb6-6"><a href="sourcesVariability.html#cb6-6"></a></span>
<span id="cb6-7"><a href="sourcesVariability.html#cb6-7"></a>ret &lt;-<span class="st"> </span><span class="kw">doBootstrap</span>(parametricFOM, B, seed, RocTable)</span>
<span id="cb6-8"><a href="sourcesVariability.html#cb6-8"></a>OrigAUC &lt;-<span class="st"> </span>ret<span class="op">$</span>OrigAUC</span>
<span id="cb6-9"><a href="sourcesVariability.html#cb6-9"></a>meanAUCboot &lt;-<span class="st"> </span>ret<span class="op">$</span>meanAUCboot</span>
<span id="cb6-10"><a href="sourcesVariability.html#cb6-10"></a>stdAUCboot &lt;-<span class="st"> </span>ret<span class="op">$</span>stdAUCboot</span>
<span id="cb6-11"><a href="sourcesVariability.html#cb6-11"></a></span>
<span id="cb6-12"><a href="sourcesVariability.html#cb6-12"></a><span class="kw">cat</span>(<span class="st">&quot;Bootstrap variance estimation:&quot;</span>,</span>
<span id="cb6-13"><a href="sourcesVariability.html#cb6-13"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">parametricFOM = &quot;</span>, parametricFOM,</span>
<span id="cb6-14"><a href="sourcesVariability.html#cb6-14"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">seed = &quot;</span>, seed, </span>
<span id="cb6-15"><a href="sourcesVariability.html#cb6-15"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">B = &quot;</span>, B,</span>
<span id="cb6-16"><a href="sourcesVariability.html#cb6-16"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">OrigAUC = &quot;</span>, OrigAUC, </span>
<span id="cb6-17"><a href="sourcesVariability.html#cb6-17"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">meanAUCboot = &quot;</span>, meanAUCboot, </span>
<span id="cb6-18"><a href="sourcesVariability.html#cb6-18"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">stdAUCboot = &quot;</span>, stdAUCboot, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb6-19"><a href="sourcesVariability.html#cb6-19"></a><span class="co">#&gt; Bootstrap variance estimation: </span></span>
<span id="cb6-20"><a href="sourcesVariability.html#cb6-20"></a><span class="co">#&gt; parametricFOM =  TRUE </span></span>
<span id="cb6-21"><a href="sourcesVariability.html#cb6-21"></a><span class="co">#&gt; seed =  1 </span></span>
<span id="cb6-22"><a href="sourcesVariability.html#cb6-22"></a><span class="co">#&gt; B =  200 </span></span>
<span id="cb6-23"><a href="sourcesVariability.html#cb6-23"></a><span class="co">#&gt; OrigAUC =  0.8704519 </span></span>
<span id="cb6-24"><a href="sourcesVariability.html#cb6-24"></a><span class="co">#&gt; meanAUCboot =  0.8671713 </span></span>
<span id="cb6-25"><a href="sourcesVariability.html#cb6-25"></a><span class="co">#&gt; stdAUCboot =  0.04380523</span></span></code></pre></div>
<p>This shows that the AUC of the original data (i.e., before performing any bootstrapping) is 0.870, the mean AUC of the B = 200 bootstrapped datasets is 0.867, and the standard deviation of the 200 bootstraps is 0.0438. If one runs the website calculator referenced in the previous chapter on the dataset shown in Table <a href="#tab:ratingsParadigmExampleTable"><strong>??</strong></a>, one finds that the MLE of the standard deviation of the AUC of the fitted ROC curve is 0.0378. The standard deviation is itself a statistic and there is sampling variability associated with it, i.e., there exists such a beast as a standard deviation of a standard deviation; the bootstrap estimate is not too far from the MLE estimate. By setting <code>seed</code> to different values, one gets an idea of the variability of the estimate of the standard deviation of AUC. For example, with <code>seed</code> = 2, one gets:</p>
<pre><code>#&gt; Bootstrap variance estimation: 
#&gt; parametricFOM =  TRUE 
#&gt; seed =  2 
#&gt; B =  200 
#&gt; OrigAUC =  0.8704519 
#&gt; meanAUCboot =  0.8673155 
#&gt; stdAUCboot =  0.03815402</code></pre>
<p>Note that both the mean of the bootstrap samples and the standard deviation have changed, but both are close to the MLE values. Examined next is the dependence of the estimates on <code>B</code>, the number of bootstraps. With <code>seed</code> = 1 and <code>B</code> = 2000 one gets:</p>
<pre><code>#&gt; Bootstrap variance estimation: 
#&gt; parametricFOM =  TRUE 
#&gt; seed =  1 
#&gt; B =  2000 
#&gt; OrigAUC =  0.8704519 
#&gt; meanAUCboot =  0.8674622 
#&gt; stdAUCboot =  0.03833508</code></pre>
<p>The estimates are evidently rather insensitive to <span class="math inline">\(B\)</span>, but the computation time was longer, ~13 seconds (running MLE 2000 times in 13 seconds is not bad!). It is always a good idea to test the stability of the results to different <span class="math inline">\(B\)</span> and <code>seed</code> values. Unlike the DeLong et al method, which is restricted to the Wilcoxon statistic (which equals empirical AUC as per the Bamber theorem), the bootstrap is broadly applicable to other figures of merit, including non-ROC paradigm figures of merit. However, beware that it depends on the assumption that the sample itself is representative of the population. With limited numbers of cases, this could be a bad assumption. [With small numbers of cases it is relatively easy to enumerate the different outcomes of the sampling process and, more importantly, their respective probabilities, leading to what is termed the <em>exact bootstrap</em>. It is “exact” in the sense that there is no seed variable or number of bootstrap dependence.]</p>
<p>Finally, here is the output when using non-parametric AUC, with <code>seed</code> = 1.</p>
<pre><code>#&gt; Bootstrap variance estimation: 
#&gt; parametricFOM =  FALSE 
#&gt; seed =  1 
#&gt; B =  200 
#&gt; OrigAUC =  0.8606667 
#&gt; meanAUCboot =  0.8604575 
#&gt; stdAUCboot =  0.04125475</code></pre>
</div>
</div>
<div id="sourcesVariabilityJackknife" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Jackknife method</h2>
<p>The second resampling method, termed the <em>jackknife</em>, is computationally less demanding, but as was seen with the bootstrap, with modern personal computers computational limitations are no longer that important, at least for the types of analyses that this book is concerned with.</p>
<p>In this method, the first case is removed, or jackknifed, from the set of cases and the MLE (or empirical estimation) is conducted on the resulting dataset, which has one less case. Let us denote by <span class="math inline">\(AUC_{(1)}\)</span> the resulting value of AUC. The parentheses around the subscript <span class="math inline">\(1\)</span> are meant to emphasize that the AUC value corresponds to that with the first case <em>removed</em> from the original dataset. Next, the first case is replaced, and now the second case is removed, the new dataset is analyzed yielding <span class="math inline">\(AUC_{(2)}\)</span>, and so on, yielding <span class="math inline">\(K\)</span> (<span class="math inline">\(K\)</span> is the total number of cases; <span class="math inline">\(K=K_1+K_2\)</span>) <em>jackknife AUC values</em>:</p>
<p><span class="math display" id="eq:sourcesVariabilityAUC-jackknife-fom">\[\begin{equation} 
AUC_{(k)} \qquad k=1,2,...,K
\tag{7.6}
\end{equation}\]</span></p>
<p>The corresponding jackknife pseudovalues <span class="math inline">\(Y_k\)</span> are defined by:</p>
<p><span class="math display" id="eq:sourcesVariability-pseudovalues-Y">\[\begin{equation} 
Y_k = K\times AUC - \left ( K-1 \right ) \times AUC_{(k)}
\tag{7.7}
\end{equation}\]</span></p>
<p>Here AUC denotes the estimate using the entire dataset, i.e., not removing any cases. The jackknife pseudovalues will turn out to be of central importance in TBA Chapter 09. The <em>jackknife AUC values</em>, defined by Eqn. <a href="sourcesVariability.html#eq:sourcesVariabilityAUC-jackknife-fom">(7.6)</a>, should not be confused with jackknife derived psuedovalues, defined by Eqn. <a href="sourcesVariability.html#eq:sourcesVariability-pseudovalues-Y">(7.7)</a>.</p>
<p>The jackknife estimate of the variance is defined by <span class="citation">(Efron and Tibshirani <a href="#ref-RN2261" role="doc-biblioref">1993</a>)</span>:</p>
<p><span class="math display" id="eq:sourcesVariability-jackknife-variance-definition">\[\begin{equation} 
\text{Var}_{\text{jack}} = \frac{\left ( K-1 \right )^2}{K} \frac{1}{K-1} \sum_{k=1}^{K} \left ( AUC_{(k)} - AUC_{(\bullet)} \right )^2
\tag{7.8}
\end{equation}\]</span></p>
<p>Since variance of <span class="math inline">\(K\)</span> scalars is defined by:</p>
<p><span class="math display" id="eq:sourcesVariability-variance-definition">\[\begin{equation} 
\text{Var}\left ( x \right ) = \frac{1}{K-1} \sum_{k=1}^{K} \left ( x_{k} - x_{\bullet} \right )^2
\tag{7.9}
\end{equation}\]</span></p>
<p>It follows that:</p>
<p><span class="math display" id="eq:sourcesVariability-jackknife-variance-ordinary-variance">\[\begin{equation} 
\text{Var}_{\text{jack}} \left ( \text{AUC} \right ) = \frac{\left ( K-1 \right )^2}{K} \text{Var} \left ( \text{AUC} \right )
\tag{7.10}
\end{equation}\]</span></p>
<p>In Eqn. <a href="sourcesVariability.html#eq:sourcesVariability-jackknife-variance-definition">(7.8)</a> I have deliberately not simplified the right hand side by canceling out <span class="math inline">\(K-1\)</span>. The purpose is to show, Eqn. <a href="sourcesVariability.html#eq:sourcesVariability-jackknife-variance-ordinary-variance">(7.10)</a>, that the usual expression for the variance (of the jackknife FOM values) needs to be multiplied by a <strong>variance inflation factor</strong> <span class="math inline">\(\frac{\left ( K-1 \right )^2}{K}\)</span>, which is approximately equal to <span class="math inline">\(K\)</span>, in order to obtain the correct jackknife estimate of variance of AUC. This factor was not necessary when one used the bootstrap method. That is because the bootstrap samples are more representative of the actual spread in the data. The jackknife samples are more restricted than the bootstrap samples, so the spread of the data is smaller; hence the need for the variance inflation factor <span class="citation">(Efron and Tibshirani <a href="#ref-RN2261" role="doc-biblioref">1993</a>)</span>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="sourcesVariability.html#cb10-1"></a>doJackknife &lt;-<span class="st"> </span><span class="cf">function</span>(parametricFOM, RocTable) {</span>
<span id="cb10-2"><a href="sourcesVariability.html#cb10-2"></a>  <span class="co"># this is the K vector </span></span>
<span id="cb10-3"><a href="sourcesVariability.html#cb10-3"></a>  K &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sum</span>(RocTable[<span class="dv">1</span>,]), <span class="kw">sum</span>(RocTable[<span class="dv">2</span>,]))</span>
<span id="cb10-4"><a href="sourcesVariability.html#cb10-4"></a>  </span>
<span id="cb10-5"><a href="sourcesVariability.html#cb10-5"></a>  <span class="cf">if</span> (parametricFOM) {</span>
<span id="cb10-6"><a href="sourcesVariability.html#cb10-6"></a>    ret &lt;-<span class="st"> </span><span class="kw">RocfitR</span>(RocTable)                 </span>
<span id="cb10-7"><a href="sourcesVariability.html#cb10-7"></a>  } <span class="cf">else</span> {</span>
<span id="cb10-8"><a href="sourcesVariability.html#cb10-8"></a>    ret &lt;-<span class="st"> </span><span class="kw">WilcoxonCountsTable</span>(RocTable) </span>
<span id="cb10-9"><a href="sourcesVariability.html#cb10-9"></a>  }</span>
<span id="cb10-10"><a href="sourcesVariability.html#cb10-10"></a>  OrigAUC  &lt;-<span class="st"> </span>ret<span class="op">$</span>AUC</span>
<span id="cb10-11"><a href="sourcesVariability.html#cb10-11"></a>  </span>
<span id="cb10-12"><a href="sourcesVariability.html#cb10-12"></a>  <span class="co"># first put the counts data into a linear array</span></span>
<span id="cb10-13"><a href="sourcesVariability.html#cb10-13"></a>  z1  &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(RocTable[<span class="dv">1</span>,]),</span>
<span id="cb10-14"><a href="sourcesVariability.html#cb10-14"></a>             RocTable[<span class="dv">1</span>,])</span>
<span id="cb10-15"><a href="sourcesVariability.html#cb10-15"></a>  z2  &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(RocTable[<span class="dv">1</span>,]),</span>
<span id="cb10-16"><a href="sourcesVariability.html#cb10-16"></a>             RocTable[<span class="dv">2</span>,])</span>
<span id="cb10-17"><a href="sourcesVariability.html#cb10-17"></a>  </span>
<span id="cb10-18"><a href="sourcesVariability.html#cb10-18"></a>  AUC_jack  &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">sum</span>(K))</span>
<span id="cb10-19"><a href="sourcesVariability.html#cb10-19"></a>  Y_k &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">sum</span>(K))</span>
<span id="cb10-20"><a href="sourcesVariability.html#cb10-20"></a>  z_jk  &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">sum</span>(K))</span>
<span id="cb10-21"><a href="sourcesVariability.html#cb10-21"></a>  <span class="co"># ready to jackknife</span></span>
<span id="cb10-22"><a href="sourcesVariability.html#cb10-22"></a>  <span class="cf">for</span> ( k <span class="cf">in</span> <span class="dv">1</span> <span class="op">:</span><span class="st"> </span><span class="kw">sum</span>(K)){</span>
<span id="cb10-23"><a href="sourcesVariability.html#cb10-23"></a>    RocTable_jk  &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="kw">length</span>(RocTable[<span class="dv">1</span>,])))</span>
<span id="cb10-24"><a href="sourcesVariability.html#cb10-24"></a>    <span class="cf">if</span> ( k <span class="op">&lt;=</span><span class="st"> </span>K[ <span class="dv">1</span> ]){</span>
<span id="cb10-25"><a href="sourcesVariability.html#cb10-25"></a>      z1_jk &lt;-<span class="st"> </span>z1[ <span class="op">-</span>k ]</span>
<span id="cb10-26"><a href="sourcesVariability.html#cb10-26"></a>      z2_jk &lt;-<span class="st"> </span>z2</span>
<span id="cb10-27"><a href="sourcesVariability.html#cb10-27"></a>    }<span class="cf">else</span>{</span>
<span id="cb10-28"><a href="sourcesVariability.html#cb10-28"></a>      z1_jk &lt;-<span class="st"> </span>z1</span>
<span id="cb10-29"><a href="sourcesVariability.html#cb10-29"></a>      z2_jk &lt;-<span class="st"> </span>z2[ <span class="op">-</span>(k <span class="op">-</span><span class="st"> </span>K[ <span class="dv">1</span> ]) ] </span>
<span id="cb10-30"><a href="sourcesVariability.html#cb10-30"></a>    }  </span>
<span id="cb10-31"><a href="sourcesVariability.html#cb10-31"></a>    <span class="co">#convert array to frequency table</span></span>
<span id="cb10-32"><a href="sourcesVariability.html#cb10-32"></a>    RocTable_jk[<span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">table</span>(z1_jk))]  &lt;-<span class="st"> </span></span>
<span id="cb10-33"><a href="sourcesVariability.html#cb10-33"></a><span class="st">      </span><span class="kw">table</span>(z1_jk)</span>
<span id="cb10-34"><a href="sourcesVariability.html#cb10-34"></a>    RocTable_jk[<span class="dv">2</span>,<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(<span class="kw">table</span>(z2_jk))]  &lt;-<span class="st"> </span></span>
<span id="cb10-35"><a href="sourcesVariability.html#cb10-35"></a><span class="st">      </span><span class="kw">table</span>(z2_jk)</span>
<span id="cb10-36"><a href="sourcesVariability.html#cb10-36"></a>    <span class="co">#replace NAs with zeroes</span></span>
<span id="cb10-37"><a href="sourcesVariability.html#cb10-37"></a>    RocTable_jk[<span class="kw">is.na</span>(RocTable_jk)] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb10-38"><a href="sourcesVariability.html#cb10-38"></a>    <span class="co"># AUC_jack for observed data</span></span>
<span id="cb10-39"><a href="sourcesVariability.html#cb10-39"></a>    <span class="cf">if</span> (parametricFOM) {</span>
<span id="cb10-40"><a href="sourcesVariability.html#cb10-40"></a>      temp &lt;-<span class="st"> </span><span class="kw">RocfitR</span>(RocTable_jk) </span>
<span id="cb10-41"><a href="sourcesVariability.html#cb10-41"></a>    } <span class="cf">else</span> {</span>
<span id="cb10-42"><a href="sourcesVariability.html#cb10-42"></a>      temp &lt;-<span class="st"> </span><span class="kw">WilcoxonCountsTable</span>(RocTable_jk) </span>
<span id="cb10-43"><a href="sourcesVariability.html#cb10-43"></a>    }      </span>
<span id="cb10-44"><a href="sourcesVariability.html#cb10-44"></a>    AUC_jack[k]  &lt;-<span class="st"> </span>temp<span class="op">$</span>AUC</span>
<span id="cb10-45"><a href="sourcesVariability.html#cb10-45"></a>    Y_k[k] &lt;-<span class="st"> </span><span class="kw">sum</span>(K)<span class="op">*</span>OrigAUC <span class="op">-</span><span class="st"> </span>(<span class="kw">sum</span>(K)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>AUC_jack[k]</span>
<span id="cb10-46"><a href="sourcesVariability.html#cb10-46"></a>    <span class="cf">if</span> (AUC_jack[k] <span class="op">==</span><span class="st"> </span><span class="dv">-1</span>) </span>
<span id="cb10-47"><a href="sourcesVariability.html#cb10-47"></a>      <span class="kw">stop</span>(<span class="st">&quot;RocfitR did not converge in jackknife loop&quot;</span>) </span>
<span id="cb10-48"><a href="sourcesVariability.html#cb10-48"></a>  }</span>
<span id="cb10-49"><a href="sourcesVariability.html#cb10-49"></a>  meanAUCjack &lt;-<span class="st"> </span><span class="kw">mean</span>(AUC_jack)</span>
<span id="cb10-50"><a href="sourcesVariability.html#cb10-50"></a>  <span class="co">#Efron and Stein&#39;s paper, include jackknife inflation factor</span></span>
<span id="cb10-51"><a href="sourcesVariability.html#cb10-51"></a>  Var_jack &lt;-<span class="st"> </span><span class="kw">var</span>(AUC_jack) <span class="op">*</span><span class="st"> </span>( <span class="kw">sum</span>(K) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">^</span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(K) </span>
<span id="cb10-52"><a href="sourcesVariability.html#cb10-52"></a>  stdAUCjack  &lt;-<span class="st"> </span><span class="kw">sqrt</span>(Var_jack)</span>
<span id="cb10-53"><a href="sourcesVariability.html#cb10-53"></a>  <span class="kw">return</span>(<span class="kw">list</span>(</span>
<span id="cb10-54"><a href="sourcesVariability.html#cb10-54"></a>    <span class="dt">OrigAUC =</span> OrigAUC,</span>
<span id="cb10-55"><a href="sourcesVariability.html#cb10-55"></a>    <span class="dt">meanAUCjack =</span> meanAUCjack,</span>
<span id="cb10-56"><a href="sourcesVariability.html#cb10-56"></a>    <span class="dt">stdAUCjack =</span> stdAUCjack</span>
<span id="cb10-57"><a href="sourcesVariability.html#cb10-57"></a>  ))</span>
<span id="cb10-58"><a href="sourcesVariability.html#cb10-58"></a>}</span></code></pre></div>
<p>Since the jackknife method is applicable to any scalar figure of merit, two options are provided in the code. If <code>parametricFOM</code> is set to <code>TRUE</code>, then the binormal model estimate is used, and if set to <code>FALSE</code>, the empirical AUC is used. The first set of results are obtained with <code>parametricFOM</code> set to <code>TRUE</code>. Notice that the code does not use a <code>set.seed()</code> statement, as no random number generator is needed in the jackknife method. Systematically removing and replacing each case in sequence, one at a time, is not random sampling, which should further explain the need for the variance inflation factor in Eqn. <a href="sourcesVariability.html#eq:sourcesVariability-jackknife-variance-ordinary-variance">(7.10)</a>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="sourcesVariability.html#cb11-1"></a>parametricFOM &lt;-<span class="st"> </span><span class="ot">TRUE</span></span>
<span id="cb11-2"><a href="sourcesVariability.html#cb11-2"></a>RocTable =<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>))</span>
<span id="cb11-3"><a href="sourcesVariability.html#cb11-3"></a>RocTable[<span class="dv">1</span>,]  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">19</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb11-4"><a href="sourcesVariability.html#cb11-4"></a>RocTable[<span class="dv">2</span>,]  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">12</span>,<span class="dv">22</span>)</span>
<span id="cb11-5"><a href="sourcesVariability.html#cb11-5"></a></span>
<span id="cb11-6"><a href="sourcesVariability.html#cb11-6"></a>ret &lt;-<span class="st"> </span><span class="kw">doJackknife</span>(parametricFOM, RocTable)</span>
<span id="cb11-7"><a href="sourcesVariability.html#cb11-7"></a>OrigAUC &lt;-<span class="st"> </span>ret<span class="op">$</span>OrigAUC</span>
<span id="cb11-8"><a href="sourcesVariability.html#cb11-8"></a>meanAUCjack &lt;-<span class="st"> </span>ret<span class="op">$</span>meanAUCjack</span>
<span id="cb11-9"><a href="sourcesVariability.html#cb11-9"></a>stdAUCjack &lt;-<span class="st"> </span>ret<span class="op">$</span>stdAUCjack</span>
<span id="cb11-10"><a href="sourcesVariability.html#cb11-10"></a></span>
<span id="cb11-11"><a href="sourcesVariability.html#cb11-11"></a><span class="kw">cat</span>(<span class="st">&quot;Jackknife variance estimation:&quot;</span>,</span>
<span id="cb11-12"><a href="sourcesVariability.html#cb11-12"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">parametricFOM = &quot;</span>, parametricFOM,</span>
<span id="cb11-13"><a href="sourcesVariability.html#cb11-13"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">OrigAUC = &quot;</span>, OrigAUC, </span>
<span id="cb11-14"><a href="sourcesVariability.html#cb11-14"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">meanAUCjack = &quot;</span>, meanAUCjack, </span>
<span id="cb11-15"><a href="sourcesVariability.html#cb11-15"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">stdAUCjack = &quot;</span>, stdAUCjack, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb11-16"><a href="sourcesVariability.html#cb11-16"></a><span class="co">#&gt; Jackknife variance estimation: </span></span>
<span id="cb11-17"><a href="sourcesVariability.html#cb11-17"></a><span class="co">#&gt; parametricFOM =  TRUE </span></span>
<span id="cb11-18"><a href="sourcesVariability.html#cb11-18"></a><span class="co">#&gt; OrigAUC =  0.8704519 </span></span>
<span id="cb11-19"><a href="sourcesVariability.html#cb11-19"></a><span class="co">#&gt; meanAUCjack =  0.8704304 </span></span>
<span id="cb11-20"><a href="sourcesVariability.html#cb11-20"></a><span class="co">#&gt; stdAUCjack =  0.03861591</span></span></code></pre></div>
<p>The next output is with the non-parametric figure of merit:</p>
<pre><code>#&gt; Jackknife variance estimation: 
#&gt; parametricFOM =  FALSE 
#&gt; OrigAUC =  0.8606667 
#&gt; meanAUCjack =  0.8606667 
#&gt; stdAUCjack =  0.03689264</code></pre>
<p>It may be noticed that the mean of the jackknife figure of merit values, i.e., 0.8606667, exactly equals the original figure of merit 0.8606667 (i.e., that calculated including all cases). This can be shown analytically to be true so long as the figure of merit is the empirical AUC. A similar relation is not true for the bootstrap.</p>
</div>
<div id="sourcesVariabilityCalSimulator" class="section level2" number="7.7">
<h2><span class="header-section-number">7.7</span> Calibrated simulator</h2>
<p>In real life one does have the luxury of sampling from the population of cases, but with a simulator almost anything is possible. The population sampling method used previously, <a href="sourcesVariability.html#sourcesVariabilityDeLong">7.4</a>, to compare the DeLong method to a known standard used arbitrarily set simulator values, <span class="math inline">\(\mu = 1.5\)</span> and <span class="math inline">\(\sigma = 1.3\)</span> . One does not know if these values are actually representative of real clinical data. In this section a simple method of implementing population sampling using a calibrated simulator is described. A calibrated simulator is one whose parameters are chosen to match those of an actual clinical dataset, so the simulator is calibrated to the specific one-and-only-one dataset. Why might one wish to do that? Rather than “fish in the dark” and set arbitrary values for the simulator parameters, one needs to find realistic values that match an actual clinical dataset. This way one has at least some assurance that the simulator is realistic and therefore its verdict on a proposed method or analysis is more likely to be correct.</p>
<p>As an example, consider a real clinical dataset, such as in Table <a href="#tab:ratingsParadigmExampleTable"><strong>??</strong></a>. This data set analyzed by MLE yielded model parameters, <code>a</code>, <code>b</code> and the 4 thresholds <span class="math inline">\(\zeta_1,\zeta_2,\zeta_3,\zeta_4\)</span>. After conversion to <span class="math inline">\(\mu=a/b\)</span> and <span class="math inline">\(\sigma= 1/b\)</span> and new zetas <span class="math inline">\(\zeta = \zeta/b\)</span>, the values are (in the same order): 2.173597, 1.646099, 0.01263423, 1.475351, 2.494901, 3.945221 (see code output below).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="sourcesVariability.html#cb13-1"></a><span class="co"># x is the mu-sigma notation</span></span>
<span id="cb13-2"><a href="sourcesVariability.html#cb13-2"></a>x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">2.173597</span>, <span class="fl">1.646099</span>, <span class="fl">0.01263423</span>, <span class="fl">1.475351</span>, <span class="fl">2.494901</span>, <span class="fl">3.945221</span>)</span>
<span id="cb13-3"><a href="sourcesVariability.html#cb13-3"></a><span class="co"># y is the a-b notation</span></span>
<span id="cb13-4"><a href="sourcesVariability.html#cb13-4"></a>y &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.320453</span>, <span class="fl">0.607497</span>, <span class="fl">0.007675259</span>, <span class="fl">0.8962713</span>, <span class="fl">1.515645</span>, <span class="fl">2.39671</span>)</span>
<span id="cb13-5"><a href="sourcesVariability.html#cb13-5"></a>y[<span class="dv">1</span>]<span class="op">/</span>y[<span class="dv">2</span>] <span class="co"># this is mu</span></span>
<span id="cb13-6"><a href="sourcesVariability.html#cb13-6"></a><span class="co">#&gt; [1] 2.173596</span></span>
<span id="cb13-7"><a href="sourcesVariability.html#cb13-7"></a><span class="dv">1</span><span class="op">/</span>y[<span class="dv">2</span>]    <span class="co"># this is sigma</span></span>
<span id="cb13-8"><a href="sourcesVariability.html#cb13-8"></a><span class="co">#&gt; [1] 1.646099</span></span>
<span id="cb13-9"><a href="sourcesVariability.html#cb13-9"></a>y[<span class="dv">3</span><span class="op">:</span><span class="dv">6</span>]<span class="op">/</span>y[<span class="dv">2</span>] <span class="co"># this is zeta in mu-sigma notation</span></span>
<span id="cb13-10"><a href="sourcesVariability.html#cb13-10"></a><span class="co">#&gt; [1] 0.01263423 1.47535099 2.49490121 3.94522113</span></span></code></pre></div>
<p>On each pass through the simulator one samples 60 values from the non-diseased distribution and 50 values from the diseased distribution, which producers a simulated ROC counts table like Table <a href="#tab:ratingsParadigmExampleTable"><strong>??</strong></a>. MLE on the ROC counts table yields <span class="math inline">\(A_z\)</span>. The process is repeated <span class="math inline">\(P = 2000\)</span> (<span class="math inline">\(p\)</span> is the population sampling index, ranging from 1 to <span class="math inline">\(P\)</span>) and finally one calculates the mean and standard deviation of the 2000 <span class="math inline">\(A_z\)</span> values. Open the file mainCalSimulator.R, Online Appendix 7.C, confirm that FOM is set to “Az” at line 11 (i.e., it is not commented out) and source it. There is no <code>seed</code> dependence of the code (the physical book is incorrect on this point):</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="sourcesVariability.html#cb14-1"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH07-Variability/SimulateRocCountsTable.R&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="sourcesVariability.html#cb15-1"></a>doCalSimulator &lt;-<span class="st"> </span><span class="cf">function</span>(P, parametricFOM, RocCountsTable) {</span>
<span id="cb15-2"><a href="sourcesVariability.html#cb15-2"></a>  K &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sum</span>(RocCountsTable[<span class="dv">1</span>,]), </span>
<span id="cb15-3"><a href="sourcesVariability.html#cb15-3"></a>         <span class="kw">sum</span>(RocCountsTable[<span class="dv">2</span>,]))</span>
<span id="cb15-4"><a href="sourcesVariability.html#cb15-4"></a>  <span class="co"># to build the model we have to do a parametric fit first</span></span>
<span id="cb15-5"><a href="sourcesVariability.html#cb15-5"></a>  ret &lt;-<span class="st"> </span><span class="kw">RocfitR</span>(RocCountsTable) <span class="co"># AUC for observed data</span></span>
<span id="cb15-6"><a href="sourcesVariability.html#cb15-6"></a>  a &lt;-<span class="st"> </span>ret<span class="op">$</span>a</span>
<span id="cb15-7"><a href="sourcesVariability.html#cb15-7"></a>  b  &lt;-<span class="st"> </span>ret<span class="op">$</span>b</span>
<span id="cb15-8"><a href="sourcesVariability.html#cb15-8"></a>  zetas &lt;-<span class="st"> </span>ret<span class="op">$</span>zeta</span>
<span id="cb15-9"><a href="sourcesVariability.html#cb15-9"></a>  mu  &lt;-<span class="st"> </span>a<span class="op">/</span>b</span>
<span id="cb15-10"><a href="sourcesVariability.html#cb15-10"></a>  sigma &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>b</span>
<span id="cb15-11"><a href="sourcesVariability.html#cb15-11"></a>  zetas &lt;-<span class="st"> </span>zetas<span class="op">/</span>b <span class="co"># need to also scale zetas</span></span>
<span id="cb15-12"><a href="sourcesVariability.html#cb15-12"></a>   <span class="co"># AUC for observed data</span></span>
<span id="cb15-13"><a href="sourcesVariability.html#cb15-13"></a>  <span class="cf">if</span> (parametricFOM) {</span>
<span id="cb15-14"><a href="sourcesVariability.html#cb15-14"></a>    OrigAUC &lt;-<span class="st"> </span><span class="kw">RocfitR</span>(RocCountsTable)<span class="op">$</span>AUC                 </span>
<span id="cb15-15"><a href="sourcesVariability.html#cb15-15"></a>  } <span class="cf">else</span> {</span>
<span id="cb15-16"><a href="sourcesVariability.html#cb15-16"></a>    OrigAUC &lt;-<span class="st"> </span><span class="kw">WilcoxonCountsTable</span>(RocCountsTable)<span class="op">$</span>AUC </span>
<span id="cb15-17"><a href="sourcesVariability.html#cb15-17"></a>  }</span>
<span id="cb15-18"><a href="sourcesVariability.html#cb15-18"></a>  <span class="co">#to save the pop sample AUC values</span></span>
<span id="cb15-19"><a href="sourcesVariability.html#cb15-19"></a>  AUC &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> P)</span>
<span id="cb15-20"><a href="sourcesVariability.html#cb15-20"></a>  <span class="cf">for</span> ( p <span class="cf">in</span> <span class="dv">1</span> <span class="op">:</span><span class="st"> </span>P){</span>
<span id="cb15-21"><a href="sourcesVariability.html#cb15-21"></a>    <span class="cf">while</span> (<span class="dv">1</span>) {</span>
<span id="cb15-22"><a href="sourcesVariability.html#cb15-22"></a>      RocCountsTableSimPop &lt;-<span class="st"> </span></span>
<span id="cb15-23"><a href="sourcesVariability.html#cb15-23"></a><span class="st">        </span><span class="kw">SimulateRocCountsTable</span>(K, mu, sigma, zetas)</span>
<span id="cb15-24"><a href="sourcesVariability.html#cb15-24"></a>      <span class="co">#replace NAs with zeroes</span></span>
<span id="cb15-25"><a href="sourcesVariability.html#cb15-25"></a>      RocCountsTableSimPop[<span class="kw">is.na</span>(RocCountsTableSimPop )] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb15-26"><a href="sourcesVariability.html#cb15-26"></a>      <span class="cf">if</span> (parametricFOM) {</span>
<span id="cb15-27"><a href="sourcesVariability.html#cb15-27"></a>        <span class="co"># AUC for observed data </span></span>
<span id="cb15-28"><a href="sourcesVariability.html#cb15-28"></a>        temp &lt;-<span class="st"> </span><span class="kw">RocfitR</span>(RocCountsTableSimPop)</span>
<span id="cb15-29"><a href="sourcesVariability.html#cb15-29"></a>        <span class="co"># a return of -1 means RocFitR did not converge</span></span>
<span id="cb15-30"><a href="sourcesVariability.html#cb15-30"></a>        <span class="cf">if</span> (temp[<span class="dv">1</span>] <span class="op">!=</span><span class="st"> </span><span class="dv">-1</span>) {</span>
<span id="cb15-31"><a href="sourcesVariability.html#cb15-31"></a>          AUC[p]  &lt;-<span class="st"> </span>temp<span class="op">$</span>AUC</span>
<span id="cb15-32"><a href="sourcesVariability.html#cb15-32"></a>          <span class="cf">break</span> </span>
<span id="cb15-33"><a href="sourcesVariability.html#cb15-33"></a>        }</span>
<span id="cb15-34"><a href="sourcesVariability.html#cb15-34"></a>      } <span class="cf">else</span> {</span>
<span id="cb15-35"><a href="sourcesVariability.html#cb15-35"></a>        AUC[p] &lt;-<span class="st"> </span>(<span class="kw">WilcoxonCountsTable</span>(RocCountsTableSimPop))<span class="op">$</span>AUC</span>
<span id="cb15-36"><a href="sourcesVariability.html#cb15-36"></a>        <span class="cf">break</span> </span>
<span id="cb15-37"><a href="sourcesVariability.html#cb15-37"></a>      }    </span>
<span id="cb15-38"><a href="sourcesVariability.html#cb15-38"></a>    }</span>
<span id="cb15-39"><a href="sourcesVariability.html#cb15-39"></a>  }</span>
<span id="cb15-40"><a href="sourcesVariability.html#cb15-40"></a>  AUC &lt;-<span class="st"> </span>AUC[<span class="op">!</span><span class="kw">is.na</span>(AUC)]</span>
<span id="cb15-41"><a href="sourcesVariability.html#cb15-41"></a>  meanAUC  &lt;-<span class="st"> </span><span class="kw">mean</span>(AUC)</span>
<span id="cb15-42"><a href="sourcesVariability.html#cb15-42"></a>  stdAUC  &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">var</span>(AUC))</span>
<span id="cb15-43"><a href="sourcesVariability.html#cb15-43"></a>  <span class="kw">return</span>(<span class="kw">list</span>(</span>
<span id="cb15-44"><a href="sourcesVariability.html#cb15-44"></a>    <span class="dt">mu =</span> mu,</span>
<span id="cb15-45"><a href="sourcesVariability.html#cb15-45"></a>    <span class="dt">sigma =</span> sigma,</span>
<span id="cb15-46"><a href="sourcesVariability.html#cb15-46"></a>    <span class="dt">zetas =</span> zetas,</span>
<span id="cb15-47"><a href="sourcesVariability.html#cb15-47"></a>    <span class="dt">OrigAUC =</span> OrigAUC,</span>
<span id="cb15-48"><a href="sourcesVariability.html#cb15-48"></a>    <span class="dt">meanAUC =</span> meanAUC,</span>
<span id="cb15-49"><a href="sourcesVariability.html#cb15-49"></a>    <span class="dt">stdAUC =</span> stdAUC</span>
<span id="cb15-50"><a href="sourcesVariability.html#cb15-50"></a>  ))</span>
<span id="cb15-51"><a href="sourcesVariability.html#cb15-51"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="sourcesVariability.html#cb16-1"></a>parametricFOM &lt;-<span class="st"> </span><span class="ot">TRUE</span></span>
<span id="cb16-2"><a href="sourcesVariability.html#cb16-2"></a>P &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb16-3"><a href="sourcesVariability.html#cb16-3"></a>RocCountsTable =<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">5</span>))</span>
<span id="cb16-4"><a href="sourcesVariability.html#cb16-4"></a>RocCountsTable[<span class="dv">1</span>,]  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">30</span>,<span class="dv">19</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span>
<span id="cb16-5"><a href="sourcesVariability.html#cb16-5"></a>RocCountsTable[<span class="dv">2</span>,]  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">5</span>,<span class="dv">12</span>,<span class="dv">22</span>)</span>
<span id="cb16-6"><a href="sourcesVariability.html#cb16-6"></a>ret &lt;-<span class="st"> </span><span class="kw">doCalSimulator</span>(P, parametricFOM, RocCountsTable)</span>
<span id="cb16-7"><a href="sourcesVariability.html#cb16-7"></a><span class="kw">cat</span>(<span class="st">&quot;parametricFOM = &quot;</span>, parametricFOM,</span>
<span id="cb16-8"><a href="sourcesVariability.html#cb16-8"></a>  <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Calibrated simulator values:</span><span class="ch">\n</span><span class="st">&quot;</span>, </span>
<span id="cb16-9"><a href="sourcesVariability.html#cb16-9"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">mu = &quot;</span>, ret<span class="op">$</span>mu, </span>
<span id="cb16-10"><a href="sourcesVariability.html#cb16-10"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">sigma = &quot;</span>, ret<span class="op">$</span>sigma, </span>
<span id="cb16-11"><a href="sourcesVariability.html#cb16-11"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">zetas = &quot;</span>, ret<span class="op">$</span>zetas, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb16-12"><a href="sourcesVariability.html#cb16-12"></a><span class="co">#&gt; parametricFOM =  TRUE </span></span>
<span id="cb16-13"><a href="sourcesVariability.html#cb16-13"></a><span class="co">#&gt; Calibrated simulator values:</span></span>
<span id="cb16-14"><a href="sourcesVariability.html#cb16-14"></a><span class="co">#&gt;  </span></span>
<span id="cb16-15"><a href="sourcesVariability.html#cb16-15"></a><span class="co">#&gt; mu =  2.173597 </span></span>
<span id="cb16-16"><a href="sourcesVariability.html#cb16-16"></a><span class="co">#&gt; sigma =  1.646099 </span></span>
<span id="cb16-17"><a href="sourcesVariability.html#cb16-17"></a><span class="co">#&gt; zetas =  0.01263423 1.475351 2.494901 3.945221</span></span>
<span id="cb16-18"><a href="sourcesVariability.html#cb16-18"></a></span>
<span id="cb16-19"><a href="sourcesVariability.html#cb16-19"></a><span class="kw">cat</span>(<span class="st">&quot;Simulations using calibrated simulator&quot;</span>,</span>
<span id="cb16-20"><a href="sourcesVariability.html#cb16-20"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">P = &quot;</span>, P, </span>
<span id="cb16-21"><a href="sourcesVariability.html#cb16-21"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">OrigAUC = &quot;</span>, ret<span class="op">$</span>OrigAUC, </span>
<span id="cb16-22"><a href="sourcesVariability.html#cb16-22"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">meanAUC = &quot;</span>, ret<span class="op">$</span>meanAUC, </span>
<span id="cb16-23"><a href="sourcesVariability.html#cb16-23"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">stdAUC = &quot;</span>, ret<span class="op">$</span>stdAUC, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb16-24"><a href="sourcesVariability.html#cb16-24"></a><span class="co">#&gt; Simulations using calibrated simulator </span></span>
<span id="cb16-25"><a href="sourcesVariability.html#cb16-25"></a><span class="co">#&gt; P =  2000 </span></span>
<span id="cb16-26"><a href="sourcesVariability.html#cb16-26"></a><span class="co">#&gt; OrigAUC =  0.8704519 </span></span>
<span id="cb16-27"><a href="sourcesVariability.html#cb16-27"></a><span class="co">#&gt; meanAUC =  0.8675359 </span></span>
<span id="cb16-28"><a href="sourcesVariability.html#cb16-28"></a><span class="co">#&gt; stdAUC =  0.04064876</span></span></code></pre></div>
<pre><code>#&gt; parametricFOM =  TRUE 
#&gt; Calibrated simulator values:
#&gt;  
#&gt; mu =  2.173597 
#&gt; sigma =  1.646099 
#&gt; zetas =  0.01263423 1.475351 2.494901 3.945221
#&gt; Simulations using calibrated simulator: 
#&gt; P =  2000 
#&gt; OrigAUC =  0.8704519 
#&gt; meanAUC =  0.867856 
#&gt; stdAUC =  0.04101963</code></pre>
<pre><code>#&gt; parametricFOM =  FALSE 
#&gt; Calibrated simulator values:
#&gt;  
#&gt; mu =  2.173597 
#&gt; sigma =  1.646099 
#&gt; zetas =  0.01263423 1.475351 2.494901 3.945221
#&gt; Simulations using calibrated simulator: 
#&gt; P =  2000 
#&gt; OrigAUC =  0.8606667 
#&gt; meanAUC =  0.8504027 
#&gt; stdAUC =  0.03773004</code></pre>
<pre><code>#&gt; parametricFOM =  FALSE 
#&gt; Calibrated simulator values:
#&gt;  
#&gt; mu =  2.173597 
#&gt; sigma =  1.646099 
#&gt; zetas =  0.01263423 1.475351 2.494901 3.945221
#&gt; Simulations using calibrated simulator: 
#&gt; P =  2000 
#&gt; OrigAUC =  0.8606667 
#&gt; meanAUC =  0.8509415 
#&gt; stdAUC =  0.01145896</code></pre>
<div id="tba" class="section level3" number="7.7.1">
<h3><span class="header-section-number">7.7.1</span> TBA</h3>
<p>The seed = 1 estimate of standard deviation of AUC (0.0403) is recorded in Table 7.3, row A, sub-row “Population”. The entry for sub-row “MLE” was obtained using the ROCFIT equivalent Eng’s JAVA program <span class="citation">(Eng <a href="#ref-RN2114" role="doc-biblioref">2006</a>)</span>, §6.2.6. The DeLong method entry for row A was obtained using mainDeLongSd.R with FOM set to " Wilcoxon“, as indicated by the asterisk; see §7.3.2. The bootstrap entry was obtained using mainBootstrapSd.R, and the jackknife entry was obtained using mainJackknifeSd.R; in both cases FOM was set to”Az". Note that the four estimates are close to each other, around 0.04. This confirms the validity of the different approaches to estimating the case sampling standard deviation, and is a self-consistency check on the calibration process.</p>
<p>Row B repeats the values in row A, except that this time the empirical AUC is being used as the figure of merit. The flexibility afforded by the calibrated simulator is that using it one can test various ideas. For example, what happens if the number of cases is increased? One expects the standard deviations in the last column of Table 7.3 to decrease, but by how much. Row B uses datasets generated by the simulator calibrated to the data in Table 7.3. Since the numbers of cases has not changed, the values are similar to those in row A. In row-C the number of cases has been inflated by a factor of 10, and the standard deviations decrease by about a factor of square root of 10. [Since rows B, C and D use empirical AUC, MLE estimates are inapplicable.]</p>
<p>Exercise: Use the calibrated simulator to test the effect of changing simulator parameters, particularly mu. As mu increases, the standard deviation is expected to decrease, because there is “less room” for AUC to vary, since it is constrained to be ≤1.</p>
<p>Table 7.3: Comparison of different estimates of the standard deviation of AUC, namely MLE, the DeLong method, bootstrap, jackknife and population sampling. MLE = maximum likelihood estimate; shown are results for a real dataset (A, B) and two simulated datasets (C and D) and two choices for estimating AUC: parametric and empirical. * The entry for the DeLong method was obtained using the empirical AUC. (P = 2000) (B = 2000)</p>
</div>
</div>
<div id="comparison-of-methods-of-estimating-variability" class="section level2" number="7.8">
<h2><span class="header-section-number">7.8</span> Comparison of methods of estimating variability</h2>
<p>TBA This section compares the four methods described above: MLE, population sampling, bootstrap, jackknife and the DeLong method.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="sourcesVariability.html#cb20-1"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH07-Variability/GenerateCaseSamples.R&quot;</span>))</span>
<span id="cb20-2"><a href="sourcesVariability.html#cb20-2"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH07-Variability/VarPopSampling.R&quot;</span>))</span>
<span id="cb20-3"><a href="sourcesVariability.html#cb20-3"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH07-Variability/VarBootstrap.R&quot;</span>))</span>
<span id="cb20-4"><a href="sourcesVariability.html#cb20-4"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH07-Variability/VarJack.R&quot;</span>))</span>
<span id="cb20-5"><a href="sourcesVariability.html#cb20-5"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH07-Variability/Wilcoxon.R&quot;</span>))</span>
<span id="cb20-6"><a href="sourcesVariability.html#cb20-6"></a><span class="kw">source</span>(<span class="kw">here</span>(<span class="st">&quot;R/CH07-Variability/VarDeLong.R&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="sourcesVariability.html#cb21-1"></a><span class="co"># this takes a long time to run and the results are not used below</span></span>
<span id="cb21-2"><a href="sourcesVariability.html#cb21-2"></a><span class="co"># the summary tables are hard-coded</span></span>
<span id="cb21-3"><a href="sourcesVariability.html#cb21-3"></a>FinalParameters &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.320455</span>, </span>
<span id="cb21-4"><a href="sourcesVariability.html#cb21-4"></a>                     <span class="fl">0.6074974</span>, </span>
<span id="cb21-5"><a href="sourcesVariability.html#cb21-5"></a>                     <span class="fl">0.007676989</span>, </span>
<span id="cb21-6"><a href="sourcesVariability.html#cb21-6"></a>                     <span class="fl">0.8962713</span>, </span>
<span id="cb21-7"><a href="sourcesVariability.html#cb21-7"></a>                     <span class="fl">1.515645</span>, </span>
<span id="cb21-8"><a href="sourcesVariability.html#cb21-8"></a>                     <span class="fl">2.396711</span>)</span>
<span id="cb21-9"><a href="sourcesVariability.html#cb21-9"></a>a  &lt;-<span class="st"> </span>FinalParameters[<span class="dv">1</span>]</span>
<span id="cb21-10"><a href="sourcesVariability.html#cb21-10"></a>b  &lt;-<span class="st">  </span>FinalParameters[<span class="dv">2</span>]</span>
<span id="cb21-11"><a href="sourcesVariability.html#cb21-11"></a>zetas &lt;-<span class="st"> </span>FinalParameters[<span class="dv">3</span><span class="op">:</span><span class="kw">length</span>((FinalParameters))]</span>
<span id="cb21-12"><a href="sourcesVariability.html#cb21-12"></a>mu &lt;-<span class="st"> </span>a<span class="op">/</span>b</span>
<span id="cb21-13"><a href="sourcesVariability.html#cb21-13"></a>sigma &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>b</span>
<span id="cb21-14"><a href="sourcesVariability.html#cb21-14"></a>K &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">60</span>, <span class="dv">50</span>)</span>
<span id="cb21-15"><a href="sourcesVariability.html#cb21-15"></a>seed &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb21-16"><a href="sourcesVariability.html#cb21-16"></a><span class="kw">cat</span>(<span class="st">&quot;seed = &quot;</span>, seed, </span>
<span id="cb21-17"><a href="sourcesVariability.html#cb21-17"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">K1 = &quot;</span>, K[<span class="dv">1</span>], </span>
<span id="cb21-18"><a href="sourcesVariability.html#cb21-18"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">K2 = &quot;</span>, K[<span class="dv">2</span>], </span>
<span id="cb21-19"><a href="sourcesVariability.html#cb21-19"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">mu = &quot;</span>, mu, </span>
<span id="cb21-20"><a href="sourcesVariability.html#cb21-20"></a>    <span class="st">&quot;</span><span class="ch">\n</span><span class="st">sigma = &quot;</span>, sigma, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb21-21"><a href="sourcesVariability.html#cb21-21"></a></span>
<span id="cb21-22"><a href="sourcesVariability.html#cb21-22"></a>P &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb21-23"><a href="sourcesVariability.html#cb21-23"></a>B &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb21-24"><a href="sourcesVariability.html#cb21-24"></a>P1 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb21-25"><a href="sourcesVariability.html#cb21-25"></a></span>
<span id="cb21-26"><a href="sourcesVariability.html#cb21-26"></a><span class="kw">set.seed</span>( seed )</span>
<span id="cb21-27"><a href="sourcesVariability.html#cb21-27"></a>VPS&lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> P1)</span>
<span id="cb21-28"><a href="sourcesVariability.html#cb21-28"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span> <span class="op">:</span><span class="st"> </span>P1) VPS[p] &lt;-<span class="st"> </span><span class="kw">VarPopSampling</span>(K, mu, sigma, zetas, P)</span>
<span id="cb21-29"><a href="sourcesVariability.html#cb21-29"></a></span>
<span id="cb21-30"><a href="sourcesVariability.html#cb21-30"></a><span class="kw">set.seed</span>( seed )</span>
<span id="cb21-31"><a href="sourcesVariability.html#cb21-31"></a>VBS&lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> P1)</span>
<span id="cb21-32"><a href="sourcesVariability.html#cb21-32"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span> <span class="op">:</span><span class="st"> </span>P1) VBS[p] &lt;-<span class="st"> </span><span class="kw">VarBootstrap</span>(K, mu, sigma, zetas, B)</span>
<span id="cb21-33"><a href="sourcesVariability.html#cb21-33"></a></span>
<span id="cb21-34"><a href="sourcesVariability.html#cb21-34"></a><span class="kw">set.seed</span>( seed )</span>
<span id="cb21-35"><a href="sourcesVariability.html#cb21-35"></a>VJK&lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> P1)</span>
<span id="cb21-36"><a href="sourcesVariability.html#cb21-36"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span> <span class="op">:</span><span class="st"> </span>P1) VJK[p] &lt;-<span class="st"> </span><span class="kw">VarJack</span>(K, mu, sigma, zetas)</span>
<span id="cb21-37"><a href="sourcesVariability.html#cb21-37"></a></span>
<span id="cb21-38"><a href="sourcesVariability.html#cb21-38"></a><span class="kw">set.seed</span>( seed )</span>
<span id="cb21-39"><a href="sourcesVariability.html#cb21-39"></a>VDL &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dt">dim =</span> P1)</span>
<span id="cb21-40"><a href="sourcesVariability.html#cb21-40"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">1</span> <span class="op">:</span><span class="st"> </span>P1) VDL[p] &lt;-<span class="st"> </span><span class="kw">VarDeLong</span>(K, mu, sigma, zetas)</span>
<span id="cb21-41"><a href="sourcesVariability.html#cb21-41"></a></span>
<span id="cb21-42"><a href="sourcesVariability.html#cb21-42"></a><span class="kw">cat</span>(<span class="st">&quot;Mean Sd Pop Sampling = &quot;</span>, <span class="kw">mean</span>(<span class="kw">sqrt</span>(VPS)),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb21-43"><a href="sourcesVariability.html#cb21-43"></a><span class="kw">cat</span>(<span class="st">&quot;Mean Sd Boot Sampling = &quot;</span>, <span class="kw">mean</span>(<span class="kw">sqrt</span>(VBS)),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb21-44"><a href="sourcesVariability.html#cb21-44"></a><span class="kw">cat</span>(<span class="st">&quot;Mean Sd Jack Sampling = &quot;</span>, <span class="kw">mean</span>(<span class="kw">sqrt</span>(VJK)),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb21-45"><a href="sourcesVariability.html#cb21-45"></a><span class="kw">cat</span>(<span class="st">&quot;Mean Sd DeLong  = &quot;</span>, <span class="kw">mean</span>(<span class="kw">sqrt</span>(VDL)),<span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<table>
<caption>
<span id="tab:sourcesVariabilityTableCompareA">TABLE 7.2: </span>Different estimates of standard deviation of AUC (* the entry for the DeLong method was obtained using the empirical AUC).
</caption>
<thead>
<tr>
<th style="text-align:left;">
Dataset
</th>
<th style="text-align:left;">
AUC est. method
</th>
<th style="text-align:left;">
Var. est. method
</th>
<th style="text-align:left;">
std. dev. AUC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ExampleTable
</td>
<td style="text-align:left;">
Rocfit
</td>
<td style="text-align:left;">
MLE
</td>
<td style="text-align:left;">
0.0378
</td>
</tr>
<tr>
<td style="text-align:left;">
ExampleTable
</td>
<td style="text-align:left;">
Rocfit
</td>
<td style="text-align:left;">
DeLong
</td>
<td style="text-align:left;">
*0.0380
</td>
</tr>
<tr>
<td style="text-align:left;">
ExampleTable
</td>
<td style="text-align:left;">
Rocfit
</td>
<td style="text-align:left;">
Bootstrap
</td>
<td style="text-align:left;">
0.0438
</td>
</tr>
<tr>
<td style="text-align:left;">
ExampleTable
</td>
<td style="text-align:left;">
Rocfit
</td>
<td style="text-align:left;">
Jackknife
</td>
<td style="text-align:left;">
0.0386
</td>
</tr>
<tr>
<td style="text-align:left;">
ExampleTable
</td>
<td style="text-align:left;">
Rocfit
</td>
<td style="text-align:left;">
PopulationSampling
</td>
<td style="text-align:left;">
0.0403
</td>
</tr>
</tbody>
</table>
<ul>
<li>The entry for the DeLong method was obtained using the empirical AUC.</li>
</ul>
<table>
<caption>
<span id="tab:sourcesVariabilityTableCompareB">TABLE 7.3: </span>Different estimates of standard deviation of AUC.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Dataset
</th>
<th style="text-align:left;">
AUC est. method
</th>
<th style="text-align:left;">
Var. est. method
</th>
<th style="text-align:left;">
std. dev. AUC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
ExampleTable
</td>
<td style="text-align:left;">
Wilcoxon
</td>
<td style="text-align:left;">
MLE
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
ExampleTable
</td>
<td style="text-align:left;">
Wilcoxon
</td>
<td style="text-align:left;">
DeLong
</td>
<td style="text-align:left;">
0.0380
</td>
</tr>
<tr>
<td style="text-align:left;">
ExampleTable
</td>
<td style="text-align:left;">
Wilcoxon
</td>
<td style="text-align:left;">
Bootstrap
</td>
<td style="text-align:left;">
0.0413
</td>
</tr>
<tr>
<td style="text-align:left;">
ExampleTable
</td>
<td style="text-align:left;">
Wilcoxon
</td>
<td style="text-align:left;">
Jackknife
</td>
<td style="text-align:left;">
0.0369
</td>
</tr>
<tr>
<td style="text-align:left;">
ExampleTable
</td>
<td style="text-align:left;">
Wilcoxon
</td>
<td style="text-align:left;">
PopulationSampling
</td>
<td style="text-align:left;">
0.0369
</td>
</tr>
</tbody>
</table>
<table>
<caption>
<span id="tab:sourcesVariabilityTableCompareC">TABLE 7.4: </span>Different estimates of standard deviation of AUC.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Dataset
</th>
<th style="text-align:left;">
AUC est. method
</th>
<th style="text-align:left;">
Var. est. method
</th>
<th style="text-align:left;">
std. dev. AUC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Cal. Simulator 60 cases
</td>
<td style="text-align:left;">
Wilcoxon
</td>
<td style="text-align:left;">
MLE
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Cal. Simulator 60 cases
</td>
<td style="text-align:left;">
Wilcoxon
</td>
<td style="text-align:left;">
DeLong
</td>
<td style="text-align:left;">
0.0333
</td>
</tr>
<tr>
<td style="text-align:left;">
Cal. Simulator 60 cases
</td>
<td style="text-align:left;">
Wilcoxon
</td>
<td style="text-align:left;">
Bootstrap
</td>
<td style="text-align:left;">
0.0366
</td>
</tr>
<tr>
<td style="text-align:left;">
Cal. Simulator 60 cases
</td>
<td style="text-align:left;">
Wilcoxon
</td>
<td style="text-align:left;">
Jackknife
</td>
<td style="text-align:left;">
0.0335
</td>
</tr>
<tr>
<td style="text-align:left;">
Cal. Simulator 60 cases
</td>
<td style="text-align:left;">
Wilcoxon
</td>
<td style="text-align:left;">
PopulationSampling
</td>
<td style="text-align:left;">
0.0359
</td>
</tr>
</tbody>
</table>
<table>
<caption>
<span id="tab:sourcesVariabilityTableCompareD">TABLE 7.5: </span>Different estimates of standard deviation of AUC.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Dataset
</th>
<th style="text-align:left;">
AUC est. method
</th>
<th style="text-align:left;">
Var. est. method
</th>
<th style="text-align:left;">
std. dev. AUC
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Cal. Simulator 600 cases
</td>
<td style="text-align:left;">
Wilcoxon
</td>
<td style="text-align:left;">
MLE
</td>
<td style="text-align:left;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Cal. Simulator 600 cases
</td>
<td style="text-align:left;">
Wilcoxon
</td>
<td style="text-align:left;">
DeLong
</td>
<td style="text-align:left;">
0.0113
</td>
</tr>
<tr>
<td style="text-align:left;">
Cal. Simulator 600 cases
</td>
<td style="text-align:left;">
Wilcoxon
</td>
<td style="text-align:left;">
Bootstrap
</td>
<td style="text-align:left;">
0.0110
</td>
</tr>
<tr>
<td style="text-align:left;">
Cal. Simulator 600 cases
</td>
<td style="text-align:left;">
Wilcoxon
</td>
<td style="text-align:left;">
Jackknife
</td>
<td style="text-align:left;">
0.0113
</td>
</tr>
<tr>
<td style="text-align:left;">
Cal. Simulator 600 cases
</td>
<td style="text-align:left;">
Wilcoxon
</td>
<td style="text-align:left;">
PopulationSampling
</td>
<td style="text-align:left;">
0.0113
</td>
</tr>
</tbody>
</table>
</div>
<div id="sourcesVariabilityreaderExpertise" class="section level2" number="7.9">
<h2><span class="header-section-number">7.9</span> Dependence of AUC on reader expertise</h2>
<p>Suppose one conducts an ROC study with J readers where typically J is about 5 but can be as low as 3 and as high as 20 (the wide variability reflects, in the author’s opinion, lack of understanding of the factors affecting the optimal choice of J and the related issue of statistical power). Each reader interprets the same case sample, i.e., the same set of cases, but because they have different expertise levels and for other reasons (see below), the observed ROC counts tables will not be identical. The variance of the observed values is an empirical estimate of between-reader variance (including the inseparable within-reader component). Here is an example, in file MainBetweenReaderSd.R. This file loads the Van Dyke dataset, consisting of two modalities and five readers described in Online Chapter 24. Source the code file to get:
7.8.1: Code Output
&gt; source(‘~/book2/02 A ROC analysis/A7 Sources of variability in AUC/software/mainBetweenReaderSd.R’)
between-reader variance in modality 1 = 0.003082629
between-reader variance in modality 2 = 0.001304602
avg. between-reader variance in both modalities = 0.002193615</p>
<p>Notice that the between-reader (including, as always, within-reader) variance appears to be modality dependent. Determining if the difference is significant requires more analysis. For now one simply averages the two estimates.</p>
<p>How can one handle between-reader variability in the notation? Each reader’s interpretation can be analyzed by MLE to get the corresponding AUC value. The notation for the observed AUC values is:</p>
<p>. (7.11)</p>
<p>How does one conceptualize reader variability? As stated before, it is due to differences in expertise levels, but there is more to it. Since the single reader is characterized by parameters (R is the number of ratings bins; it is assumed that all readers employ the same number of bins, although they may employ it in different ways, i.e., the values of the thresholds may be different). While the non-diseased distribution for each reader could have mean different from 0 and variance different from unity, one can always translate it to zero and scale it to assure that the non-diseased distribution is the unit normal distribution. However, one cannot be assured that the separation and the width of the diseased distribution, and the thresholds, will not depend on the reader. Therefore, the most general way of thinking of reader variability is to put a j subscript on each of the model parameters, yielding . Now the first two of these define the population ROC curve for reader j, and the corresponding AUC value is (this equation was derived in Chapter 06, Eqn. (6.92.24)):</p>
<p>. (7.12)</p>
<p>All else being equal, readers with larger will perform better because they are better able to separate the non-diseased and diseased cases in z-space than their fellow readers. It is difficult and possibly misleading to try to estimate the differences directly from the observed ROC counts tables, but in general better readers will yield counts more skewed towards the low end of the rating scale on non-diseased cases and more skewed towards the high end of the rating scale for diseased cases. The ideal reader would rate all diseased cases one value (e.g. 5) and all non-diseased cases a smaller fixed value (e.g., 1, 2, 3, or 4), resulting in unit AUC, i.e., perfect performance. According to Eqn. (7.12), a reader with smaller will also perform better. As noted before, typically the parameter is greater than unity. The reasons for this general finding will be discussed later, but accept the author’s word for now that the best the reader can is to reduce this parameter to unity. See Summary of Chapter 06 for reasons for the observation that generally the variance of the diseased distribution is larger than one – it has to do with the inhomogeneity of the distribution of diseased cases and the possibility that a mixture distribution is involved. As regards thresholds, while the population based performance for a particular reader does not depend on thresholds, the thresholds determine the ROC counts table, so differences in usage of the thresholds will translate to differences in estimates of , but this is expected to be a smaller effect compared to the dependence on . To summarize, variability of readers can be attributed to variability in the binormal model parameters and, to a lesser extent, to variability in adopted thresholds.</p>
</div>
<div id="sourcesVariabilityModalityEffect" class="section level2" number="7.10">
<h2><span class="header-section-number">7.10</span> Dependence of AUC on modality</h2>
<p>Suppose one conducts an ROC study with j (j =1,2,…J) readers but there are I (i=1,2,…I) modalities. This is frequently referred to as the multiple reader multiple case (MRMC) paradigm. Each reader interprets the same case sample, i.e., the same set of cases, in two or more modalities. Here is an example, in file MainModalityEffect.R. This file loads the Van Dyke dataset, consisting of two modalities and five readers described in Online Chapter 24. Source the code file to get:
7.9.1: Code Output
&gt; source(‘~/book2/02 A ROC analysis/A7 Sources of variability in AUC/software/mainModalityEffect.R’)
reader-average FOM in modality 1 = 0.897037 reader-average FOM in modality 2 = 0.9408374 , effect size, i.e., fom modality 1 minus modality 2 = -0.04380032</p>
<p>Notice that the second modality has a higher FOM. Determining if the difference is significant requires more analysis as described in Chapter 09. The difference between the reader-averaged FOMs is referred to as the observed effect size.</p>
<p>How does on handle modality dependence of the FOM in the notation? If K is the total number of cases, the total number of interpretations involved is IJK, each of which results in a rating. MLE analysis yields IJ values for AUC, one for each modality-reader combination. The appropriate notation is</p>
<p>. (7.13)</p>
<p>The most general way of thinking of reader and modality variability is to put ij subscripts on each of the model parameters, yielding . For a particular combination of modality and reader, the population ROC curve as fitted by the binormal model, yields the area under the ROC curve:</p>
<p>. (7.14)</p>
<p>Given an MRMC dataset, using MLE one can estimate the parameters for each modality-reader combination, and this could be used to design a simulator that is calibrated to the specific clinical dataset, which in turn can be used to illustrate the ideas and to test any proposed method of analyzing the data. However, the problem is more complex; the procedure needs to also account for the correlations arising from the large number of pairings inherent is such a dataset (e.g., reader 1 in modality 1 vs. reader 2 in modality 2, since both interpret a common dataset). Designing a MRMC calibrated simulator was until recently, an unsolved problem, which necessitated recent work9 by the author and Mr. Xuetong Zhai. Chapter 23 describes recent progress towards this end.</p>
</div>
<div id="sourcesVariabilityBinning" class="section level2" number="7.11">
<h2><span class="header-section-number">7.11</span> Effect of binning</h2>
<p>There are actually two effects. (1) The empirical AUC will tend to be smaller than the true AUC. If there are few operating points, and they are clustered together, the difference may be large, Fig. 7.1 (A).</p>
<p>7.10.1: Code listing</p>
<p>This figure was generated by a binormal model simulator, with thresholds chosen to exaggerate the effect, line 4 - 7. The true or population AUC is 0.8664, while the empirical AUC is 0.8030, line 13. However, since interest is in differences in AUCs, e.g., between two modalities, and the underestimates may tend to cancel, this may not be a serious issue. However, an effect that may be problematical is that the operating points for a given reader may not span the same FPF ranges in the two modalities, in which case the empirical AUCs will be different, as depicted in Fig. 7.1 (A - B). The AUC in modality (B), where the operating points span the entire range, is 0.8580, line 21, which is closer to the population value. Since the usage of the bins is not under the researcher’s control, this effect cannot be ruled out. Fitted AUCs are expected to be less sensitive, but not immune, to this effect. Fig. 7.1 (C) is a contaminated binormal model (CBM) fitted curve, line 14, to the same data as in (A), fitted AUC = 0.892, while Fig. 7.1 (D) is a CBM fitted curve, line 22, to the same data as in (B), fitted AUC = 0.867. The difference in AUCs between (A) and (B) is 0.055, while that between (C) and (D) is 0.024. The consequences of these effects on the validity of analyses using the empirical AUC have not been studied. [The parameters of the model were a = 1.33 and b = 0.667, which yields the quoted value of the population AUC. The population value is that predicted by the parameters; it has zero sampling variability. The fitted curves are those predicted by the CBM, discussed in Chapter 20.]</p>
<ol start="2" style="list-style-type: decimal">
<li>The second effect is varying numbers of thresholds or bins between the readers. One could be a radiologist, capable of maintaining at most about 6 bins, and the other an algorithmic observer, such as CAD, capable of maintaining more bins. Moreover, if the radiologist is an expert, the data points will tend to cluster near the initial near vertical part of the ROC (see Chapter 17 for explanation). This is illustrated using code in file mainBinVariability.R. Sourcing this code yields Fig. 7.1 (E – F) and the AUC values shown in these plots.</li>
</ol>
<p>7.10.2: Code listing</p>
<p>In Fig. 7.1(E) and Fig. 7.1(F) the effect is dramatic. The expert radiologist trapezoidal AUC is 0.7418, while that for CAD is 0.8632; the latter is close to the population value. It is left as an exercise for the reader to demonstrate that using CBM one can avoid the severe underestimate of performance that occurs in plot (E).</p>
<ol style="list-style-type: upper-alpha">
<li><p>AUC = 0.8030<br />
</p></li>
<li><p>AUC = 0.8580</p></li>
<li><p>AUC = 0.892<br />
</p></li>
<li><p>AUC = 0.867</p></li>
<li><p>AUC = 0.7418<br />
</p></li>
<li><p>AUC = 0.8632
Fig. 7.1 (A-D): Plots (A - B) depict empirical plots for two simulated datasets for the same model, i.e., same continuous ratings, using different thresholds. In (A) the thresholds are clustered at low FPF values, while in (B) they are more evenly spaced. Empirical AUCs for the plots are 0.803 for (A) and 0.858 for (B). The clustering in (A) leads to a low estimate of AUC. Plots (C) and (D) are fitted curves corresponding to the same data as in (A) and (B), respectively. For each plot, the population AUC is 0.866. The fitted curves are less sensitive, but not immune, to the data clustering variations. With a large number of evenly spaced points, the empirical AUC is close to that of the fitted curve. This effect is demonstrated in plots (E) and (F). The plots were generated by mainEmpVsFit.R and mainBinVariability.R.</p></li>
</ol>
</div>
<div id="sourcesVariabilityEmpiricalVsFitted" class="section level2" number="7.12">
<h2><span class="header-section-number">7.12</span> Empirical vs. fitted AUCs</h2>
<p>There is a preference with some researchers to using the empirical AUC as a figure of merit. Its usage enables analyses10-14 variously referred to as the “probabilistic”, mechanistic" or “first-principles” approach and the “one-shot” approach15 to multiple reader multiple case analysis. The author is aware of some statisticians who distrust parametric modeling and the associate normality assumptions (the author trusts that the demonstrations in §6.2.2 may assuage the concerns). In addition, empirical AUC frees the researcher from problems with binormal model based fitting, e.g., handling degenerate datasets (these problems go away with two of the fitting methods described in later chapters). The fact that the empirical AUC can always be calculated, even, for example, with a single operating point, can make the analyst blissfully unaware of anomalous data structures. In contrast, the binormal curve-fitting method in Chapter 06 will complain when the ratings bins are not well populated, e.g., by failing to converge. This at least alerts the analyst that conditions are not optimal, and prompt data visualization and consideration of alternate fitting methods.</p>
<p>If empirical AUC is defined by a large number of operating points, such as with continuous ratings obtained with algorithmic observers, then empirical AUC will be nearly equal to the true AUC, to within sampling error. However, with human observers one rarely gets more than about 6 distinct ratings. The researcher has no control over the internal sensory thresholds used by the radiologist to bin the data, and these could depend on the modality. As demonstrated in the previous section, the empirical AUC is sensitive to the choice of thresholds, especially when the number of thresholds is small, as is usually the case with radiologists, and when the operating points are clustered on the initial near vertical section of the plot, as is also the case with experts.</p>
<ol style="list-style-type: upper-alpha">
<li></li>
<li></li>
<li></li>
<li></li>
<li>Fig. 7.2 (A-E): This figure shows a small sample of the 236 viewable plots in the cited online document. In this figure, each panel corresponds to a different reader (the j-index in the labels). The modality is the same (the i-index) and the dataset is labeled D1. The three curves correspond to different advanced method of fitting ROC data. The interest in this chapter is on the positions of the operating points. Reader (C) traverses more of the FPF range than does reader (E). Empirical AUC may result in a greater error for reader (E) than for reader (C). An explanation of the three fits is deferred to Chapter 18</li>
</ol>
</div>
<div id="sourcesVariability-Discussion" class="section level2" number="7.13">
<h2><span class="header-section-number">7.13</span> Discussion</h2>
<p>This chapter focused on the factors affecting variability of AUC, namely case-sampling and between-reader variability, each of which contain an inseparable within-reader contribution. The only way to get an estimate of within-reader variability is to have the same reader re-interpret the same case-set on multiple occasions (with sufficient time delay to minimize memory effects). This is rarely done and is unnecessary, in the ROC context, to sound experimental design and analysis. Some early publications have suggested that such re-interpretations are needed to estimate the within-reader component, but modern analysis, described in the next part of the book, does not require re-interpretations. Indeed, it is a waste of precious reader-time resources. Rather than have the same readers re-interpret the same case-set on multiple occasions, it makes much more sense to recruit more readers and/or collect more cases, guided by a systematic sample size estimation method. Another reason the author is not in favor of re-interpretations is that the within-reader variance is usually smaller than case-sampling and between-reader variances. Re-interpretations would minimize a quantity that is already small, which is not good science.</p>
<p>In the author’s judgment, current literature on this topic lacks notational clarity, particularly when it comes to case sampling. An important part of this chapter is the explicit usage of the case-set index to describe a key-factor, namely the case-sample, on which AUC depends. This index is assumed in the literature, which can lead to confusion; especially understanding one the methods used to analyze ROC MRMC data, see Chapter 10. Different simulated datasets correspond to different values of . This indexing leads to a natural, in the author’s opinion, understanding of the bootstrap method; one simply replaces with , the bootstrap case-set index.</p>
<p>The bootstrap and jackknife methods described in this chapter have wide applicability. Later they will be extended to estimating the covariance (essentially a scaled correlation) between two random variables. Also described was the DeLong method, applicable to the empirical AUC. Using a real dataset and simulators, all methods were shown to agree with each other, especially when the numbers of cases is large, Table 7.3 (row-D).</p>
<p>The concept of a calibrated simulator was introduced as a way of “anchoring” a simulator to a real dataset. While relatively easy for a single dataset, the concept has yet to be extended to where it would be useful, namely designing a simulator calibrated to a dataset consisting of interpretations by multiple readers in multiple modalities of a common dataset. Just as a calibrated simulator allowed comparison of the different variance estimation methods to a known standard, obtained by population sampling, a more general calibrated simulator would allow better testing the validity of the analysis described in the next few chapters.</p>
<p>A source of variability not generally considered, namely threshold variability, is introduced, and a cautionary note is struck with respect to indiscriminate usage of the empirical AUC. Finally, the author wishes to reemphasize the importance of viewing ROC plots, to detect anomalous conditions that might be otherwise overlooked.</p>
<p>This concludes Part A of this book. The next chapter begins Part B, namely the statistical analysis of multiple-reader multiple-case (MRMC) ROC datasets.</p>
</div>
<div id="sourcesVariability-references" class="section level2" number="7.14">
<h2><span class="header-section-number">7.14</span> References</h2>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-RN2174">
<p>Bamber, Donald. 1975. “The Area Above the Ordinal Dominance Graph and the Area Below the Receiver Operating Characteristic Graph.” Journal Article. <em>Journal of Mathematical Psychology</em> 12 (4): 387–415. <a href="https://doi.org/10.1016/0022-2496(75)90001-2">https://doi.org/10.1016/0022-2496(75)90001-2</a>.</p>
</div>
<div id="ref-RN2261">
<p>Efron, Bradley, and Robert J. Tibshirani. 1993. <em>An Introduction to the Bootstrap</em>. Book. Vol. 57. Monographs on Statistics and Applied Probability. Boca Raton: Chapman; Hall/CRC.</p>
</div>
<div id="ref-RN2114">
<p>Eng, J. 2006. “ROC Analysis: Web-Based Calculator for ROC Curves, Http://Www.jrocfit.org.” Journal Article. <a href="http://www.jrocfit.org.">http://www.jrocfit.org.</a></p>
</div>
<div id="ref-RN2530">
<p>Noether, Gottfried E. 1967. “Elements of Nonparametric Statistics.” Report. Wiley; Sons.</p>
</div>
<div id="ref-RN412">
<p>Swets, John A., and Ronald M. Pickett. 1982. <em>Evaluation of Diagnostic Systems: Methods from Signal Detection Theory</em>. Book. First. Series in Cognition and Perception. New York: Academic Press.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="BinormalModel.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="HypothesisTesting.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["RJafrocBook.pdf", "RJafrocBook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
