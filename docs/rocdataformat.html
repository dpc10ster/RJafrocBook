<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 ROC data format | RJafroc Documentation</title>
  <meta name="description" content="Extended RJafroc documentation." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 ROC data format | RJafroc Documentation" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Extended RJafroc documentation." />
  <meta name="github-repo" content="dpc10ster/RJafrocBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 ROC data format | RJafroc Documentation" />
  
  <meta name="twitter:description" content="Extended RJafroc documentation." />
  

<meta name="author" content="Dev P. Chakraborty, PhD" />


<meta name="date" content="2019-08-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html">
<link rel="next" href="frocdataformat.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RJafroc documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="rocdataformat.html"><a href="rocdataformat.html"><i class="fa fa-check"></i><b>3</b> ROC data format</a><ul>
<li class="chapter" data-level="3.1" data-path="rocdataformat.html"><a href="rocdataformat.html#introduction"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="rocdataformat.html"><a href="rocdataformat.html#an-actual-mrmc-roc-dataset"><i class="fa fa-check"></i><b>3.2</b> An actual MRMC ROC dataset</a><ul>
<li class="chapter" data-level="3.2.1" data-path="rocdataformat.html"><a href="rocdataformat.html#overview-of-the-data-structure"><i class="fa fa-check"></i><b>3.2.1</b> Overview of the data structure</a></li>
<li class="chapter" data-level="3.2.2" data-path="rocdataformat.html"><a href="rocdataformat.html#details-of-the-modalityid-and-readerid-list-members"><i class="fa fa-check"></i><b>3.2.2</b> Details of the <code>modalityID</code> and <code>readerID</code> list members</a></li>
<li class="chapter" data-level="3.2.3" data-path="rocdataformat.html"><a href="rocdataformat.html#details-of-the-nl-and-ll-list-members"><i class="fa fa-check"></i><b>3.2.3</b> Details of the <code>NL</code> and <code>LL</code> list members</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="rocdataformat.html"><a href="rocdataformat.html#the-roc-excel-data-file"><i class="fa fa-check"></i><b>3.3</b> The ROC Excel data file</a><ul>
<li class="chapter" data-level="3.3.1" data-path="rocdataformat.html"><a href="rocdataformat.html#the-roc-excel-data-input-file"><i class="fa fa-check"></i><b>3.3.1</b> The ROC Excel data input file</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="rocdataformat.html"><a href="rocdataformat.html#summary"><i class="fa fa-check"></i><b>3.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="frocdataformat.html"><a href="frocdataformat.html"><i class="fa fa-check"></i><b>4</b> FROC data format</a><ul>
<li class="chapter" data-level="4.1" data-path="frocdataformat.html"><a href="frocdataformat.html#introduction-1"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="frocdataformat.html"><a href="frocdataformat.html#an-actual-mrmc-froc-dataset"><i class="fa fa-check"></i><b>4.2</b> An actual MRMC FROC dataset</a><ul>
<li class="chapter" data-level="4.2.1" data-path="frocdataformat.html"><a href="frocdataformat.html#the-nl-aand-ll-list-members"><i class="fa fa-check"></i><b>4.2.1</b> The <code>NL</code> aand <code>LL</code> list members</a></li>
<li class="chapter" data-level="4.2.2" data-path="frocdataformat.html"><a href="frocdataformat.html#the-lesionnum-list-member"><i class="fa fa-check"></i><b>4.2.2</b> The <code>lesionNum</code> list member</a></li>
<li class="chapter" data-level="4.2.3" data-path="frocdataformat.html"><a href="frocdataformat.html#the-lesionid-list-member"><i class="fa fa-check"></i><b>4.2.3</b> The <code>lesionID</code> list member</a></li>
<li class="chapter" data-level="4.2.4" data-path="frocdataformat.html"><a href="frocdataformat.html#the-lesionweight-list-member"><i class="fa fa-check"></i><b>4.2.4</b> The <code>LesionWeight</code> list member</a></li>
<li class="chapter" data-level="4.2.5" data-path="frocdataformat.html"><a href="frocdataformat.html#the-datatype-list-member"><i class="fa fa-check"></i><b>4.2.5</b> The <code>dataType</code> list member</a></li>
<li class="chapter" data-level="4.2.6" data-path="frocdataformat.html"><a href="frocdataformat.html#details-of-the-modalityid-and-readerid-list-members-1"><i class="fa fa-check"></i><b>4.2.6</b> Details of the <code>modalityID</code> and <code>readerID</code> list members</a></li>
<li class="chapter" data-level="4.2.7" data-path="frocdataformat.html"><a href="frocdataformat.html#details-of-the-nl-and-ll-list-members-1"><i class="fa fa-check"></i><b>4.2.7</b> Details of the <code>NL</code> and <code>LL</code> list members</a></li>
<li class="chapter" data-level="4.2.8" data-path="frocdataformat.html"><a href="frocdataformat.html#numbers-of-non-diseased-and-diseased-cases-1"><i class="fa fa-check"></i><b>4.2.8</b> Numbers of non-diseased and diseased cases</a></li>
<li class="chapter" data-level="4.2.9" data-path="frocdataformat.html"><a href="frocdataformat.html#why-dimension-the-nl-array-for-the-total-number-of-cases-1"><i class="fa fa-check"></i><b>4.2.9</b> Why dimension the <code>NL</code> array for the total number of cases?</a></li>
<li class="chapter" data-level="4.2.10" data-path="frocdataformat.html"><a href="frocdataformat.html#ratings-on-a-non-diseased-case-1"><i class="fa fa-check"></i><b>4.2.10</b> Ratings on a non-diseased case</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="frocdataformat.html"><a href="frocdataformat.html#the-froc-excel-data-input-file"><i class="fa fa-check"></i><b>4.3</b> The FROC Excel data input file</a><ul>
<li class="chapter" data-level="4.3.1" data-path="frocdataformat.html"><a href="frocdataformat.html#the-truth-worksheet"><i class="fa fa-check"></i><b>4.3.1</b> The Truth worksheet</a></li>
<li class="chapter" data-level="4.3.2" data-path="frocdataformat.html"><a href="frocdataformat.html#the-fpnl-worksheet"><i class="fa fa-check"></i><b>4.3.2</b> The <code>FP/NL</code> worksheet</a></li>
<li class="chapter" data-level="4.3.3" data-path="frocdataformat.html"><a href="frocdataformat.html#the-tpll-worksheet"><i class="fa fa-check"></i><b>4.3.3</b> The <code>TP/LL</code> worksheet</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="frocdataformat.html"><a href="frocdataformat.html#summary-1"><i class="fa fa-check"></i><b>4.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="split-plot-analysis.html"><a href="split-plot-analysis.html"><i class="fa fa-check"></i><b>5</b> Split Plot Analysis</a><ul>
<li class="chapter" data-level="5.1" data-path="split-plot-analysis.html"><a href="split-plot-analysis.html#introduction-2"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="roidataformat.html"><a href="roidataformat.html"><i class="fa fa-check"></i><b>6</b> ROI data format</a><ul>
<li class="chapter" data-level="6.1" data-path="roidataformat.html"><a href="roidataformat.html#roi-paradigm"><i class="fa fa-check"></i><b>6.1</b> ROI paradigm</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">RJafroc Documentation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rocdataformat" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> ROC data format</h1>
<div id="introduction" class="section level2">
<h2><span class="header-section-number">3.1</span> Introduction</h2>
<ul>
<li>In the receiver operating characteristic (<strong>ROC</strong>) paradigm <span class="citation">(Metz <a href="#ref-RN1766">1978</a>)</span> the observer’s task is to <strong>rate</strong> (i.e., assign an ordered label representing the degree of suspicion) each case for confidence in presence of disease. The rating is frequently called a <em>confidence level</em>.</li>
<li>The rating can be an integer or quasi- continuous (e.g., 0 – 100), or a floating point value, as long as higher numbers represent greater confidence in presence of one or more lesions in the case.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a></li>
<li>For human observer studies a 6-point rating scale is recommended, collected via two questions <span class="citation">(Chakraborty <a href="#ref-RN2680">2017</a>)</span>:
<ul>
<li>Is the case diseased?
<ul>
<li>Binary response: <em>Yes</em> or <em>No</em>.</li>
</ul></li>
<li>What is your confidence in the preceding decisions?
<ul>
<li>Three level response: <em>Low</em>, <em>Medium</em> or <em>High</em>.</li>
</ul></li>
</ul></li>
<li>With algorithmic readers, e.g., computer aided detection (CAD) algorithms, a floating point rating, if possible, should be retained.</li>
<li>In the most common study design, termed multiple-reader multiple-case (<strong>MRMC</strong>), the rating collection procedure is repeated for all cases, treatments and readers.</li>
</ul>
</div>
<div id="an-actual-mrmc-roc-dataset" class="section level2">
<h2><span class="header-section-number">3.2</span> An actual MRMC ROC dataset</h2>
<p>An actual MRMC ROC dataset <span class="citation">(Van Dyke et al. <a href="#ref-RN1993">1993</a>)</span> is included as <code>dataset02</code>. It has the following structure:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">str</span>(dataset02)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#&gt; List of 8</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt;  $ NL          : num [1:2, 1:5, 1:114, 1] 1 3 2 3 2 2 1 2 3 2 ...</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt;  $ LL          : num [1:2, 1:5, 1:45, 1] 5 5 5 5 5 5 5 5 5 5 ...</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt;  $ lesionNum   : int [1:45] 1 1 1 1 1 1 1 1 1 1 ...</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt;  $ lesionID    : num [1:45, 1] 1 1 1 1 1 1 1 1 1 1 ...</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt;  $ lesionWeight: num [1:45, 1] 1 1 1 1 1 1 1 1 1 1 ...</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt;  $ dataType    : chr &quot;ROC&quot;</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="co">#&gt;  $ modalityID  : Named chr [1:2] &quot;0&quot; &quot;1&quot;</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;0&quot; &quot;1&quot;</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt;  $ readerID    : Named chr [1:5] &quot;0&quot; &quot;1&quot; &quot;2&quot; &quot;3&quot; ...</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt;   ..- attr(*, &quot;names&quot;)= chr [1:5] &quot;0&quot; &quot;1&quot; &quot;2&quot; &quot;3&quot; ...</span></a></code></pre></div>
<div id="overview-of-the-data-structure" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Overview of the data structure</h3>
<ul>
<li>The <code>dataset</code> structure is a <code>list</code> variable with 8 members.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>
<ul>
<li>Ratings of non-diseased cases are stored in the <code>NL</code> list member.</li>
<li>Ratings of diseased cases are stored in the <code>LL</code> list member.</li>
<li>The <code>lesionNum</code> list member is an array of length 45, filled with ones. It lists the number of lesions per case, which for ROC data, is always unity. The length of this array equals the number of diseased cases <code>K2</code>, see below.</li>
<li>The <code>lesionID</code> list member is a <code>[45 x 1]</code> array, also filled with ones.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></li>
<li>The <code>LesionWeight</code> list member is also a <code>[45 x 1]</code> array filled with ones.</li>
<li>The <code>dataType</code> list member equals the string <code>&quot;ROC&quot;</code>, identifying it as an ROC dataset.</li>
<li>The <code>modalityID</code> list member is a string array identifying the names of the treatments (see below).</li>
<li>The <code>readerID</code> list member is a string array, identifying the names of the readers (see below).</li>
</ul></li>
</ul>
</div>
<div id="details-of-the-modalityid-and-readerid-list-members" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Details of the <code>modalityID</code> and <code>readerID</code> list members</h3>
<ul>
<li>The names of the treatments are in the <code>modalityID</code> list member:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">attributes</span>(dataset02<span class="op">$</span>modalityID)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; $names</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; [1] &quot;0&quot; &quot;1&quot;</span></a></code></pre></div>
<ul>
<li>For example, the name of the first treatment is <code>&quot;0&quot;</code>. The names can be longer strings, but use of very long string names may mess up the output formats of the analysis report. As per the <strong>KISS</strong> principle,<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> keep the names short.</li>
<li>The names of the readers are in the <code>readerID</code> array:</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">attributes</span>(dataset02<span class="op">$</span>readerID)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; $names</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; [1] &quot;0&quot; &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot;</span></a></code></pre></div>
<p>For example, the name of the second reader is <code>&quot;1&quot;</code>. A similar caveat regarding long reader names applies.</p>
</div>
<div id="details-of-the-nl-and-ll-list-members" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Details of the <code>NL</code> and <code>LL</code> list members</h3>
<ul>
<li>For either <code>NL</code> or <code>LL</code> list members, the fourth dimension has unit length. This dimension, which is strictly speaking unnecessary for ROC data, is retained for ease of generalizability to the FROC and ROC paradigms, where more than one rating per case is possible.</li>
<li><code>dataset02</code> is a 2-treatment 5-reader dataset (the lengths of the first and second dimensions, respectively, of the <code>NL</code> and <code>LL</code> list members).</li>
</ul>
<div id="numbers-of-non-diseased-and-diseased-cases" class="section level4">
<h4><span class="header-section-number">3.2.3.1</span> Numbers of non-diseased and diseased cases</h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">K &lt;-<span class="st"> </span><span class="kw">length</span>(dataset02<span class="op">$</span>NL[<span class="dv">1</span>,<span class="dv">1</span>,,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">K2 &lt;-<span class="st"> </span><span class="kw">length</span>(dataset02<span class="op">$</span>LL[<span class="dv">1</span>,<span class="dv">1</span>,,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">K1 &lt;-<span class="st"> </span>K <span class="op">-</span><span class="st"> </span>K2</a></code></pre></div>
<ul>
<li><code>K1</code> is the number of non-diseased cases, while <code>K2</code> is the number of diseased cases.</li>
<li><p>The third dimension of the <code>NL</code> array is the total number of <strong>all</strong> cases, i.e., <code>K</code> = 114, and the third dimension of the <code>LL</code> array, i.e., <code>K2</code> = 45, is the total number of diseased cases.</p></li>
<li><p>Subtracting the number of diseased cases from the number of all cases yields the number of non-diseased cases.</p></li>
<li><p>Therefore, in this dataset, there are <strong>45</strong> diseased cases and <strong>69</strong> non-diseased cases.</p></li>
</ul>
</div>
<div id="why-dimension-the-nl-array-for-the-total-number-of-cases" class="section level4">
<h4><span class="header-section-number">3.2.3.2</span> Why dimension the <code>NL</code> array for the total number of cases?</h4>
<ul>
<li>Again, this is for ease of generalizability to the FROC and ROI paradigms.</li>
</ul>
</div>
<div id="ratings-on-a-non-diseased-case" class="section level4">
<h4><span class="header-section-number">3.2.3.3</span> Ratings on a non-diseased case</h4>
<ul>
<li>For ROC data a non-diseased case can have only one, and exactly one, <code>NL</code> rating.</li>
<li>For treatment 1, reader 1 and case 1 (the first non-diseased case), the NL rating is <code>&quot;1&quot;</code>:</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">dataset02<span class="op">$</span>NL[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="kw">mean</span>(dataset02<span class="op">$</span>NL[,,<span class="dv">1</span><span class="op">:</span>K1,<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; [1] 1.784058</span></a></code></pre></div>
<ul>
<li>This study utilized a 5-point rating scale, 1 thru 5, so non-diseased cases are expected to have low ratings; in this case the lowest rating was observed.</li>
<li>The mean rating over all non-diseased cases, treatments and readers, is 1.784058.</li>
</ul>
</div>
<div id="ratings-on-a-diseased-case" class="section level4">
<h4><span class="header-section-number">3.2.3.4</span> Ratings on a diseased case</h4>
<ul>
<li>For ROC data a diseased case can have only one, and exactly one, <code>LL</code> rating.</li>
<li>For treatment 1, reader 1, case 1 (the first diseased case) the LL rating is:</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">dataset02<span class="op">$</span>LL[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; [1] 5</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw">mean</span>(dataset02<span class="op">$</span>LL)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; [1] 4.297778</span></a></code></pre></div>
<ul>
<li>As noted previously, this study utilized a 5-point rating scale, 1 thru 5, so diseased cases are expected to have high ratings; in this case the highest rating was observed.</li>
<li>The mean rating over all diseased cases, treatments and readers, is 4.2977778.</li>
</ul>
</div>
</div>
</div>
<div id="the-roc-excel-data-file" class="section level2">
<h2><span class="header-section-number">3.3</span> The ROC Excel data file</h2>
<ul>
<li>An Excel file in JAFROC format containing ROC data corresponding to <code>dataset02</code> is included with the <strong>RJafroc</strong> package. The first command (below) finds the location of the file and the second command reads it and saves it to a dataset object <code>ds</code>.</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">fileName &lt;-<span class="st"> </span><span class="kw">system.file</span>(</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">    <span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;includedRocData.xlsx&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;RJafroc&quot;</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">ds &lt;-<span class="st"> </span><span class="kw">DfReadDataFile</span>(fileName)</a></code></pre></div>
<ul>
<li>On my Mac, the file name is huge:</li>
<li>/Library/Frameworks/R.framework/Versions/3.6/Resources/library/RJafroc/extdata/includedRocData.xlsx.</li>
<li>Use the following code to make a duplicate of the Excel file in a more convenient location.</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">DfSaveDataFile</span>(dataset02, <span class="st">&quot;MyDataset02.xlsx&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;JAFROC&quot;</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt; Note: zip::zip() is deprecated, please use zip::zipr() instead</span></a></code></pre></div>
<ul>
<li><code>DfReadDataFile</code> is short for <em>Data File Function to Read a Data File</em>.</li>
<li>All data file related functions start with <code>Df</code>, and a similar organization applies to other functions. This makes it easier, in my opinion, to find a function in the <code>R</code> help system.</li>
<li>To see the online help files, use the following command:</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">help</span>(<span class="st">&quot;RJafroc-package&quot;</span>)</a></code></pre></div>
<ul>
<li>Click the <code>&quot;Show in new window&quot;</code> button to see it full screen (i.e., not constrained to a single quarter panel in <strong>RStudio</strong>).</li>
<li>This advice applies, of course, to all help files.</li>
</ul>
<div id="the-roc-excel-data-input-file" class="section level3">
<h3><span class="header-section-number">3.3.1</span> The ROC Excel data input file</h3>
<ul>
<li>It contains three worksheets, <code>Truth</code>, <code>TP</code> and <code>FP</code>.</li>
<li>The <code>Truth</code> worksheet defines the ground-truth of each case. It indicates which cases are diseased and which are non-diseased.</li>
<li>The <code>FP</code> worksheet lists the ratings of non-diseased cases.</li>
<li>The <code>TP</code> worksheet lists the ratings of diseased cases.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></li>
</ul>
<div id="the-truth-worksheet-organization" class="section level4">
<h4><span class="header-section-number">3.3.1.1</span> The Truth worksheet organization</h4>
<ul>
<li>The <code>CaseID</code> column lists the numeric labels identifying each case. Again, string names are possible, but keep them short.</li>
<li>A <code>1</code> in the <code>LesionID</code> column denotes a diseased case.</li>
<li>A <code>0</code> in the <code>LesionID</code> column denotes a non-diseased case.</li>
<li>The <code>Weight</code> column is irrelevant for ROC data.<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a></li>
<li>The contents of the <code>Truth</code> worksheet corresponding to <code>dataset02</code> are displayed next:</li>
</ul>
<p><img src="images/ROC-Truth-1.png" style="width:40.0%" /><img src="images/ROC-Truth-2.png" style="width:40.0%" /><img src="images/ROC-Truth-3.png" style="width:40.0%" /><img src="images/ROC-Truth-4.png" style="width:40.0%" /></p>
<ul>
<li>There are 69 non-diseased cases (labeled 1-69) under column <code>CaseID</code>.</li>
<li>There are 45 diseased cases (labeled 70-114) under column <code>CaseID</code>.<br />
</li>
<li>The <code>LesionID</code> field for each non-diseased case (e.g., <code>CaseID</code> = 1) is zero. A zero in this field defines a non-diseased case.</li>
<li>The <code>LesionID</code> field for each diseased case (e.g., <code>CaseID</code> = 70) is unity. A unit value in this field defines a diseased case.</li>
<li>The <code>Weights</code> field is irrelevant for ROC datasets. For convenience it is filled with zeroes.</li>
</ul>
</div>
<div id="the-fpnl-worksheet-organization" class="section level4">
<h4><span class="header-section-number">3.3.1.2</span> The FP/NL worksheet organization</h4>
<p>The following screen-shots show different parts of the <code>FP</code> worsheet for <code>dataset02</code>.</p>
<p><img src="images/ROC-FP-1.png" style="width:40.0%" /><img src="images/ROC-FP-2.png" style="width:40.0%" /><img src="images/ROC-FP-3.png" style="width:40.0%" /><img src="images/ROC-FP-5.png" style="width:40.0%" /></p>
<ul>
<li>The <code>FP</code> (or <code>NL</code>) worksheet lists the ratings of non-diseased cases.</li>
<li>The <strong>ModalityID</strong> values range from <code>0</code> to <code>1</code>, corresponding to two treatments.</li>
<li>The <strong>ReaderID</strong> values range from <code>0</code> to <code>4</code>, corresponding to five readers.</li>
<li>The <strong>CaseID</strong> values range from <code>1</code> to <code>69</code>, corresponding to non-diseased cases <strong>only</strong>.</li>
<li>For each reader and treatment, each non-diseased case gets one rating; therefore the length of the column labeled <strong>FP-Rating</strong> is <strong>69 x 2 x 5 = 690</strong>.</li>
<li>The FP ratings tend to be low, there are a lot of ones, fewer twos, even fewer threes, and an ocassional four and a five rating may be found.</li>
</ul>
</div>
<div id="the-tpll-worksheet-organization" class="section level4">
<h4><span class="header-section-number">3.3.1.3</span> The TP/LL worksheet organization</h4>
<p>The following screen-shots show different parts of the <code>FP</code> worsheet for <code>dataset02</code>.</p>
<p><img src="images/ROC-TP-1.png" style="width:40.0%" /><img src="images/ROC-TP-2.png" style="width:40.0%" /><img src="images/ROC-TP-3.png" style="width:40.0%" /><img src="images/ROC-TP-4.png" style="width:40.0%" />
* The <code>TP</code> (or <code>LL</code>) worksheet lists the ratings of diseased cases.
* The <strong>ModalityID</strong> values range from <code>0</code> to <code>1</code>, corresponding to two treatments.
* The <strong>ReaderID</strong> values range from <code>0</code> to <code>4</code>, corresponding to five readers.
* The <strong>CaseID</strong> values range from <code>70</code> to <code>114</code>, corresponding to diseased cases <strong>only</strong>.
* For each reader and treatment, each non-diseased case gets one rating; therefore the length of the column labeled <strong>FP-Rating</strong> is <strong>45 x 2 x 5 = 450</strong>.
* The TP ratings tend to be high, there are a lot of fives, fewer fours, even fewer threes, and an ocassional two and a one rating may be found.</p>
</div>
</div>
</div>
<div id="summary" class="section level2">
<h2><span class="header-section-number">3.4</span> Summary</h2>
<ul>
<li>Since each case gets one rating, the ROC data structure is relatively easy to visualize. For a single treatment and single reader, all of the information in the dataset can be summarize by a two-row five-column table, with one row listing the number of non-diseased cases rated 1, the number rated two, etc., ending with the number rated five, and a corresponding row for diseased cases. These 10 values contain all of the information contained in the Excel file for the specified treatment and reader. The example below is for treatment <code>0</code> and reader <code>0</code>:</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">nl &lt;-<span class="st"> </span>dataset02<span class="op">$</span>NL</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">binnedFpCounts &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) binnedFpCounts[b] &lt;-<span class="st"> </span><span class="kw">sum</span>(nl[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span>K1,<span class="dv">1</span>] <span class="op">==</span><span class="st"> </span>b)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">ll &lt;-<span class="st"> </span>dataset02<span class="op">$</span>LL</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">binnedTpCounts &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) binnedTpCounts[b] &lt;-<span class="st"> </span><span class="kw">sum</span>(ll[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span>K2,<span class="dv">1</span>] <span class="op">==</span><span class="st"> </span>b)</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">binnedFpCounts</a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; [1] 47  9 10  2  1</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9">binnedTpCounts</a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt; [1]  4  1  2 10 28</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="kw">sum</span>(binnedFpCounts)</a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt; [1] 69</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="kw">sum</span>(binnedTpCounts)</a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt; [1] 45</span></a></code></pre></div>
<ul>
<li>The values in <code>binnedFpCounts</code> sum to 69.</li>
<li>The values in <code>binnedTpCounts</code> sum to 45.</li>
<li>A similar table is needed for each treatment-reader combination.</li>
<li>The real value of the Excel format is that it allows generalization to other paradigms where the number of ratings per case is variable.</li>
</ul>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-RN2680">
<p>Chakraborty, Dev P. 2017. <em>Observer Performance Methods for Diagnostic Imaging - Foundations, Modeling, and Applications with R-Based Examples</em>. Book. Boca Raton, FL: CRC Press.</p>
</div>
<div id="ref-RN1766">
<p>Metz, C.E. 1978. “Basic Principles of Roc Analysis.” Journal Article. <em>Seminars in Nuclear Medicine</em> 8 (4): 283–98.</p>
</div>
<div id="ref-RN1993">
<p>Van Dyke, C.W., R.D. White, N.A. Obuchowski, M.A. Geisinger, R.J. Lorig, and M.A. Meziane. 1993. “Cine Mri in the Diagnosis of Thoracic Aortic Dissection.” Journal Article. <em>79th RSNA Meetings</em>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>The directionaliy of the rating is not a limitation. If lower values correspond to increased confidence level, it is only necessary to transform the observed rating by subtracting it from a constant value. The constant value can be chosen arbitrarily, typically as the maximum of all observed ratings, thereby ensuring that the transformed value is always non-negative.<a href="rocdataformat.html#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>This is true for ROC, FROC and ROI datasets. LROC datasets have 9 <code>list</code> members.<a href="rocdataformat.html#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>The second “unnecessary” dimension is necessary for compatibility with FROC datasets.<a href="rocdataformat.html#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>For those not familiar with it, KISS is American for <strong>Keep It Simple, Stupid</strong>.<a href="rocdataformat.html#fnref4" class="footnote-back">↩</a></p></li>
<li id="fn5"><p>OK, I am being inconsistent. I am using <code>NL</code>, <code>LL</code> for the ratings and <code>FP</code>, <code>TP</code>j for the worksheets. The worksheet format will accept <code>NL</code> and <code>LL</code> instead of <code>FP</code> and <code>TP</code>. However, for ease of generalization to the FROC paradigm it is necessary to use <code>NL</code> and <code>LL</code> for the list members of the dataset object.<a href="rocdataformat.html#fnref5" class="footnote-back">↩</a></p></li>
<li id="fn6"><p>It is only needed for FROC data.<a href="rocdataformat.html#fnref6" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="frocdataformat.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["RJafrocBook.pdf", "RJafrocBook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
