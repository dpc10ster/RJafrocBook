<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Binormal model | The RJafroc Book</title>
  <meta name="description" content="Extended RJafroc documentation." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Binormal model | The RJafroc Book" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Extended RJafroc documentation." />
  <meta name="github-repo" content="dpc10ster/RJafrocBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Binormal model | The RJafroc Book" />
  
  <meta name="twitter:description" content="Extended RJafroc documentation." />
  

<meta name="author" content="Dev P. Chakraborty, PhD" />


<meta name="date" content="2020-04-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ratingsParadigm.html"/>
<link rel="next" href="rocdataformat.html"/>
<script src="libs/header-attrs-2.1/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RJafroc documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="a-note-on-the-online-distribution-mechanism-of-the-book.html"><a href="a-note-on-the-online-distribution-mechanism-of-the-book.html"><i class="fa fa-check"></i>A note on the online distribution mechanism of the book</a></li>
<li class="chapter" data-level="" data-path="contributing-to-this-book.html"><a href="contributing-to-this-book.html"><i class="fa fa-check"></i>Contributing to this book</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="NpvPpv.html"><a href="NpvPpv.html"><i class="fa fa-check"></i><b>2</b> Negative and Positive Predictive Values</a>
<ul>
<li class="chapter" data-level="2.1" data-path="NpvPpv.html"><a href="NpvPpv.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="NpvPpv.html"><a href="NpvPpv.html#relevant-equations"><i class="fa fa-check"></i><b>2.2</b> Relevant equations</a></li>
<li class="chapter" data-level="2.3" data-path="NpvPpv.html"><a href="NpvPpv.html#example-calculation-of-ppv-npv-and-accuracy"><i class="fa fa-check"></i><b>2.3</b> Example calculation of PPV, NPV and accuracy</a></li>
<li class="chapter" data-level="2.4" data-path="NpvPpv.html"><a href="NpvPpv.html#comments"><i class="fa fa-check"></i><b>2.4</b> Comments</a></li>
<li class="chapter" data-level="2.5" data-path="NpvPpv.html"><a href="NpvPpv.html#ppv-and-npv-are-irrelevant-to-laboratory-tasks"><i class="fa fa-check"></i><b>2.5</b> PPV and NPV are irrelevant to laboratory tasks</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="modelingBinaryTask.html"><a href="modelingBinaryTask.html"><i class="fa fa-check"></i><b>3</b> Modeling the Binary Task</a>
<ul>
<li class="chapter" data-level="3.1" data-path="modelingBinaryTask.html"><a href="modelingBinaryTask.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="modelingBinaryTask.html"><a href="modelingBinaryTask.html#the-equal-variance-binormal-model"><i class="fa fa-check"></i><b>3.2</b> The equal-variance binormal model</a></li>
<li class="chapter" data-level="3.3" data-path="modelingBinaryTask.html"><a href="modelingBinaryTask.html#definitions-and-relevant-formulae"><i class="fa fa-check"></i><b>3.3</b> Definitions and relevant formulae</a></li>
<li class="chapter" data-level="3.4" data-path="modelingBinaryTask.html"><a href="modelingBinaryTask.html#the-normal-distribution-pdf-and-cdf-plots"><i class="fa fa-check"></i><b>3.4</b> The normal distribution pdf and cdf plots</a></li>
<li class="chapter" data-level="3.5" data-path="modelingBinaryTask.html"><a href="modelingBinaryTask.html#binary-ratings"><i class="fa fa-check"></i><b>3.5</b> Binary ratings</a></li>
<li class="chapter" data-level="3.6" data-path="modelingBinaryTask.html"><a href="modelingBinaryTask.html#calculating-confidence-intervals-for-sensitivity-and-specificity"><i class="fa fa-check"></i><b>3.6</b> Calculating confidence intervals for sensitivity and specificity</a></li>
<li class="chapter" data-level="3.7" data-path="modelingBinaryTask.html"><a href="modelingBinaryTask.html#references"><i class="fa fa-check"></i><b>3.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html"><i class="fa fa-check"></i><b>4</b> Ratings Paradigm</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#the-roc-counts-table"><i class="fa fa-check"></i><b>4.2</b> The ROC counts table</a></li>
<li class="chapter" data-level="4.3" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#operating-points-from-counts-table"><i class="fa fa-check"></i><b>4.3</b> Operating points from counts table</a></li>
<li class="chapter" data-level="4.4" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#automating-all-this"><i class="fa fa-check"></i><b>4.4</b> Automating all this</a></li>
<li class="chapter" data-level="4.5" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#relation-between-ratings-paradigm-and-the-binary-paradigm"><i class="fa fa-check"></i><b>4.5</b> Relation between ratings paradigm and the binary paradigm</a></li>
<li class="chapter" data-level="4.6" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#ratings-are-not-numerical-values"><i class="fa fa-check"></i><b>4.6</b> Ratings are not numerical values</a></li>
<li class="chapter" data-level="4.7" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#a-single-clinical-operating-point-from-ratings-data"><i class="fa fa-check"></i><b>4.7</b> A single “clinical” operating point from ratings data</a></li>
<li class="chapter" data-level="4.8" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#observer-performance-studies-as-laboratory-simulations-of-clinical-tasks"><i class="fa fa-check"></i><b>4.8</b> Observer performance studies as laboratory simulations of clinical tasks</a></li>
<li class="chapter" data-level="4.9" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#discrete-vs.-continuous-ratings-the-miller-study"><i class="fa fa-check"></i><b>4.9</b> Discrete vs. continuous ratings: the Miller study</a></li>
<li class="chapter" data-level="4.10" data-path="ratingsParadigm.html"><a href="ratingsParadigm.html#references-1"><i class="fa fa-check"></i><b>4.10</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="BinormalModel.html"><a href="BinormalModel.html"><i class="fa fa-check"></i><b>5</b> Binormal model</a>
<ul>
<li class="chapter" data-level="5.1" data-path="BinormalModel.html"><a href="BinormalModel.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="BinormalModel.html"><a href="BinormalModel.html#the-binormal-model"><i class="fa fa-check"></i><b>5.2</b> The binormal model</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="BinormalModel.html"><a href="BinormalModel.html#binning-the-data"><i class="fa fa-check"></i><b>5.2.1</b> Binning the data</a></li>
<li class="chapter" data-level="5.2.2" data-path="BinormalModel.html"><a href="BinormalModel.html#invariance-of-the-binormal-model-to-arbitrary-monotone-transformations"><i class="fa fa-check"></i><b>5.2.2</b> Invariance of the binormal model to arbitrary monotone transformations</a></li>
<li class="chapter" data-level="5.2.3" data-path="BinormalModel.html"><a href="BinormalModel.html#expressions-for-sensitivity-and-specificity"><i class="fa fa-check"></i><b>5.2.3</b> Expressions for sensitivity and specificity</a></li>
<li class="chapter" data-level="5.2.4" data-path="BinormalModel.html"><a href="BinormalModel.html#binormal-model-in-conventional-notation"><i class="fa fa-check"></i><b>5.2.4</b> Binormal model in “conventional” notation</a></li>
<li class="chapter" data-level="5.2.5" data-path="BinormalModel.html"><a href="BinormalModel.html#properties-of-the-binormal-model-roc-curve"><i class="fa fa-check"></i><b>5.2.5</b> Properties of the binormal model ROC curve</a></li>
<li class="chapter" data-level="5.2.6" data-path="BinormalModel.html"><a href="BinormalModel.html#pdfs-of-the-binormal-model"><i class="fa fa-check"></i><b>5.2.6</b> pdfs of the binormal model</a></li>
<li class="chapter" data-level="5.2.7" data-path="BinormalModel.html"><a href="BinormalModel.html#fitting-the-roc-curve"><i class="fa fa-check"></i><b>5.2.7</b> Fitting the ROC curve</a></li>
<li class="chapter" data-level="5.2.8" data-path="BinormalModel.html"><a href="BinormalModel.html#least-squares-estimation"><i class="fa fa-check"></i><b>5.2.8</b> Least-squares estimation</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="BinormalModel.html"><a href="BinormalModel.html#maximum-likelihood-estimation-mle"><i class="fa fa-check"></i><b>5.3</b> Maximum likelihood estimation (MLE)</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="BinormalModel.html"><a href="BinormalModel.html#code-implementing-mle"><i class="fa fa-check"></i><b>5.3.1</b> Code implementing MLE</a></li>
<li class="chapter" data-level="5.3.2" data-path="BinormalModel.html"><a href="BinormalModel.html#validating-the-fitting-model"><i class="fa fa-check"></i><b>5.3.2</b> Validating the fitting model</a></li>
<li class="chapter" data-level="5.3.3" data-path="BinormalModel.html"><a href="BinormalModel.html#estimating-the-covariance-matrix"><i class="fa fa-check"></i><b>5.3.3</b> Estimating the covariance matrix</a></li>
<li class="chapter" data-level="5.3.4" data-path="BinormalModel.html"><a href="BinormalModel.html#estimating-the-variance-of-az"><i class="fa fa-check"></i><b>5.3.4</b> Estimating the variance of Az</a></li>
<li class="chapter" data-level="5.3.5" data-path="BinormalModel.html"><a href="BinormalModel.html#expression-for-area-under-roc-curve"><i class="fa fa-check"></i><b>5.3.5</b> Expression for area under ROC curve</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="BinormalModel.html"><a href="BinormalModel.html#discussion"><i class="fa fa-check"></i><b>5.4</b> Discussion</a></li>
<li class="chapter" data-level="5.5" data-path="BinormalModel.html"><a href="BinormalModel.html#references-2"><i class="fa fa-check"></i><b>5.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="rocdataformat.html"><a href="rocdataformat.html"><i class="fa fa-check"></i><b>6</b> ROC DATA FORMAT</a>
<ul>
<li class="chapter" data-level="6.1" data-path="rocdataformat.html"><a href="rocdataformat.html#introduction-4"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="rocdataformat.html"><a href="rocdataformat.html#note-to-existing-users"><i class="fa fa-check"></i><b>6.2</b> Note to existing users</a></li>
<li class="chapter" data-level="6.3" data-path="rocdataformat.html"><a href="rocdataformat.html#the-excel-data-format"><i class="fa fa-check"></i><b>6.3</b> The Excel data format</a></li>
<li class="chapter" data-level="6.4" data-path="rocdataformat.html"><a href="rocdataformat.html#illustrative-toy-file"><i class="fa fa-check"></i><b>6.4</b> Illustrative toy file</a></li>
<li class="chapter" data-level="6.5" data-path="rocdataformat.html"><a href="rocdataformat.html#the-truth-worksheet"><i class="fa fa-check"></i><b>6.5</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="6.6" data-path="rocdataformat.html"><a href="rocdataformat.html#the-structure-of-an-roc-dataset"><i class="fa fa-check"></i><b>6.6</b> The structure of an ROC dataset</a></li>
<li class="chapter" data-level="6.7" data-path="rocdataformat.html"><a href="rocdataformat.html#the-false-positive-fp-ratings"><i class="fa fa-check"></i><b>6.7</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="6.8" data-path="rocdataformat.html"><a href="rocdataformat.html#the-true-positive-tp-ratings"><i class="fa fa-check"></i><b>6.8</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="6.9" data-path="rocdataformat.html"><a href="rocdataformat.html#correspondence-between-nl-member-of-dataset-and-the-fp-worksheet"><i class="fa fa-check"></i><b>6.9</b> Correspondence between <code>NL</code> member of dataset and the <code>FP</code> worksheet</a></li>
<li class="chapter" data-level="6.10" data-path="rocdataformat.html"><a href="rocdataformat.html#correspondence-between-ll-member-of-dataset-and-the-tp-worksheet"><i class="fa fa-check"></i><b>6.10</b> Correspondence between <code>LL</code> member of dataset and the <code>TP</code> worksheet</a></li>
<li class="chapter" data-level="6.11" data-path="rocdataformat.html"><a href="rocdataformat.html#correspondence-using-the-which-function"><i class="fa fa-check"></i><b>6.11</b> Correspondence using the <code>which</code> function</a></li>
<li class="chapter" data-level="6.12" data-path="rocdataformat.html"><a href="rocdataformat.html#references-3"><i class="fa fa-check"></i><b>6.12</b> References</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="frocdataformat.html"><a href="frocdataformat.html"><i class="fa fa-check"></i><b>7</b> FROC data format</a>
<ul>
<li class="chapter" data-level="7.1" data-path="frocdataformat.html"><a href="frocdataformat.html#purpose"><i class="fa fa-check"></i><b>7.1</b> Purpose</a></li>
<li class="chapter" data-level="7.2" data-path="frocdataformat.html"><a href="frocdataformat.html#introduction-5"><i class="fa fa-check"></i><b>7.2</b> Introduction</a></li>
<li class="chapter" data-level="7.3" data-path="frocdataformat.html"><a href="frocdataformat.html#the-excel-data-format-1"><i class="fa fa-check"></i><b>7.3</b> The Excel data format</a></li>
<li class="chapter" data-level="7.4" data-path="frocdataformat.html"><a href="frocdataformat.html#the-truth-worksheet-1"><i class="fa fa-check"></i><b>7.4</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="7.5" data-path="frocdataformat.html"><a href="frocdataformat.html#the-structure-of-an-froc-dataset"><i class="fa fa-check"></i><b>7.5</b> The structure of an FROC dataset</a></li>
<li class="chapter" data-level="7.6" data-path="frocdataformat.html"><a href="frocdataformat.html#the-false-positive-fp-ratings-1"><i class="fa fa-check"></i><b>7.6</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="7.7" data-path="frocdataformat.html"><a href="frocdataformat.html#the-true-positive-tp-ratings-1"><i class="fa fa-check"></i><b>7.7</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="7.8" data-path="frocdataformat.html"><a href="frocdataformat.html#on-the-distribution-of-numbers-of-lesions-in-abnormal-cases"><i class="fa fa-check"></i><b>7.8</b> On the distribution of numbers of lesions in abnormal cases</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="frocdataformat.html"><a href="frocdataformat.html#definition-of-lesdistr-array"><i class="fa fa-check"></i><b>7.8.1</b> Definition of <code>lesDistr</code> array</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="frocdataformat.html"><a href="frocdataformat.html#definition-of-leswghtdistr-array"><i class="fa fa-check"></i><b>7.9</b> Definition of <code>lesWghtDistr</code> array</a></li>
<li class="chapter" data-level="7.10" data-path="frocdataformat.html"><a href="frocdataformat.html#summary"><i class="fa fa-check"></i><b>7.10</b> Summary</a></li>
<li class="chapter" data-level="7.11" data-path="frocdataformat.html"><a href="frocdataformat.html#references-4"><i class="fa fa-check"></i><b>7.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html"><i class="fa fa-check"></i><b>8</b> ROC split plot data format</a>
<ul>
<li class="chapter" data-level="8.1" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#introduction-6"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-excel-data-format-2"><i class="fa fa-check"></i><b>8.2</b> The Excel data format</a></li>
<li class="chapter" data-level="8.3" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-truth-worksheet-2"><i class="fa fa-check"></i><b>8.3</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="8.4" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-structure-of-the-roc-split-plot-dataset"><i class="fa fa-check"></i><b>8.4</b> The structure of the ROC split plot dataset</a></li>
<li class="chapter" data-level="8.5" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-truthtablestr-member"><i class="fa fa-check"></i><b>8.5</b> The <code>truthTableStr</code> member</a></li>
<li class="chapter" data-level="8.6" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-false-positive-fp-ratings-2"><i class="fa fa-check"></i><b>8.6</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="8.7" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-true-positive-tp-ratings-2"><i class="fa fa-check"></i><b>8.7</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="8.8" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#summary-1"><i class="fa fa-check"></i><b>8.8</b> Summary</a></li>
<li class="chapter" data-level="8.9" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#references-5"><i class="fa fa-check"></i><b>8.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html"><i class="fa fa-check"></i><b>9</b> FROC ROC DATA FORMAT SPLIT PLOT</a>
<ul>
<li class="chapter" data-level="9.1" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#introduction-7"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-excel-data-format-3"><i class="fa fa-check"></i><b>9.2</b> The Excel data format</a></li>
<li class="chapter" data-level="9.3" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-truth-worksheet-3"><i class="fa fa-check"></i><b>9.3</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="9.4" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-structure-of-the-froc-split-plot-dataset"><i class="fa fa-check"></i><b>9.4</b> The structure of the FROC split plot dataset</a></li>
<li class="chapter" data-level="9.5" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-false-positive-fp-ratings-3"><i class="fa fa-check"></i><b>9.5</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="9.6" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-true-positive-tp-ratings-3"><i class="fa fa-check"></i><b>9.6</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="9.7" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#summary-2"><i class="fa fa-check"></i><b>9.7</b> Summary</a></li>
<li class="chapter" data-level="9.8" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#references-6"><i class="fa fa-check"></i><b>9.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html"><i class="fa fa-check"></i><b>10</b> QUICK START DBM1</a>
<ul>
<li class="chapter" data-level="10.1" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#introduction-8"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#an-roc-dataset"><i class="fa fa-check"></i><b>10.2</b> An ROC dataset</a></li>
<li class="chapter" data-level="10.3" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#creating-a-dataset-from-a-jafroc-format-file"><i class="fa fa-check"></i><b>10.3</b> Creating a dataset from a JAFROC format file</a></li>
<li class="chapter" data-level="10.4" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#analyzing-the-roc-dataset"><i class="fa fa-check"></i><b>10.4</b> Analyzing the ROC dataset</a></li>
<li class="chapter" data-level="10.5" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#explanation-of-the-output"><i class="fa fa-check"></i><b>10.5</b> Explanation of the output</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#foms"><i class="fa fa-check"></i><b>10.5.1</b> FOMs</a></li>
<li class="chapter" data-level="10.5.2" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#pseudovalue-anova-table"><i class="fa fa-check"></i><b>10.5.2</b> Pseudovalue ANOVA table</a></li>
<li class="chapter" data-level="10.5.3" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#pseudovalue-anova-table-each-treatment"><i class="fa fa-check"></i><b>10.5.3</b> Pseudovalue ANOVA table, each treatment</a></li>
<li class="chapter" data-level="10.5.4" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#pseudovalue-variance-components"><i class="fa fa-check"></i><b>10.5.4</b> Pseudovalue Variance Components</a></li>
<li class="chapter" data-level="10.5.5" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#random-reader-random-case-rrrc-analysis"><i class="fa fa-check"></i><b>10.5.5</b> Random-reader random-case (RRRC) analysis</a></li>
<li class="chapter" data-level="10.5.6" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#fixed-reader-random-case-frrc-analysis"><i class="fa fa-check"></i><b>10.5.6</b> Fixed-reader random-case (FRRC) analysis</a></li>
<li class="chapter" data-level="10.5.7" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#random-reader-fixed-case-rrfc-analysis"><i class="fa fa-check"></i><b>10.5.7</b> Random-reader fixed-case (RRFC) analysis</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#orh-significance-testing"><i class="fa fa-check"></i><b>10.6</b> ORH significance testing</a></li>
<li class="chapter" data-level="10.7" data-path="QuickStartDBM1.html"><a href="QuickStartDBM1.html#references-7"><i class="fa fa-check"></i><b>10.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="QuickStartDBM2.html"><a href="QuickStartDBM2.html"><i class="fa fa-check"></i><b>11</b> QUICK START DBM2</a>
<ul>
<li class="chapter" data-level="11.1" data-path="QuickStartDBM2.html"><a href="QuickStartDBM2.html#introduction-9"><i class="fa fa-check"></i><b>11.1</b> Introduction</a></li>
<li class="chapter" data-level="11.2" data-path="QuickStartDBM2.html"><a href="QuickStartDBM2.html#generating-the-excel-output-file"><i class="fa fa-check"></i><b>11.2</b> Generating the Excel output file</a></li>
<li class="chapter" data-level="11.3" data-path="QuickStartDBM2.html"><a href="QuickStartDBM2.html#orh-significance-testing-1"><i class="fa fa-check"></i><b>11.3</b> ORH significance testing</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="SSFDistr.html"><a href="SSFDistr.html"><i class="fa fa-check"></i><b>12</b> BACKGROUND ON THE F-DISTRIBUTION</a>
<ul>
<li class="chapter" data-level="12.1" data-path="SSFDistr.html"><a href="SSFDistr.html#introduction-10"><i class="fa fa-check"></i><b>12.1</b> Introduction</a></li>
<li class="chapter" data-level="12.2" data-path="SSFDistr.html"><a href="SSFDistr.html#effect-of-ncp-for-ndf-2-and-ddf-10"><i class="fa fa-check"></i><b>12.2</b> Effect of <code>ncp</code> for <code>ndf</code> = 2 and <code>ddf</code> = 10</a></li>
<li class="chapter" data-level="12.3" data-path="SSFDistr.html"><a href="SSFDistr.html#comments-1"><i class="fa fa-check"></i><b>12.3</b> Comments</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-a"><i class="fa fa-check"></i><b>12.3.1</b> Fig. A</a></li>
<li class="chapter" data-level="12.3.2" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-b"><i class="fa fa-check"></i><b>12.3.2</b> Fig. B</a></li>
<li class="chapter" data-level="12.3.3" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-c"><i class="fa fa-check"></i><b>12.3.3</b> Fig. C</a></li>
<li class="chapter" data-level="12.3.4" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-d"><i class="fa fa-check"></i><b>12.3.4</b> Fig. D</a></li>
<li class="chapter" data-level="12.3.5" data-path="SSFDistr.html"><a href="SSFDistr.html#summary-3"><i class="fa fa-check"></i><b>12.3.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="SSFDistr.html"><a href="SSFDistr.html#effect-of-ncp-for-ndf-2-and-ddf-100"><i class="fa fa-check"></i><b>12.4</b> Effect of <code>ncp</code> for <code>ndf</code> = 2 and <code>ddf</code> = 100</a></li>
<li class="chapter" data-level="12.5" data-path="SSFDistr.html"><a href="SSFDistr.html#comments-2"><i class="fa fa-check"></i><b>12.5</b> Comments</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-e"><i class="fa fa-check"></i><b>12.5.1</b> Fig. E</a></li>
<li class="chapter" data-level="12.5.2" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-f"><i class="fa fa-check"></i><b>12.5.2</b> Fig. F</a></li>
<li class="chapter" data-level="12.5.3" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-g"><i class="fa fa-check"></i><b>12.5.3</b> Fig. G</a></li>
<li class="chapter" data-level="12.5.4" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-h"><i class="fa fa-check"></i><b>12.5.4</b> Fig. H</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="SSFDistr.html"><a href="SSFDistr.html#effect-of-ncp-for-ndf-1-ddf-100"><i class="fa fa-check"></i><b>12.6</b> Effect of <code>ncp</code> for <code>ndf</code> = 1, <code>ddf</code> = 100</a></li>
<li class="chapter" data-level="12.7" data-path="SSFDistr.html"><a href="SSFDistr.html#comments-3"><i class="fa fa-check"></i><b>12.7</b> Comments</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-i"><i class="fa fa-check"></i><b>12.7.1</b> Fig. I</a></li>
<li class="chapter" data-level="12.7.2" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-j"><i class="fa fa-check"></i><b>12.7.2</b> Fig. J</a></li>
<li class="chapter" data-level="12.7.3" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-k"><i class="fa fa-check"></i><b>12.7.3</b> Fig. K</a></li>
<li class="chapter" data-level="12.7.4" data-path="SSFDistr.html"><a href="SSFDistr.html#fig.-l"><i class="fa fa-check"></i><b>12.7.4</b> Fig. L</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="SSFDistr.html"><a href="SSFDistr.html#summary-4"><i class="fa fa-check"></i><b>12.8</b> Summary</a></li>
<li class="chapter" data-level="12.9" data-path="SSFDistr.html"><a href="SSFDistr.html#references-8"><i class="fa fa-check"></i><b>12.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html"><i class="fa fa-check"></i><b>13</b> ROC-DBMH sample size from first principles</a>
<ul>
<li class="chapter" data-level="13.1" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#introduction-11"><i class="fa fa-check"></i><b>13.1</b> Introduction</a></li>
<li class="chapter" data-level="13.2" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#sample-size-estimation-using-the-dbmh-method"><i class="fa fa-check"></i><b>13.2</b> Sample size estimation using the DBMH method</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#random-reader-random-case-rrrc"><i class="fa fa-check"></i><b>13.2.1</b> Random reader random case (RRRC)</a></li>
<li class="chapter" data-level="13.2.2" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#fixed-reader-random-case-frrc"><i class="fa fa-check"></i><b>13.2.2</b> Fixed reader random case (FRRC)</a></li>
<li class="chapter" data-level="13.2.3" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#random-reader-fixed-case-rrfc"><i class="fa fa-check"></i><b>13.2.3</b> Random reader fixed case (RRFC)</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#summary-5"><i class="fa fa-check"></i><b>13.3</b> Summary</a></li>
<li class="chapter" data-level="13.4" data-path="SSRocFirstPrinciples.html"><a href="SSRocFirstPrinciples.html#references-9"><i class="fa fa-check"></i><b>13.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html"><i class="fa fa-check"></i><b>14</b> ROC-DBMH sample size using RJafroc</a>
<ul>
<li class="chapter" data-level="14.1" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#introduction-12"><i class="fa fa-check"></i><b>14.1</b> Introduction</a></li>
<li class="chapter" data-level="14.2" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#illustration-of-sspowergivenjk-using-method-dbmh"><i class="fa fa-check"></i><b>14.2</b> Illustration of <code>SsPowerGivenJK()</code> using <code>method = "DBMH"</code></a></li>
<li class="chapter" data-level="14.3" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#illustration-of-sspowertable-using-method-dbmh"><i class="fa fa-check"></i><b>14.3</b> Illustration of <code>SsPowerTable()</code> using <code>method = "DBMH"</code></a></li>
<li class="chapter" data-level="14.4" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#illustration-of-sssamplesizekgivenj-using-method-dbmh"><i class="fa fa-check"></i><b>14.4</b> Illustration of <code>SsSampleSizeKGivenJ()</code> using <code>method = "DBMH"</code></a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#rrrc"><i class="fa fa-check"></i><b>14.4.1</b> RRRC</a></li>
<li class="chapter" data-level="14.4.2" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#frrc"><i class="fa fa-check"></i><b>14.4.2</b> FRRC</a></li>
<li class="chapter" data-level="14.4.3" data-path="SSRocDBMHRJafroc.html"><a href="SSRocDBMHRJafroc.html#rrfc"><i class="fa fa-check"></i><b>14.4.3</b> RRFC</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html"><i class="fa fa-check"></i><b>15</b> ROC-ORH sample size using RJafroc</a>
<ul>
<li class="chapter" data-level="15.1" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#introduction-13"><i class="fa fa-check"></i><b>15.1</b> Introduction</a></li>
<li class="chapter" data-level="15.2" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#illustration-of-sspowergivenjk-using-method-orh"><i class="fa fa-check"></i><b>15.2</b> Illustration of <code>SsPowerGivenJK()</code> using <code>method = "ORH"</code></a></li>
<li class="chapter" data-level="15.3" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#illustration-of-sspowertable-using-method-orh"><i class="fa fa-check"></i><b>15.3</b> Illustration of <code>SsPowerTable()</code> using <code>method = "ORH"</code></a></li>
<li class="chapter" data-level="15.4" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#illustrations-of-sssamplesizekgivenj-using-method-orh"><i class="fa fa-check"></i><b>15.4</b> Illustrations of <code>SsSampleSizeKGivenJ()</code> using <code>method = "ORH"</code></a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#for-rrrc-generalization"><i class="fa fa-check"></i><b>15.4.1</b> For RRRC generalization</a></li>
<li class="chapter" data-level="15.4.2" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#for-frrc-generalization"><i class="fa fa-check"></i><b>15.4.2</b> For FRRC generalization</a></li>
<li class="chapter" data-level="15.4.3" data-path="SSRocORHRJafroc.html"><a href="SSRocORHRJafroc.html#for-rrfc-generalization"><i class="fa fa-check"></i><b>15.4.3</b> For RRFC generalization</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="SSJafrocEffectSize.html"><a href="SSJafrocEffectSize.html"><i class="fa fa-check"></i><b>16</b> Choosing a realistic effect size</a>
<ul>
<li class="chapter" data-level="16.1" data-path="SSJafrocEffectSize.html"><a href="SSJafrocEffectSize.html#introduction-14"><i class="fa fa-check"></i><b>16.1</b> Introduction</a></li>
<li class="chapter" data-level="16.2" data-path="SSJafrocEffectSize.html"><a href="SSJafrocEffectSize.html#illustration-of-sspowergivenjk-using-method-orh-1"><i class="fa fa-check"></i><b>16.2</b> Illustration of <code>SsPowerGivenJK()</code> using <code>method = "ORH"</code></a></li>
<li class="chapter" data-level="16.3" data-path="SSJafrocEffectSize.html"><a href="SSJafrocEffectSize.html#references-10"><i class="fa fa-check"></i><b>16.3</b> References</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="SSFroc1.html"><a href="SSFroc1.html"><i class="fa fa-check"></i><b>17</b> FROC sample size estimation and comparison to ROC</a>
<ul>
<li class="chapter" data-level="17.1" data-path="SSFroc1.html"><a href="SSFroc1.html#introduction-15"><i class="fa fa-check"></i><b>17.1</b> Introduction</a></li>
<li class="chapter" data-level="17.2" data-path="SSFroc1.html"><a href="SSFroc1.html#relating-an-roc-effect-size-to-a-wafroc-effect-size"><i class="fa fa-check"></i><b>17.2</b> Relating an ROC effect-size to a wAFROC effect-size</a></li>
<li class="chapter" data-level="17.3" data-path="SSFroc1.html"><a href="SSFroc1.html#computing-the-respective-variance-components"><i class="fa fa-check"></i><b>17.3</b> Computing the respective variance components</a></li>
<li class="chapter" data-level="17.4" data-path="SSFroc1.html"><a href="SSFroc1.html#comparing-roc-power-to-wafroc-power-for-equivalent-effect-sizes"><i class="fa fa-check"></i><b>17.4</b> Comparing ROC power to wAFROC power for equivalent effect-sizes</a></li>
<li class="chapter" data-level="17.5" data-path="SSFroc1.html"><a href="SSFroc1.html#references-11"><i class="fa fa-check"></i><b>17.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="SSFroc2.html"><a href="SSFroc2.html"><i class="fa fa-check"></i><b>18</b> FROC sample size estimation using specified ROC effect</a>
<ul>
<li class="chapter" data-level="18.1" data-path="SSFroc2.html"><a href="SSFroc2.html#introduction-16"><i class="fa fa-check"></i><b>18.1</b> Introduction</a></li>
<li class="chapter" data-level="18.2" data-path="SSFroc2.html"><a href="SSFroc2.html#constructing-the-nh-model-for-the-dataset"><i class="fa fa-check"></i><b>18.2</b> Constructing the NH model for the dataset</a></li>
<li class="chapter" data-level="18.3" data-path="SSFroc2.html"><a href="SSFroc2.html#extracting-the-wafroc-variance-components"><i class="fa fa-check"></i><b>18.3</b> Extracting the wAFROC variance components</a></li>
<li class="chapter" data-level="18.4" data-path="SSFroc2.html"><a href="SSFroc2.html#wafroc-power-for-specified-roc-effect-size-number-of-readers-j-and-number-of-cases-k"><i class="fa fa-check"></i><b>18.4</b> wAFROC power for specified ROC effect size, number of readers J and number of cases K</a></li>
<li class="chapter" data-level="18.5" data-path="SSFroc2.html"><a href="SSFroc2.html#wafroc-number-of-cases-for-80-power-for-a-given-number-of-readers-j"><i class="fa fa-check"></i><b>18.5</b> wAFROC number of cases for 80% power for a given number of readers J</a></li>
<li class="chapter" data-level="18.6" data-path="SSFroc2.html"><a href="SSFroc2.html#wafroc-power-for-a-given-number-of-readers-j-and-cases-k"><i class="fa fa-check"></i><b>18.6</b> wAFROC Power for a given number of readers J and cases K</a></li>
<li class="chapter" data-level="18.7" data-path="SSFroc2.html"><a href="SSFroc2.html#references-12"><i class="fa fa-check"></i><b>18.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="RsmOpCh.html"><a href="RsmOpCh.html"><i class="fa fa-check"></i><b>19</b> RSM predicted operating characteristics</a>
<ul>
<li class="chapter" data-level="19.1" data-path="RsmOpCh.html"><a href="RsmOpCh.html#introduction-17"><i class="fa fa-check"></i><b>19.1</b> Introduction</a></li>
<li class="chapter" data-level="19.2" data-path="RsmOpCh.html"><a href="RsmOpCh.html#the-distinction-between-predicted-curves-and-empirical-curves"><i class="fa fa-check"></i><b>19.2</b> The distinction between predicted curves and empirical curves</a></li>
<li class="chapter" data-level="19.3" data-path="RsmOpCh.html"><a href="RsmOpCh.html#the-rsm-model"><i class="fa fa-check"></i><b>19.3</b> The RSM model</a></li>
<li class="chapter" data-level="19.4" data-path="RsmOpCh.html"><a href="RsmOpCh.html#the-empirical-wafroc"><i class="fa fa-check"></i><b>19.4</b> The empirical wAFROC</a></li>
<li class="chapter" data-level="19.5" data-path="RsmOpCh.html"><a href="RsmOpCh.html#the-predicted-wafroc"><i class="fa fa-check"></i><b>19.5</b> The predicted wAFROC</a></li>
<li class="chapter" data-level="19.6" data-path="RsmOpCh.html"><a href="RsmOpCh.html#the-distribution-of-number-of-lesions-and-weights"><i class="fa fa-check"></i><b>19.6</b> The distribution of number of lesions and weights</a></li>
<li class="chapter" data-level="19.7" data-path="RsmOpCh.html"><a href="RsmOpCh.html#other-operating-characteristics"><i class="fa fa-check"></i><b>19.7</b> Other operating characteristics</a></li>
<li class="chapter" data-level="19.8" data-path="RsmOpCh.html"><a href="RsmOpCh.html#summary-6"><i class="fa fa-check"></i><b>19.8</b> Summary</a></li>
<li class="chapter" data-level="19.9" data-path="RsmOpCh.html"><a href="RsmOpCh.html#references-13"><i class="fa fa-check"></i><b>19.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="ImproperROCs.html"><a href="ImproperROCs.html"><i class="fa fa-check"></i><b>20</b> Improper ROCs</a>
<ul>
<li class="chapter" data-level="20.1" data-path="ImproperROCs.html"><a href="ImproperROCs.html#the-binormal-model-1"><i class="fa fa-check"></i><b>20.1</b> The binormal model</a></li>
<li class="chapter" data-level="20.2" data-path="ImproperROCs.html"><a href="ImproperROCs.html#improper-rocs"><i class="fa fa-check"></i><b>20.2</b> Improper ROCs</a></li>
<li class="chapter" data-level="20.3" data-path="ImproperROCs.html"><a href="ImproperROCs.html#reason-for-improper-rocs"><i class="fa fa-check"></i><b>20.3</b> Reason for improper ROCs</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html"><i class="fa fa-check"></i><b>21</b> Degenerate datasets in the binormal model</a>
<ul>
<li class="chapter" data-level="21.1" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#two-helper-functions"><i class="fa fa-check"></i><b>21.1</b> Two helper functions</a></li>
<li class="chapter" data-level="21.2" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#degenerate-datasets"><i class="fa fa-check"></i><b>21.2</b> Degenerate datasets</a></li>
<li class="chapter" data-level="21.3" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#understanding-degenerate-datasets"><i class="fa fa-check"></i><b>21.3</b> Understanding degenerate datasets</a></li>
<li class="chapter" data-level="21.4" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#the-exact-fit-is-not-unique"><i class="fa fa-check"></i><b>21.4</b> The exact fit is not unique</a></li>
<li class="chapter" data-level="21.5" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#comments-on-degeneracy"><i class="fa fa-check"></i><b>21.5</b> Comments on degeneracy</a></li>
<li class="chapter" data-level="21.6" data-path="DegenerateDatasetsBinormalModel.html"><a href="DegenerateDatasetsBinormalModel.html#a-reasonable-fit-to-the-degenerate-dataset"><i class="fa fa-check"></i><b>21.6</b> A reasonable fit to the degenerate dataset</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="ProperROCs.html"><a href="ProperROCs.html"><i class="fa fa-check"></i><b>22</b> Proper ROCs</a>
<ul>
<li class="chapter" data-level="22.1" data-path="ProperROCs.html"><a href="ProperROCs.html#helper-functions"><i class="fa fa-check"></i><b>22.1</b> Helper functions</a></li>
<li class="chapter" data-level="22.2" data-path="ProperROCs.html"><a href="ProperROCs.html#definitions-of-proproc-parameters-in-terms-of-binormal-model-parameters"><i class="fa fa-check"></i><b>22.2</b> Definitions of PROPROC parameters in terms of binormal model parameters</a></li>
<li class="chapter" data-level="22.3" data-path="ProperROCs.html"><a href="ProperROCs.html#main-code-and-output"><i class="fa fa-check"></i><b>22.3</b> Main code and output</a></li>
<li class="chapter" data-level="22.4" data-path="ProperROCs.html"><a href="ProperROCs.html#discussion-1"><i class="fa fa-check"></i><b>22.4</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="MetzEqn36.html"><a href="MetzEqn36.html"><i class="fa fa-check"></i><b>23</b> Metz Eqn36 numerical check</a>
<ul>
<li class="chapter" data-level="23.1" data-path="MetzEqn36.html"><a href="MetzEqn36.html#helper-functions-1"><i class="fa fa-check"></i><b>23.1</b> Helper functions</a></li>
<li class="chapter" data-level="23.2" data-path="MetzEqn36.html"><a href="MetzEqn36.html#main-code-and-output-1"><i class="fa fa-check"></i><b>23.2</b> Main code and output</a></li>
<li class="chapter" data-level="23.3" data-path="MetzEqn36.html"><a href="MetzEqn36.html#discussion-2"><i class="fa fa-check"></i><b>23.3</b> Discussion</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="CbmPlots.html"><a href="CbmPlots.html"><i class="fa fa-check"></i><b>24</b> CBM Plots</a>
<ul>
<li class="chapter" data-level="24.1" data-path="CbmPlots.html"><a href="CbmPlots.html#helper-functions-2"><i class="fa fa-check"></i><b>24.1</b> Helper functions</a></li>
<li class="chapter" data-level="24.2" data-path="CbmPlots.html"><a href="CbmPlots.html#main-code-and-output-2"><i class="fa fa-check"></i><b>24.2</b> Main code and output</a></li>
<li class="chapter" data-level="24.3" data-path="CbmPlots.html"><a href="CbmPlots.html#comments-4"><i class="fa fa-check"></i><b>24.3</b> Comments</a></li>
<li class="chapter" data-level="24.4" data-path="CbmPlots.html"><a href="CbmPlots.html#pdf-plots"><i class="fa fa-check"></i><b>24.4</b> pdf plots</a></li>
<li class="chapter" data-level="24.5" data-path="CbmPlots.html"><a href="CbmPlots.html#comments-5"><i class="fa fa-check"></i><b>24.5</b> Comments</a></li>
<li class="chapter" data-level="24.6" data-path="CbmPlots.html"><a href="CbmPlots.html#likelihood-ratio-plots"><i class="fa fa-check"></i><b>24.6</b> likelihood ratio plots</a></li>
<li class="chapter" data-level="24.7" data-path="CbmPlots.html"><a href="CbmPlots.html#comments-6"><i class="fa fa-check"></i><b>24.7</b> Comments</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="ROIDataStr.html"><a href="ROIDataStr.html"><i class="fa fa-check"></i><b>25</b> ROI paradigm data</a>
<ul>
<li class="chapter" data-level="25.1" data-path="ROIDataStr.html"><a href="ROIDataStr.html#introduction-this-chapter-is-under-construction"><i class="fa fa-check"></i><b>25.1</b> Introduction; this chapter is under construction!</a></li>
<li class="chapter" data-level="25.2" data-path="ROIDataStr.html"><a href="ROIDataStr.html#an-example-roi-dataset"><i class="fa fa-check"></i><b>25.2</b> An example ROI dataset</a></li>
<li class="chapter" data-level="25.3" data-path="ROIDataStr.html"><a href="ROIDataStr.html#the-roi-excel-data-file"><i class="fa fa-check"></i><b>25.3</b> The ROI Excel data file</a></li>
<li class="chapter" data-level="25.4" data-path="ROIDataStr.html"><a href="ROIDataStr.html#next-tba"><i class="fa fa-check"></i><b>25.4</b> Next, TBA</a></li>
<li class="chapter" data-level="25.5" data-path="ROIDataStr.html"><a href="ROIDataStr.html#references-14"><i class="fa fa-check"></i><b>25.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html"><i class="fa fa-check"></i><b>26</b> Analyzing data acquired according to the ROI paradigm</a>
<ul>
<li class="chapter" data-level="26.1" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#introduction-this-chapter-is-under-construction-1"><i class="fa fa-check"></i><b>26.1</b> Introduction; this chapter is under construction!</a></li>
<li class="chapter" data-level="26.2" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#note-to-self-102919-dpc"><i class="fa fa-check"></i><b>26.2</b> Note to self (10/29/19) !!!DPC!!!</a></li>
<li class="chapter" data-level="26.3" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#introduction-18"><i class="fa fa-check"></i><b>26.3</b> Introduction</a></li>
<li class="chapter" data-level="26.4" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#the-roi-figure-of-merit"><i class="fa fa-check"></i><b>26.4</b> The ROI figure of merit</a></li>
<li class="chapter" data-level="26.5" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#calculation-of-the-roi-figure-of-merit."><i class="fa fa-check"></i><b>26.5</b> Calculation of the ROI figure of merit.</a></li>
<li class="chapter" data-level="26.6" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#significance-testing"><i class="fa fa-check"></i><b>26.6</b> Significance testing</a>
<ul>
<li class="chapter" data-level="26.6.1" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#rrrc-analysis"><i class="fa fa-check"></i><b>26.6.1</b> RRRC analysis</a></li>
<li class="chapter" data-level="26.6.2" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#frrc-analysis"><i class="fa fa-check"></i><b>26.6.2</b> FRRC analysis</a></li>
<li class="chapter" data-level="26.6.3" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#rrfc-analysis"><i class="fa fa-check"></i><b>26.6.3</b> RRFC analysis</a></li>
</ul></li>
<li class="chapter" data-level="26.7" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#summary-7"><i class="fa fa-check"></i><b>26.7</b> Summary</a></li>
<li class="chapter" data-level="26.8" data-path="ROIDataAnalysis.html"><a href="ROIDataAnalysis.html#references-15"><i class="fa fa-check"></i><b>26.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="myEquations.html"><a href="myEquations.html"><i class="fa fa-check"></i><b>27</b> EQUATIONS</a></li>
<li class="chapter" data-level="" data-path="references-16.html"><a href="references-16.html"><i class="fa fa-check"></i>REFERENCES</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The RJafroc Book</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="BinormalModel" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> Binormal model</h1>
<div id="introduction-3" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Introduction</h2>
<p>In this chapter the univariate binormal model <span class="citation">(Dorfman and Alf <a href="#ref-RN212" role="doc-biblioref">1968</a>)</span> is described, in which one is dealing with one ROC rating per case, as in a single observer interpreting cases, one at a time, in a single modality. By convention the qualifier “univariate” is often omitted, i.e., it is implicit. In a later chapter a bivariate binormal model will be described where each case yields two ratings, as in a single observer interpreting cases in two modalities, or equivalently, two observers interpreting cases in a single modality.</p>
<p>The equal variance binormal model was described in Chapter “Binary Paradigm”. The ratings method of acquiring ROC data and calculation of operating points was illustrated in Chapter “Ratings Paradigm”. It was shown that for a clinical ROC dataset the unequal-variance binormal model fitted the data better than the equal-variance binormal model. This chapter deals with details of the unequal-variance binormal model, establishes necessary notation for describing the model, and derives expressions for sensitivity, specificity and the area under the predicted ROC curve (due to its complexity it appears in an Appendix).
The main aim of this chapter is to take the mystery out of statistical curve fitting. Accordingly, this is one chapter where the Appendices are longer than the main text, but as usual, they are essential reading as they reinforce the main text. It is not too much to expect the reader to load each file beginning with “main”, click on Source and see what happens. [The reader is reminded that any file that starts with “main” contains directly executable code.]</p>
</div>
<div id="the-binormal-model" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> The binormal model</h2>
<p>The unequal-variance binormal model (henceforth abbreviated to binormal model; when the author means equal variances, it will be made explicit) is defined by (capital letters indicate random variables and their lower-case counterparts are actual realized values):</p>
<p><span class="math display">\[\begin{equation*} 
Z_{k_tt}\sim N\left ( \mu_t,\sigma_{t}^{2} \right );t=1,2
\end{equation*}\]</span></p>
<p>where</p>
<p><span class="math display">\[\begin{equation*} 
\mu_1=0;\mu_2=\mu;\sigma_{1}^{2}=1;\sigma_{2}^{2}=\sigma^{2}
\end{equation*}\]</span></p>
<p>Eqn. (6.2.1) states that the Z-samples for non-diseased cases are distributed as a <span class="math inline">\(N(0,1)\)</span> distribution, i.e., the unit normal distribution, while the Z-samples for diseased cases are distributed as a <span class="math inline">\(N(\mu,\sigma^2)\)</span> distribution, i.e., a normal distribution with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>. This is a 2-parameter model of the z-samples, not counting additional threshold parameters needed for data binning.</p>
<div id="binning-the-data" class="section level3" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Binning the data</h3>
<p>In an R-rating ROC study the observed ratings r take on integer values, 1 through R, it being understood that higher ratings correspond to greater confidence for disease. Defining dummy cutoffs <span class="math inline">\(\zeta_0 = -\infty\)</span> and <span class="math inline">\(\zeta_R = +\infty\)</span>, the binning rule for a case with realized z-sample z is (Chapter “Ratings Paradigm”, Eqn. 4.13):</p>
<p><span class="math display">\[\begin{equation*} 
if \left (\zeta_{r-1} \le z \le \zeta_r  \right )\Rightarrow \text rating = r
\end{equation*}\]</span></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="BinormalModel.html#cb8-1"></a>mu &lt;-<span class="st"> </span><span class="fl">1.5</span>;sigma &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb8-2"><a href="BinormalModel.html#cb8-2"></a></span>
<span id="cb8-3"><a href="BinormalModel.html#cb8-3"></a>z1 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb8-4"><a href="BinormalModel.html#cb8-4"></a>z2 &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">6</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb8-5"><a href="BinormalModel.html#cb8-5"></a></span>
<span id="cb8-6"><a href="BinormalModel.html#cb8-6"></a>Pdf1 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(z1)</span>
<span id="cb8-7"><a href="BinormalModel.html#cb8-7"></a>Pdf2 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(z2, mu, <span class="dt">sd =</span> sigma)</span>
<span id="cb8-8"><a href="BinormalModel.html#cb8-8"></a></span>
<span id="cb8-9"><a href="BinormalModel.html#cb8-9"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">z =</span> <span class="kw">c</span>(z1, z2), <span class="dt">pdfs =</span> <span class="kw">c</span>(Pdf1, Pdf2), </span>
<span id="cb8-10"><a href="BinormalModel.html#cb8-10"></a>                 <span class="dt">truth =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&#39;non-diseased&#39;</span>, <span class="kw">length</span>(Pdf1)), <span class="kw">rep</span>(<span class="st">&#39;diseased&#39;</span>, <span class="kw">length</span>(Pdf2))), </span>
<span id="cb8-11"><a href="BinormalModel.html#cb8-11"></a>                 <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</span>
<span id="cb8-12"><a href="BinormalModel.html#cb8-12"></a></span>
<span id="cb8-13"><a href="BinormalModel.html#cb8-13"></a>cut_point &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">z =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.0</span>, <span class="fl">-0.5</span>, <span class="dv">1</span>, <span class="fl">2.5</span>))</span>
<span id="cb8-14"><a href="BinormalModel.html#cb8-14"></a></span>
<span id="cb8-15"><a href="BinormalModel.html#cb8-15"></a>rocPdfs &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> z, <span class="dt">y =</span> pdfs, <span class="dt">color =</span> truth)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb8-16"><a href="BinormalModel.html#cb8-16"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb8-17"><a href="BinormalModel.html#cb8-17"></a><span class="st">  </span><span class="kw">scale_colour_manual</span>(<span class="dt">values=</span><span class="kw">c</span>(<span class="st">&quot;darkgrey&quot;</span>,<span class="st">&quot;black&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb8-18"><a href="BinormalModel.html#cb8-18"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title =</span> <span class="kw">element_blank</span>(), <span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.85</span>, <span class="fl">0.95</span>), </span>
<span id="cb8-19"><a href="BinormalModel.html#cb8-19"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">25</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>), </span>
<span id="cb8-20"><a href="BinormalModel.html#cb8-20"></a>          <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.8</span>, <span class="dt">size =</span> <span class="dv">30</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb8-21"><a href="BinormalModel.html#cb8-21"></a>        <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">25</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="op">+</span></span>
<span id="cb8-22"><a href="BinormalModel.html#cb8-22"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">data =</span> cut_point, <span class="kw">aes</span>(<span class="dt">xintercept =</span> z), <span class="dt">linetype =</span> <span class="st">&quot;dotted&quot;</span>, <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb8-23"><a href="BinormalModel.html#cb8-23"></a><span class="st">  </span><span class="kw">annotation_custom</span>(<span class="dt">grob =</span> <span class="kw">textGrob</span>(<span class="kw">bquote</span>(<span class="kw">italic</span>(<span class="st">&quot;O&quot;</span>)),</span>
<span id="cb8-24"><a href="BinormalModel.html#cb8-24"></a>                                    <span class="dt">gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">32</span>)), </span>
<span id="cb8-25"><a href="BinormalModel.html#cb8-25"></a>                    <span class="dt">xmin =</span> <span class="fl">-3.2</span>, <span class="dt">xmax =</span> <span class="fl">-3.2</span>, <span class="co"># adjust the position of &quot;O&quot;</span></span>
<span id="cb8-26"><a href="BinormalModel.html#cb8-26"></a>                    <span class="dt">ymin =</span> <span class="fl">-0.0</span>, <span class="dt">ymax =</span> <span class="fl">-0.01</span>) <span class="op">+</span></span>
<span id="cb8-27"><a href="BinormalModel.html#cb8-27"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb8-28"><a href="BinormalModel.html#cb8-28"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb8-29"><a href="BinormalModel.html#cb8-29"></a></span>
<span id="cb8-30"><a href="BinormalModel.html#cb8-30"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span> <span class="op">:</span><span class="st"> </span><span class="kw">length</span>(cut_point<span class="op">$</span>z)){</span>
<span id="cb8-31"><a href="BinormalModel.html#cb8-31"></a>  rocPdfs &lt;-<span class="st"> </span>rocPdfs <span class="op">+</span></span>
<span id="cb8-32"><a href="BinormalModel.html#cb8-32"></a><span class="st">    </span><span class="kw">annotation_custom</span>(<span class="dt">grob =</span> <span class="kw">textGrob</span>(<span class="kw">bquote</span>(zeta[.(i)]),<span class="dt">gp =</span> <span class="kw">gpar</span>(<span class="dt">fontsize =</span> <span class="dv">20</span>)),</span>
<span id="cb8-33"><a href="BinormalModel.html#cb8-33"></a>                      <span class="dt">xmin =</span> cut_point<span class="op">$</span>z[i], <span class="dt">xmax =</span> cut_point<span class="op">$</span>z[i],</span>
<span id="cb8-34"><a href="BinormalModel.html#cb8-34"></a>                      <span class="dt">ymin =</span> <span class="fl">-0.01</span>, <span class="dt">ymax =</span> <span class="fl">-0.01</span>)</span>
<span id="cb8-35"><a href="BinormalModel.html#cb8-35"></a>}</span>
<span id="cb8-36"><a href="BinormalModel.html#cb8-36"></a></span>
<span id="cb8-37"><a href="BinormalModel.html#cb8-37"></a>gt &lt;-<span class="st"> </span><span class="kw">ggplot_gtable</span>(<span class="kw">ggplot_build</span>(rocPdfs))</span>
<span id="cb8-38"><a href="BinormalModel.html#cb8-38"></a>gt<span class="op">$</span>layout<span class="op">$</span>clip[gt<span class="op">$</span>layout<span class="op">$</span>name <span class="op">==</span><span class="st"> &quot;panel&quot;</span>] &lt;-<span class="st"> &quot;off&quot;</span></span>
<span id="cb8-39"><a href="BinormalModel.html#cb8-39"></a><span class="kw">grid.draw</span>(gt)</span></code></pre></div>
<p><img src="06-binormal-model_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>In the unequal-variance binormal model, the variance <span class="math inline">\(\sigma^2\)</span> of the Z-samples for diseased cases, is allowed to be different from unity. Most ROC datasets are consistent with <span class="math inline">\(\sigma &gt; 1\)</span>. The above figure, generated with <span class="math inline">\(\mu = 1.5, \sigma = 1.5\)</span>, illustrates how realized z-samples are converted to ratings, i.e., it illustrates application of the binning rule. For example, a case with Z-sample equal to -2.5 would be rated “1”, and one with Z-sample equal to -1 would be rated “2”, cases with Z-samples greater than 2.5 would be rated “5”, etc.</p>
</div>
<div id="invariance-of-the-binormal-model-to-arbitrary-monotone-transformations" class="section level3" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Invariance of the binormal model to arbitrary monotone transformations</h3>
<p>The binormal model is not as restrictive as might appear at first sight. Any monotone increasing transformation <span class="math inline">\(Y=f(Z)\)</span> applied to the observed z-samples, and the associated thresholds, will yield the same observed data, e.g., Table 6.1. This is because such a transformation leaves the ordering of the ratings unaltered and hence results in the same operating points. While the distributions for will not be binormal (i.e., two independent normal distributions), one can safely “pretend” that one is still dealing with an underlying binormal model. An alternative way of stating this is that any pair of distributions is allowed as long as they are reducible to a binormal model form by a monotonic increasing transformation of Y: e.g., <span class="math inline">\(Z=f^{-1}\)</span>. [If <span class="math inline">\(f\)</span> is a monotone increasing function of its argument, so is <span class="math inline">\(f^{-1}\)</span>}.] For this reason, the term “pair of latent underlying normal distributions” is sometimes used to describe the binormal model. The robustness of the binormal model has been investigated <span class="citation">(Hanley <a href="#ref-RN1216" role="doc-biblioref">1988</a>; Dorfman et al. <a href="#ref-RN100" role="doc-biblioref">1997</a>)</span>. The referenced paper by Dorfman et al has an excellent discussion of the robustness of the binormal model.</p>
<p>The robustness of the binormal model, i.e., the flexibility allowed by the infinite choices of monotonic increasing functions, application of each of which leaves the ordering of the data unaltered, is widely misunderstood. The non-Gaussian appearance of histograms of ratings in ROC studies can lead one to incorrect conclusions that the binormal model is inapplicable to these datasets. To quote a reviewer of one of the author’s recent papers, <em>"I have had multiple encounters with statisticians who do not understand this difference…. They show me histograms of data, and tell me that the data is obviously not normal, therefore the binormal model should not be used.</em>"</p>
<p><em>The reviewer is correct.</em> The example below illustrates the misconception.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="BinormalModel.html#cb9-1"></a><span class="co"># shows that monontone transformations have no effect on </span></span>
<span id="cb9-2"><a href="BinormalModel.html#cb9-2"></a><span class="co"># AUC even though the pdfs look non-gaussian</span></span>
<span id="cb9-3"><a href="BinormalModel.html#cb9-3"></a><span class="co"># common statistician misconception about ROC analysis</span></span>
<span id="cb9-4"><a href="BinormalModel.html#cb9-4"></a></span>
<span id="cb9-5"><a href="BinormalModel.html#cb9-5"></a><span class="kw">options</span>(<span class="dt">digits =</span> <span class="dv">7</span>) <span class="co"># line 10</span></span>
<span id="cb9-6"><a href="BinormalModel.html#cb9-6"></a></span>
<span id="cb9-7"><a href="BinormalModel.html#cb9-7"></a>fArray &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.9</span>);seedArray &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">12</span>)</span>
<span id="cb9-8"><a href="BinormalModel.html#cb9-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) { </span>
<span id="cb9-9"><a href="BinormalModel.html#cb9-9"></a>  f &lt;-<span class="st"> </span>fArray[i];seed &lt;-<span class="st"> </span>seedArray[i];<span class="kw">set.seed</span>(seed) <span class="co"># line 20</span></span>
<span id="cb9-10"><a href="BinormalModel.html#cb9-10"></a>  K1 &lt;-<span class="st"> </span><span class="dv">900</span>;K2 &lt;-<span class="st"> </span><span class="dv">1000</span>;mu1 &lt;-<span class="st"> </span><span class="dv">30</span>;sigma1 &lt;-<span class="st"> </span><span class="dv">7</span>;mu2 &lt;-<span class="st"> </span><span class="dv">55</span>;sigma2 &lt;-<span class="st"> </span><span class="dv">7</span> <span class="co"># line 21</span></span>
<span id="cb9-11"><a href="BinormalModel.html#cb9-11"></a>  z1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K1, <span class="dt">mean =</span> mu1, <span class="dt">sd =</span> sigma1);z1[z1<span class="op">&gt;</span><span class="dv">100</span>] &lt;-<span class="st"> </span><span class="dv">100</span>;z1[z1<span class="op">&lt;</span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb9-12"><a href="BinormalModel.html#cb9-12"></a>  z2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(K2, <span class="dt">mean =</span> mu2, <span class="dt">sd =</span> sigma2);z2[z2<span class="op">&gt;</span><span class="dv">100</span>] &lt;-<span class="st"> </span><span class="dv">100</span>;z2[z2<span class="op">&lt;</span><span class="dv">0</span>] &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb9-13"><a href="BinormalModel.html#cb9-13"></a>  AUC1 &lt;-<span class="st"> </span><span class="kw">TrapezoidalArea</span>(z1, z2)</span>
<span id="cb9-14"><a href="BinormalModel.html#cb9-14"></a>  Gaussians &lt;-<span class="st"> </span><span class="kw">c</span>(z1, z2)</span>
<span id="cb9-15"><a href="BinormalModel.html#cb9-15"></a>  hist1 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>Gaussians) <span class="co">#  line 27</span></span>
<span id="cb9-16"><a href="BinormalModel.html#cb9-16"></a>  hist<span class="fl">.1</span> &lt;-<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> hist1, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></span>
<span id="cb9-17"><a href="BinormalModel.html#cb9-17"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-18"><a href="BinormalModel.html#cb9-18"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="dt">label =</span> <span class="st">&quot;Original Rating&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;A&quot;</span>, i, <span class="st">&quot;: &quot;</span>, <span class="st">&quot;Gaussians&quot;</span>))</span>
<span id="cb9-19"><a href="BinormalModel.html#cb9-19"></a>  <span class="kw">print</span>(hist<span class="fl">.1</span>)</span>
<span id="cb9-20"><a href="BinormalModel.html#cb9-20"></a>  </span>
<span id="cb9-21"><a href="BinormalModel.html#cb9-21"></a>  z &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="fl">0.0</span>, <span class="dv">100</span>, <span class="fl">0.1</span>) <span class="co"># line 32</span></span>
<span id="cb9-22"><a href="BinormalModel.html#cb9-22"></a>  curveData &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> z, <span class="dt">z =</span>  <span class="kw">Y</span>(z,mu1,mu2,sigma1,sigma2,f))</span>
<span id="cb9-23"><a href="BinormalModel.html#cb9-23"></a>  plot3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> z)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> curveData, <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb9-24"><a href="BinormalModel.html#cb9-24"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="dt">label =</span> <span class="st">&quot;Original Rating&quot;</span>) <span class="op">+</span></span>
<span id="cb9-25"><a href="BinormalModel.html#cb9-25"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="dt">label =</span> <span class="st">&quot;Transformed Rating&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;B&quot;</span>, i, <span class="st">&quot;: &quot;</span>, <span class="st">&quot;Monotone Transformation&quot;</span>))</span>
<span id="cb9-26"><a href="BinormalModel.html#cb9-26"></a>  <span class="kw">print</span>(plot3)</span>
<span id="cb9-27"><a href="BinormalModel.html#cb9-27"></a>  </span>
<span id="cb9-28"><a href="BinormalModel.html#cb9-28"></a>  y &lt;-<span class="st"> </span><span class="kw">Y</span>(<span class="kw">c</span>(z1, z2),mu1,mu2,sigma1,sigma2,f)</span>
<span id="cb9-29"><a href="BinormalModel.html#cb9-29"></a>  y1 &lt;-<span class="st"> </span>y[<span class="dv">1</span><span class="op">:</span>K1];y2 &lt;-<span class="st"> </span>y[(K1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(K1<span class="op">+</span>K2)]</span>
<span id="cb9-30"><a href="BinormalModel.html#cb9-30"></a>  AUC2 &lt;-<span class="st"> </span><span class="kw">TrapezoidalArea</span>( y1, y2)</span>
<span id="cb9-31"><a href="BinormalModel.html#cb9-31"></a>  hist2 &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>y)</span>
<span id="cb9-32"><a href="BinormalModel.html#cb9-32"></a>  hist<span class="fl">.2</span> &lt;-<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> hist2, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></span>
<span id="cb9-33"><a href="BinormalModel.html#cb9-33"></a><span class="st">    </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;grey&quot;</span>) <span class="op">+</span></span>
<span id="cb9-34"><a href="BinormalModel.html#cb9-34"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="dt">label =</span> <span class="st">&quot;Transformed Rating&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;C&quot;</span>, i, <span class="st">&quot;: &quot;</span>, <span class="st">&quot;Latent Gaussians&quot;</span>))</span>
<span id="cb9-35"><a href="BinormalModel.html#cb9-35"></a>  <span class="kw">print</span>(hist<span class="fl">.2</span>)</span>
<span id="cb9-36"><a href="BinormalModel.html#cb9-36"></a>  <span class="kw">cat</span>(<span class="st">&quot;seed =&quot;</span>, seed, <span class="st">&quot;f =&quot;</span>, f, <span class="st">&quot;, AUC of actual Gaussians =&quot;</span>, AUC1, <span class="st">&quot;, AUC of latent Gaussians =&quot;</span>, AUC2, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb9-37"><a href="BinormalModel.html#cb9-37"></a>}</span>
<span id="cb9-38"><a href="BinormalModel.html#cb9-38"></a><span class="co">#&gt; seed = 10 f = 0.1 , AUC of actual Gaussians = 0.99308 , AUC of latent Gaussians = 0.99308</span></span>
<span id="cb9-39"><a href="BinormalModel.html#cb9-39"></a><span class="co">#&gt; seed = 11 f = 0.5 , AUC of actual Gaussians = 0.9936689 , AUC of latent Gaussians = 0.9936689</span></span>
<span id="cb9-40"><a href="BinormalModel.html#cb9-40"></a><span class="co">#&gt; seed = 12 f = 0.9 , AUC of actual Gaussians = 0.9950411 , AUC of latent Gaussians = 0.9950411</span></span></code></pre></div>
<p><img src="06-binormal-model_files/figure-html/unnamed-chunk-4-1.png" width="33%" /><img src="06-binormal-model_files/figure-html/unnamed-chunk-4-2.png" width="33%" /><img src="06-binormal-model_files/figure-html/unnamed-chunk-4-3.png" width="33%" /><img src="06-binormal-model_files/figure-html/unnamed-chunk-4-4.png" width="33%" /><img src="06-binormal-model_files/figure-html/unnamed-chunk-4-5.png" width="33%" /><img src="06-binormal-model_files/figure-html/unnamed-chunk-4-6.png" width="33%" /><img src="06-binormal-model_files/figure-html/unnamed-chunk-4-7.png" width="33%" /><img src="06-binormal-model_files/figure-html/unnamed-chunk-4-8.png" width="33%" /><img src="06-binormal-model_files/figure-html/unnamed-chunk-4-9.png" width="33%" /></p>
<p><strong>Figure captions (A1 - C3):</strong> Plots illustrating the invariance of ROC analysis to arbitrary monotone transformations of the ratings. Each of the latent Gaussian plots (C1, C2 and C3) appears not binormal. However, by using the inverse of the monotone transformations shown (B1, B2 and B3), they can be transformed to the binormal model histograms (A1, A2 and A3). Plot (A1) shows the histogram of simulated ratings from a binormal model. Two peaks, one at 30 and the other at 55 are evident (by design, all ratings in this figure are in the range 0 to 100). Plot (B1) shows the monotone transformation for <span class="math inline">\(f = 0.1\)</span>. Plot (C1) shows the histogram of the transformed rating. The choice of <span class="math inline">\(f\)</span> leads to a transformed rating histogram that is peaked near the high end of the rating scale. For (A1) and (C1) the corresponding AUCs are identical (0.99308). Plot (A2) is for a different seed value, plot (B2) is the transformation for <span class="math inline">\(f = 0.5\)</span> and now the transformed histogram is almost flat, plot C2. For plots (A2) and (C2) the corresponding AUCs are identical (0.9936689). Plot (A3) is for a different seed value, (B3) is the transformation for <span class="math inline">\(f = 0.9\)</span> and the transformed histogram (C3) is peaked near the low end of the transformed rating scale. For plots (A3) and (C3) the corresponding AUCs are identical (0.9950411).</p>
<p>Line 20-21 sets the parameters of the simulation model. The idea is to simulate continuous ratings data in the range 0 to 100 from a binormal model. Non-diseased cases are sampled from a Gaussian centered at <span class="math inline">\(\mu_1\)</span> = 30 and standard deviation <span class="math inline">\(\sigma_1 = 7\)</span>. Diseased cases are sampled from a Gaussian centered at <span class="math inline">\(\mu_2\)</span> = 55 and standard deviation <span class="math inline">\(\sigma_2\)</span> = 7. The variable <span class="math inline">\(f\)</span>, which is in the range (0,1), controls the shape of the transformed distribution. If <span class="math inline">\(f\)</span> is small, the transformed distribution will be peaked towards 0 and if <span class="math inline">\(f\)</span> is unity, it will be peaked at 100. If <span class="math inline">\(f\)</span> equals 0.5, the transformed distribution is flat. Insight into the reason for this transformation is in <span class="citation">(Press et al. <a href="#ref-RN300" role="doc-biblioref">2007</a>)</span>, Chapter 7, ibid: it has to do with transformations of random variables. The transformation <span class="math inline">\(Y(Z)\)</span>, in the in-line function <span class="math inline">\(Y\)</span>, not shown, implements:</p>
<p><span class="math display">\[\begin{equation*} 
Y\left ( Z \right )=\left [ \left ( 1-f \right )\Phi\left ( \frac{Z-\mu_1}{\sigma_1} \right )+f\Phi\left ( \frac{Z-\mu_2}{\sigma_2} \right ) \right ]100
\end{equation*}\]</span></p>
<p>The multiplication by 100 ensures that the transformed variable is in the range 0 to 100. The code chunk realizes the random samples, calculates the empirical AUC using the binormal samples, displays the histogram of the binormal samples, plots the transformation function, calculates the empirical AUC using the transformed samples, and plots the histogram of the transformed samples.</p>
<p>The output lists the values of the seed variable and the value of the shape parameter <span class="math inline">\(f\)</span>. <em>For each value of seed and the shape parameter, the AUCs of the actual Gaussians and the transformed variables are identical to seven digits (set at line 10)</em>. For this reason, the transformed variables are termed “Latent Gaussians”. The values of the parameters were chosen to explicate the binormal nature of the plots A2 and A3). This has the effect of making the AUCs close to unity. It is left as an exercise for the reader to plot ROC curves corresponding to actual Gaussian and latent Gaussian variables and show that they are identical.</p>
<p>Fig. (B1) shows the transformation for <span class="math inline">\(f = 0.1\)</span>. The steep initial rise of the curve has the effect of flattening the histogram of the transformed ratings at the low end of the rating scale, Fig. (C1). Conversely, the flat nature of the curve near upper end of the rating range has the effect of causing the histogram of the transformed variable to peak in that range. Fig. (B2) shows the transformation for <span class="math inline">\(f = 0.5\)</span>. This time the transformed rating histogram, Fig. (C2), is almost flat over the entire range. Fig. (B3) shows the transformation for <span class="math inline">\(f = 0.9\)</span>. This time the transformed rating histogram, Fig. (C3) is peaked at the low end of the transformed rating scale.</p>
<p>Each histogram in Fig. (C1, C2 and C3) appears to be non-Gaussian. The corresponding non-diseased and diseased ratings will fail tests of normality. [Showing this is left as an exercise for the reader.] Nevertheless, the transformed ratings are latent Gaussians in the sense that the inverses of the transformations shown in Fig. (B1, B2 and B3) will yield histograms that are strictly binormal. By appropriate changes to the monotone transformation function, the histograms shown in Fig. (C1, C2 and C3) can be made to resemble a wide variety of shapes. [As another exercise, the reader could modify the transformation function to yield quasi-bimodal histograms.] <strong>One concludes that visual examination of the shape of the histogram of ratings yields little, if any, insight into whether the underlying binormal model assumptions are being violated.</strong></p>
</div>
<div id="expressions-for-sensitivity-and-specificity" class="section level3" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Expressions for sensitivity and specificity</h3>
<p>Let <span class="math inline">\(Z_t\)</span> denote the random Z-sample for truth state <span class="math inline">\(t\)</span> (<span class="math inline">\(t\)</span> = 1 for non-diseased and <span class="math inline">\(t\)</span> = 2 for diseased cases). Since the distribution of Z-samples from disease-free cases is <span class="math inline">\(N(0,1)\)</span>, the expression for specificity, Chapter “Modeling Binary Paradigm”, Eqn. 3.13, applies. It is reproduced below:</p>
<p><span class="math display">\[\begin{equation*} 
Sp\left ( \zeta \right )=P\left ( Z_1 &lt; \zeta \right )=\Phi\left ( \zeta \right )
\end{equation*}\]</span></p>
<p>To obtain an expression for sensitivity, consider that for truth state <span class="math inline">\(t = 2\)</span>, the random variable <span class="math inline">\(\frac{Z_2-\mu}{\sigma}\)</span> is distributed as <span class="math inline">\(N(0,1)\)</span>:</p>
<p><span class="math display">\[\begin{equation*} 
\frac{Z_2-\mu}{\sigma}\sim N\left ( 0,1 \right )
\end{equation*}\]</span></p>
<p>Sensitivity is <span class="math inline">\(P\left ( Z_2 &gt; \zeta \right )\)</span>, which implies, because <span class="math inline">\(\sigma\)</span> is positive (subtract from both sides of the “greater than” symbol and divide by <span class="math inline">\(\sigma\)</span>):</p>
<p><span class="math display">\[\begin{equation*} 
Se\left ( \zeta | \mu, \sigma \right )= P\left ( Z_2 &gt; \zeta \right )=P\left ( \frac{Z_2-\mu}{\sigma} &gt; \frac{\zeta-\mu}{\sigma} \right )
\end{equation*}\]</span></p>
<p>The right-hand-side can be rewritten as follows:</p>
<p><span class="math display">\[\begin{equation*} 
Se\left ( \zeta | \mu, \sigma \right )= 1 - P\left ( \frac{Z_2-\mu}{\sigma} \leq  \frac{\zeta-\mu}{\sigma} \right )\\
=1-\Phi\left (  \frac{\zeta-\mu}{\sigma}\right )=\Phi\left (  \frac{\mu-\zeta}{\sigma}\right )
\end{equation*}\]</span></p>
<p>Summarizing, the formulae for the specificity and sensitivity for the binormal model are:</p>
<p><span class="math display">\[\begin{equation*} 
Sp\left ( \zeta \right ) = \Phi\left ( \zeta \right )\\
Se\left ( \zeta | \mu, \sigma \right ) = \Phi\left (  \frac{\mu-\zeta}{\sigma}\right )
\end{equation*}\]</span></p>
<p>The coordinates of the operating point defined by <span class="math inline">\(\zeta\)</span> are given by:</p>
<p><span class="math display">\[\begin{equation*} 
FPF\left ( \zeta \right ) = 1 - Sp\left ( \zeta \right ) = 1 - \Phi\left ( \zeta \right ) = \Phi\left ( -\zeta \right ) \\
TPF\left ( \zeta | \mu, \sigma \right ) = \Phi\left ( \frac{\mu-\zeta}{\sigma} \right )
\end{equation*}\]</span></p>
<p>These expressions allow calculation of the operating point for any <span class="math inline">\(\zeta\)</span>. An equation for a curve is usually expressed as <span class="math inline">\(y=f(x)\)</span>. An expression of this form for the ROC curve, i.e., the y coordinate (TPF) expressed as a function of the x coordinate (FPF), follows upon inversion of the expression for FPF, Eqn. (6.2.11):</p>
<p><span class="math display">\[\begin{equation*} 
\zeta = -\Phi^{-1}\left ( FPF \right )
\end{equation*}\]</span></p>
<p>Substituting Eqn. (6.2.13) in the expression for TPF in 2nd Eqn. (6.2.11):</p>
<p><span class="math display">\[\begin{equation*} 
TPF = \Phi\left ( \frac{\mu + \Phi^{-1}\left (FPF  \right )}{\sigma} \right )
\end{equation*}\]</span></p>
</div>
<div id="binormal-model-in-conventional-notation" class="section level3" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Binormal model in “conventional” notation</h3>
<p>The following notation is widely used in the literature:</p>
<p><span class="math display">\[\begin{equation*} 
a=\frac{\mu}{\sigma};b=\frac{1}{\sigma}
\end{equation*}\]</span></p>
<p><img src="06-binormal-model_files/figure-html/unnamed-chunk-5-1.png" width="672" /><img src="06-binormal-model_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
<p>The reason for the <span class="math inline">\((a,b)\)</span> instead of the <span class="math inline">\((\mu,\sigma)\)</span> notation is that Dorfman and Alf assumed, in their seminal paper3, that the diseased (often termed signal) distribution had unit variance, and the non-diseased (often termed noise) distribution had standard deviation <span class="math inline">\(b\)</span> (<span class="math inline">\(b &gt; 0\)</span>) or variance <span class="math inline">\(b^2\)</span>, and that the separation of the two distributions was a, Fig. 6.2(A). In this example, <span class="math inline">\(a = 1.11\)</span> and <span class="math inline">\(b = 0.556\)</span>. Dorfman and Alf’s fundamental contribution, namely estimating these parameters from ratings data, to be described below, has led to the widespread usage of the <span class="math inline">\((a,b)\)</span> parameters, estimated by their software (RSCORE), and its modern variants (e.g., ROCFIT and ROCKIT).</p>
</div>
<div id="properties-of-the-binormal-model-roc-curve" class="section level3" number="5.2.5">
<h3><span class="header-section-number">5.2.5</span> Properties of the binormal model ROC curve</h3>
<p>Using the a, b notation, Eqn. (6.2.14) for the ROC curve reduces to:</p>
<p><span class="math display">\[\begin{equation*} 
TPF = \Phi\left ( a+ b \Phi^{-1}\left (FPF  \right ) \right )
\end{equation*}\]</span></p>
<p>Since <span class="math inline">\(\Phi^{-1}(FPF)\)</span> is an increasing function of its argument FPF, and <span class="math inline">\(b &gt; 0\)</span>, the argument of the <span class="math inline">\(\Phi\)</span> function is an increasing function of FPF. Since <span class="math inline">\(\Phi\)</span> is a monotonically increasing function of its argument, TPF is a monotonically increasing function of FPF. This is true regardless of the sign of <span class="math inline">\(a\)</span>. If FPF = 0, then <span class="math inline">\(\Phi^{-1}(0) = -\infty\)</span> and TPF = 0. If FPF = 1, then <span class="math inline">\(\Phi^{-1}(1) = +\infty\)</span> and TPF = 1. [The fact that TPF is a monotonic increasing function of FPF is consistent with the following argument: to increase FPF, <span class="math inline">\(\zeta\)</span> must decrease, which will increase the area under the diseased distribution to the right of <span class="math inline">\(\zeta\)</span>, i.e., increase TPF.]</p>
<p>Regardless of the value of <span class="math inline">\(a\)</span>, as long as <span class="math inline">\(b \ge 0\)</span>, the ROC curve starts at (0,0) and ends at (1,1), increasing monotonically from the origin to (1,1).</p>
<p>From Eqn. (6.2.11) and Eqn. (6.2.12), the expressions for FPF and TPF in terms of model parameters <span class="math inline">\((a,b)\)</span> are:</p>
<p><span class="math display">\[\begin{equation*} 
FPF\left ( \zeta \right ) = \Phi\left ( -\zeta \right )\\
TPF = \Phi\left ( a - b \zeta \right )
\end{equation*}\]</span></p>
</div>
<div id="pdfs-of-the-binormal-model" class="section level3" number="5.2.6">
<h3><span class="header-section-number">5.2.6</span> pdfs of the binormal model</h3>
<p>According to Eqn. (6.2.1), the probability that a Z-sample is smaller than a specified threshold <span class="math inline">\(\zeta\)</span>, i.e., the CDF function, is:</p>
<p><span class="math display">\[\begin{equation*} 
P\left ( Z \le \zeta \mid  Z\sim N\left ( 0,1 \right ) \right ) = 1-FPF\left ( \zeta \right ) = \Phi \left ( \zeta  \right )
\end{equation*}\]</span></p>
<p><span class="math display">\[\begin{equation*} 
P\left ( Z \le \zeta \mid  Z\sim N\left ( \mu,\sigma^2 \right ) \right ) = 1-TPF\left ( \zeta \right ) = \Phi \left ( \frac{\zeta - \mu}{\sigma}  \right )
\end{equation*}\]</span></p>
<p>Since the <em>pdf</em> is the derivative of the corresponding CDF function, it follows that (the subscripts N and D denote non-diseased and diseased cases, respectively):</p>
<p><span class="math display">\[\begin{equation*} 
pdf_N\left ( \zeta \right ) = \frac{\partial \Phi\left ( \zeta \right )}{\partial \zeta} = \phi\left ( \zeta \right ) \equiv \frac{1}{\sqrt{2 \pi}}\exp\left ( -\frac{\zeta^2}{2} \right )
\end{equation*}\]</span></p>
<p><span class="math display">\[\begin{equation*} 
pdf_D\left ( \zeta \right ) = \frac{\partial \Phi\left ( \frac{\zeta - \mu}{\sigma} \right )}{\partial \zeta} = \frac{1}{\sigma} \phi\left ( \frac{\zeta - \mu}{\sigma} \right ) \equiv \frac{1}{\sqrt{2 \pi}\sigma}\exp\left ( -\frac{\left (\zeta-\mu  \right )^2}{2\sigma} \right )
\end{equation*}\]</span></p>
<p>The second equation can be written in <span class="math inline">\((a,b)\)</span> notation as:</p>
<p><span class="math display">\[\begin{equation*} 
pdf_D\left ( \zeta \right ) = b\phi\left ( b\zeta-a \right ) = \frac{b}{\sqrt{2 \pi}}\exp\left ( -\frac{\left (b\zeta - a \right )^2}{2} \right )
\end{equation*}\]</span></p>
<p>Generation of pdfs for specified values of binormal model parameters was illustrated above (ref. TBA) for specified values of <span class="math inline">\(\mu,\sigma\)</span>. Using transformations in Eqn. (6.2.16) the code can be readily converted to accept <span class="math inline">\(a,b\)</span> values as inputs.</p>
</div>
<div id="fitting-the-roc-curve" class="section level3" number="5.2.7">
<h3><span class="header-section-number">5.2.7</span> Fitting the ROC curve</h3>
<p>To be described next is a method for fitting data such as in Table 6.1 to the binormal model, i.e., determining the parameters <span class="math inline">\(a,b\)</span> and the thresholds <span class="math inline">\(\zeta_r , r = 1, 2, ..., R-1\)</span>, to best fit, in some to-be-defined sense, the observed cell counts. The most common method uses an algorithm called maximum likelihood. But before getting to that, I describe the least-square method, which is conceptually the simplest, but is not really applicable for this type of fitting.</p>
</div>
<div id="least-squares-estimation" class="section level3" number="5.2.8">
<h3><span class="header-section-number">5.2.8</span> Least-squares estimation</h3>
<p>By applying the function <span class="math inline">\(\Phi^{-1}\)</span> to both sides of Eqn. (6.2.17), one gets (the “inverse” function cancels the “forward” function on the right hand side):</p>
<p><span class="math display">\[\begin{equation*} 
\Phi^{-1}\left ( TPF \right ) = a + b \Phi^{-1}\left ( FPF \right )
\end{equation*}\]</span></p>
<p>This suggests that a plot of <span class="math inline">\(y = \Phi^{-1}\left ( TPF \right )\)</span> vs. <span class="math inline">\(\Phi^{-1}\left ( FPF \right )\)</span> is expected to follow a straight line with slope b and intercept a. Fitting a straight line to such data is generally performed by the method of least-squares, a capability present in most software packages and even spreadsheets, e.g., Excel. Alternatively one can simply visually draw the best straight line that fits the points, memorably referred to7 as “chi-by-eye”. This was the way parameters of the binormal model were estimated prior to Dorfman and Alf’s work3. The least-squares method is a quantitative way of accomplishing the same aim. If <span class="math inline">\(\left ( x_t,y_t \right )\)</span> are the data points, one constructs <span class="math inline">\(S\)</span>, the sum of the squared deviations of the observed ordinates from the predicted values:</p>
<p><span class="math display">\[\begin{equation*} 
S  = \sum_{i=1}^{R-1}\left ( y_i - \left ( a + bx_i \right ) \right )^2
\end{equation*}\]</span></p>
<p>The idea is to minimize S with respect to the parameters <span class="math inline">\((a,b)\)</span>. One approach is to differentiate this with respect to <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> and equate each resulting derivate expression to zero. This yields two equations in two unknowns, which are solved for <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. If the reader has never done this before, one should go through these steps at least once, but it would be smarter in future to use software that does all this. In <code>R</code> the least-squares fitting function is <code>lm(y~x)</code>, which in its simplest form fits a linear model using the method of least-squares (in case you are wondering lm stands for linear model, a whole branch of statistics in itself; in this example one is using its simplest capability).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="BinormalModel.html#cb10-1"></a><span class="co"># ML estimates of a and b (from Eng JAVA program)</span></span>
<span id="cb10-2"><a href="BinormalModel.html#cb10-2"></a><span class="co"># a &lt;- 1.3204; b &lt;- 0.6075 # these are not used in program; just there for comparison</span></span>
<span id="cb10-3"><a href="BinormalModel.html#cb10-3"></a></span>
<span id="cb10-4"><a href="BinormalModel.html#cb10-4"></a>FPF &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.017</span>, <span class="fl">0.050</span>, <span class="fl">0.183</span>, <span class="fl">0.5</span>)  <span class="co"># this is from Table 6.11, last two rows</span></span>
<span id="cb10-5"><a href="BinormalModel.html#cb10-5"></a>TPF &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.440</span>, <span class="fl">0.680</span>, <span class="fl">0.780</span>, <span class="fl">0.900</span>)<span class="co"># ...do...</span></span>
<span id="cb10-6"><a href="BinormalModel.html#cb10-6"></a></span>
<span id="cb10-7"><a href="BinormalModel.html#cb10-7"></a>phiInvFPF &lt;-<span class="st"> </span><span class="kw">qnorm</span>(FPF)<span class="co"># apply the PHI_INV function</span></span>
<span id="cb10-8"><a href="BinormalModel.html#cb10-8"></a>phiInvTPF &lt;-<span class="st"> </span><span class="kw">qnorm</span>(TPF)<span class="co"># ... do ... </span></span>
<span id="cb10-9"><a href="BinormalModel.html#cb10-9"></a></span>
<span id="cb10-10"><a href="BinormalModel.html#cb10-10"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(phiInvTPF<span class="op">~</span>phiInvFPF)</span>
<span id="cb10-11"><a href="BinormalModel.html#cb10-11"></a><span class="kw">print</span>(fit)</span>
<span id="cb10-12"><a href="BinormalModel.html#cb10-12"></a><span class="co">#&gt; </span></span>
<span id="cb10-13"><a href="BinormalModel.html#cb10-13"></a><span class="co">#&gt; Call:</span></span>
<span id="cb10-14"><a href="BinormalModel.html#cb10-14"></a><span class="co">#&gt; lm(formula = phiInvTPF ~ phiInvFPF)</span></span>
<span id="cb10-15"><a href="BinormalModel.html#cb10-15"></a><span class="co">#&gt; </span></span>
<span id="cb10-16"><a href="BinormalModel.html#cb10-16"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb10-17"><a href="BinormalModel.html#cb10-17"></a><span class="co">#&gt; (Intercept)    phiInvFPF  </span></span>
<span id="cb10-18"><a href="BinormalModel.html#cb10-18"></a><span class="co">#&gt;      1.3288       0.6307</span></span>
<span id="cb10-19"><a href="BinormalModel.html#cb10-19"></a>pointsData &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">phiInvFPF =</span> phiInvFPF, <span class="dt">phiInvTPF =</span> phiInvTPF)</span>
<span id="cb10-20"><a href="BinormalModel.html#cb10-20"></a>pointsPlot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> pointsData, </span>
<span id="cb10-21"><a href="BinormalModel.html#cb10-21"></a>  <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> phiInvFPF, <span class="dt">y =</span> phiInvTPF)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb10-22"><a href="BinormalModel.html#cb10-22"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">25</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),</span>
<span id="cb10-23"><a href="BinormalModel.html#cb10-23"></a>        <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">30</span>,<span class="dt">face=</span><span class="st">&quot;bold&quot;</span>)) <span class="op">+</span></span>
<span id="cb10-24"><a href="BinormalModel.html#cb10-24"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> fit<span class="op">$</span>coefficients[<span class="dv">2</span>], <span class="dt">intercept =</span> fit<span class="op">$</span>coefficients[<span class="dv">1</span>], <span class="dt">size =</span> <span class="dv">2</span>)</span>
<span id="cb10-25"><a href="BinormalModel.html#cb10-25"></a><span class="kw">print</span>(pointsPlot)</span></code></pre></div>
<p><img src="06-binormal-model_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>This plot shows operating points from Table 1, transformed by the <span class="math inline">\(\Phi^{-1}\)</span> function; the slope of the line is the least-squares estimate of the <span class="math inline">\(b\)</span> parameter and the intercept is the corresponding <span class="math inline">\(a\)</span> parameter of the binormal model.</p>
<p>The first two lines of the output are simply a reminder about the names of the dependent and independent variables. The last line contains the least squares estimated values, <span class="math inline">\(a\)</span> = 1.3288 and <span class="math inline">\(b\)</span> = 0.6307. The corresponding maximum likelihood estimates of these parameters, as yielded by the Eng web code, Appendix B, are listed in line 4 of the main program: <span class="math inline">\(a\)</span> = 1.3204 and <span class="math inline">\(b\)</span> = 0.6075. The estimates appear to be close, particularly the estimate of <span class="math inline">\(a\)</span> , but there are a few things wrong with the least-squares approach. First, the method of least squares assumes that the data points are independent. Because of the manner in which they are constructed, namely by cumulating points, the independence assumption is not valid for ROC operating points. Cumulating the 4 and 5 responses constrains the resulting operating point to be above and to the right of the point obtained by cumulating the 5 responses only, so the data points are definitely not independent. Similarly, cumulating the 3, 4 and 5 responses constrains the resulting operating point to be above and to the right of the point obtained by cumulating the 4 and 5 responses, and so on. The second problem is the linear least-squares method assumes there is no error in measuring x; the only source of error that is accounted for is in the y-coordinate. In fact, both coordinates of an ROC operating point are subject to sampling error. Third, disregard of error in the x-direction is further implicit in the estimates of the thresholds, which according to Eqn. (6.2.19), is given by:</p>
<p><span class="math display">\[\begin{equation*} 
\zeta_r = - \Phi^{-1}\left ( FPF_r \right )
\end{equation*}\]</span></p>
<p>These are “rigid” estimates that assume no error in the FPF values. As was shown in Chapter “Modeling Binary Paradigm”, these are finite sample based estimates, subject to 95% confidence intervals.</p>
<p>[A historical note: prior to computers and easy access to statistical functions the analyst had to use a special plotting paper, termed “double probability paper”, that converted probabilities into x and y distances using the inverse function. The complement of the inverse function is sometimes termed the z-deviate.4 Since this term confused me when I entered this field ca. 1985, and it confuses me even now, I will not use it further.]</p>
</div>
</div>
<div id="maximum-likelihood-estimation-mle" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Maximum likelihood estimation (MLE)</h2>
<p>The approach taken by Dorfman and Alf was to maximize the likelihood function instead of S. The likelihood function is the probability of the observed data given a set of parameter values, i.e.,</p>
<p><span class="math display">\[\begin{equation*} 
\text {L} \equiv P\left ( data \mid \text {parameters} \right )
\end{equation*}\]</span></p>
<p>Generally “data” is suppressed, so likelihood is a function of the parameters; but “data” is always implicit. With reference to Fig. 6.1, the probability of a non-diseased case yielding a count in the 2nd bin equals the area under the curve labeled “Noise” bounded by the vertical lines at <span class="math inline">\(\zeta_1\)</span> and <span class="math inline">\(\zeta_2\)</span>. In general, the probability of a non-diseased case yielding a count in the rth bin equals the area under the curve labeled “Noise” bounded by the vertical lines at <span class="math inline">\(\zeta_{r-1}\)</span> and <span class="math inline">\(\zeta_r\)</span>. Since the area to the left of a threshold is the CDF corresponding to that threshold, the required probability is <span class="math inline">\(\Phi\left ( \zeta_r \right ) - \Phi\left ( \zeta_{r-1} \right )\)</span>; we are simply subtracting two expressions for specificity, Eqn. (6.2.5).</p>
<p><span class="math display">\[\begin{equation*} 
\text {count in non-diseased bin } r = \Phi\left ( \zeta_r \right ) - \Phi\left ( \zeta_{r-1} \right )
\end{equation*}\]</span></p>
<p>Similarly, the probability of a diseased case yielding a count in the rth bin equals the area under the curve labeled “Signal” bounded by the vertical lines at <span class="math inline">\(\zeta_{r-1}\)</span> and <span class="math inline">\(\zeta_r\)</span>. The area under the diseased distribution to the left of threshold <span class="math inline">\(\zeta_r\)</span> is the <span class="math inline">\(1 - TPF\)</span> at that threshold:</p>
<p><span class="math display">\[\begin{equation*} 
1 - \Phi\left ( \frac{\mu-\zeta_r}{\sigma} \right ) = \Phi\left ( \frac{\zeta_r - \mu}{\sigma} \right )
\end{equation*}\]</span></p>
<p>The area between the two thresholds is:</p>
<p><span class="math display">\[\begin{equation*} 
P\left ( \text{count in diseased bin }r \right ) \\ = \Phi\left ( \frac{\zeta_r - \mu}{\sigma} \right ) - \Phi\left ( \frac{\zeta_{r-1} - \mu}{\sigma} \right ) \\
= \Phi\left ( b\zeta_r-a \right ) - \Phi\left ( b\zeta_{r-1}-a \right )
\end{equation*}\]</span></p>
<p>Let <span class="math inline">\(K_{1r}\)</span> denote the number of non-diseased cases in the rth bin, and <span class="math inline">\(K_{2r}\)</span> denotes the number of diseased cases in the rth bin. Consider the number of counts <span class="math inline">\(K_{1r}\)</span> in non-diseased case bin <span class="math inline">\(r\)</span>. Since the probability of each count is <span class="math inline">\(\Phi\left ( \zeta_{r+1} \right ) - \Phi\left ( \zeta_r \right )\)</span>, the probability of the observed number of counts, assuming the counts are independent, is <span class="math inline">\(\left (\Phi\left ( \zeta_{r+1} \right ) - \Phi\left ( \zeta_r \right ) \right )^{K_{1r}}\)</span>. Similarly, the probability of observing counts in diseased case bin <span class="math inline">\(r\)</span> is <span class="math inline">\(\left (\Phi\left ( b\zeta_{r+1}-a \right ) - \Phi\left ( b\zeta_r-a \right ) \right )^{K_{2r}}\)</span>, subject to the same independence assumption. The probability of simultaneously observing <span class="math inline">\(K_{1r}\)</span> counts in non-diseased case bin r and <span class="math inline">\(K_{2r}\)</span> counts in diseased case bin <span class="math inline">\(r\)</span> is the product of these individual probabilities (again, an independence assumption is being used):</p>
<p><span class="math display">\[\begin{equation*} 
\left (\Phi\left ( \zeta_{r+1}  \right ) - \Phi\left ( \zeta_r  \right )  \right )^{K_{1r}} \left (\Phi\left ( b\zeta_{r+1}-a  \right ) - \Phi\left ( b\zeta_r-a  \right )  \right )^{K_{2r}}
\end{equation*}\]</span></p>
<p>Similar expressions apply for all integer values of <span class="math inline">\(r\)</span> ranging from <span class="math inline">\(1,2,...,R\)</span>. Therefore the probability of observing the entire data set is the product of expressions like Eqn. (6.4.5), over all values of <span class="math inline">\(r\)</span>:</p>
<p><span class="math display">\[\begin{equation*} 
\prod_{r=1}^{R}\left [\left (\Phi\left ( \zeta_{r+1}  \right ) - \Phi\left ( \zeta_r  \right )  \right )^{K_{1r}} \left (\Phi\left ( b\zeta_{r+1}-a  \right ) - \Phi\left ( b\zeta_r-a  \right )  \right )^{K_{2r}}  \right ]
\end{equation*}\]</span></p>
<p>We are almost there. A specific combination of <span class="math inline">\(K_{11},K_{12},...,K_{1R}\)</span> counts from <span class="math inline">\(K_1\)</span> non-diseased cases and counts <span class="math inline">\(K_{21},K_{22},...,K_{2R}\)</span> from <span class="math inline">\(K_2\)</span> diseased cases can occur the following number of times (given by the multinomial factor shown below):</p>
<p><span class="math display">\[\begin{equation*} 
\frac{K_1!}{\prod_{r=1}^{R}K_{1r}!}\frac{K_2!}{\prod_{r=1}^{R}K_{2r}!}
\end{equation*}\]</span></p>
<p>The likelihood function is the product of Eqn. (6.4.6) and Eqn. (6.4.7):</p>
<p><span class="math display">\[\begin{equation*} 
L\left ( a,b,\overrightarrow{\zeta} \right ) = \left (\frac{K_1!}{\prod_{r=1}^{R}K_{1r}!}\frac{K_2!}{\prod_{r=1}^{R}K_{2r}!}  \right )\times \\
\prod_{r=1}^{R}\left [\left (\Phi\left ( \zeta_{r+1}  \right ) - \Phi\left ( \zeta_r  \right )  \right )^{K_{1r}} \left (\Phi\left ( b\zeta_{r+1}-a  \right ) - \Phi\left ( b\zeta_r-a  \right )  \right )^{K_{2r}}  \right ]
\end{equation*}\]</span></p>
<p>The left hand side of Eqn. (6.4.8) explicitly shows the dependence of the likelihood function on the parameters of the model, namely <span class="math inline">\(a,b,\overrightarrow{\zeta}\)</span>, where the vector of thresholds is a compact notation for the set of thresholds <span class="math inline">\(\zeta_1,\zeta_2,...,\zeta_R,\)</span> (note that since <span class="math inline">\(\zeta_0 = -\infty\)</span>, and <span class="math inline">\(\zeta_R = +\infty\)</span>, only <span class="math inline">\(R-1\)</span> free threshold parameters are involved, and the total number of free parameters in the model is <span class="math inline">\(R+1\)</span>). For example, for a 5-rating ROC study, the total number of free parameters is 6, i.e., <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and 4 thresholds.</p>
<p>Eqn. (6.4.8) is forbidding but here comes a simplification. The difference of probabilities such as <span class="math inline">\(\Phi\left ( \zeta_r \right )-\Phi\left ( \zeta_{r-1} \right )\)</span> is guaranteed to be positive and less than one: the <span class="math inline">\(\Phi\)</span> function is a probability, i.e., in the range 0 to 1, and since <span class="math inline">\(\zeta_r\)</span> is greater than <span class="math inline">\(\zeta_{r-1}\)</span>, the difference is positive and less than one. When the difference is raised to the power of <span class="math inline">\(K_{1r}\)</span> (a non-negative integer) a very small number can result. Multiplication of all these small numbers may result in an even smaller number, which may be too small to be represented as a floating-point value, especially as the number of counts increases. To prevent this we resort to a trick. Instead of maximizing the likelihood function <span class="math inline">\(L\left ( a,b,\overrightarrow{\zeta} \right )\)</span> we choose to maximize the logarithm of the likelihood function (the base of the logarithm is immaterial). The logarithm of the likelihood function is:</p>
<p><span class="math display">\[\begin{equation*} 
LL\left ( a,b,\overrightarrow{\zeta} \right )=\log \left ( L\left ( a,b,\overrightarrow{\zeta} \right ) \right )
\end{equation*}\]</span></p>
<p>Since the logarithm is a monotonically increasing function of its argument, maximizing the logarithm of the likelihood function is equivalent to maximizing the likelihood function. Taking the logarithm converts the product symbols in Eqn. (6.4.8) to summations, so instead of multiplying small numbers one is adding them, thereby avoiding underflow errors. Another simplification is that one can ignore the logarithm of the multinomial factor involving the factorials, because these do not depend on the parameters of the model. Putting all this together, we get the following expression for the logarithm of the likelihood function:</p>
<p><span class="math display">\[\begin{equation*} 
LL\left ( a,b,\overrightarrow{\zeta} \right ) \propto \\
\sum_{r=1}^{R} K_{1r}\log \left ( \Phi\left ( \zeta_{r+1} \right ) - \Phi\left ( \zeta_r \right ) \right ) + \\
\sum_{r=1}^{R} K_{2r}\log \left ( \Phi\left (b \zeta_{r+1} - a \right ) - \Phi\left ( b \zeta_r - a \right ) \right ) 
\end{equation*}\]</span></p>
<p>If one looks carefully at the left hand side of Eqn. (6.4.10) one sees that it is a function of the model parameters <span class="math inline">\(a,b,\overrightarrow{\zeta}\)</span> and the observed data, the latter being the counts contained in the vectors <span class="math inline">\(\overrightarrow{K_1}\)</span> and <span class="math inline">\(\overrightarrow{K_2}\)</span>, where the vector notation is used as a compact form for the counts <span class="math inline">\(K_{11},K_{12},...,K_{1R}\)</span> and <span class="math inline">\(K_{21},K_{22},...,K_{2R}\)</span>, respectively. The right hand side of Eqn. (6.4.10) is monotonically related to the probability of observing the data given the model parameters <span class="math inline">\(a,b,\overrightarrow{\zeta}\)</span>. If the choice of model parameters is poor, then the probability of observing the data will be small and log likelihood will be small. With a better choice of model parameters the probability and log likelihood will increase. With optimal choice of model parameters the probability and log likelihood will be maximized, and the corresponding optimal values of the model parameters are called maximum likelihood estimates (MLEs). These are the estimates produced by the programs RSCORE and ROCFIT.</p>
<div id="code-implementing-mle" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Code implementing MLE</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="BinormalModel.html#cb11-1"></a>  <span class="kw">library</span>(RJafroc)</span>
<span id="cb11-2"><a href="BinormalModel.html#cb11-2"></a></span>
<span id="cb11-3"><a href="BinormalModel.html#cb11-3"></a><span class="co"># ML estimates of a and b (from Eng JAVA program)</span></span>
<span id="cb11-4"><a href="BinormalModel.html#cb11-4"></a><span class="co"># a &lt;- 1.3204; b &lt;- 0.6075 # these are not used in program; just there for comparison</span></span>
<span id="cb11-5"><a href="BinormalModel.html#cb11-5"></a></span>
<span id="cb11-6"><a href="BinormalModel.html#cb11-6"></a>K1t &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">19</span>, <span class="dv">8</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb11-7"><a href="BinormalModel.html#cb11-7"></a>K2t &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,  <span class="dv">6</span>, <span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">22</span>)</span>
<span id="cb11-8"><a href="BinormalModel.html#cb11-8"></a>dataset &lt;-<span class="st"> </span><span class="kw">Df2RJafrocDataset</span>(K1t, K2t, <span class="dt">InputIsCountsTable =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-9"><a href="BinormalModel.html#cb11-9"></a>retFit &lt;-<span class="st"> </span><span class="kw">FitBinormalRoc</span>(dataset)</span>
<span id="cb11-10"><a href="BinormalModel.html#cb11-10"></a>retFit[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span>
<span id="cb11-11"><a href="BinormalModel.html#cb11-11"></a><span class="co">#&gt; $a</span></span>
<span id="cb11-12"><a href="BinormalModel.html#cb11-12"></a><span class="co">#&gt; [1] 1.320449</span></span>
<span id="cb11-13"><a href="BinormalModel.html#cb11-13"></a><span class="co">#&gt; </span></span>
<span id="cb11-14"><a href="BinormalModel.html#cb11-14"></a><span class="co">#&gt; $b</span></span>
<span id="cb11-15"><a href="BinormalModel.html#cb11-15"></a><span class="co">#&gt; [1] 0.6074912</span></span>
<span id="cb11-16"><a href="BinormalModel.html#cb11-16"></a><span class="co">#&gt; </span></span>
<span id="cb11-17"><a href="BinormalModel.html#cb11-17"></a><span class="co">#&gt; $zetas</span></span>
<span id="cb11-18"><a href="BinormalModel.html#cb11-18"></a><span class="co">#&gt;    zetaFwd1    zetaFwd2    zetaFwd3    zetaFwd4 </span></span>
<span id="cb11-19"><a href="BinormalModel.html#cb11-19"></a><span class="co">#&gt; 0.007679249 0.896272157 1.515648564 2.396721792 </span></span>
<span id="cb11-20"><a href="BinormalModel.html#cb11-20"></a><span class="co">#&gt; </span></span>
<span id="cb11-21"><a href="BinormalModel.html#cb11-21"></a><span class="co">#&gt; $AUC</span></span>
<span id="cb11-22"><a href="BinormalModel.html#cb11-22"></a><span class="co">#&gt; [1] 0.8704517</span></span>
<span id="cb11-23"><a href="BinormalModel.html#cb11-23"></a><span class="co">#&gt; </span></span>
<span id="cb11-24"><a href="BinormalModel.html#cb11-24"></a><span class="co">#&gt; $StdAUC</span></span>
<span id="cb11-25"><a href="BinormalModel.html#cb11-25"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb11-26"><a href="BinormalModel.html#cb11-26"></a><span class="co">#&gt; [1,] 0.03790432</span></span>
<span id="cb11-27"><a href="BinormalModel.html#cb11-27"></a><span class="kw">print</span>(retFit<span class="op">$</span>fittedPlot)</span></code></pre></div>
<p><img src="06-binormal-model_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Note the usage of the <code>RJafroc</code> package <span class="citation">(Chakraborty, Philips, and Zhai <a href="#ref-R-RJafroc" role="doc-biblioref">2020</a>)</span>. Specifically, the function <code>FitBinormalRoc</code>. The ratings table is converted to an <code>RJafroc</code> dataset object, followed by application of the fitting function. The results, contained in <code>retFit</code> should be compared to those obtained from the <a href="http://www.rad.jhmi.edu/jeng/javarad/roc/JROCFITi.html">website implementation of ROCFIT</a>.</p>
</div>
<div id="validating-the-fitting-model" class="section level3" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> Validating the fitting model</h3>
<p>The above ROC curve is a good visual fit to the observed operating points. Quantification of the validity of the fitting model is accomplished by calculating the Pearson goodness-of-fit test <span class="citation">(Pearson <a href="#ref-RN2656" role="doc-biblioref">1900</a>)</span>, also known as the chi-square test, which uses the statistic defined by <span class="citation">(Larsen and Marx <a href="#ref-RN1492" role="doc-biblioref">2001</a>)</span>:</p>
<p><span class="math display">\[\begin{equation*} 
C^2=\sum_{t=1}^{2}\sum_{r=1}^{R}\frac{\left (K_{tr}-\left \langle K_{tr} \right \rangle  \right )^2}{\left \langle K_{tr} \right \rangle}\\
K_{tr} \geq 5
\end{equation*}\]</span></p>
<p>The expected values are given by:</p>
<p><span class="math display">\[\begin{equation*} 
\left \langle K_{1r} \right \rangle=K_1\left ( \Phi\left ( \zeta_{r+1} \right ) \right - \Phi\left ( \zeta_r \right ))\\
\left \langle K_{2r} \right \rangle=K_2\left ( \Phi\left ( a\zeta_{r+1}-b \right ) \right - \Phi\left ( a\zeta_r - b\right ))
\end{equation*}\]</span></p>
<p>These expressions should make sense: the difference between the two CDF functions is the probability of a count in the specified bin, and multiplication by the total number of relevant cases should yield the expected counts (a non-integer).</p>
<p>It can be shown that under the null hypothesis that the assumed probability distribution functions for the counts equals the true probability distributions, i.e., the model is valid, the statistic <span class="math inline">\(C^2\sim \chi_{df}^{2}\)</span> is distributed as:</p>
<p><span class="math display">\[\begin{equation*} 
C^2\sim \chi_{df}^{2}
\end{equation*}\]</span></p>
<p>Here <span class="math inline">\(C^2\sim \chi_{df}^{2}\)</span> is the chi-square distribution with degrees of freedom <span class="math inline">\(ddf\)</span> defined by:</p>
<p><span class="math display">\[\begin{equation*} 
ddf=\left ( R-1 \right )+\left ( R-1 \right )-\left (2+ R-1 \right )=\left ( R-3 \right )
\end{equation*}\]</span></p>
<p>The right hand side of the above equation has been written in an expansive form to illustrate the general rule: for <span class="math inline">\(R\)</span> non-diseased cells in the ratings table, the degree of freedom is <span class="math inline">\(R-1\)</span>: this is because when all but one cells are specified, the last is determined, because they must sum to <span class="math inline">\(K_1\)</span> . Similarly, the degree of freedom for the diseased cells is also <span class="math inline">\(R-1\)</span>. Last, we need to subtract the number of free parameters in the model, which is <span class="math inline">\((2+R-1)\)</span>, i.e., the <span class="math inline">\(a,b\)</span> parameters and the <span class="math inline">\(R-1\)</span> thresholds. It is evident that if <span class="math inline">\(R = 3\)</span> then <span class="math inline">\(df = 0\)</span>. In this situation, there are only two non-trivial operating points and the straight-line fit shown will pass through both of them. With two basic parameters, fitting two points is trivial, and goodness of fit cannot be calculated.</p>
<p>Under the null hypothesis (i.e., model is valid) <span class="math inline">\(C^2\)</span> is distributed as <span class="math inline">\(\chi_{df}^{2}\)</span>. Therefore, one computes the probability that this statistic is larger than the observed value, called the <em>p-value</em>. If this probability is very small, that means that the deviations of the observed values of the cell counts from the expected values are so large that it is unlikely that the model is correct. The degree of unlikeliness is quantified by the p-value. Poor fits lead to small p values.</p>
<p>At the 5% significance level, one concludes that the fit is not good if <span class="math inline">\(p &lt; 0.05\)</span>. In practice one occasionally accepts smaller values of <span class="math inline">\(p\)</span>, <span class="math inline">\(p &gt; 0.001\)</span> before completely abandoning a model. It is known that adoption of a stricter criterion, e.g., <span class="math inline">\(p &gt; 0.05\)</span>, can occasionally lead to rejection of a retrospectively valid model <span class="citation">(Press et al. <a href="#ref-RN300" role="doc-biblioref">2007</a>)</span>.</p>
</div>
<div id="estimating-the-covariance-matrix" class="section level3" number="5.3.3">
<h3><span class="header-section-number">5.3.3</span> Estimating the covariance matrix</h3>
<p>See book chapter 6.4.3. This is implemented in RJafroc.</p>
</div>
<div id="estimating-the-variance-of-az" class="section level3" number="5.3.4">
<h3><span class="header-section-number">5.3.4</span> Estimating the variance of Az</h3>
<p>See book chapter 6.4.4. This is implemented in RJafroc.</p>
</div>
<div id="expression-for-area-under-roc-curve" class="section level3" number="5.3.5">
<h3><span class="header-section-number">5.3.5</span> Expression for area under ROC curve</h3>
<p><span class="math display">\[\begin{equation*} 
A_z=\Phi\left ( \frac{a}{\sqrt{1+b^2}} \right )=\Phi\left ( \frac{\mu}{\sqrt{1+\sigma^2}} \right )
\end{equation*}\]</span></p>
</div>
</div>
<div id="discussion" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Discussion</h2>
<p>This chapter has covered much territory. The binormal model is historically very important and the contribution by Dorfman and Alf <span class="citation">(Dorfman and Alf <a href="#ref-RN212" role="doc-biblioref">1968</a>)</span> was seminal. Prior to their work, there was no valid way of estimating AUC from observed ratings counts. Their work and a key paper by Lusted <span class="citation">(Lusted <a href="#ref-RN1487" role="doc-biblioref">1971</a>)</span> accelerated research using ROC methods. The number of publications using their algorithm, and the more modern versions developed by Metz and colleagues, is probably well in excess of 500. Because of its key role, the author has endeavored to take out some of the mystery about how the binormal model parameters are estimated. In particular, a common misunderstanding that the binormal model assumptions are violated by real datasets, when in fact it is quite robust to apparent deviations from normality, is addressed.</p>
<p>A good understanding of this chapter should enable the reader to better understand alternative ROC models, discussed in a later chapter.</p>
<p>It has been stated that the <code>b</code>-parameter of the binormal model is generally observed to be less than one, consistent with the diseased distribution being wider than the non-diseased one. The ROC literature is largely silent on the reason for this finding. One reason, namely location uncertainty, is presented in Chapter “Predictions of the RSM”, where RSM stands for Radiological Search Model. Basically, if the location of the lesion is unknown, then z-samples from diseased cases can be of two types, samples from the correct lesion location, or samples from other non-lesion locations. The resulting mixture distribution will then appear to have larger variance than the corresponding samples from non-diseased cases. This type of mixing need not be restricted to location uncertainty. Even is location is known, if the lesions are non-homogenous (e.g., they contain a range of contrasts) then a similar mixture-distribution induced broadening is expected. The contaminated binormal model (CBM) - see Chapter TBA - also predicts that the diseased distribution is wider than the non-diseased one.</p>
<p>The fact that the <code>b</code>-parameter is less than unity implies that the predicted ROC curve is improper, meaning its slope is not monotone decreasing as the operating point moves up the curve. The result is that a portion of the curve, near (1,1) that crosses the chance-diagonal and hooks upward approaching (1,1) with infinite slope. Ways of fitting proper ROC curves are described in Chapter “Other proper ROC models”. Usually the hook is not readily visible, which has been used as an excuse to ignore the problem. For example, in Fig. 6.4, one would have to “zoom-in” on the upper right corner to see it, but the reader should make no mistake about it, the hook is there as .</p>
<p>A recent example is Fig. 1 in the publication resulting from the Digital Mammographic Imaging Screening Trial (DMIST) clinical trial <span class="citation">(Pisano et al. <a href="#ref-RN1784" role="doc-biblioref">2005</a>)</span> involving 49,528 asymptomatic women from 33 clinical sites and involving 153 radiologists, where each of the film modality ROC plots crosses the chance diagonal and hooks upwards to (1,1), which as is known, results anytime .</p>
<p>The unphysical nature of the hook (predicting worse than chance-level performance for supposedly expert readers) is not the only reason for seeking alternate ROC models. The binormal model is susceptible to degeneracy problems. If the dataset does not provide any interior operating points (i.e., all observed points lie on the axes defined by FPF = 0 or TPF = 1) then the model fits these points with b = 0. The resulting straight-line segment fits do not make physical sense. These problems are addressed by the contaminated binormal model16 to be discussed in Chapter “Other proper ROC models”. The first paper in the series has particularly readable accounts of data degeneracy.</p>
<p>To this day the binormal model is widely used to fit ROC datasets. In spite of its limitations, the binormal model has been very useful in bringing a level of quantification to this field that did not exist prior to the work <span class="citation">(Dorfman and Alf <a href="#ref-RN212" role="doc-biblioref">1968</a>)</span> by Dorfman and Alf.</p>
</div>
<div id="references-2" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> References</h2>

</div>
</div>
<h3>REFERENCES</h3>
<div id="refs" class="references">
<div id="ref-R-RJafroc">
<p>Chakraborty, Dev, Peter Philips, and Xuetong Zhai. 2020. <em>RJafroc: Analyzing Diagnostic Observer Performance Studies</em>. <a href="https://dpc10ster.github.io/RJafrocRJafrocBook/">https://dpc10ster.github.io/RJafrocRJafrocBook/</a>.</p>
</div>
<div id="ref-RN212">
<p>Dorfman, D. D., and E. Alf. 1968. “Maximum Likelihood Estimation of Parameters of Signal Detection Theory- a Direct Solution.” Journal Article. <em>Psychometrika</em> 33 (1): 117–24.</p>
</div>
<div id="ref-RN100">
<p>Dorfman, D. D., K. S. Berbaum, C. E. Metz, R. V. Lenth, J. A. Hanley, and H. Abu Dagga. 1997. “Proper Receiving Operating Characteristic Analysis: The Bigamma Model.” Journal Article. <em>Acad. Radiol.</em> 4 (2): 138–49.</p>
</div>
<div id="ref-RN1216">
<p>Hanley, James A. 1988. “The Robustness of the "Binormal" Assumptions Used in Fitting Roc Curves.” Journal Article. <em>Med. Decis. Making</em> 8 (3): 197–203.</p>
</div>
<div id="ref-RN1492">
<p>Larsen, Richard J., and Morris L. Marx. 2001. <em>An Introduction to Mathematical Statistics and Its Applications</em>. Book. 3rd ed. Upper Saddle River, NJ: Prentice-Hall Inc.</p>
</div>
<div id="ref-RN1487">
<p>Lusted, L. B. 1971. “Signal Detectability and Medical Decision Making.” Journal Article. <em>Science</em> 171: 1217–1219.</p>
</div>
<div id="ref-RN2656">
<p>Pearson, Karl. 1900. “X. On the Criterion That a Given System of Deviations from the Probable in the Case of a Correlated System of Variables Is Such That It Can Be Reasonably Supposed to Have Arisen from Random Sampling.” Journal Article. <em>The London, Edinburgh, and Dublin Philosophical Magazine and Journal of Science</em> 50 (302): 157–75.</p>
</div>
<div id="ref-RN1784">
<p>Pisano, E. D., C. Gatsonis, E. Hendrick, M. Yaffe, J. K. Baum, S. Acharyya, E. F. Conant, et al. 2005. “Diagnostic Performance of Digital Versus Film Mammography for Breast-Cancer Screening.” Journal Article. <em>N Engl J Med</em> 353 (17): 1–11.</p>
</div>
<div id="ref-RN300">
<p>Press, W. H., S. A. Teukolsky, W. T. Vetterling, and B. P. Flannery. 2007. <em>Numerical Recipes: The Art of Scientific Computing</em>. Book. 3rd ed. Cambridge: Cambridge University Press.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ratingsParadigm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="rocdataformat.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["RJafrocBook.pdf", "RJafrocBook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
