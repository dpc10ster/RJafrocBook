<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Simulate an FROC split plot dataset | RJafroc Documentation</title>
  <meta name="description" content="Extended RJafroc documentation." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Simulate an FROC split plot dataset | RJafroc Documentation" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Extended RJafroc documentation." />
  <meta name="github-repo" content="dpc10ster/RJafrocBook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Simulate an FROC split plot dataset | RJafroc Documentation" />
  
  <meta name="twitter:description" content="Extended RJafroc documentation." />
  

<meta name="author" content="Dev P. Chakraborty, PhD" />


<meta name="date" content="2020-03-10" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="frocSpdataformat.html"/>
<link rel="next" href="references-6.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">RJafroc documentation</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#references"><i class="fa fa-check"></i><b>1.1</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rocdataformat.html"><a href="rocdataformat.html"><i class="fa fa-check"></i><b>2</b> ROC data format</a><ul>
<li class="chapter" data-level="2.1" data-path="rocdataformat.html"><a href="rocdataformat.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="rocdataformat.html"><a href="rocdataformat.html#note-to-existing-users"><i class="fa fa-check"></i><b>2.2</b> Note to existing users</a></li>
<li class="chapter" data-level="2.3" data-path="rocdataformat.html"><a href="rocdataformat.html#the-excel-data-format"><i class="fa fa-check"></i><b>2.3</b> The Excel data format</a></li>
<li class="chapter" data-level="2.4" data-path="rocdataformat.html"><a href="rocdataformat.html#illustrative-toy-file"><i class="fa fa-check"></i><b>2.4</b> Illustrative toy file</a></li>
<li class="chapter" data-level="2.5" data-path="rocdataformat.html"><a href="rocdataformat.html#the-truth-worksheet"><i class="fa fa-check"></i><b>2.5</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="2.6" data-path="rocdataformat.html"><a href="rocdataformat.html#the-structure-of-an-roc-dataset"><i class="fa fa-check"></i><b>2.6</b> The structure of an ROC dataset</a></li>
<li class="chapter" data-level="2.7" data-path="rocdataformat.html"><a href="rocdataformat.html#the-false-positive-fp-ratings"><i class="fa fa-check"></i><b>2.7</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="2.8" data-path="rocdataformat.html"><a href="rocdataformat.html#the-true-positive-tp-ratings"><i class="fa fa-check"></i><b>2.8</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="2.9" data-path="rocdataformat.html"><a href="rocdataformat.html#correspondence-between-nl-member-of-dataset-and-the-fp-worksheet"><i class="fa fa-check"></i><b>2.9</b> Correspondence between <code>NL</code> member of dataset and the <code>FP</code> worksheet</a></li>
<li class="chapter" data-level="2.10" data-path="rocdataformat.html"><a href="rocdataformat.html#correspondence-between-ll-member-of-dataset-and-the-tp-worksheet"><i class="fa fa-check"></i><b>2.10</b> Correspondence between <code>LL</code> member of dataset and the <code>TP</code> worksheet</a></li>
<li class="chapter" data-level="2.11" data-path="rocdataformat.html"><a href="rocdataformat.html#correspondence-using-the-which-function"><i class="fa fa-check"></i><b>2.11</b> Correspondence using the <code>which</code> function</a></li>
<li class="chapter" data-level="2.12" data-path="rocdataformat.html"><a href="rocdataformat.html#references-1"><i class="fa fa-check"></i><b>2.12</b> References</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="frocdataformat.html"><a href="frocdataformat.html"><i class="fa fa-check"></i><b>3</b> FROC data format</a><ul>
<li class="chapter" data-level="3.1" data-path="frocdataformat.html"><a href="frocdataformat.html#purpose"><i class="fa fa-check"></i><b>3.1</b> Purpose</a></li>
<li class="chapter" data-level="3.2" data-path="frocdataformat.html"><a href="frocdataformat.html#introduction-1"><i class="fa fa-check"></i><b>3.2</b> Introduction</a></li>
<li class="chapter" data-level="3.3" data-path="frocdataformat.html"><a href="frocdataformat.html#the-excel-data-format-1"><i class="fa fa-check"></i><b>3.3</b> The Excel data format</a></li>
<li class="chapter" data-level="3.4" data-path="frocdataformat.html"><a href="frocdataformat.html#the-truth-worksheet-1"><i class="fa fa-check"></i><b>3.4</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="3.5" data-path="frocdataformat.html"><a href="frocdataformat.html#the-structure-of-an-froc-dataset"><i class="fa fa-check"></i><b>3.5</b> The structure of an FROC dataset</a></li>
<li class="chapter" data-level="3.6" data-path="frocdataformat.html"><a href="frocdataformat.html#the-false-positive-fp-ratings-1"><i class="fa fa-check"></i><b>3.6</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="3.7" data-path="frocdataformat.html"><a href="frocdataformat.html#the-true-positive-tp-ratings-1"><i class="fa fa-check"></i><b>3.7</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="3.8" data-path="frocdataformat.html"><a href="frocdataformat.html#on-the-distribution-of-numbers-of-lesions-in-abnormal-cases"><i class="fa fa-check"></i><b>3.8</b> On the distribution of numbers of lesions in abnormal cases</a><ul>
<li class="chapter" data-level="3.8.1" data-path="frocdataformat.html"><a href="frocdataformat.html#definition-of-lesdistr-array"><i class="fa fa-check"></i><b>3.8.1</b> Definition of <code>lesDistr</code> array</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="frocdataformat.html"><a href="frocdataformat.html#definition-of-leswghtdistr-array"><i class="fa fa-check"></i><b>3.9</b> Definition of <code>lesWghtDistr</code> array</a></li>
<li class="chapter" data-level="3.10" data-path="frocdataformat.html"><a href="frocdataformat.html#summary"><i class="fa fa-check"></i><b>3.10</b> Summary</a></li>
<li class="chapter" data-level="3.11" data-path="frocdataformat.html"><a href="frocdataformat.html#references-2"><i class="fa fa-check"></i><b>3.11</b> References</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html"><i class="fa fa-check"></i><b>4</b> ROC split plot data format</a><ul>
<li class="chapter" data-level="4.1" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-excel-data-format-2"><i class="fa fa-check"></i><b>4.2</b> The Excel data format</a></li>
<li class="chapter" data-level="4.3" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-truth-worksheet-2"><i class="fa fa-check"></i><b>4.3</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="4.4" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-structure-of-the-roc-split-plot-dataset"><i class="fa fa-check"></i><b>4.4</b> The structure of the ROC split plot dataset</a></li>
<li class="chapter" data-level="4.5" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-truthtablestr-member"><i class="fa fa-check"></i><b>4.5</b> The <code>truthTableStr</code> member</a></li>
<li class="chapter" data-level="4.6" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-false-positive-fp-ratings-2"><i class="fa fa-check"></i><b>4.6</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="4.7" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#the-true-positive-tp-ratings-2"><i class="fa fa-check"></i><b>4.7</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="4.8" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#summary-1"><i class="fa fa-check"></i><b>4.8</b> Summary</a></li>
<li class="chapter" data-level="4.9" data-path="rocSpdataformat.html"><a href="rocSpdataformat.html#references-3"><i class="fa fa-check"></i><b>4.9</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html"><i class="fa fa-check"></i><b>5</b> FROC split plot data format</a><ul>
<li class="chapter" data-level="5.1" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#introduction-3"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-excel-data-format-3"><i class="fa fa-check"></i><b>5.2</b> The Excel data format</a></li>
<li class="chapter" data-level="5.3" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-truth-worksheet-3"><i class="fa fa-check"></i><b>5.3</b> The <code>Truth</code> worksheet</a></li>
<li class="chapter" data-level="5.4" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-structure-of-the-froc-split-plot-dataset"><i class="fa fa-check"></i><b>5.4</b> The structure of the FROC split plot dataset</a></li>
<li class="chapter" data-level="5.5" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-false-positive-fp-ratings-3"><i class="fa fa-check"></i><b>5.5</b> The false positive (FP) ratings</a></li>
<li class="chapter" data-level="5.6" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#the-true-positive-tp-ratings-3"><i class="fa fa-check"></i><b>5.6</b> The true positive (TP) ratings</a></li>
<li class="chapter" data-level="5.7" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#summary-2"><i class="fa fa-check"></i><b>5.7</b> Summary</a></li>
<li class="chapter" data-level="5.8" data-path="frocSpdataformat.html"><a href="frocSpdataformat.html#references-4"><i class="fa fa-check"></i><b>5.8</b> References</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="SimufrocSpdataset.html"><a href="SimufrocSpdataset.html"><i class="fa fa-check"></i><b>6</b> Simulate an FROC split plot dataset</a><ul>
<li class="chapter" data-level="6.1" data-path="SimufrocSpdataset.html"><a href="SimufrocSpdataset.html#this-vignette-is-under-construction"><i class="fa fa-check"></i><b>6.1</b> This vignette is under construction!!</a></li>
<li class="chapter" data-level="6.2" data-path="SimufrocSpdataset.html"><a href="SimufrocSpdataset.html#the-starting-point-is-an-actual-crossed-froc-dataset"><i class="fa fa-check"></i><b>6.2</b> The starting point is an actual crossed FROC dataset</a></li>
<li class="chapter" data-level="6.3" data-path="SimufrocSpdataset.html"><a href="SimufrocSpdataset.html#understanding-truthtablestr-object-t1"><i class="fa fa-check"></i><b>6.3</b> Understanding <code>truthTableStr</code> object <code>t1</code></a></li>
<li class="chapter" data-level="6.4" data-path="SimufrocSpdataset.html"><a href="SimufrocSpdataset.html#modify-a-crossed-froc-workbook-to-simulate-a-split-plot-froc-design"><i class="fa fa-check"></i><b>6.4</b> Modify a crossed FROC workbook to simulate a split-plot FROC design</a></li>
<li class="chapter" data-level="6.5" data-path="SimufrocSpdataset.html"><a href="SimufrocSpdataset.html#example-of-deletion-of-interpretations"><i class="fa fa-check"></i><b>6.5</b> Example of deletion of interpretations</a></li>
<li class="chapter" data-level="6.6" data-path="SimufrocSpdataset.html"><a href="SimufrocSpdataset.html#understanding-truthtablestr-object-t2"><i class="fa fa-check"></i><b>6.6</b> Understanding <code>truthTableStr</code> object <code>t2</code></a></li>
<li class="chapter" data-level="6.7" data-path="SimufrocSpdataset.html"><a href="SimufrocSpdataset.html#references-5"><i class="fa fa-check"></i><b>6.7</b> References</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-6.html"><a href="references-6.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">RJafroc Documentation</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="SimufrocSpdataset" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Simulate an FROC split plot dataset</h1>
<div id="this-vignette-is-under-construction" class="section level2">
<h2><span class="header-section-number">6.1</span> This vignette is under construction!!</h2>
<ul>
<li>This is a follow-up on the recently added (v1.3.1) capability to read a split-plot dataset.</li>
<li>Lacking an actual split-plot dataset to test the routines, I decided to simulate one.</li>
<li>The simulated dataset is of dataType FROC and the number of cases interpreted by each reader is reader-dependent.</li>
<li>This makes it <em>really</em> exercise the validity of the <code>DfReadDataFile</code> function.</li>
<li>In my experience, the <code>dataset$truthTableStr</code> member is invaluable in catching data entry errors so much of this vignette focuses on it.</li>
</ul>
</div>
<div id="the-starting-point-is-an-actual-crossed-froc-dataset" class="section level2">
<h2><span class="header-section-number">6.2</span> The starting point is an actual crossed FROC dataset</h2>
<p>The example shown below begins with the Excel file <code>inst/extdata/FrocData.xlsx</code> in the project directory (this corresponds to the 5-modality FED dataset <code>dataseet04</code> <span class="citation">(Zanca et al. <a href="#ref-RN1882">2009</a>)</span> with modalities 1, 2 and 3 removed). The first statement retrieves the name of the data file, located in a hidden directory that one need not be concerned with. The second statement reads the file using <code>DfReadDataFile()</code> and saves it to object <code>x1</code>. The next statement extracts the <code>truthTableStr</code> list member, saves it to <code>t1</code> and shows its structure.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">fed &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;FrocData.xlsx&quot;</span>,</a>
<a class="sourceLine" id="cb26-2" title="2">                       <span class="dt">package =</span> <span class="st">&quot;RJafroc&quot;</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-3" title="3">x1 &lt;-<span class="st"> </span><span class="kw">DfReadDataFile</span>(fed, <span class="dt">newExcelFileFormat =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb26-4" title="4">t1 &lt;-<span class="st"> </span>x1<span class="op">$</span>truthTableStr</a>
<a class="sourceLine" id="cb26-5" title="5"><span class="kw">str</span>(t1)</a>
<a class="sourceLine" id="cb26-6" title="6"><span class="co">#&gt;  num [1:2, 1:4, 1:200, 1:4] 1 1 1 1 1 1 1 1 1 1 ...</span></a></code></pre></div>
<ul>
<li>There are 100 normal and 100 abnormal cases in this two-modality four-reader crossed dataset.</li>
<li>Note that <code>t1</code> is the original crossed dataset <code>truthTableStr</code>.</li>
<li>Recall from earlier vignette that for the fourth subscript of <code>t1</code> the value 1 applies to cases with no lesions (normals), value 2 applies to cases with one lesion, value 3 applies to cases with two lesions and 4 applies to cases with three lesions.</li>
<li>The value for any allowed interpretation is 1 and otherwise it is <code>NA</code>.</li>
</ul>
</div>
<div id="understanding-truthtablestr-object-t1" class="section level2">
<h2><span class="header-section-number">6.3</span> Understanding <code>truthTableStr</code> object <code>t1</code></h2>
<ul>
<li>The following line yields 200 (=2*100) as reader 1 (second subscript) provides interpretations in both modalities (first subscript is blank meaning both modalities) for all 100 normal cases (third subscript is 1:100 and fourth subscript is 1) and therefore each of these interpretations yields a <code>TRUE</code> (i.e., 1).</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(t1[,<span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb27-2" title="2"><span class="co">#&gt; [1] 200</span></a></code></pre></div>
<ul>
<li>The following line yields 0 as the third subscript is 1:100, implying normal cases, but the fourth subscript is 2:4, implyng abnormal cases and therefore each of these interpretations yields an NA and <code>!is.na(NA)</code> equals <code>FALSE</code> (i.e., zero).</li>
</ul>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(t1[,<span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>]))</a>
<a class="sourceLine" id="cb28-2" title="2"><span class="co">#&gt; [1] 0</span></a></code></pre></div>
<ul>
<li>The following line also yields 800 (=2x4x100) as readers 1:4 provide interpretations in both modalities for all normal cases and each interpretation yields a 1.</li>
</ul>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(t1[,,<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb29-2" title="2"><span class="co">#&gt; [1] 800</span></a></code></pre></div>
<ul>
<li>The following line yields 200 (=2*100) because the fourth subscript (2) applies to abnormal cases with at least one lesion, and each abnormal case is guaranteed to have at least one lesion (i.e., a 1 entry in the <code>LesionID</code> column of the Excel Truth worksheet) and each of these interpretations yields a 1.</li>
</ul>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(t1[,<span class="dv">1</span>,<span class="dv">101</span><span class="op">:</span><span class="dv">200</span>,<span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb30-2" title="2"><span class="co">#&gt; [1] 200</span></a></code></pre></div>
<ul>
<li>The following line yields 62 (=2x31) because the fourth subscript (3) applies to abnormal cases with at least two lesions, and inspection of the <code>LesionID</code> column in the original Excel file reveals that 31 abnormal cases have two lesions.</li>
</ul>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(t1[,<span class="dv">1</span>,<span class="dv">101</span><span class="op">:</span><span class="dv">200</span>,<span class="dv">3</span>]))</a>
<a class="sourceLine" id="cb31-2" title="2"><span class="co">#&gt; [1] 62</span></a></code></pre></div>
<ul>
<li>The following line yields 22 (=2x11) because the fourth subscript (4) applies to abnormal cases with three lesions. Inspection of the <code>LesionID</code> column reveals that 11 abnormal cases have three lesions.</li>
</ul>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(t1[,<span class="dv">1</span>,<span class="dv">101</span><span class="op">:</span><span class="dv">200</span>,<span class="dv">4</span>]))</a>
<a class="sourceLine" id="cb32-2" title="2"><span class="co">#&gt; [1] 22</span></a></code></pre></div>
<ul>
<li>The following line yields 242 (=200+31+11), the number of rows in the <code>Truth</code> worksheet.</li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(t1[<span class="dv">1</span>,<span class="dv">1</span>,,]))</a>
<a class="sourceLine" id="cb33-2" title="2"><span class="co">#&gt; [1] 242</span></a></code></pre></div>
</div>
<div id="modify-a-crossed-froc-workbook-to-simulate-a-split-plot-froc-design" class="section level2">
<h2><span class="header-section-number">6.4</span> Modify a crossed FROC workbook to simulate a split-plot FROC design</h2>
<ul>
<li>We create a simulated split-plot FROC dataset starting from a crossed FROC dataset.</li>
<li>The basic idea is to modify interpretations that do not belong to a specified split-plot design.</li>
<li>This was done (one could say the “hard way”) by manually making apppropriate changes to <code>inst/extdata/FrocData.xlsx</code> and saving the results to <code>inst/extdata/toyFiles/FROC/FrocDataSpVaryK1K2.xlsx</code>. The filename is intended to emphasize that the numbers of normal and abnormal cases can be reader-dependent, as long as they individually add up to 100.</li>
<li>We divided the 100 normal and 100 abnormal cases into 4 groups of normal and abnormal cases, where each group is interpreted by one reader only.</li>
<li>The first groups of cases, interpreted by reader 1 (label “1”), consists of 23 normal (case labels “100:122”) and 24 abnormal (case labels “0:23”) cases.</li>
<li>The second groups of cases, interpreted by reader 2 (label “3”), consists of 27 normal (case labels “123:149”) and 26 abnormal (case labels “24:49”) cases.</li>
<li>The third groups of cases, interpreted by reader 3 (label “4”), consists of 22 normal (case labels “150:171”) and 23 abnormal (case labels “51:73”) cases.</li>
<li>The fourth groups of cases, interpreted by reader 4 (label “5”), consists of 28 normal (case labels “172:199”) and 27 abnormal (case labels c(“50,74:99”)) cases.</li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:frocDataSpVaryK1K2"></span>
<img src="images/frocData.png" alt="Truth worksheets; (a) LEFT=FrocData.xlsx, original crossed dataset; (b) RIGHT=FrocDataSpVaryK1K2.xlsx, modified split-plot dataset" width="50%" height="20%" /><img src="images/frocDataSpVaryK1K2.png" alt="Truth worksheets; (a) LEFT=FrocData.xlsx, original crossed dataset; (b) RIGHT=FrocDataSpVaryK1K2.xlsx, modified split-plot dataset" width="50%" height="20%" />
<p class="caption">
FIGURE 6.1: Truth worksheets; (a) LEFT=FrocData.xlsx, original crossed dataset; (b) RIGHT=FrocDataSpVaryK1K2.xlsx, modified split-plot dataset
</p>
</div>
<ul>
<li>The above figure shows that the <code>ReaderID</code> column for cases <code>0:23</code> has been replaced with a 1, meaning that only reader 1 interprets these cases in both modalities. This yields 24 abnormal cases for reader 1 in each modality. Normal cases for this reader are <code>100:122</code>.</li>
<li>Not shown above: <strong>all interpretations by reader 1 occurring for cases outside of <code>0:23</code> and <code>100:122</code> in the other two worksheets (<code>TP</code> and <code>FP</code>) are deleted</strong>.</li>
<li>The <code>ReaderID</code> column for cases <code>24:49</code> are replaced by 3, corresponding to the second reader. All interpretations by this reader for cases outside of <code>24:49</code> in the other two worksheets are deleted. Normal cases for this reader are <code>123:149</code> and observations outside of this range in the <code>TP</code> and <code>FP</code> worsheets are deleted.</li>
<li>The <code>ReaderID</code> column for cases <code>51:73</code> are replaced by 4, corresponding to the third reader. All interpretations by this reader for cases outside of <code>51:73</code> in the other two worksheets are deleted. Normal cases for this reader are <code>150:171</code> and observations outside of this range in the <code>TP</code> and <code>FP</code> worsheets are deleted.</li>
<li>The <code>ReaderID</code> column for cases <code>50</code> and <code>74:79</code> are replaced by 5, corresponding to the fourth reader. All interpretations by this reader for cases outside of the specified range in the other two worksheets are deleted. Normal cases for this reader are <code>172:199</code> and observations outside of this range in the <code>TP</code> and <code>FP</code> worsheets are deleted.
<!-- * The modifed file is saved to `extdata/toyFiles/FROC/FrocDataSpVaryK1K2.xlsx`. --></li>
<li>The modified file is read by the code chunk below. The read function explicitly tests that observations outside of the specified ranges in the <code>Truth</code> sheet are not present in the other two worksheets.</li>
</ul>
</div>
<div id="example-of-deletion-of-interpretations" class="section level2">
<h2><span class="header-section-number">6.5</span> Example of deletion of interpretations</h2>
<div class="figure" style="text-align: center"><span id="fig:frocDataSpVaryK1K2FP"></span>
<img src="images/frocDataFP.png" alt="FP worksheets; (a) LEFT=FrocDataFP.xlsx, original crossed dataset; (b) RIGHT=FrocDataSpVaryK1K2FP.xlsx, modified split-plot dataset" width="50%" height="20%" /><img src="images/frocDataSpVaryK1K2FP.png" alt="FP worksheets; (a) LEFT=FrocDataFP.xlsx, original crossed dataset; (b) RIGHT=FrocDataSpVaryK1K2FP.xlsx, modified split-plot dataset" width="50%" height="20%" />
<p class="caption">
FIGURE 6.2: FP worksheets; (a) LEFT=FrocDataFP.xlsx, original crossed dataset; (b) RIGHT=FrocDataSpVaryK1K2FP.xlsx, modified split-plot dataset
</p>
</div>
<ul>
<li>The two figures above illustrate deletion of interpretations.</li>
<li>The left panel shows the <code>FP</code> worksheet for the original crossed data.</li>
<li>For reader 1 and modality 4 it contains cases 29, 30, 44, …, 91, 96 that do not belong to the split-plot dataset for this reader.</li>
<li>Specifically, they are outside of <code>0:23</code> and <code>100:122</code>, the allowed ranges for this reader.</li>
<li>These are deleted, see right panel of above figure. The next allowed cases for this reader are <code>107, 109,...., 122</code>.</li>
<li>The procedure is repeated for all readers and both <code>TP</code> and <code>FP</code> sheets.</li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">fedsp &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;toyFiles/FROC/FrocDataSpVaryK1K2.xlsx&quot;</span>,</a>
<a class="sourceLine" id="cb34-2" title="2">                       <span class="dt">package =</span> <span class="st">&quot;RJafroc&quot;</span>, <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb34-3" title="3">x2 &lt;-<span class="st"> </span><span class="kw">DfReadDataFile</span>(fedsp, <span class="dt">newExcelFileFormat =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb34-4" title="4">t2 &lt;-<span class="st"> </span>x2<span class="op">$</span>truthTableStr</a></code></pre></div>
</div>
<div id="understanding-truthtablestr-object-t2" class="section level2">
<h2><span class="header-section-number">6.6</span> Understanding <code>truthTableStr</code> object <code>t2</code></h2>
<ul>
<li>The following line below yields 46 (= 2x23) as reader 1 (second subscript) provides interpretations in both modalities (first subscript is blank) for all normal cases (third subscript is 1:100 and fourth subscript is 1) and there are 23 normal cases interpreted by reader 1.</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(t2[,<span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>,<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb35-2" title="2"><span class="co">#&gt; [1] 46</span></a></code></pre></div>
<ul>
<li>The following line confirms the first line, with a 1 contribution coming from each case in range 1:23.</li>
</ul>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1"><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(t2[,<span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">23</span>,<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb36-2" title="2"><span class="co">#&gt; [1] 46</span></a></code></pre></div>
<ul>
<li>The following line yields 48 (= 2x24) because the fourth subscript (2) applies to abnormal cases with at least one lesion, and we know that this reader has interpreted 24 abnormal cases.</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(t2[,<span class="dv">1</span>,<span class="dv">101</span><span class="op">:</span><span class="dv">124</span>,<span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb37-2" title="2"><span class="co">#&gt; [1] 48</span></a></code></pre></div>
<ul>
<li>The following line yields 54 (= 2x27) because the fourth subscript (1) applies to normal cases and we know that reader 2 has interpreted 27 normal cases.</li>
</ul>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(t2[,<span class="dv">2</span>,,<span class="dv">1</span>]))</a>
<a class="sourceLine" id="cb38-2" title="2"><span class="co">#&gt; [1] 54</span></a></code></pre></div>
<ul>
<li>The following line yields 52 (= 2x26) because the fourth subscript (2:4) applies to abnormal cases with at least one lesion, and we know that reader 2 has interpreted 26 abnormal cases.</li>
</ul>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(t2[,<span class="dv">2</span>,,<span class="dv">2</span><span class="op">:</span><span class="dv">4</span>]))</a>
<a class="sourceLine" id="cb39-2" title="2"><span class="co">#&gt; [1] 52</span></a></code></pre></div>
</div>
<div id="references-5" class="section level2">
<h2><span class="header-section-number">6.7</span> References</h2>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-RN1882">
<p>Zanca, Federica, Jurgen Jacobs, Van OngevalChantal, Filip Claus, Valerie Celis, Catherine Geniets, Veerle Provost, Herman Pauwels, Guy Marchal, and Hilde Bosmans. 2009. “Evaluation of Clinical Image Processing Algorithms Used in Digital Mammography.” Journal Article. <em>Medical Physics</em> 36 (3): 765–75.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="frocSpdataformat.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references-6.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["RJafrocBook.pdf", "RJafrocBook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
